<!DOCTYPE html><html lang='en'><head><title>[allocator.adaptor.members]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>20</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>20.13</a> Class template <span class='texttt'>scoped_allocator_adaptor</span> <a class='abbr_ref' href='allocator.adaptor#members'>[allocator.adaptor]</a></h2><div id='allocator.adaptor.members'><h3 ><a class='secnum' style='min-width:103pt'>20.13.4</a> Scoped allocator adaptor members <a class='abbr_ref'>[allocator.adaptor.members]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p >In the <span class='texttt'>construct</span> member functions,
<i>OUTERMOST(x)</i> is <span class='texttt'>x</span> if <span class='texttt'>x</span> does not have an
<span class='texttt'>outer_allocator()</span> member function and <br/>
<i>OUTERMOST(x.outer_allocator())</i>
otherwise;
<i>OUTERMOST_ALLOC_TRAITS(x)</i> is <br/>
<span class='texttt'>allocator_traits&lt;decltype(<i>OUTERMOST</i>(x))&gt;</span>.
[&nbsp;<i>Note:</i> <i>OUTERMOST</i>(x) and <br/>
<i>OUTERMOST_ALLOC_TRAITS</i>(x) are recursive operations. It
is incumbent upon the definition of <span class='texttt'>outer_allocator()</span> to ensure that the
recursion terminates. It will terminate for all instantiations of <br/>
<span class='texttt'>scoped_allocator_adaptor</span>. <i>&nbsp;—&nbsp;end note</i>&nbsp;]</p><p ><span class='indexparent'><a class='index' id='inner_allocator,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,inner_allocator'></a></span><code class='itemdecl'>
inner_allocator_type&amp; inner_allocator() noexcept;
const inner_allocator_type&amp; inner_allocator() const noexcept;
</code></p></div><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>*this</span> if <span class='texttt'>sizeof...(InnerAllocs)</span> is zero; otherwise,
<span class='texttt'>inner</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='outer_allocator,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,outer_allocator'></a></span><code class='itemdecl'>
outer_allocator_type&amp; outer_allocator() noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>static_cast&lt;OuterAlloc&amp;&gt;(*this)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='outer_allocator,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,outer_allocator'></a></span><code class='itemdecl'>
const outer_allocator_type&amp; outer_allocator() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>static_cast&lt;const OuterAlloc&amp;&gt;(*this)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='allocate,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,allocate'></a></span><code class='itemdecl'>
pointer allocate(size_type n);
</code></p><div class='itemdescr'></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>allocator_traits&lt;OuterAlloc&gt;::allocate(outer_allocator(), n)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='allocate,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,allocate'></a></span><code class='itemdecl'>
pointer allocate(size_type n, const_void_pointer hint);
</code></p><div class='itemdescr'></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>allocator_traits&lt;OuterAlloc&gt;::allocate(outer_allocator(), n, hint)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='deallocate,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,deallocate'></a></span><code class='itemdecl'>
void deallocate(pointer p, size_type n) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><p ><i>Effects:</i> As if by:
<span class='texttt'>allocator_traits&lt;OuterAlloc&gt;::deallocate(outer_allocator(), p, n);</span>
</p></div></div><p ><span class='indexparent'><a class='index' id='max_size,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,max_size'></a></span><code class='itemdecl'>
size_type max_size() const;
</code></p><div class='itemdescr'></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>allocator_traits&lt;OuterAlloc&gt;::max_size(outer_allocator())</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='construct,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,construct'></a></span><code class='itemdecl'>
template &lt;class T, class... Args&gt;
  void construct(T* p, Args&amp;&amp;... args);
</code></p><div class='itemdescr'></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><p ><i>Effects:</i></p><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#9.1'>(9.1)</a></div><p >If <span class='texttt'>uses_allocator_v&lt;T, inner_allocator_type&gt;</span> is <span class='texttt'>false</span> and<br/>
<span class='texttt'>is_constructible_v&lt;T, Args...&gt;</span> is <span class='texttt'>true</span>, calls<br/>
<i>OUTERMOST_ALLOC_TRAITS</i>(<span class='texttt'>*this</span>)<span class='texttt'>::construct(<br/>
<i>OUTERMOST</i>(*this), p, std::forward&lt;Args&gt;(args)...)</span>.</p></li><li id='9.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#9.2'>(9.2)</a></div><p >Otherwise, if <span class='texttt'>uses_allocator_v&lt;T, inner_allocator_type&gt;</span> is <span class='texttt'>true</span> and
<span class='texttt'>is_constructible_v&lt;T, allocator_arg_t, inner_allocator_type&amp;, Args...&gt;</span> is <span class='texttt'>true</span>, calls
<i>OUTERMOST_ALLOC_TRAITS</i>(<span class='texttt'>*this</span>)<span class='texttt'>::construct(<i>OUTERMOST</i>(*this),
p, allocator_arg,<br/>inner_allocator(), std::forward&lt;Args&gt;(args)...)</span>.</p></li><li id='9.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#9.3'>(9.3)</a></div><p >Otherwise, if <span class='texttt'>uses_allocator_v&lt;T, inner_allocator_type&gt;</span> is <span class='texttt'>true</span> and
<span class='texttt'>is_constructible_v&lt;T, Args..., inner_allocator_type&amp;&gt;</span> is <span class='texttt'>true</span>, calls
<i>OUTERMOST_ALLOC_TRAITS</i>(*this)::
<span class='texttt'>construct(<i>OUTERMOST</i>(*this), p, std::forward&lt;Args&gt;(args)...,<br/>inner_allocator())</span>.</p></li><li id='9.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#9.4'>(9.4)</a></div><p >Otherwise, the program is ill-formed. [&nbsp;<i>Note:</i> An error will result if
<span class='texttt'>uses_allocator</span> evaluates to <span class='texttt'>true</span> but the specific constructor does not take an
allocator. This definition prevents a silent failure to pass an inner allocator to a
contained element. <i>&nbsp;—&nbsp;end note</i>&nbsp;]
</p></li></ul></div></div><p ><span class='indexparent'><a class='index' id='construct,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,construct'></a></span><code class='itemdecl'>
template &lt;class T1, class T2, class... Args1, class... Args2&gt;
  void construct(pair&lt;T1, T2&gt;* p, piecewise_construct_t,
                 tuple&lt;Args1...&gt; x, tuple&lt;Args2...&gt; y);
</code></p><div class='itemdescr'></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><p ><i>Requires:</i> all of the types in <span class='texttt'>Args1</span> and <span class='texttt'>Args2</span> shall be
<span class='texttt'>CopyConstructible</span> (Table <a href='utility.arg.requirements#tab:copyconstructible'>[tab:copyconstructible]</a>).</p></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><p ><i>Effects:</i> Constructs a <span class='texttt'>tuple</span> object <span class='texttt'>xprime</span> from <span class='texttt'>x</span> by the
following rules:</p><ul class='itemize'><li id='11.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.1'>(11.1)</a></div><p >If <span class='texttt'>uses_allocator_v&lt;T1, inner_allocator_type&gt;</span> is <span class='texttt'>false</span> and<br/>
<span class='texttt'>is_constructible_v&lt;T1, Args1...&gt;</span> is <span class='texttt'>true</span>,
then <span class='texttt'>xprime</span> is <span class='texttt'>x</span>.</p></li><li id='11.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.2'>(11.2)</a></div><p >Otherwise, if <span class='texttt'>uses_allocator_v&lt;T1, inner_allocator_type&gt;</span> is <span class='texttt'>true</span>
and
<span class='texttt'>is_constructible_v&lt;T1, allocator_arg_t, inner_allocator_type&amp;, Args1...&gt;</span>
is
<span class='texttt'>true</span>, then <span class='texttt'>xprime</span> is
<span class='texttt'>tuple_cat(tuple&lt;allocator_arg_t, inner_allocator_type&amp;&gt;(
allocator_arg, inner_allocator()), std::move(x))</span>.</p></li><li id='11.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.3'>(11.3)</a></div><p >Otherwise, if <span class='texttt'>uses_allocator_v&lt;T1, inner_allocator_type&gt;</span> is
<span class='texttt'>true</span> and
<span class='texttt'>is_constructible_v&lt;T1, Args1..., inner_allocator_type&amp;&gt;</span> is <span class='texttt'>true</span>,
then <span class='texttt'>xprime</span> is
<span class='texttt'>tuple_cat(std::move(x), tuple&lt;inner_allocator_type&amp;&gt;(inner_allocator()))</span>.</p></li><li id='11.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.4'>(11.4)</a></div><p >Otherwise, the program is ill-formed.
</p></li></ul><p >and constructs a <span class='texttt'>tuple</span> object <span class='texttt'>yprime</span> from <span class='texttt'>y</span> by the following rules:</p><ul class='itemize'><li id='11.5'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.5'>(11.5)</a></div><p >If <span class='texttt'>uses_allocator_v&lt;T2, inner_allocator_type&gt;</span> is <span class='texttt'>false</span> and<br/>
<span class='texttt'>is_constructible_v&lt;T2,
Args2...&gt;</span> is <span class='texttt'>true</span>, then <span class='texttt'>yprime</span> is <span class='texttt'>y</span>.</p></li><li id='11.6'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.6'>(11.6)</a></div><p >Otherwise, if <span class='texttt'>uses_allocator_v&lt;T2, inner_allocator_type&gt;</span> is <span class='texttt'>true</span>
and
<span class='texttt'>is_constructible_v&lt;T2, allocator_arg_t, inner_allocator_type&amp;, Args2...&gt;</span>
is
<span class='texttt'>true</span>, then <span class='texttt'>yprime</span> is
<span class='texttt'>tuple_cat(tuple&lt;allocator_arg_t, inner_allocator_type&amp;&gt;(
allocator_arg, inner_allocator()), std::move(y))</span>.</p></li><li id='11.7'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.7'>(11.7)</a></div><p >Otherwise, if <span class='texttt'>uses_allocator_v&lt;T2, inner_allocator_type&gt;</span> is
<span class='texttt'>true</span> and
<span class='texttt'>is_constructible_v&lt;T2, Args2..., inner_allocator_type&amp;&gt;</span> is <span class='texttt'>true</span>,
then <span class='texttt'>yprime</span> is
<span class='texttt'>tuple_cat(std::move(y), tuple&lt;inner_allocator_type&amp;&gt;(inner_allocator()))</span>.</p></li><li id='11.8'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#11.8'>(11.8)</a></div><p >Otherwise, the program is ill-formed.
</p></li></ul><p >then calls <span class='texttt'><i>OUTERMOST_ALLOC_TRAITS</i>(*this)::construct(<i>OUTERMOST</i>(*this), p,<br/>
piecewise_construct, std::move(xprime), std::move(yprime))</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='construct,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,construct'></a></span><code class='itemdecl'>
template &lt;class T1, class T2&gt;
  void construct(pair&lt;T1, T2&gt;* p);
</code></p><div class='itemdescr'></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><p ><i>Effects:</i> Equivalent to:
</p><pre class='codeblock'>
construct(p, piecewise_construct, tuple&lt;&gt;(), tuple&lt;&gt;());
</pre></div></div><p ><span class='indexparent'><a class='index' id='construct,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,construct'></a></span><code class='itemdecl'>
template &lt;class T1, class T2, class U, class V&gt;
  void construct(pair&lt;T1, T2&gt;* p, U&amp;&amp; x, V&amp;&amp; y);
</code></p><div class='itemdescr'></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><p ><i>Effects:</i> Equivalent to:
</p><pre class='codeblock'>
construct(p, piecewise_construct,
          forward_as_tuple(std::forward&lt;U&gt;(x)),
          forward_as_tuple(std::forward&lt;V&gt;(y)));
</pre></div></div><p ><span class='indexparent'><a class='index' id='construct,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,construct'></a></span><code class='itemdecl'>
template &lt;class T1, class T2, class U, class V&gt;
  void construct(pair&lt;T1, T2&gt;* p, const pair&lt;U, V&gt;&amp; x);
</code></p><div class='itemdescr'></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><p ><i>Effects:</i> Equivalent to:
</p><pre class='codeblock'>
construct(p, piecewise_construct,
          forward_as_tuple(x.first),
          forward_as_tuple(x.second));
</pre></div></div><p ><span class='indexparent'><a class='index' id='construct,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,construct'></a></span><code class='itemdecl'>
template &lt;class T1, class T2, class U, class V&gt;
  void construct(pair&lt;T1, T2&gt;* p, pair&lt;U, V&gt;&amp;&amp; x);
</code></p><div class='itemdescr'></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><p ><i>Effects:</i> Equivalent to:
</p><pre class='codeblock'>
construct(p, piecewise_construct,
          forward_as_tuple(std::forward&lt;U&gt;(x.first)),
          forward_as_tuple(std::forward&lt;V&gt;(x.second)));
</pre></div></div><p ><span class='indexparent'><a class='index' id='destroy,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,destroy'></a></span><code class='itemdecl'>
template &lt;class T&gt;
  void destroy(T* p);
</code></p><div class='itemdescr'></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><p ><i>Effects:</i> Calls <span class='texttt'><i>OUTERMOST_ALLOC_TRAITS</i>(*this)::destroy(<i>OUTERMOST</i>(*this), p)</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='select_on_container_copy_construction,scoped_allocator_adaptor'></a></span><span class='indexparent'><a class='index' id='scoped_allocator_adaptor,select_on_container_copy_construction'></a></span><code class='itemdecl'>
scoped_allocator_adaptor select_on_container_copy_construction() const;
</code></p><div class='itemdescr'></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><p ><i>Returns:</i> A new <span class='texttt'>scoped_allocator_adaptor</span> object where each allocator <span class='texttt'>A</span> in the
adaptor is initialized from the result of calling
<span class='texttt'>allocator_traits&lt;A&gt;::select_on_container_copy_construction()</span> on the
corresponding allocator in <span class='texttt'>*this</span>.
</p></div></div></div></div></body></html>