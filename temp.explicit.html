<!DOCTYPE html><html lang='en'><head><title>[temp.explicit]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>14</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>14.7</a> Template instantiation and specialization <a class='abbr_ref' href='temp.spec#temp.explicit'>[temp.spec]</a></h2><div id='temp.explicit'><h3 ><a class='secnum' style='min-width:103pt'>14.7.2</a> Explicit instantiation <a class='abbr_ref'>[temp.explicit]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4862'>#</a></div><p ><span class='indexparent'><a class='index' id='instantiation,explicit'></a></span>A class, function, variable, or member template specialization can be explicitly
instantiated from its template.
A member function, member class or static data member of a class template can
be explicitly instantiated from the member definition associated with its class
template. An explicit instantiation of a function template
or member function of a class template
shall not
use the <span class='texttt'>inline</span> or <span class='texttt'>constexpr</span> specifiers.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4873'>#</a></div><p >The syntax for explicit instantiation is:</p><pre class='bnf'><a class='nontermdef' id='nt:explicit-instantiation'>explicit-instantiation:</a>
&#9;<span class='terminal'>extern<span id="MathJax-Element-1-Frame" class="mjx-chtml"><span id="MJXc-Node-1" class="mjx-math"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-4" class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-5" class="mjx-texatom" style=""><span id="MJXc-Node-6" class="mjx-mrow"><span id="MJXc-Node-7" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span id="MJXc-Node-8" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span id="MJXc-Node-9" class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span></span> <span class='terminal'>template</span> <i ><a href='dcl.dcl#nt:declaration'>declaration</a></i>
</pre><p >There are two forms of explicit instantiation: an explicit instantiation
definition and an explicit instantiation declaration. An explicit instantiation
declaration begins with the <span class='texttt'>extern</span> keyword.</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4885'>#</a></div><p >If the explicit instantiation is for a class or member class, the
<i ><a href='dcl.type.elab#nt:elaborated-type-specifier'>elaborated-type-specifier</a></i> in the <i ><a href='dcl.dcl#nt:declaration'>declaration</a></i> shall
include a <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>. If the explicit instantiation is for
a function or member function,
the
<i ><a href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a></i>
in the
<i ><a href='dcl.dcl#nt:declaration'>declaration</a></i>
shall be either a
<i ><a href='temp.names#nt:template-id'>template-id</a></i>
or, where all template arguments can be deduced, a
<i ><a href='temp.names#nt:template-name'>template-name</a></i> or <i ><a href='over.oper#nt:operator-function-id'>operator-function-id</a></i>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
The declaration may declare a
<i ><a href='expr.prim.id.qual#nt:qualified-id'>qualified-id</a></i>,
in which case the
<i ><a href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a></i>
of the
<i ><a href='expr.prim.id.qual#nt:qualified-id'>qualified-id</a></i>
must be a
<i ><a href='temp.names#nt:template-id'>template-id</a></i>.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
If the explicit instantiation is for a member function, a member class or
a static data member of a class template specialization,
the name of the class template specialization in the
<i ><a href='expr.prim.id.qual#nt:qualified-id'>qualified-id</a></i>
for the member name shall be a <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>.
If the explicit instantiation is for a variable, the
<i ><a href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a></i> in the declaration shall be a
<i ><a href='temp.names#nt:template-id'>template-id</a></i>.
An explicit instantiation shall appear in an enclosing namespace
of its template. If the name declared in the explicit
instantiation is an unqualified name, the explicit instantiation
shall appear in the namespace where its template is declared or, if that
namespace is inline (<a href='namespace.def'>[namespace.def]</a>), any namespace from its enclosing
namespace set.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
Regarding qualified names in declarators, see <a href='dcl.meaning'>[dcl.meaning]</a>.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><pre class='codeblock'>
template&lt;class T&gt; class Array { void mf(); };
template class Array&lt;char&gt;;
template void Array&lt;int&gt;::mf();

template&lt;class T&gt; void sort(Array&lt;T&gt;&amp; v) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }
template void sort(Array&lt;char&gt;&amp;);       <span class='comment'>// argument is deduced here
</span>
namespace N {
  template&lt;class T&gt; void f(T&amp;) { }
}
template void N::f&lt;int&gt;(int&amp;);</pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4942'>#</a></div><p >A declaration of a function template, a variable template, a member function
or static data member
of a class template, or a member function template of a class or class
template shall precede an explicit instantiation of that entity. A definition
of a class template, a member class of a class template, or a member class
template of a class or class template shall precede an explicit instantiation
of that entity unless the explicit instantiation is preceded by an explicit
specialization of the entity with the same template arguments.
If the
<i ><a href='dcl.dcl#nt:declaration'>declaration</a></i>
of the explicit instantiation names an implicitly-declared special member
function (Clause <a href='special'>[special]</a>), the program is ill-formed.</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4956'>#</a></div><p >For a given set of template arguments, if an explicit
instantiation of a template appears after a declaration of
an explicit specialization for that template, the explicit
instantiation has no effect. Otherwise, for an explicit instantiation
definition the definition of a
function template, a variable template, a member
function template, or a member function or static
data member of a class template shall be present in every
translation unit in which it is explicitly instantiated.</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4967'>#</a></div><p >An explicit instantiation of a class, function template, or variable template
specialization is
placed in the namespace in which the template is defined.
An explicit instantiation for a member of a class template is placed in
the namespace where the enclosing class template is defined.
An explicit instantiation for a member template is placed in the namespace
where the enclosing class or class template is defined.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><pre class='codeblock'>
namespace N {
  template&lt;class T&gt; class Y { void mf() { } };
}

template class Y&lt;int&gt;;                  <span class='comment'>// error: class template <span class='tcode_in_codeblock'>Y</span> not visible in the global namespace
</span>
using N::Y;
template class Y&lt;int&gt;;                  <span class='comment'>// error: explicit instantiation outside of the
</span>                                        <span class='comment'>// namespace of the template
</span>
template class N::Y&lt;char*&gt;;             <span class='comment'>// OK: explicit instantiation in namespace <span class='tcode_in_codeblock'>N</span>
</span>template void N::Y&lt;double&gt;::mf();       <span class='comment'>// OK: explicit instantiation in namespace <span class='tcode_in_codeblock'>N</span>
</span></pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L4993'>#</a></div><p >A trailing
<i ><a href='temp.names#nt:template-argument'>template-argument</a></i>
can be left unspecified in an explicit instantiation of a function template
specialization or of a member function template specialization provided
it can be deduced from the type of a function parameter (<a href='temp.deduct'>[temp.deduct]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><pre class='codeblock'>
template&lt;class T&gt; class Array { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
template&lt;class T&gt; void sort(Array&lt;T&gt;&amp; v) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }

<span class='comment'>// instantiate <span class='tcode_in_codeblock'>sort(Array&lt;int&gt;&amp;)</span> - template-argument deduced
</span>template void sort&lt;&gt;(Array&lt;int&gt;&amp;);</pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L5010'>#</a></div><p >An explicit instantiation that names a class
template specialization is also an explicit
instantiation of the same kind (declaration or definition) of each
of its members (not including members inherited from base classes and members
that are templates) that has not been previously explicitly specialized in
the translation unit containing the explicit instantiation,
except as described below.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> In addition, it will typically be an explicit instantiation of certain
implementation-dependent data about the class. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L5021'>#</a></div><p >An explicit instantiation definition that names a class template
specialization explicitly instantiates the class template specialization
and is an explicit instantiation definition of only those
members that have been defined at the point of instantiation.</p></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L5027'>#</a></div><p >Except for inline functions and variables, declarations with types deduced from their
initializer or return value (<a href='dcl.spec.auto'>[dcl.spec.auto]</a>), <span class='texttt'>const</span> variables of
literal types,
variables of reference types, and class template specializations,
explicit instantiation declarations have the
effect of suppressing the implicit instantiation of the entity to which they
refer. [<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> The intent is that an inline function that is the
subject of an explicit instantiation declaration will still be implicitly
instantiated when odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>) so that the body can be considered for inlining, but
that no out-of-line copy of the inline function would be generated in the
translation unit.<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L5040'>#</a></div><p >If an entity is the subject of both an explicit instantiation declaration
and an explicit instantiation definition in the same translation unit, the
definition shall follow the declaration. An entity that is the subject of an
explicit instantiation declaration and that is also used
in a way that would otherwise cause an implicit instantiation (<a href='temp.inst'>[temp.inst]</a>)
in the translation unit
shall be the subject of an explicit instantiation definition somewhere in the
program; otherwise the program is ill-formed, no diagnostic required.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> This rule does apply to inline functions even though an
explicit instantiation declaration of such an entity has no other normative
effect. This is needed to ensure that if the address of an inline function is
taken in a translation unit in which the implementation chose to suppress the
out-of-line body, another translation unit will supply the body.<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
An explicit instantiation declaration shall not name a specialization of a
template with internal linkage.</p></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L5059'>#</a></div><p >The usual access checking rules do not apply to names used to specify
explicit instantiations.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
In particular, the template arguments and names used in the function
declarator (including parameter types, return types and exception
specifications) may be private types or objects which would normally
not be accessible and the template may be a member template or member
function which would not normally be accessible.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/c7f6a9139872aad48a944d018ce5e4b3de15ce81/source/templates.tex#L5070'>#</a></div><p >An explicit instantiation does not constitute a use of a default argument,
so default argument instantiation is not done.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><pre class='codeblock'>
char* p = 0;
template&lt;class T&gt; T g(T x = &amp;p) { return x; }
template int g&lt;int&gt;(int);       <span class='comment'>// OK even though <span class='tcode_in_codeblock'>&amp;p</span> isn't an <span class='tcode_in_codeblock'>int</span>.
</span></pre><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div></div></div></body></html>