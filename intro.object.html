<!DOCTYPE html><html lang='en'><head><title>[intro.object]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>4</a> General principles <a class='abbr_ref' href='./#intro'>[intro]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>4.5</a> The C++ object model <a class='abbr_ref'>[intro.object]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L550'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object_model'></a></span>The constructs in a C++ program create, destroy, refer to, access, and
manipulate objects<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>An <a class='hidden_link' href='#def:object' id='def:object'><i >object</i></a> is created
by a <a href='basic.def'>definition</a>,
by a <i ><a href='expr.new#nt:new-expression'>new-expression</a></i>,
when implicitly changing the active member of a <a href='class.union'>union</a>,
or
when a temporary object is created (<a href='conv.rval'>[conv.rval]</a>, <a href='class.temporary'>[class.temporary]</a>)<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>An object occupies a region of storage
in its period of construction (<a href='class.cdtor'>[class.cdtor]</a>),
throughout its <a href='basic.life'>lifetime</a>,
and
in its period of destruction (<a href='class.cdtor'>[class.cdtor]</a>)<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'><div id='1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-11' class='sentence'>A function is not an object, regardless of whether or not it
occupies storage in the way that objects do<a class='hidden_link' href='#1.sentence-11'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='1.sentence-5' class='sentence'>
The properties of an
object are determined when the object is created<a class='hidden_link' href='#1.sentence-5'>.</a></div> <div id='1.sentence-6' class='sentence'>An object can have a
<a href='basic#def:name'>name</a><a class='hidden_link' href='#1.sentence-6'>.</a></div> <div id='1.sentence-7' class='sentence'>An object has a
<a href='basic.stc#def:storage_duration'>storage duration</a> which influences its
<a href='basic.life'>lifetime</a><a class='hidden_link' href='#1.sentence-7'>.</a></div> <div id='1.sentence-8' class='sentence'>An object has a
<a href='basic.types'>type</a><a class='hidden_link' href='#1.sentence-8'>.</a></div> <div id='1.sentence-9' class='sentence'>Some objects are
<a href='class.virtual#def:polymorphic_class'>polymorphic</a>; the implementation
generates information associated with each such object that makes it
possible to determine that object's type during program execution<a class='hidden_link' href='#1.sentence-9'>.</a></div> <div id='1.sentence-10' class='sentence'>For
other objects, the interpretation of the values found therein is
determined by the type of the <i ><a href='expr.comma#nt:expression'>expression</a></i><span class='textit'>s</span> (Clause <a href='expr'>[expr]</a>)
used to access them<a class='hidden_link' href='#1.sentence-10'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L581'>#</a></div><div id='2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':subobject'></a></span>Objects can contain other objects, called <a class='hidden_link' href='#def:subobject' id='def:subobject'><i >subobjects</i></a><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>A subobject can be
a <a class='hidden_link' href='#def:member_subobject' id='def:member_subobject'><i >member subobject</i></a> (<a href='class.mem'>[class.mem]</a>), a <a class='hidden_link' href='#def:base_class_subobject' id='def:base_class_subobject'><i >base class subobject</i></a>
(Clause <a href='class.derived'>[class.derived]</a>), or an array element<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'><span class='indexparent'><a class='index' id=':object,complete'></a></span>An object that is not a subobject of any other object is called a <a class='hidden_link' href='#def:complete_object' id='def:complete_object'><i >complete
object</i></a><a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'>If an object is created
in storage associated with a member subobject or array element <span class='textit'>e</span>
(which may or may not be within its lifetime),
the created object
is a subobject of <span class='textit'>e</span>'s containing object if:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div><div id='2.1.sentence-7' class='sentence'>the lifetime of <span class='textit'>e</span>'s containing object has begun and not ended, and</div></li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div><div id='2.2.sentence-8' class='sentence'>the storage for the new object exactly overlays the storage location associated with <span class='textit'>e</span>, and</div></li><li id='2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.3'>(2.3)</a></div><div id='2.3.sentence-9' class='sentence'>the new object is of the same type as <span class='textit'>e</span> (ignoring cv-qualification)<a class='hidden_link' href='#2.3.sentence-9'>.</a></div></li></ul></div> <div id='2.sentence-5' class='sentence'><div id='2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-10' class='sentence'>If the subobject contains a reference member or a <span class='texttt'>const</span> subobject,
the name of the original subobject cannot be used to access the new object (<a href='basic.life'>[basic.life]</a>)<a class='hidden_link' href='#2.sentence-10'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='2.sentence-6' class='sentence'><div id='2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='2.sentence-11' class='sentence'><pre class='codeblock'>
struct X { const int n; };
union U { X x; float f; };
void tong() {
  U u = {{ 1 }};
  u.f = 5.f;                          <span class='comment'>// OK, creates new subobject of <span class='tcode_in_codeblock'>u</span> (<a href='class.union'>[class.union]</a>)
</span>  X *p = new (&amp;u.x) X {2};            <span class='comment'>// OK, creates new subobject of <span class='tcode_in_codeblock'>u</span>
</span>  assert(p-&gt;n == 2);                  <span class='comment'>// OK
</span>  assert(*std::launder(&amp;u.x.n) == 2); <span class='comment'>// OK
</span>  assert(u.x.n == 2);                 <span class='comment'>// undefined behavior, <span class='tcode_in_codeblock'>u.x</span> does not name new subobject
</span>}</pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L622'>#</a></div><div id='3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object,providing_storage_for'></a></span>If a complete object is created (<a href='expr.new'>[expr.new]</a>)
in storage associated with another object <span class='textit'>e</span>
of type “array of <span class='math'><span class='mathalpha'>N</span></span> <span class='texttt'>unsigned char</span>” or
of type “array of <span class='math'><span class='mathalpha'>N</span></span> <span class='texttt'>std&#x200b;::&#x200b;byte</span>” (<a href='cstddef.syn'>[cstddef.syn]</a>),
that array <a class='hidden_link' href='#def:provides_storage' id='def:provides_storage'><i >provides storage</i></a>
for the created object if:
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><div id='3.1.sentence-4' class='sentence'>the lifetime of <span class='textit'>e</span> has begun and not ended, and</div></li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div><div id='3.2.sentence-5' class='sentence'>the storage for the new object fits entirely within <span class='textit'>e</span>, and</div></li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div><div id='3.3.sentence-6' class='sentence'>there is no smaller array object that satisfies these constraints<a class='hidden_link' href='#3.3.sentence-6'>.</a></div></li></ul></div> <div id='3.sentence-2' class='sentence'><div id='3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-7' class='sentence'>If that portion of the array
previously provided storage for another object,
the lifetime of that object ends
because its storage was reused (<a href='basic.life'>[basic.life]</a>)<a class='hidden_link' href='#3.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='3.sentence-3' class='sentence'><div id='3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='3.sentence-8' class='sentence'><pre class='codeblock'>
template&lt;typename ...T&gt;
struct AlignedUnion {
  alignas(T...) unsigned char data[max(sizeof(T)...)];
};
int f() {
  AlignedUnion&lt;int, char&gt; au;
  int *p = new (au.data) int;     <span class='comment'>// OK, <span class='tcode_in_codeblock'>au.data</span> provides storage
</span>  char *c = new (au.data) char(); <span class='comment'>// OK, ends lifetime of <span class='tcode_in_codeblock'>*p</span>
</span>  char *d = new (au.data + 1) char();
  return *c + *d; <span class='comment'>// OK
</span>}

struct A { unsigned char a[32]; };
struct B { unsigned char b[16]; };
A a;
B *b = new (a.a + 8) B;      <span class='comment'>// <span class='tcode_in_codeblock'>a.a</span> provides storage for <span class='tcode_in_codeblock'>*b</span>
</span>int *p = new (b-&gt;b + 4) int; <span class='comment'>// <span class='tcode_in_codeblock'>b-&gt;b</span> provides storage for <span class='tcode_in_codeblock'>*p</span>
</span>                             <span class='comment'>// <span class='tcode_in_codeblock'>a.a</span> does not provide storage for <span class='tcode_in_codeblock'>*p</span> (directly),
</span>                             <span class='comment'>// but <span class='tcode_in_codeblock'>*p</span> is nested within <span class='tcode_in_codeblock'>a</span> (see below)
</span></pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L668'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object,nested_within'></a></span>An object <span class='textit'>a</span> is <a class='hidden_link' href='#def:nested_within' id='def:nested_within'><i >nested within</i></a> another object <span class='textit'>b</span> if:
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><div id='4.1.sentence-2' class='sentence'><span class='textit'>a</span> is a subobject of <span class='textit'>b</span>, or</div></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><div id='4.2.sentence-3' class='sentence'><span class='textit'>b</span> provides storage for <span class='textit'>a</span>, or</div></li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div><div id='4.3.sentence-4' class='sentence'>there exists an object <span class='textit'>c</span>
where <span class='textit'>a</span> is nested within <span class='textit'>c</span>,
and <span class='textit'>c</span> is nested within <span class='textit'>b</span><a class='hidden_link' href='#4.3.sentence-4'>.</a></div></li></ul></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L682'>#</a></div><div id='5.sentence-1' class='sentence'>For every object <span class='texttt'>x</span>, there is some object called the
<a class='hidden_link' href='#def:complete_object_of' id='def:complete_object_of'><i >complete object of</i></a> <span class='texttt'>x</span>, determined as follows:
<ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><div id='5.1.sentence-2' class='sentence'>If <span class='texttt'>x</span> is a complete object, then the complete object
of <span class='texttt'>x</span> is itself<a class='hidden_link' href='#5.1.sentence-2'>.</a></div></li><li id='5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.2'>(5.2)</a></div><div id='5.2.sentence-3' class='sentence'>Otherwise, the complete object of <span class='texttt'>x</span> is the complete object
of the (unique) object that contains <span class='texttt'>x</span><a class='hidden_link' href='#5.2.sentence-3'>.</a></div></li></ul></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L695'>#</a></div><div id='6.sentence-1' class='sentence'>If a complete object, a <a href='class.mem#def:data_member'>data member</a>, or an array element is of
class type, its type is considered the <a class='hidden_link' href='#def:most_derived_class' id='def:most_derived_class'><i >most derived
class</i></a>, to distinguish it from the class type of any base class subobject;
an object of a most derived class type or of a non-class type is called a
<a class='hidden_link' href='#def:most_derived_object' id='def:most_derived_object'><i >most derived object</i></a><a class='hidden_link' href='#6.sentence-1'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L702'>#</a></div><div id='7.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':most_derived_object,bit-field'></a></span>Unless it is a <a href='class.bit'>bit-field</a>, a most derived object shall have a
nonzero size and shall occupy one or more bytes of storage<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>Base class
subobjects may have zero size<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>An object of trivially copyable or
<a href='basic.types#def:standard-layout_types'>standard-layout type</a>
shall occupy contiguous bytes of storage<a class='hidden_link' href='#7.sentence-3'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L710'>#</a></div><div id='8.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':most_derived_object,bit-field_'></a></span><span class='indexparent'><a class='index' id=':most_derived_object,zero_size_subobject'></a></span>Unless an object is a bit-field or a base class subobject of zero size, the
address of that object is the address of the first byte it occupies<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>Two objects <span class='textit'>a</span> and <span class='textit'>b</span>
with overlapping lifetimes
that are not bit-fields
may have the same address
if one is nested within the other,
or
if at least one is a base class subobject of zero size
and they are of different types;
otherwise, they have distinct addresses<a class='hidden_link' href='#8.sentence-2'>.</a><a class='footnotenum' href='#footnote-5'>5</a></div> <div id='8.sentence-3' class='sentence'><div id='8.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='8.sentence-4' class='sentence'><pre class='codeblock'>
static const char test1 = 'x';
static const char test2 = 'x';
const bool b = &amp;test1 != &amp;test2;      <span class='comment'>// always <span class='tcode_in_codeblock'>true</span>
</span></pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/8c005473ba69d52314d5c399c9c9adb6429cc7ed/source/intro.tex#L736'>#</a></div><div id='9.sentence-1' class='sentence'><div id='9.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='9.sentence-3' class='sentence'>C++  provides a variety of fundamental types and several ways of composing
new types from existing types (<a href='basic.types'>[basic.types]</a>)<a class='hidden_link' href='#9.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div> <div id='9.sentence-2' class='sentence'></div></div><div class='footnote' id='footnote-5'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-5'>5)</a></div><div id='footnote-5.sentence-1' class='sentence'>Under the “as-if” rule an
implementation is allowed to store two objects at the same machine address or
not store an object at all if the program cannot observe the
difference (<a href='intro.execution'>[intro.execution]</a>)<a class='hidden_link' href='#footnote-5.sentence-1'>.</a></div></div></div></body></html>