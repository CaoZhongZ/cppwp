<!DOCTYPE html><html lang='en'><head><title>[dcl.init.aggr]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>11</a> Declarators <a class='abbr_ref' href='./#dcl.decl'>[dcl.decl]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>11.6</a> Initializers <a class='abbr_ref' href='dcl.init#aggr'>[dcl.init]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>11.6.1</a> Aggregates <a class='abbr_ref'>[dcl.init.aggr]</a></h3><span class='indexparent'><a class='index' id=':aggregate'></a></span><span class='indexparent'><a class='index' id=':initialization,aggregate'></a></span><span class='indexparent'><a class='index' id=':aggregate_initialization'></a></span><span class='indexparent'><a class='index' id=':initialization,array'></a></span><span class='indexparent'><a class='index' id=':initialization,class_object'></a></span><span class='indexparent'><a class='index' id=':{},initializer_list'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L2905'>#</a></div><div id='1.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:aggregate' id='def:aggregate'><i >aggregate</i></a> is an array or a <a href='class'>class</a> with
<ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.1'>(1.1)</a></div><div id='1.1.sentence-1' class='sentence'>no user-declared or inherited constructors (<a href='class.ctor'>[class.ctor]</a>),</div></li><li id='1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.2'>(1.2)</a></div><div id='1.2.sentence-1' class='sentence'>no private or protected non-static data members (<a href='class.access'>[class.access]</a>),</div></li><li id='1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.3'>(1.3)</a></div><div id='1.3.sentence-1' class='sentence'>no <a href='class.virtual'>virtual functions</a>, and</div></li><li id='1.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.4'>(1.4)</a></div><div id='1.4.sentence-1' class='sentence'>no virtual, private, or protected base classes (<a href='class.mi'>[class.mi]</a>)<a class='hidden_link' href='#1.4.sentence-1'>.</a></div></li></ul></div> <div id='1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-2' class='sentence'>Aggregate initialization does not allow accessing
protected and private base class' members or constructors<a class='hidden_link' href='#1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L2922'>#</a></div><div id='2.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:aggregate,elements' id='def:aggregate,elements'><i >elements</i></a> of an aggregate are:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div><div id='2.1.sentence-1' class='sentence'>for an array, the array elements in increasing subscript order, or</div></li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div><div id='2.2.sentence-1' class='sentence'>for a class, the direct base classes in declaration order,
followed by the direct non-static data members (<a href='class.mem'>[class.mem]</a>)
that are not members of an anonymous union, in declaration order<a class='hidden_link' href='#2.2.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L2933'>#</a></div><div id='3.sentence-1' class='sentence'>When an aggregate is initialized by an initializer list
as specified in <a href='dcl.init.list'>[dcl.init.list]</a>,
the elements of the initializer list are taken as initializers
for the elements of the aggregate<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>The <a class='hidden_link' href='#def:explicitly_initialized_elements,aggregate' id='def:explicitly_initialized_elements,aggregate'><i >explicitly initialized elements</i></a>
of the aggregate are determined as follows:
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><div id='3.1.sentence-1' class='sentence'>If the initializer list is a <i ><a href='dcl.init#nt:designated-initializer-list'>designated-initializer-list</a></i>,
the aggregate shall be of class type,
the <i ><a href='lex.name#nt:identifier'>identifier</a></i> in each <i ><a href='dcl.init#nt:designator'>designator</a></i>
shall name a direct non-static data member of the class, and
the explicitly initialized elements of the aggregate
are the elements that are, or contain, those members<a class='hidden_link' href='#3.1.sentence-1'>.</a></div></li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div><div id='3.2.sentence-1' class='sentence'>If the initializer list is an <i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>,
the explicitly initialized elements of the aggregate
are the first <span class='math'><span class='mathalpha'>n</span></span> elements of the aggregate,
where <span class='math'><span class='mathalpha'>n</span></span> is the number of elements in the initializer list<a class='hidden_link' href='#3.2.sentence-1'>.</a></div></li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div><div id='3.3.sentence-1' class='sentence'>Otherwise, the initializer list must be <span class='texttt'>{}</span>,
and there are no explicitly initialized elements<a class='hidden_link' href='#3.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L2958'>#</a></div><div id='4.sentence-1' class='sentence'>For each explicitly initialized element:
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><div id='4.1.sentence-1' class='sentence'>If the element is an anonymous union object and
the initializer list is a <i ><a href='dcl.init#nt:designated-initializer-list'>designated-initializer-list</a></i>,
the anonymous union object is initialized by the
<i ><a href='dcl.init#nt:designated-initializer-list'>designated-initializer-list</a></i> <span class='texttt'>{ </span><span class='textit'>D</span><span class='texttt'> }</span>,
where <span class='textit'>D</span> is the <i ><a href='dcl.init#nt:designated-initializer-clause'>designated-initializer-clause</a></i>
naming a member of the anonymous union object<a class='hidden_link' href='#4.1.sentence-1'>.</a></div> <div id='4.1.sentence-2' class='sentence'>There shall be only one such <i ><a href='dcl.init#nt:designated-initializer-clause'>designated-initializer-clause</a></i><a class='hidden_link' href='#4.1.sentence-2'>.</a></div></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><div id='4.2.sentence-1' class='sentence'>Otherwise, the element is copy-initialized
from the corresponding <i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i>
or is initialized with the <i ><a href='dcl.init#nt:brace-or-equal-initializer'>brace-or-equal-initializer</a></i>
of the corresponding <i ><a href='dcl.init#nt:designated-initializer-clause'>designated-initializer-clause</a></i><a class='hidden_link' href='#4.2.sentence-1'>.</a></div> <div id='4.2.sentence-2' class='sentence'>If that initializer is of the form
<i ><a href='expr.ass#nt:assignment-expression'>assignment-expression</a></i> or
<span class='texttt'>= </span><i ><a href='expr.ass#nt:assignment-expression'>assignment-expression</a></i>
and
a <a href='dcl.init.list#def:narrowing_conversion'>narrowing conversion</a> is required
to convert the expression, the program is ill-formed<a class='hidden_link' href='#4.2.sentence-2'>.</a></div> <div id='4.2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#4.2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='4.2.sentence-3' class='sentence'>If an initializer is itself an initializer list,
the element is list-initialized, which will result in a recursive application
of the rules in this subclause if the element is an aggregate<a class='hidden_link' href='#4.2.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul>
<div id='4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  int x;
  struct B {
    int i;
    int j;
  } b;
} a = { 1, { 2, 3 } };</pre> <div id='4.sentence-2' class='sentence'>
initializes
<span class='texttt'>a.x</span>
with 1,
<span class='texttt'>a.b.i</span>
with 2,
<span class='texttt'>a.b.j</span>
with 3<a class='hidden_link' href='#4.sentence-2'>.</a></div><pre class='codeblock'>
struct base1 { int b1, b2 = 42; };
struct base2 {
  base2() {
    b3 = 42;
  }
  int b3;
};
struct derived : base1, base2 {
  int d;
};

derived d1{{1, 2}, {}, 4};
derived d2{{}, {}, 4};</pre> <div id='4.sentence-3' class='sentence'>
initializes
<span class='texttt'>d1.b1</span> with 1,
<span class='texttt'>d1.b2</span> with 2,
<span class='texttt'>d1.b3</span> with 42,
<span class='texttt'>d1.d</span> with 4, and
<span class='texttt'>d2.b1</span> with 0,
<span class='texttt'>d2.b2</span> with 42,
<span class='texttt'>d2.b3</span> with 42,
<span class='texttt'>d2.d</span> with 4<a class='hidden_link' href='#4.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3028'>#</a></div><div id='5.sentence-1' class='sentence'>For a non-union aggregate,
each element that is not an explicitly initialized element
is initialized as follows:
<ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><div id='5.1.sentence-1' class='sentence'>If the element has a <a href='class.mem#def:default_member_initializer'>default member initializer</a>,
the element is initialized from that initializer<a class='hidden_link' href='#5.1.sentence-1'>.</a></div></li><li id='5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.2'>(5.2)</a></div><div id='5.2.sentence-1' class='sentence'>Otherwise, if the element is not a reference, the element
is copy-initialized from an empty initializer list (<a href='dcl.init.list'>[dcl.init.list]</a>)<a class='hidden_link' href='#5.2.sentence-1'>.</a></div></li><li id='5.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.3'>(5.3)</a></div><div id='5.3.sentence-1' class='sentence'>Otherwise, the program is ill-formed<a class='hidden_link' href='#5.3.sentence-1'>.</a></div></li></ul></div> <div id='5.sentence-2' class='sentence'>
If the aggregate is a union and the initializer list is empty, then
<ul class='itemize'><li id='5.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.4'>(5.4)</a></div><div id='5.4.sentence-1' class='sentence'>if any variant member has a default member initializer,
that member is initialized from its default member initializer;</div></li><li id='5.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.5'>(5.5)</a></div><div id='5.5.sentence-1' class='sentence'>otherwise, the first member of the union (if any)
is copy-initialized from an empty initializer list<a class='hidden_link' href='#5.5.sentence-1'>.</a></div></li></ul></div> <div id='5.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S { int a; const char* b; int c; int d = b[a]; };
S ss = { 1, "asdf" };</pre><div id='5.sentence-3' class='sentence'>initializes
<span class='texttt'>ss.a</span>
with 1,
<span class='texttt'>ss.b</span>
with <span class='texttt'>"asdf"</span>,
<span class='texttt'>ss.c</span>
with the value of an expression of the form
<span class='texttt'>int{}</span>
(that is, <span class='texttt'>0</span>), and <span class='texttt'>ss.d</span> with the value of <span class='texttt'>ss.b[ss.a]</span>
(that is, <span class='texttt'>'s'</span>), and in</div><pre class='codeblock'>
struct X { int i, j, k = 42; };
X a[] = { 1, 2, 3, 4, 5, 6 };
X b[2] = { { 1, 2, 3 }, { 4, 5, 6 } };</pre><div id='5.sentence-4' class='sentence'><span class='texttt'>a</span> and <span class='texttt'>b</span> have the same value</div><pre class='codeblock'>
struct A {
  string a;
  int b = 42;
  int c = -1;
};</pre><div id='5.sentence-5' class='sentence'><span class='texttt'>A{.c=21}</span> has the following steps:
<ul class='itemize'><li ><div id='5.sentence-1' class='sentence'>Initialize <span class='texttt'>a</span> with <span class='texttt'>{}</span></div></li><li ><div id='5.sentence-1' class='sentence'>Initialize <span class='texttt'>b</span> with <span class='texttt'>= 42</span></div></li><li ><div id='5.sentence-1' class='sentence'>Initialize <span class='texttt'>c</span> with <span class='texttt'>= 21</span></div></li></ul></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3093'>#</a></div><div id='6.sentence-1' class='sentence'>The initializations of the elements of the aggregate
are evaluated in the element order<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>That is,
all value computations and side effects associated with a given element
are sequenced before
those of any element that follows it in order<a class='hidden_link' href='#6.sentence-2'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3101'>#</a></div><div id='7.sentence-1' class='sentence'>An aggregate that is a class can also be initialized with a single
expression not enclosed in braces, as described in <a href='dcl.init'>[dcl.init]</a><a class='hidden_link' href='#7.sentence-1'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3105'>#</a></div><div id='8.sentence-1' class='sentence'>The destructor for each element of class type
is potentially invoked (<a href='class.dtor'>[class.dtor]</a>)
from the context where the aggregate initialization occurs<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='8.sentence-2' class='sentence'>This provision ensures that destructors can be called
for fully-constructed subobjects
in case an exception is thrown (<a href='except.ctor'>[except.ctor]</a>)<a class='hidden_link' href='#8.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3115'>#</a></div><div id='9.sentence-1' class='sentence'>An array of unknown bound initialized with a
brace-enclosed
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
containing
<span class='texttt'>n</span>
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>,
where
<span class='texttt'>n</span>
shall be greater than zero, is defined as having
<span class='texttt'>n</span>
elements (<a href='dcl.array'>[dcl.array]</a>)<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
int x[] = { 1, 3, 5 };</pre><div id='9.sentence-3' class='sentence'>declares and initializes
<span class='texttt'>x</span>
as a one-dimensional array that has three elements
since no size was specified and there are three initializers<a class='hidden_link' href='#9.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='9.sentence-2' class='sentence'>
An empty initializer list
<span class='texttt'>{}</span>
shall not be used as the <i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i>
for an array of unknown bound<a class='hidden_link' href='#9.sentence-2'>.</a><a class='footnotenum' href='#footnote-106'>106</a></div> <div id='9.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='9.sentence-4' class='sentence'>A default member initializer does not determine the bound for a member
array of unknown bound<a class='hidden_link' href='#9.sentence-4'>.</a></div> <div id='9.sentence-5' class='sentence'>Since the default member initializer is
ignored if a suitable <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> is present (<a href='class.base.init'>[class.base.init]</a>),
the default member initializer is not
considered to initialize the array of unknown bound<a class='hidden_link' href='#9.sentence-5'>.</a></div> <div id='9.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#9.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S {
  int y[] = { 0 };          <span class='comment'>// error: non-static data member of incomplete type
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3159'>#</a></div><div id='10.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#10.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='10.sentence-1' class='sentence'>Static data members,
non-static data members of anonymous union members,
and
unnamed bit-fields
are not considered elements of the aggregate<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#10.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  int i;
  static int s;
  int j;
  int :17;
  int k;
} a = { 1, 2, 3 };</pre><div id='10.sentence-2' class='sentence'>Here, the second initializer 2 initializes
<span class='texttt'>a.j</span>
and not the static data member
<span class='texttt'>A&#x200b;::&#x200b;s</span>, and the third initializer 3 initializes <span class='texttt'>a.k</span>
and not the unnamed bit-field before it<a class='hidden_link' href='#10.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3186'>#</a></div><div id='11.sentence-1' class='sentence'>An
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
is ill-formed if the number of
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>
exceeds the number of elements of the aggregate<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
char cv[4] = { 'a', 's', 'd', 'f', 0 };     <span class='comment'>// error
</span></pre> <div id='11.sentence-2' class='sentence'>
is ill-formed<a class='hidden_link' href='#11.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3200'>#</a></div><div id='12.sentence-1' class='sentence'>If a reference member is initialized from its default member initializer
and a potentially-evaluated subexpression thereof is an aggregate
initialization that would use that default member initializer,
the program is ill-formed<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
  struct A;
  extern A a;
  struct A {
    const A&amp; a1 { A{a,a} };     <span class='comment'>// OK
</span>    const A&amp; a2 { A{} };        <span class='comment'>// error
</span>  };
  A a{a,a};                     <span class='comment'>// OK
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3217'>#</a></div><div id='13.sentence-1' class='sentence'>If an aggregate class <span class='texttt'>C</span> contains a subaggregate element
<span class='texttt'>e</span> with no elements,
the <i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i> for <span class='texttt'>e</span> shall not be
omitted from an <i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i> for an object of type
<span class='texttt'>C</span> unless the <i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span> for all
elements of <span class='texttt'>C</span> following <span class='texttt'>e</span> are also omitted<a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#13.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S { } s;
struct A {
  S s1;
  int i1;
  S s2;
  int i2;
  S s3;
  int i3;
} a = {
  { },              <span class='comment'>// Required initialization
</span>  0,
  s,                <span class='comment'>// Required initialization
</span>  0
};                  <span class='comment'>// Initialization not required for <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;s3</span> because <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;i3</span> is also not initialized
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3243'>#</a></div><div id='14.sentence-1' class='sentence'>When initializing a multi-dimensional array,
the
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>
initialize the elements with the last (rightmost) index of the array
varying the fastest (<a href='dcl.array'>[dcl.array]</a>)<a class='hidden_link' href='#14.sentence-1'>.</a></div> <div id='14.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
int x[2][2] = { 3, 1, 4, 2 };</pre> <div id='14.sentence-2' class='sentence'>
initializes
<span class='texttt'>x[0][0]</span>
to
<span class='texttt'>3</span>,
<span class='texttt'>x[0][1]</span>
to
<span class='texttt'>1</span>,
<span class='texttt'>x[1][0]</span>
to
<span class='texttt'>4</span>,
and
<span class='texttt'>x[1][1]</span>
to
<span class='texttt'>2</span><a class='hidden_link' href='#14.sentence-2'>.</a></div> <div id='14.sentence-3' class='sentence'>On the other hand,
<pre class='codeblock'>
float y[4][3] = {
  { 1 }, { 2 }, { 3 }, { 4 }
};</pre>
initializes the first column of
<span class='texttt'>y</span>
(regarded as a two-dimensional array)
and leaves the rest zero<a class='hidden_link' href='#14.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3279'>#</a></div><div id='15.sentence-1' class='sentence'>Braces can be elided in an
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
as follows<a class='hidden_link' href='#15.sentence-1'>.</a></div> <div id='15.sentence-2' class='sentence'>If the
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
begins with a left brace,
then the succeeding comma-separated list of
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>
initializes the elements of a subaggregate;
it is erroneous for there to be more
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>
than elements<a class='hidden_link' href='#15.sentence-2'>.</a></div> <div id='15.sentence-3' class='sentence'>If, however, the
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
for a subaggregate does not begin with a left brace,
then only enough
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>
from the list are taken to initialize the elements of the subaggregate;
any remaining
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i><span class='textit'>s</span>
are left to initialize the next element of the aggregate
of which the current subaggregate is an element<a class='hidden_link' href='#15.sentence-3'>.</a></div> <div id='15.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#15.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
float y[4][3] = {
  { 1, 3, 5 },
  { 2, 4, 6 },
  { 3, 5, 7 },
};</pre><div id='15.sentence-4' class='sentence'>is a completely-braced initialization:
1, 3, and 5 initialize the first row of the array
<span class='texttt'>y[0]</span>,
namely
<span class='texttt'>y[0][0]</span>,
<span class='texttt'>y[0][1]</span>,
and
<span class='texttt'>y[0][2]</span><a class='hidden_link' href='#15.sentence-4'>.</a></div> <div id='15.sentence-5' class='sentence'>Likewise the next two lines initialize
<span class='texttt'>y[1]</span>
and
<span class='texttt'>y[2]</span><a class='hidden_link' href='#15.sentence-5'>.</a></div> <div id='15.sentence-6' class='sentence'>The initializer ends early and therefore
<span class='texttt'>y[3]</span>s
elements are initialized as if explicitly initialized with an
expression of the form
<span class='texttt'>float()</span>,
that is, are initialized with
<span class='texttt'>0.0</span><a class='hidden_link' href='#15.sentence-6'>.</a></div> <div id='15.sentence-7' class='sentence'>In the following example, braces in the
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
are elided;
however the
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
has the same effect as the completely-braced
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
of the above example,</div><pre class='codeblock'>
float y[4][3] = {
  1, 3, 5, 2, 4, 6, 3, 5, 7
};</pre><div id='15.sentence-8' class='sentence'>The initializer for
<span class='texttt'>y</span>
begins with a left brace, but the one for
<span class='texttt'>y[0]</span>
does not,
therefore three elements from the list are used<a class='hidden_link' href='#15.sentence-8'>.</a></div> <div id='15.sentence-9' class='sentence'>Likewise the next three are taken successively for
<span class='texttt'>y[1]</span>
and
<span class='texttt'>y[2]</span><a class='hidden_link' href='#15.sentence-9'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3358'>#</a></div><div id='16.sentence-1' class='sentence'>All implicit type conversions (<a href='conv'>[conv]</a>) are considered when
initializing the element with an <i ><a href='expr.ass#nt:assignment-expression'>assignment-expression</a></i><a class='hidden_link' href='#16.sentence-1'>.</a></div> <div id='16.sentence-2' class='sentence'>If the
<i ><a href='expr.ass#nt:assignment-expression'>assignment-expression</a></i>
can initialize an element, the element is initialized<a class='hidden_link' href='#16.sentence-2'>.</a></div> <div id='16.sentence-3' class='sentence'>Otherwise, if the element is itself a subaggregate,
brace elision is assumed and the
<i ><a href='expr.ass#nt:assignment-expression'>assignment-expression</a></i>
is considered for the initialization of the first element of the subaggregate<a class='hidden_link' href='#16.sentence-3'>.</a></div> <div id='16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='16.sentence-4' class='sentence'>As specified above, brace elision cannot apply to
subaggregates with no elements; an
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i> for the entire subobject is
required<a class='hidden_link' href='#16.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <div id='16.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#16.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  int i;
  operator int();
};
struct B {
  A a1, a2;
  int z;
};
A a;
B b = { 4, a, a };</pre><div id='16.sentence-5' class='sentence'>Braces are elided around the
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i>
for
<span class='texttt'>b.a1.i</span><a class='hidden_link' href='#16.sentence-5'>.</a></div> <div id='16.sentence-6' class='sentence'><span class='texttt'>b.a1.i</span>
is initialized with 4,
<span class='texttt'>b.a2</span>
is initialized with
<span class='texttt'>a</span>,
<span class='texttt'>b.z</span>
is initialized with whatever
<span class='texttt'>a.operator int()</span>
returns<a class='hidden_link' href='#16.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3403'>#</a></div><span class='indexparent'><a class='index' id=':initialization,array_of_class_objects'></a></span><div id='17.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#17.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='17.sentence-1' class='sentence'>An aggregate array or an aggregate class may contain elements of a
class type with a user-declared constructor (<a href='class.ctor'>[class.ctor]</a>)<a class='hidden_link' href='#17.sentence-1'>.</a></div> <div id='17.sentence-2' class='sentence'>Initialization of these aggregate objects is described in <a href='class.expl.init'>[class.expl.init]</a><a class='hidden_link' href='#17.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3411'>#</a></div><div id='18.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#18.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='18.sentence-1' class='sentence'>Whether the initialization of aggregates with static storage duration
is static or dynamic is specified
in <a href='basic.start.static'>[basic.start.static]</a>, <a href='basic.start.dynamic'>[basic.start.dynamic]</a>, and <a href='stmt.dcl'>[stmt.dcl]</a><a class='hidden_link' href='#18.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3418'>#</a></div><div id='19.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,union'></a></span>When a union is initialized with an initializer list,
there shall not be more than one
explicitly initialized element<a class='hidden_link' href='#19.sentence-1'>.</a></div> <div id='19.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#19.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
union u { int a; const char* b; };
u a = { 1 };
u b = a;
u c = 1;                        <span class='comment'>// error
</span>u d = { 0, "asdf" };            <span class='comment'>// error
</span>u e = { "asdf" };               <span class='comment'>// error
</span>u f = { .b = "asdf" };
u g = { .a = 1, .b = "asdf" };  <span class='comment'>// error
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3fe46c716367d6e367b4c5acff344bce3f2a5cd2/source/declarators.tex#L3436'>#</a></div><div id='20.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#20.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='20.sentence-1' class='sentence'>As described above,
the braces around the
<i ><a href='dcl.init#nt:initializer-clause'>initializer-clause</a></i>
for a union member can be omitted if the
union is a member of another aggregate<a class='hidden_link' href='#20.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-106'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-106'>106)</a></div><div id='footnote-106.sentence-1' class='sentence'>The syntax provides for empty
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i><span class='textit'>s</span>,
but nonetheless C++ does not have zero length arrays<a class='hidden_link' href='#footnote-106.sentence-1'>.</a></div></div></div></body></html>