<!DOCTYPE html><html lang='en'><head><title>[special]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>15</a> Special member functions <a class='abbr_ref' href='./#special'>[special]</a></h1><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L12'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,default'></a></span><span class='indexparent'><a class='index' id=':constructor,copy'></a></span><span class='indexparent'><a class='index' id=':constructor,move'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,copy'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,move'></a></span>The <a href='#def:constructor,default'>default constructor</a>,
<a href='#def:constructor,copy'>copy constructor</a> and
<a href='#def:assignment_operator,copy'>copy assignment operator</a>,
<a href='#def:constructor,move'>move constructor</a> and
<a href='#def:assignment_operator,move'>move assignment operator</a>,
and <a href='#class.dtor'>destructor</a> are
<a class='hidden_link' href='#def:special_member_functions' id='def:special_member_functions'><i>special member functions</i></a><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-4' class='sentence'>The implementation will implicitly declare these member functions for some class
types when the program does not explicitly declare them<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='1.sentence-5' class='sentence'>The implementation will implicitly define them
if they are odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>) or
needed for constant evaluation (<a href='expr.const'>[expr.const]</a>)<a class='hidden_link' href='#1.sentence-5'>.</a></div> <div id='1.sentence-6' class='sentence'>See <a href='#class.ctor'>[class.ctor]</a>, <a href='#class.dtor'>[class.dtor]</a> and <a href='#class.copy'>[class.copy]</a><a class='hidden_link' href='#1.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='1.sentence-2' class='sentence'>
An implicitly-declared special member function is declared at the closing
<span class='texttt'>}</span> of the <i ><a href='class#nt:class-specifier'>class-specifier</a></i><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>Programs shall not define implicitly-declared special member functions<a class='hidden_link' href='#1.sentence-3'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L35'>#</a></div><div id='2.sentence-1' class='sentence'>Programs may explicitly refer to implicitly-declared special member functions<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='2.sentence-2' class='sentence'>A program may explicitly call or form a pointer to member
to an implicitly-declared special member function<a class='hidden_link' href='#2.sentence-2'>.</a></div><pre class='codeblock'>
struct A { };                   <span class='comment'>// implicitly declared <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;operator=</span>
</span>struct B : A {
  B&amp; operator=(const B &amp;);
};
B&amp; B::operator=(const B&amp; s) {
  this-&gt;A::operator=(s);        <span class='comment'>// well-formed
</span>  return *this;
}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L53'>#</a></div><div id='3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-1' class='sentence'>The special member functions affect the way objects of class type are created,
copied, moved, and destroyed, and how values can be converted to values of other types<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>Often such special member functions are called implicitly<a class='hidden_link' href='#3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L60'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':access_control,member_function_and'></a></span>Special member functions obey the usual <a href='class.access'>access rules</a><a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='4.sentence-2' class='sentence'>Declaring a constructor protected
ensures that only derived classes and friends can create objects using it<a class='hidden_link' href='#4.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L68'>#</a></div><div id='5.sentence-1' class='sentence'>For a class, its non-static data members, its non-virtual direct base classes,
and, if the class is not <a href='class.abstract#def:class,abstract'>abstract</a>, its virtual base
classes are called its <a class='hidden_link' href='#def:potentially_constructed_subobjects' id='def:potentially_constructed_subobjects'><i>potentially constructed subobjects</i></a><a class='hidden_link' href='#5.sentence-1'>.</a></div></div><div id='class.ctor' class='section'><h2 ><a class='secnum' href='#class.ctor' style='min-width:88pt'>15.1</a> Constructors <a class='abbr_ref' href='class.ctor'>[class.ctor]</a></h2><span class='indexparent'><a class='index' id=':constructor'></a></span><div class='para' id='class.ctor-1'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L77'>#</a></div><div id='class.ctor-1.sentence-1' class='sentence'>Constructors do not have names<a class='hidden_link' href='#class.ctor-1.sentence-1'>.</a></div> <div id='class.ctor-1.sentence-2' class='sentence'>In a declaration of a constructor, the <i ><a href='dcl.decl#nt:declarator'>declarator</a></i> is a
<a href='dcl.fct'>function declarator</a> of the form
<pre class='ncbnf'><i ><a href='dcl.decl#nt:ptr-declarator'>ptr-declarator</a></i> <span class='terminal'>(</span> <i ><a href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a></i> <span class='terminal'>)</span> <i ><a href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre>
where the <i ><a href='dcl.decl#nt:ptr-declarator'>ptr-declarator</a></i> consists solely of an
<i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i>, an optional <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i>,
and optional surrounding parentheses, and the <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> has
one of the following forms:</div><div id='class.ctor-1.sentence-3' class='sentence'><ul class='itemize'><li id='class.ctor-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-1.1'>(1.1)</a></div><div id='class.ctor-1.1.sentence-1' class='sentence'>in a <i ><a href='class.mem#nt:member-declaration'>member-declaration</a></i> that belongs to the
<i ><a href='class.mem#nt:member-specification'>member-specification</a></i> of a class or class template
but is not a friend
declaration (<a href='class.friend'>[class.friend]</a>), the <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> is the
injected-class-name (<a href='class'>[class]</a>) of the immediately-enclosing entity or</div></li><li id='class.ctor-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-1.2'>(1.2)</a></div><div id='class.ctor-1.2.sentence-1' class='sentence'>in a declaration at namespace scope or in a friend declaration, the
<i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> is a <i ><a href='expr.prim.id.qual#nt:qualified-id'>qualified-id</a></i> that names a
constructor (<a href='class.qual'>[class.qual]</a>)<a class='hidden_link' href='#class.ctor-1.2.sentence-1'>.</a></div></li></ul></div><div id='class.ctor-1.sentence-4' class='sentence'>The <i ><a href='class#nt:class-name'>class-name</a></i> shall not be a <i ><a href='dcl.typedef#nt:typedef-name'>typedef-name</a></i><a class='hidden_link' href='#class.ctor-1.sentence-4'>.</a></div> <div id='class.ctor-1.sentence-5' class='sentence'>In a constructor
declaration, each <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i> in the optional
<i ><a href='dcl.spec#nt:decl-specifier-seq'>decl-specifier-seq</a></i> shall be <span class='texttt'>friend</span>, <span class='texttt'>inline</span>,
<span class='texttt'>constexpr</span>, or an <i ><a href='dcl.fct.spec#nt:explicit-specifier'>explicit-specifier</a></i><a class='hidden_link' href='#class.ctor-1.sentence-5'>.</a></div> <div id='class.ctor-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.ctor-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S {
  S();              <span class='comment'>// declares the constructor
</span>};

S::S() { }          <span class='comment'>// defines the constructor
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-2'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L118'>#</a></div><div id='class.ctor-2.sentence-1' class='sentence'>A constructor is used to initialize objects of its class type<a class='hidden_link' href='#class.ctor-2.sentence-1'>.</a></div> <div id='class.ctor-2.sentence-2' class='sentence'>Because constructors do not have names, they are never found during
name lookup; however an <a href='expr.type.conv'>explicit type conversion using the functional
notation</a> will cause a constructor to be called to
initialize an object<a class='hidden_link' href='#class.ctor-2.sentence-2'>.</a></div> <div id='class.ctor-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-2.sentence-3' class='sentence'>For initialization of objects of class type see <a href='#class.init'>[class.init]</a><a class='hidden_link' href='#class.ctor-2.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-3'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L128'>#</a></div><div id='class.ctor-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':const,constructor_and'></a></span><span class='indexparent'><a class='index' id=':volatile,constructor_and'></a></span>A constructor can be invoked for a
<span class='texttt'>const</span>,
<span class='texttt'>volatile</span>
or
<span class='texttt'>const</span>
<span class='texttt'>volatile</span>
object<a class='hidden_link' href='#class.ctor-3.sentence-1'>.</a></div> <div id='class.ctor-3.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':restriction,constructor'></a></span><span class='texttt'>const</span>
and
<span class='texttt'>volatile</span>
semantics (<a href='dcl.type.cv'>[dcl.type.cv]</a>) are not applied on an object under construction<a class='hidden_link' href='#class.ctor-3.sentence-2'>.</a></div> <div id='class.ctor-3.sentence-3' class='sentence'>They come into effect when the constructor for the
<a href='intro.object#def:most_derived_object'>most derived object</a> ends<a class='hidden_link' href='#class.ctor-3.sentence-3'>.</a></div></div><div class='para' id='class.ctor-4'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L146'>#</a></div><div id='class.ctor-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,inheritance_of'></a></span><span class='indexparent'><a class='index' id=':constructor,non-trivial'></a></span>A
<a class='hidden_link' href='#def:constructor,default' id='def:constructor,default'><i >default</i></a>
constructor for a class
<span class='texttt'>X</span>
is a constructor of class
<span class='texttt'>X</span>
for which
each parameter
that is not a function parameter pack
has a default argument
(including the case of a constructor with no parameters)<a class='hidden_link' href='#class.ctor-4.sentence-1'>.</a></div> <div id='class.ctor-4.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':implicitly-declared_default_constructor'></a></span>If there is no user-declared constructor for class
<span class='texttt'>X</span>,
a non-explicit constructor having no parameters is implicitly declared
as defaulted (<a href='dcl.fct.def'>[dcl.fct.def]</a>)<a class='hidden_link' href='#class.ctor-4.sentence-2'>.</a></div> <div id='class.ctor-4.sentence-3' class='sentence'>An implicitly-declared default constructor is an
inline public member of its class<a class='hidden_link' href='#class.ctor-4.sentence-3'>.</a></div></div><div class='para' id='class.ctor-5'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L168'>#</a></div><div id='class.ctor-5.sentence-1' class='sentence'>A defaulted default constructor for class <span class='texttt'>X</span> is defined as deleted if:</div><div id='class.ctor-5.sentence-2' class='sentence'><ul class='itemize'><li id='class.ctor-5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.1'>(5.1)</a></div><div id='class.ctor-5.1.sentence-1' class='sentence'><span class='texttt'>X</span> is a union that has a variant member
with a non-trivial default constructor and
no variant member of <span class='texttt'>X</span> has a default member initializer,</div></li><li id='class.ctor-5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.2'>(5.2)</a></div><div id='class.ctor-5.2.sentence-1' class='sentence'><span class='texttt'>X</span> is a non-union class that has a variant member <span class='texttt'>M</span>
with a non-trivial default constructor and
no variant member of the anonymous union containing <span class='texttt'>M</span>
has a default member initializer,</div></li><li id='class.ctor-5.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.3'>(5.3)</a></div><div id='class.ctor-5.3.sentence-1' class='sentence'>any non-static data member with no <a href='class.mem#def:default_member_initializer'>default member initializer</a> is
of reference type,</div></li><li id='class.ctor-5.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.4'>(5.4)</a></div><div id='class.ctor-5.4.sentence-1' class='sentence'>any non-variant non-static data member of const-qualified type (or array
thereof) with no <i ><a href='dcl.init#nt:brace-or-equal-initializer'>brace-or-equal-initializer</a></i> does not have a user-provided default constructor,</div></li><li id='class.ctor-5.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.5'>(5.5)</a></div><div id='class.ctor-5.5.sentence-1' class='sentence'><span class='texttt'>X</span> is a union and all of its variant members are of const-qualified
type (or array thereof),</div></li><li id='class.ctor-5.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.6'>(5.6)</a></div><div id='class.ctor-5.6.sentence-1' class='sentence'><span class='texttt'>X</span> is a non-union class and all members of any anonymous union member are
of const-qualified type (or array thereof),</div></li><li id='class.ctor-5.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.7'>(5.7)</a></div><div id='class.ctor-5.7.sentence-1' class='sentence'>any potentially constructed subobject, except for a non-static data member
with a <i ><a href='dcl.init#nt:brace-or-equal-initializer'>brace-or-equal-initializer</a></i>, has
class type <span class='texttt'>M</span> (or array thereof) and either <span class='texttt'>M</span>
has no default constructor or <a href='over.match'>overload resolution</a>
as applied to find <span class='texttt'>M</span>'s corresponding
constructor results in an ambiguity or in a function that is deleted or
inaccessible from the defaulted default constructor, or</div></li><li id='class.ctor-5.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-5.8'>(5.8)</a></div><div id='class.ctor-5.8.sentence-1' class='sentence'>any potentially constructed subobject has a type
with a destructor that is deleted or inaccessible from the defaulted default
constructor<a class='hidden_link' href='#class.ctor-5.8.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='class.ctor-6'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L206'>#</a></div><div id='class.ctor-6.sentence-1' class='sentence'>A default constructor is
<a class='hidden_link' href='#def:constructor,default,trivial' id='def:constructor,default,trivial'><i >trivial</i></a>
if it is not user-provided and if:
<ul class='itemize'><li id='class.ctor-6.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-6.1'>(6.1)</a></div><div id='class.ctor-6.1.sentence-1' class='sentence'>its class has no <a href='class.virtual'>virtual functions</a> and no <a href='class.mi#def:base_class,virtual'>virtual base
classes</a>, and</div></li><li id='class.ctor-6.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-6.2'>(6.2)</a></div><div id='class.ctor-6.2.sentence-1' class='sentence'>no non-static data member of its class has
a <a href='class.mem#def:default_member_initializer'>default member initializer</a>, and</div></li><li id='class.ctor-6.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-6.3'>(6.3)</a></div><div id='class.ctor-6.3.sentence-1' class='sentence'>all the direct base classes of its class have trivial default constructors, and</div></li><li id='class.ctor-6.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.ctor-6.4'>(6.4)</a></div><div id='class.ctor-6.4.sentence-1' class='sentence'>for all the non-static data members of its class that are of class
type (or array thereof), each such class has a trivial default constructor<a class='hidden_link' href='#class.ctor-6.4.sentence-1'>.</a></div></li></ul></div><div id='class.ctor-6.sentence-2' class='sentence'>Otherwise, the default constructor is
<a class='hidden_link' href='#def:constructor,default,non-trivial' id='def:constructor,default,non-trivial'><i >non-trivial</i></a><a class='hidden_link' href='#class.ctor-6.sentence-2'>.</a></div></div><div class='para' id='class.ctor-7'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L229'>#</a></div><div id='class.ctor-7.sentence-1' class='sentence'>A default constructor
that is defaulted and not defined as deleted
is
<a class='hidden_link' href='#def:constructor,implicitly_defined' id='def:constructor,implicitly_defined'><i >implicitly defined</i></a>
when it is odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>)
to create an object of its class type (<a href='intro.object'>[intro.object]</a>),
when it is needed for constant evaluation (<a href='expr.const'>[expr.const]</a>), or
when it is explicitly defaulted after its first declaration<a class='hidden_link' href='#class.ctor-7.sentence-1'>.</a></div> <div id='class.ctor-7.sentence-2' class='sentence'>The implicitly-defined default constructor performs the set of
initializations of the class that would be performed by a user-written default
constructor for that class with no
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i> and an empty
<i ><a href='stmt.block#nt:compound-statement'>compound-statement</a></i><a class='hidden_link' href='#class.ctor-7.sentence-2'>.</a></div> <div id='class.ctor-7.sentence-3' class='sentence'>If that user-written default constructor would be ill-formed,
the program is ill-formed<a class='hidden_link' href='#class.ctor-7.sentence-3'>.</a></div> <div id='class.ctor-7.sentence-4' class='sentence'>If that user-written default constructor would satisfy the requirements
of a <a href='dcl.constexpr#def:specifier,constexpr,constructor'>constexpr constructor</a>, the implicitly-defined
default constructor is <span class='texttt'>constexpr</span><a class='hidden_link' href='#class.ctor-7.sentence-4'>.</a></div> <div id='class.ctor-7.sentence-5' class='sentence'>Before the defaulted default constructor for a class is
implicitly defined,
all the non-user-provided default constructors for its base classes and
its non-static data members shall have been implicitly defined<a class='hidden_link' href='#class.ctor-7.sentence-5'>.</a></div> <div id='class.ctor-7.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-7.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-7.sentence-6' class='sentence'>An implicitly-declared default constructor has an
exception specification (<a href='except.spec'>[except.spec]</a>)<a class='hidden_link' href='#class.ctor-7.sentence-6'>.</a></div> <div id='class.ctor-7.sentence-7' class='sentence'>An explicitly-defaulted definition might have an
implicit exception specification, see <a href='dcl.fct.def'>[dcl.fct.def]</a><a class='hidden_link' href='#class.ctor-7.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-8'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L259'>#</a></div><div id='class.ctor-8.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,implicitly_called'></a></span>Default constructors are called implicitly to create class objects of static, thread,
or automatic storage duration (<a href='basic.stc.static'>[basic.stc.static]</a>, <a href='basic.stc.thread'>[basic.stc.thread]</a>, <a href='basic.stc.auto'>[basic.stc.auto]</a>) defined
without an <a href='dcl.init'>initializer</a>,
are called to create class objects of <a href='basic.stc.dynamic'>dynamic storage duration</a> created by a
<i ><a href='expr.new#nt:new-expression'>new-expression</a></i>
in which the
<i ><a href='expr.new#nt:new-initializer'>new-initializer</a></i>
is omitted (<a href='expr.new'>[expr.new]</a>), or
are called when the <a href='expr.type.conv'>explicit type conversion</a> syntax is
used<a class='hidden_link' href='#class.ctor-8.sentence-1'>.</a></div> <div id='class.ctor-8.sentence-2' class='sentence'>A program is ill-formed if the default constructor for an object
is implicitly used and the constructor is not <a href='class.access'>accessible</a><a class='hidden_link' href='#class.ctor-8.sentence-2'>.</a></div></div><div class='para' id='class.ctor-9'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L274'>#</a></div><div id='class.ctor-9.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-9.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':order_of_execution,base_class_constructor'></a></span><span class='indexparent'><a class='index' id=':order_of_execution,member_constructor'></a></span><a href='#class.base.init'>[class.base.init]</a> describes the order in which constructors for base
classes and non-static data members are called and
describes how arguments can be specified for the calls to these constructors<a class='hidden_link' href='#class.ctor-9.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-10'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L283'>#</a></div><div id='class.ctor-10.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':restriction,constructor_'></a></span>A
<span class='texttt'>return</span>
statement in the body of a constructor shall not specify a return value<a class='hidden_link' href='#class.ctor-10.sentence-1'>.</a></div> <div id='class.ctor-10.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':constructor,address_of'></a></span>The address of a constructor shall not be taken<a class='hidden_link' href='#class.ctor-10.sentence-2'>.</a></div></div><div class='para' id='class.ctor-11'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L291'>#</a></div><div id='class.ctor-11.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object,unnamed'></a></span><span class='indexparent'><a class='index' id=':constructor,explicit_call'></a></span>A <a href='expr.type.conv'>functional notation type conversion</a> can be used
to create new objects of its type<a class='hidden_link' href='#class.ctor-11.sentence-1'>.</a></div> <div id='class.ctor-11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-11.sentence-2' class='sentence'>The syntax looks like an explicit call of the constructor<a class='hidden_link' href='#class.ctor-11.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.ctor-11.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.ctor-11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
complex zz = complex(1,2.3);
cprint( complex(7.8,1.2) );</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-12'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L306'>#</a></div><div id='class.ctor-12.sentence-1' class='sentence'>An object created in this way is unnamed<a class='hidden_link' href='#class.ctor-12.sentence-1'>.</a></div> <div id='class.ctor-12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-12.sentence-2' class='sentence'><a href='#class.temporary'>[class.temporary]</a> describes the lifetime of temporary objects<a class='hidden_link' href='#class.ctor-12.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.ctor-12.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-12.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-12.sentence-3' class='sentence'>Explicit constructor calls do not yield lvalues, see <a href='basic.lval'>[basic.lval]</a><a class='hidden_link' href='#class.ctor-12.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-13'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L315'>#</a></div><div id='class.ctor-13.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.ctor-13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.ctor-13.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':member_function,constructor_and'></a></span>Some language constructs have special semantics when used during construction;
see <a href='#class.base.init'>[class.base.init]</a> and <a href='#class.cdtor'>[class.cdtor]</a><a class='hidden_link' href='#class.ctor-13.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.ctor-14'><div class='marginalizedparent'><a class='marginalized' href='#class.ctor-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L322'>#</a></div><div id='class.ctor-14.sentence-1' class='sentence'>During the construction of an object,
if the value of the object or any of its subobjects is
accessed through a glvalue that is not obtained, directly or indirectly, from
the constructor's
<span class='texttt'>this</span>
pointer, the value of the object or subobject thus obtained is unspecified<a class='hidden_link' href='#class.ctor-14.sentence-1'>.</a></div> <div id='class.ctor-14.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.ctor-14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct C;
void no_opt(C*);

struct C {
  int c;
  C() : c(0) { no_opt(this); }
};

const C cobj;

void no_opt(C* cptr) {
  int i = cobj.c * 100;         <span class='comment'>// value of <span class='tcode_in_codeblock'>cobj.c</span> is unspecified
</span>  cptr-&gt;c = 1;
  cout &lt;&lt; cobj.c * 100          <span class='comment'>// value of <span class='tcode_in_codeblock'>cobj.c</span> is unspecified
</span>       &lt;&lt; '\n';
}

extern struct D d;
struct D {
  D(int a) : a(a), b(d.a) {}
  int a, b;
};
D d = D(1);                     <span class='comment'>// value of <span class='tcode_in_codeblock'>d.b</span> is unspecified
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='class.temporary' class='section'><h2 ><a class='secnum' href='#class.temporary' style='min-width:88pt'>15.2</a> Temporary objects <a class='abbr_ref' href='class.temporary'>[class.temporary]</a></h2><div class='para' id='class.temporary-1'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L360'>#</a></div><div id='class.temporary-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':temporary'></a></span><span class='indexparent'><a class='index' id=':temporary,elimination_of'></a></span><span class='indexparent'><a class='index' id=':temporary,implementation-defined_generation_of'></a></span>Temporary objects are created
<ul class='itemize'><li id='class.temporary-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-1.1'>(1.1)</a></div><div id='class.temporary-1.1.sentence-1' class='sentence'>when a prvalue is materialized so that it can be used as a <a href='conv.rval#def:glvalue'>glvalue</a>,</div></li><li id='class.temporary-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-1.2'>(1.2)</a></div><div id='class.temporary-1.2.sentence-1' class='sentence'>when needed by the implementation to pass or return an object of trivially-copyable type (see below),
and</div></li><li id='class.temporary-1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-1.3'>(1.3)</a></div><div id='class.temporary-1.3.sentence-1' class='sentence'>when <a href='except.throw'>throwing an exception</a><a class='hidden_link' href='#class.temporary-1.3.sentence-1'>.</a></div> <div id='class.temporary-1.3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-1.3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-1.3.sentence-2' class='sentence'>The lifetime of exception objects is described in <a href='except.throw'>[except.throw]</a><a class='hidden_link' href='#class.temporary-1.3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul>
Even when the creation of the temporary object is
unevaluated (<a href='expr.prop'>[expr.prop]</a>),
all the semantic restrictions shall be respected as if the temporary object
had been created and later destroyed<a class='hidden_link' href='#class.temporary-1.sentence-1'>.</a></div> <div id='class.temporary-1.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-1.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-1.sentence-2' class='sentence'>This includes <a href='class.access'>accessibility</a> and whether it is deleted,
for the constructor selected and for the destructor<a class='hidden_link' href='#class.temporary-1.sentence-2'>.</a></div> <div id='class.temporary-1.sentence-3' class='sentence'>However, in the special
case of the operand of a
<i ><a href='dcl.type.simple#nt:decltype-specifier'>decltype-specifier</a></i> (<a href='expr.call'>[expr.call]</a>), no temporary is introduced,
so the foregoing does not apply to such a prvalue<a class='hidden_link' href='#class.temporary-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.temporary-2'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L391'>#</a></div><div id='class.temporary-2.sentence-1' class='sentence'>The materialization of a temporary object is generally
delayed as long as possible
in order to avoid creating unnecessary temporary objects<a class='hidden_link' href='#class.temporary-2.sentence-1'>.</a></div> <div id='class.temporary-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-2.sentence-2' class='sentence'>Temporary objects are materialized:
<ul class='itemize'><li id='class.temporary-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-2.1'>(2.1)</a></div><div id='class.temporary-2.1.sentence-1' class='sentence'>when binding a reference to a prvalue (<a href='dcl.init.ref'>[dcl.init.ref]</a>, <a href='expr.type.conv'>[expr.type.conv]</a>,
<a href='expr.dynamic.cast'>[expr.dynamic.cast]</a>, <a href='expr.static.cast'>[expr.static.cast]</a>, <a href='expr.const.cast'>[expr.const.cast]</a>, <a href='expr.cast'>[expr.cast]</a>),</div></li><li id='class.temporary-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-2.2'>(2.2)</a></div><div id='class.temporary-2.2.sentence-1' class='sentence'>when performing member access on a class prvalue (<a href='expr.ref'>[expr.ref]</a>, <a href='expr.mptr.oper'>[expr.mptr.oper]</a>),</div></li><li id='class.temporary-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-2.3'>(2.3)</a></div><div id='class.temporary-2.3.sentence-1' class='sentence'>when performing an <a href='conv.array'>array-to-pointer conversion</a> or <a href='expr.sub'>subscripting</a> on an array prvalue,</div></li><li id='class.temporary-2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-2.4'>(2.4)</a></div><div id='class.temporary-2.4.sentence-1' class='sentence'>when initializing an object of type <span class='texttt'>std&#x200b;::&#x200b;initializer_&shy;list&lt;T&gt;</span> from a <i ><a href='dcl.init#nt:braced-init-list'>braced-init-list</a></i> (<a href='dcl.init.list'>[dcl.init.list]</a>),</div></li><li id='class.temporary-2.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-2.5'>(2.5)</a></div><div id='class.temporary-2.5.sentence-1' class='sentence'>for certain unevaluated operands (<a href='expr.typeid'>[expr.typeid]</a>, <a href='expr.sizeof'>[expr.sizeof]</a>), and</div></li><li id='class.temporary-2.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-2.6'>(2.6)</a></div><div id='class.temporary-2.6.sentence-1' class='sentence'>when a prvalue appears as a <a href='expr.prop#def:discarded-value_expression'>discarded-value expression</a><a class='hidden_link' href='#class.temporary-2.6.sentence-1'>.</a></div></li></ul></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.temporary-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.temporary-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.temporary-2.sentence-3' class='sentence'>Consider the following code:
<pre class='codeblock'>
class X {
public:
  X(int);
  X(const X&amp;);
  X&amp; operator=(const X&amp;);
  ~X();
};

class Y {
public:
  Y(int);
  Y(Y&amp;&amp;);
  ~Y();
};

X f(X);
Y g(Y);

void h() {
  X a(1);
  X b = f(X(2));
  Y c = g(Y(3));
  a = f(a);
}</pre></div><div id='class.temporary-2.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':constructor,copy_'></a></span><span class='texttt'>X(2)</span> is constructed in the space used to hold <span class='texttt'>f()</span>'s argument and
<span class='texttt'>Y(3)</span> is constructed in the space used to hold <span class='texttt'>g()</span>'s argument<a class='hidden_link' href='#class.temporary-2.sentence-4'>.</a></div> <div id='class.temporary-2.sentence-5' class='sentence'>Likewise,
<span class='texttt'>f()</span>'s result is constructed directly in <span class='texttt'>b</span> and
<span class='texttt'>g()</span>'s result is constructed directly in <span class='texttt'>c</span><a class='hidden_link' href='#class.temporary-2.sentence-5'>.</a></div> <div id='class.temporary-2.sentence-6' class='sentence'>On the other hand, the expression
<span class='texttt'>a = f(a)</span>
requires a temporary for
the result of <span class='texttt'>f(a)</span>,
which is materialized so that the reference parameter
of <span class='texttt'>A&#x200b;::&#x200b;operator=(const A&amp;)</span> can bind to it<a class='hidden_link' href='#class.temporary-2.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.temporary-3'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L456'>#</a></div><div id='class.temporary-3.sentence-1' class='sentence'>When an object of class type <span class='texttt'>X</span>
is passed to or returned from a function,
if each copy constructor, move constructor, and destructor of <span class='texttt'>X</span>
is either trivial or deleted,
and <span class='texttt'>X</span>
has at least one non-deleted copy or move constructor,
implementations are permitted
to create a temporary object
to hold the function parameter or result object<a class='hidden_link' href='#class.temporary-3.sentence-1'>.</a></div> <div id='class.temporary-3.sentence-2' class='sentence'>The temporary object is constructed
from the function argument or return value, respectively,
and the function's parameter or return object
is initialized as if by
using the non-deleted trivial constructor to copy the temporary
(even if that constructor is inaccessible
or would not be selected by overload resolution
to perform a copy or move of the object)<a class='hidden_link' href='#class.temporary-3.sentence-2'>.</a></div> <div id='class.temporary-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-3.sentence-3' class='sentence'>This latitude is granted to allow objects of class type to be passed to or returned from functions in registers<a class='hidden_link' href='#class.temporary-3.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.temporary-4'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L478'>#</a></div><div id='class.temporary-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':temporary,constructor_for'></a></span><span class='indexparent'><a class='index' id=':temporary,destructor_for'></a></span><span class='indexparent'><a class='index' id=':temporary,destruction_of'></a></span>When an implementation introduces a temporary object of a class that has a
non-trivial constructor (<a href='#class.ctor'>[class.ctor]</a>, <a href='#class.copy'>[class.copy]</a>), it shall ensure that
a constructor is called for the temporary object<a class='hidden_link' href='#class.temporary-4.sentence-1'>.</a></div> <div id='class.temporary-4.sentence-2' class='sentence'>Similarly, the destructor shall be called for a temporary with a non-trivial
destructor (<a href='#class.dtor'>[class.dtor]</a>)<a class='hidden_link' href='#class.temporary-4.sentence-2'>.</a></div> <div id='class.temporary-4.sentence-3' class='sentence'>Temporary objects are destroyed as the last step
in evaluating
the <a href='intro.execution#def:full-expression'>full-expression</a>
that (lexically) contains the point where
they were created<a class='hidden_link' href='#class.temporary-4.sentence-3'>.</a></div> <div id='class.temporary-4.sentence-4' class='sentence'>This is true even if that evaluation ends in throwing an exception<a class='hidden_link' href='#class.temporary-4.sentence-4'>.</a></div> <div id='class.temporary-4.sentence-5' class='sentence'>The
<span class='indexparent'><a class='index' id=':value_computation'></a></span>value computations and
<span class='indexparent'><a class='index' id=':side_effects'></a></span>side effects of destroying a temporary object
are associated only with the full-expression, not with any specific
subexpression<a class='hidden_link' href='#class.temporary-4.sentence-5'>.</a></div></div><div class='para' id='class.temporary-5'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L501'>#</a></div><div id='class.temporary-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initializer,temporary_and_declarator'></a></span><span class='indexparent'><a class='index' id=':temporary,order_of_destruction_of'></a></span>There are three contexts in which temporaries are destroyed at a different
point than the end of the full-expression<a class='hidden_link' href='#class.temporary-5.sentence-1'>.</a></div> <div id='class.temporary-5.sentence-2' class='sentence'>The first context is when a default constructor is called to initialize
an element of an array with no corresponding initializer (<a href='dcl.init'>[dcl.init]</a>)<a class='hidden_link' href='#class.temporary-5.sentence-2'>.</a></div> <div id='class.temporary-5.sentence-3' class='sentence'>The second context is when a copy constructor is called to copy an element of
an array while the entire array is copied (<a href='expr.prim.lambda.capture'>[expr.prim.lambda.capture]</a>, <a href='#class.copy'>[class.copy]</a>)<a class='hidden_link' href='#class.temporary-5.sentence-3'>.</a></div> <div id='class.temporary-5.sentence-4' class='sentence'>In either case, if the constructor has one or more default arguments,
the destruction of every temporary created in a default argument is
sequenced before the construction of the next array element, if any<a class='hidden_link' href='#class.temporary-5.sentence-4'>.</a></div></div><div class='para' id='class.temporary-6'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L514'>#</a></div><div id='class.temporary-6.sentence-1' class='sentence'>The third context is when a reference is bound to a
temporary object<a class='hidden_link' href='#class.temporary-6.sentence-1'>.</a><a class='footnotenum' href='#footnote-115'>115</a></div> <div id='class.temporary-6.sentence-2' class='sentence'>
The temporary object to which the reference is bound or the temporary object
that is the complete object of a subobject to which the reference is bound
persists for the lifetime of the reference if the glvalue
to which the reference is bound
was obtained through one of the following:
<ul class='itemize'><li id='class.temporary-6.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.1'>(6.1)</a></div><div id='class.temporary-6.1.sentence-1' class='sentence'>a temporary materialization conversion (<a href='conv.rval'>[conv.rval]</a>),</div></li><li id='class.temporary-6.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.2'>(6.2)</a></div><div id='class.temporary-6.2.sentence-1' class='sentence'><span class='texttt'>(</span> <i ><a href='expr.comma#nt:expression'>expression</a></i> <span class='texttt'>)</span>,
  where <i ><a href='expr.comma#nt:expression'>expression</a></i> is one of these expressions,</div></li><li id='class.temporary-6.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.3'>(6.3)</a></div><div id='class.temporary-6.3.sentence-1' class='sentence'>subscripting (<a href='expr.sub'>[expr.sub]</a>) of an array operand,
  where that operand is one of these expressions,</div></li><li id='class.temporary-6.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.4'>(6.4)</a></div><div id='class.temporary-6.4.sentence-1' class='sentence'>a class member access (<a href='expr.ref'>[expr.ref]</a>) using the <span class='texttt'>.</span> operator
  where the left operand is one of these expressions and
  the right operand designates a non-static data member of non-reference type,</div></li><li id='class.temporary-6.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.5'>(6.5)</a></div><div id='class.temporary-6.5.sentence-1' class='sentence'>a pointer-to-member operation (<a href='expr.mptr.oper'>[expr.mptr.oper]</a>) using the <span class='texttt'>.*</span> operator
  where the left operand is one of these expressions and
  the right operand is a pointer to data member of non-reference type,</div></li><li id='class.temporary-6.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.6'>(6.6)</a></div><div id='class.temporary-6.6.sentence-1' class='sentence'>a
  <ul class='itemize'><li id='class.temporary-6.6.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#class.temporary-6.6.1'>(6.6.1)</a></div><div id='class.temporary-6.6.1.sentence-1' class='sentence'>
  <span class='texttt'>const_&shy;cast</span> (<a href='expr.const.cast'>[expr.const.cast]</a>),</div></li><li id='class.temporary-6.6.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#class.temporary-6.6.2'>(6.6.2)</a></div><div id='class.temporary-6.6.2.sentence-1' class='sentence'><span class='texttt'>static_&shy;cast</span> (<a href='expr.static.cast'>[expr.static.cast]</a>),</div></li><li id='class.temporary-6.6.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#class.temporary-6.6.3'>(6.6.3)</a></div><div id='class.temporary-6.6.3.sentence-1' class='sentence'><span class='texttt'>dynamic_&shy;cast</span> (<a href='expr.dynamic.cast'>[expr.dynamic.cast]</a>), or</div></li><li id='class.temporary-6.6.4'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#class.temporary-6.6.4'>(6.6.4)</a></div><div id='class.temporary-6.6.4.sentence-1' class='sentence'><span class='texttt'>reinterpret_&shy;cast</span> (<a href='expr.reinterpret.cast'>[expr.reinterpret.cast]</a>)</div></li></ul>
  converting, without a user-defined conversion,
  a glvalue operand that is one of these expressions
  to a glvalue that refers
  to the object designated by the operand, or
  to its complete object or a subobject thereof,</div></li><li id='class.temporary-6.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.7'>(6.7)</a></div><div id='class.temporary-6.7.sentence-1' class='sentence'>a conditional expression (<a href='expr.cond'>[expr.cond]</a>) that is a glvalue
  where the second or third operand is one of these expressions, or</div></li><li id='class.temporary-6.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.8'>(6.8)</a></div><div id='class.temporary-6.8.sentence-1' class='sentence'>a comma expression (<a href='expr.comma'>[expr.comma]</a>) that is a glvalue
  where the right operand is one of these expressions<a class='hidden_link' href='#class.temporary-6.8.sentence-1'>.</a></div></li></ul></div> <div id='class.temporary-6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.temporary-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;typename T&gt; using id = T;

int i = 1;
int&amp;&amp; a = id&lt;int[3]&gt;{1, 2, 3}[i];          <span class='comment'>// temporary array has same lifetime as <span class='tcode_in_codeblock'>a</span>
</span>const int&amp; b = static_cast&lt;const int&amp;&gt;(0); <span class='comment'>// temporary <span class='tcode_in_codeblock'>int</span> has same lifetime as <span class='tcode_in_codeblock'>b</span>
</span>int&amp;&amp; c = cond ? id&lt;int[3]&gt;{1, 2, 3}[i] : static_cast&lt;int&amp;&amp;&gt;(0);
                                           <span class='comment'>// exactly one of the two temporaries is lifetime-extended
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.temporary-6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-6.sentence-3' class='sentence'>An explicit type conversion (<a href='expr.type.conv'>[expr.type.conv]</a>, <a href='expr.cast'>[expr.cast]</a>)
is interpreted as
a sequence of elementary casts,
covered above<a class='hidden_link' href='#class.temporary-6.sentence-3'>.</a></div> <div id='class.temporary-6.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.temporary-6.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
const int&amp; x = (const int&amp;)1;  <span class='comment'>// temporary for value 1 has same lifetime as x
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.temporary-6.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-6.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-6.sentence-4' class='sentence'>If a temporary object has a reference member initialized by another temporary object,
lifetime extension applies recursively to such a member's initializer<a class='hidden_link' href='#class.temporary-6.sentence-4'>.</a></div> <div id='class.temporary-6.example-3' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.temporary-6.example-3'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S {
  const int&amp; m;
};
const S&amp; s = S{1};             <span class='comment'>// both <span class='tcode_in_codeblock'>S</span> and <span class='tcode_in_codeblock'>int</span> temporaries have lifetime of <span class='tcode_in_codeblock'>s</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> <div id='class.temporary-6.sentence-5' class='sentence'>The exceptions to this lifetime rule are:
<ul class='itemize'><li id='class.temporary-6.9'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.9'>(6.9)</a></div><div id='class.temporary-6.9.sentence-1' class='sentence'>A temporary object bound to a reference parameter in a <a href='expr.call'>function call</a>
persists until the completion of the full-expression containing the call<a class='hidden_link' href='#class.temporary-6.9.sentence-1'>.</a></div></li><li id='class.temporary-6.10'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.10'>(6.10)</a></div><div id='class.temporary-6.10.sentence-1' class='sentence'>The lifetime of a temporary bound to the returned value in a function <a href='stmt.return'><span class='texttt'>return</span> statement</a> is not extended; the temporary is destroyed at the end of the full-expression in the <span class='texttt'>return</span> statement<a class='hidden_link' href='#class.temporary-6.10.sentence-1'>.</a></div></li><li id='class.temporary-6.11'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.temporary-6.11'>(6.11)</a></div><div id='class.temporary-6.11.sentence-1' class='sentence'>A temporary bound to a reference in a <i ><a href='expr.new#nt:new-initializer'>new-initializer</a></i> persists until the completion of the full-expression containing the <i ><a href='expr.new#nt:new-initializer'>new-initializer</a></i><a class='hidden_link' href='#class.temporary-6.11.sentence-1'>.</a></div> <div id='class.temporary-6.11.note-3' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.temporary-6.11.note-3'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.temporary-6.11.sentence-2' class='sentence'>This may introduce a dangling reference<a class='hidden_link' href='#class.temporary-6.11.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.temporary-6.11.example-4' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.temporary-6.11.example-4'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S { int mi; const std::pair&lt;int,int&gt;&amp; mp; };
S a { 1, {2,3} };
S* p = new S{ 1, {2,3} };      <span class='comment'>// creates dangling reference
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul></div></div><div class='para' id='class.temporary-7'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L614'>#</a></div><div id='class.temporary-7.sentence-1' class='sentence'>The destruction of a temporary whose lifetime is not extended by being
bound to a reference is sequenced before the destruction of every
temporary which is constructed earlier in the same full-expression<a class='hidden_link' href='#class.temporary-7.sentence-1'>.</a></div> <div id='class.temporary-7.sentence-2' class='sentence'>If the lifetime of two or more temporaries to which references are bound ends
at the same point,
these temporaries are destroyed at that point in the reverse order of the
completion of their construction<a class='hidden_link' href='#class.temporary-7.sentence-2'>.</a></div> <div id='class.temporary-7.sentence-3' class='sentence'>In addition, the destruction of temporaries bound to references shall
take into account the ordering of destruction of objects with
<a href='basic.stc.static#def:static_storage_duration'>static</a>,
<a href='basic.stc.thread#def:thread_storage_duration'>thread</a>, or
<a href='basic.stc.auto#def:automatic_storage_duration'>automatic storage duration</a>;
that is, if
<span class='texttt'>obj1</span>
is an object with the same storage duration as the temporary and
created before the temporary is created
the temporary shall be destroyed before
<span class='texttt'>obj1</span>
is destroyed;
if
<span class='texttt'>obj2</span>
is an object with the same storage duration as the temporary and
created after the temporary is created
the temporary shall be destroyed after
<span class='texttt'>obj2</span>
is destroyed<a class='hidden_link' href='#class.temporary-7.sentence-3'>.</a></div></div><div class='para' id='class.temporary-8'><div class='marginalizedparent'><a class='marginalized' href='#class.temporary-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L642'>#</a></div><div id='class.temporary-8.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.temporary-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S {
  S();
  S(int);
  friend S operator+(const S&amp;, const S&amp;);
  ~S();
};
S obj1;
const S&amp; cr = S(16)+S(23);
S obj2;</pre><div id='class.temporary-8.sentence-1' class='sentence'>The expression
<span class='texttt'>S(16) + S(23)</span>
creates three temporaries:
a first temporary
<span class='texttt'>T1</span>
to hold the result of the expression
<span class='texttt'>S(16)</span>,
a second temporary
<span class='texttt'>T2</span>
to hold the result of the expression
<span class='texttt'>S(23)</span>,
and a third temporary
<span class='texttt'>T3</span>
to hold the result of the addition of these two expressions<a class='hidden_link' href='#class.temporary-8.sentence-1'>.</a></div> <div id='class.temporary-8.sentence-2' class='sentence'>The temporary
<span class='texttt'>T3</span>
is then bound to the reference
<span class='texttt'>cr</span><a class='hidden_link' href='#class.temporary-8.sentence-2'>.</a></div> <div id='class.temporary-8.sentence-3' class='sentence'>It is unspecified whether
<span class='texttt'>T1</span>
or
<span class='texttt'>T2</span>
is created first<a class='hidden_link' href='#class.temporary-8.sentence-3'>.</a></div> <div id='class.temporary-8.sentence-4' class='sentence'>On an implementation where
<span class='texttt'>T1</span>
is created before
<span class='texttt'>T2</span>,
<span class='texttt'>T2</span>
shall be destroyed before
<span class='texttt'>T1</span><a class='hidden_link' href='#class.temporary-8.sentence-4'>.</a></div> <div id='class.temporary-8.sentence-5' class='sentence'>The temporaries
<span class='texttt'>T1</span>
and
<span class='texttt'>T2</span>
are bound to the reference parameters of
<span class='texttt'>operator+</span>;
these temporaries are destroyed at the end of the full-expression
containing the call to
<span class='texttt'>operator+</span><a class='hidden_link' href='#class.temporary-8.sentence-5'>.</a></div> <div id='class.temporary-8.sentence-6' class='sentence'>The temporary
<span class='texttt'>T3</span>
bound to the reference
<span class='texttt'>cr</span>
is destroyed at the end of
<span class='texttt'>cr</span>'s
lifetime, that is, at the end of the program<a class='hidden_link' href='#class.temporary-8.sentence-6'>.</a></div> <div id='class.temporary-8.sentence-7' class='sentence'>In addition, the order in which
<span class='texttt'>T3</span>
is destroyed takes into account the destruction order of other objects with
static storage duration<a class='hidden_link' href='#class.temporary-8.sentence-7'>.</a></div> <div id='class.temporary-8.sentence-8' class='sentence'>That is, because
<span class='texttt'>obj1</span>
is constructed before
<span class='texttt'>T3</span>,
and
<span class='texttt'>T3</span>
is constructed before
<span class='texttt'>obj2</span>,
<span class='texttt'>obj2</span>
shall be destroyed before
<span class='texttt'>T3</span>,
and
<span class='texttt'>T3</span>
shall be destroyed before
<span class='texttt'>obj1</span><a class='hidden_link' href='#class.temporary-8.sentence-8'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-115'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-115'>115)</a></div><div id='footnote-115.sentence-1' class='sentence'>The same rules apply to initialization of an
  <span class='texttt'>initializer_&shy;list</span> object (<a href='dcl.init.list'>[dcl.init.list]</a>) with its
  underlying temporary array<a class='hidden_link' href='#footnote-115.sentence-1'>.</a></div></div></div><div id='class.conv' class='section'><h2 ><a class='secnum' href='#class.conv' style='min-width:88pt'>15.3</a> Conversions <a class='abbr_ref' href='class.conv'>[class.conv]</a></h2><div class='para' id='class.conv-1'><div class='marginalizedparent'><a class='marginalized' href='#class.conv-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L725'>#</a></div><div id='class.conv-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,class'></a></span><span class='indexparent'><a class='index' id=':conversion,implicit'></a></span>Type conversions of class objects can be specified by constructors and
by conversion functions<a class='hidden_link' href='#class.conv-1.sentence-1'>.</a></div> <div id='class.conv-1.sentence-2' class='sentence'>These conversions are called
<a class='hidden_link' href='#def:conversion,user-defined' id='def:conversion,user-defined'><i >user-defined conversions</i></a>
and are used for implicit type conversions (<a href='conv'>[conv]</a>),
for <a href='dcl.init'>initialization</a>,
and for explicit type conversions (<a href='expr.cast'>[expr.cast]</a>, <a href='expr.static.cast'>[expr.static.cast]</a>)<a class='hidden_link' href='#class.conv-1.sentence-2'>.</a></div></div><div class='para' id='class.conv-2'><div class='marginalizedparent'><a class='marginalized' href='#class.conv-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L738'>#</a></div><div id='class.conv-2.sentence-1' class='sentence'>User-defined conversions are applied only where they are unambiguous (<a href='class.member.lookup'>[class.member.lookup]</a>, <a href='#class.conv.fct'>[class.conv.fct]</a>)<a class='hidden_link' href='#class.conv-2.sentence-1'>.</a></div> <div id='class.conv-2.sentence-2' class='sentence'>Conversions obey the <a href='class.access'>access control rules</a><a class='hidden_link' href='#class.conv-2.sentence-2'>.</a></div> <div id='class.conv-2.sentence-3' class='sentence'>Access control is applied after ambiguity resolution (<a href='basic.lookup'>[basic.lookup]</a>)<a class='hidden_link' href='#class.conv-2.sentence-3'>.</a></div></div><div class='para' id='class.conv-3'><div class='marginalizedparent'><a class='marginalized' href='#class.conv-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L743'>#</a></div><div id='class.conv-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.conv-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.conv-3.sentence-1' class='sentence'>See <a href='over.match'>[over.match]</a> for a discussion of the use of conversions in function calls
as well as examples below<a class='hidden_link' href='#class.conv-3.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv-4'><div class='marginalizedparent'><a class='marginalized' href='#class.conv-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L749'>#</a></div><div id='class.conv-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,implicit_user-defined'></a></span>At most one user-defined conversion (constructor or conversion function)
is implicitly applied to a single value<a class='hidden_link' href='#class.conv-4.sentence-1'>.</a></div> <div id='class.conv-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X {
  operator int();
};

struct Y {
  operator X();
};

Y a;
int b = a;          <span class='comment'>// error, <span class='tcode_in_codeblock'>a.operator X().operator int()</span> not tried
</span>int c = X(a);       <span class='comment'>// OK: <span class='tcode_in_codeblock'>a.operator X().operator int()</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv-5'><div class='marginalizedparent'><a class='marginalized' href='#class.conv-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L769'>#</a></div><div id='class.conv-5.sentence-1' class='sentence'>User-defined conversions are used implicitly only if they are unambiguous<a class='hidden_link' href='#class.conv-5.sentence-1'>.</a></div> <div id='class.conv-5.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':name_hiding,user-defined_conversion_and'></a></span>A conversion function in a derived class does not hide a conversion function
in a base class unless the two functions convert to the same type<a class='hidden_link' href='#class.conv-5.sentence-2'>.</a></div> <div id='class.conv-5.sentence-3' class='sentence'>Function <a href='over.match.best'>overload resolution</a> selects the best
conversion function to perform the conversion<a class='hidden_link' href='#class.conv-5.sentence-3'>.</a></div> <div id='class.conv-5.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X {
  operator int();
};

struct Y : X {
    operator char();
};

void f(Y&amp; a) {
  if (a) {          <span class='comment'>// ill-formed: <span class='tcode_in_codeblock'>X&#x200b;::&#x200b;operator int()</span> or <span class='tcode_in_codeblock'>Y&#x200b;::&#x200b;operator char()</span>
</span>  }
}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div id='class.conv.ctor' class='section'><h3 ><a class='secnum' href='#class.conv.ctor' style='min-width:103pt'>15.3.1</a> Conversion by constructor <a class='abbr_ref' href='class.conv.ctor'>[class.conv.ctor]</a></h3><span class='indexparent'><a class='index' id=':conversion,user-defined'></a></span><div class='para' id='class.conv.ctor-1'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.ctor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L796'>#</a></div><div id='class.conv.ctor-1.sentence-1' class='sentence'>A constructor that is not explicit (<a href='dcl.fct.spec'>[dcl.fct.spec]</a>)
specifies a conversion from
the types of its parameters (if any)
to the type of its class<a class='hidden_link' href='#class.conv.ctor-1.sentence-1'>.</a></div> <div id='class.conv.ctor-1.sentence-2' class='sentence'>Such a constructor is called a
<a class='hidden_link' href='#def:constructor,converting' id='def:constructor,converting'><i >converting constructor</i></a><a class='hidden_link' href='#class.conv.ctor-1.sentence-2'>.</a></div> <div id='class.conv.ctor-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.ctor-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <span class='indexparent'><a class='index' id=':Jessie'></a></span><pre class='codeblock'>
struct X {
    X(int);
    X(const char*, int =0);
    X(int, int);
};

void f(X arg) {
  X a = 1;          <span class='comment'>// <span class='tcode_in_codeblock'>a = X(1)</span>
</span>  X b = "Jessie";   <span class='comment'>// <span class='tcode_in_codeblock'>b = X("Jessie",0)</span>
</span>  a = 2;            <span class='comment'>// <span class='tcode_in_codeblock'>a = X(2)</span>
</span>  f(3);             <span class='comment'>// <span class='tcode_in_codeblock'>f(X(3))</span>
</span>  f({1, 2});        <span class='comment'>// <span class='tcode_in_codeblock'>f(X(1,2))</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv.ctor-2'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.ctor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L823'>#</a></div><div id='class.conv.ctor-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.conv.ctor-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.conv.ctor-2.sentence-1' class='sentence'>An explicit constructor constructs objects just like non-explicit
constructors, but does so only where the <a href='dcl.init#def:direct-initialization'>direct-initialization</a> syntax
or where casts (<a href='expr.static.cast'>[expr.static.cast]</a>, <a href='expr.cast'>[expr.cast]</a>) are explicitly
used; see also <a href='over.match.copy'>[over.match.copy]</a><a class='hidden_link' href='#class.conv.ctor-2.sentence-1'>.</a></div> <div id='class.conv.ctor-2.sentence-2' class='sentence'>A default constructor may be an explicit constructor; such a constructor
will be used to perform default-initialization
or <a href='dcl.init#def:value-initialize'>value-initialization</a><a class='hidden_link' href='#class.conv.ctor-2.sentence-2'>.</a></div> <div id='class.conv.ctor-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.ctor-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct Z {
  explicit Z();
  explicit Z(int);
  explicit Z(int, int);
};

Z a;                            <span class='comment'>// OK: default-initialization performed
</span>Z b{};                          <span class='comment'>// OK: direct initialization syntax used
</span>Z c = {};                       <span class='comment'>// error: copy-list-initialization
</span>Z a1 = 1;                       <span class='comment'>// error: no implicit conversion
</span>Z a3 = Z(1);                    <span class='comment'>// OK: direct initialization syntax used
</span>Z a2(1);                        <span class='comment'>// OK: direct initialization syntax used
</span>Z* p = new Z(1);                <span class='comment'>// OK: direct initialization syntax used
</span>Z a4 = (Z)1;                    <span class='comment'>// OK: explicit cast used
</span>Z a5 = static_cast&lt;Z&gt;(1);       <span class='comment'>// OK: explicit cast used
</span>Z a6 = { 3, 4 };                <span class='comment'>// error: no implicit conversion
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv.ctor-3'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.ctor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L854'>#</a></div><div id='class.conv.ctor-3.sentence-1' class='sentence'>A
non-explicit
copy/move constructor (<a href='#class.copy'>[class.copy]</a>) is a converting constructor<a class='hidden_link' href='#class.conv.ctor-3.sentence-1'>.</a></div> <div id='class.conv.ctor-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.conv.ctor-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.conv.ctor-3.sentence-2' class='sentence'>An implicitly-declared copy/move constructor is not an explicit constructor;
it may be called for implicit type conversions<a class='hidden_link' href='#class.conv.ctor-3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='class.conv.fct' class='section'><h3 ><a class='secnum' href='#class.conv.fct' style='min-width:103pt'>15.3.2</a> Conversion functions <a class='abbr_ref' href='class.conv.fct'>[class.conv.fct]</a></h3><span class='indexparent'><a class='index' id=':function,conversion'></a></span><span class='indexparent'><a class='index' id=':conversion,user-defined_'></a></span><div class='para' id='class.conv.fct-1'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.fct-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L868'>#</a></div><div id='class.conv.fct-1.sentence-1' class='sentence'>A member function of a class <span class='texttt'>X</span> having no parameters with a name of the form
<pre class='bnf'><a class='nontermdef' href='#nt:conversion-function-id' id='nt:conversion-function-id'>conversion-function-id:</a>
&#9;<span class='terminal'><i ><a href='over.oper#nt:operator'>operator</a></i></span> <i ><a href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a></i>
</pre>
<pre class='bnf'><a class='nontermdef' href='#nt:conversion-type-id' id='nt:conversion-type-id'>conversion-type-id:</a>
&#9;<i ><a href='dcl.type#nt:type-specifier-seq'>type-specifier-seq</a></i> <i ><a href='class.conv.fct#nt:conversion-declarator'>conversion-declarator</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre>
<pre class='bnf'><a class='nontermdef' href='#nt:conversion-declarator' id='nt:conversion-declarator'>conversion-declarator:</a>
&#9;<i ><a href='dcl.decl#nt:ptr-operator'>ptr-operator</a></i> <i ><a href='class.conv.fct#nt:conversion-declarator'>conversion-declarator</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre>
specifies a conversion from
<span class='texttt'>X</span>
to the type specified by the
<i ><a href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a></i><a class='hidden_link' href='#class.conv.fct-1.sentence-1'>.</a></div> <div id='class.conv.fct-1.sentence-2' class='sentence'>Such functions are called <a class='hidden_link' href='#def:conversion_function' id='def:conversion_function'><i >conversion functions</i></a><a class='hidden_link' href='#class.conv.fct-1.sentence-2'>.</a></div> <div id='class.conv.fct-1.sentence-3' class='sentence'>A <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i> in the <i ><a href='dcl.spec#nt:decl-specifier-seq'>decl-specifier-seq</a></i>
of a conversion function (if any) shall be neither
a <i ><a href='dcl.type#nt:defining-type-specifier'>defining-type-specifier</a></i> nor <span class='texttt'>static</span><a class='hidden_link' href='#class.conv.fct-1.sentence-3'>.</a></div> <div id='class.conv.fct-1.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':conversion,type_of'></a></span>The type of the conversion function (<a href='dcl.fct'>[dcl.fct]</a>) is
“function taking no parameter returning
<i ><a href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a></i>”<a class='hidden_link' href='#class.conv.fct-1.sentence-4'>.</a></div> <div id='class.conv.fct-1.sentence-5' class='sentence'>A conversion function is never used to convert a (possibly cv-qualified) object
to the (possibly cv-qualified) same object type (or a reference to it),
to a (possibly cv-qualified) base class of that type (or a reference to it),
or to (possibly cv-qualified) void<a class='hidden_link' href='#class.conv.fct-1.sentence-5'>.</a><a class='footnotenum' href='#footnote-116'>116</a></div> <div id='class.conv.fct-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.fct-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X {
  operator int();
  operator auto() -&gt; short;     <span class='comment'>// error: trailing return type
</span>};

void f(X a) {
  int i = int(a);
  i = (int)a;
  i = a;
}</pre> <div id='class.conv.fct-1.sentence-6' class='sentence'>
In all three cases the value assigned will be converted by
<span class='texttt'>X&#x200b;::&#x200b;operator int()</span><a class='hidden_link' href='#class.conv.fct-1.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv.fct-2'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.fct-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L919'>#</a></div><div id='class.conv.fct-2.sentence-1' class='sentence'>A conversion function may be <a href='dcl.fct.spec#:specifier,explicit'>explicit</a>, in which case it is only considered as a user-defined conversion for <a href='dcl.init#def:direct-initialization'>direct-initialization</a><a class='hidden_link' href='#class.conv.fct-2.sentence-1'>.</a></div> <div id='class.conv.fct-2.sentence-2' class='sentence'>Otherwise, user-defined conversions are not restricted to use in assignments and initializations<a class='hidden_link' href='#class.conv.fct-2.sentence-2'>.</a></div> <div id='class.conv.fct-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.fct-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class Y { };
struct Z {
  explicit operator Y() const;
};

void h(Z z) {
  Y y1(z);          <span class='comment'>// OK: direct-initialization
</span>  Y y2 = z;         <span class='comment'>// ill-formed: copy-initialization
</span>  Y y3 = (Y)z;      <span class='comment'>// OK: cast notation
</span>}

void g(X a, X b) {
  int i = (a) ? 1+a : 0;
  int j = (a&amp;&amp;b) ? a+b : i;
  if (a) {
  }
}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv.fct-3'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.fct-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L943'>#</a></div><div id='class.conv.fct-3.sentence-1' class='sentence'>The
<i ><a href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a></i>
shall not represent a function type nor an array type<a class='hidden_link' href='#class.conv.fct-3.sentence-1'>.</a></div> <div id='class.conv.fct-3.sentence-2' class='sentence'>The
<i ><a href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a></i>
in a
<i ><a href='class.conv.fct#nt:conversion-function-id'>conversion-function-id</a></i>
is the longest sequence of
tokens that could possibly form a <i ><a href='class.conv.fct#nt:conversion-type-id'>conversion-type-id</a></i><a class='hidden_link' href='#class.conv.fct-3.sentence-2'>.</a></div> <div id='class.conv.fct-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.conv.fct-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.conv.fct-3.sentence-3' class='sentence'>This prevents ambiguities between the declarator operator <span class='texttt'>*</span> and its expression
counterparts<a class='hidden_link' href='#class.conv.fct-3.sentence-3'>.</a></div> <div id='class.conv.fct-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.fct-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
&amp;ac.operator int*i; <span class='comment'>// syntax error:
</span>                    <span class='comment'>// parsed as: <span class='tcode_in_codeblock'>&amp;(ac.operator int *)i</span>
</span>                    <span class='comment'>// not as: <span class='tcode_in_codeblock'>&amp;(ac.operator int)*i</span>
</span></pre> <div id='class.conv.fct-3.sentence-5' class='sentence'>
The <span class='texttt'>*</span> is the pointer declarator and not the multiplication operator<a class='hidden_link' href='#class.conv.fct-3.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.conv.fct-3.sentence-4' class='sentence'>
This rule also prevents ambiguities for attributes<a class='hidden_link' href='#class.conv.fct-3.sentence-4'>.</a></div> <div id='class.conv.fct-3.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.fct-3.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
operator int [[noreturn]] ();   <span class='comment'>// error: <span class='tcode_in_codeblock'>noreturn</span> attribute applied to a type
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.conv.fct-4'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.fct-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L972'>#</a></div><div id='class.conv.fct-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,inheritance_of_user-defined'></a></span>Conversion functions are inherited<a class='hidden_link' href='#class.conv.fct-4.sentence-1'>.</a></div></div><div class='para' id='class.conv.fct-5'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.fct-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L976'>#</a></div><div id='class.conv.fct-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,virtual_user-defined'></a></span>Conversion functions can be virtual<a class='hidden_link' href='#class.conv.fct-5.sentence-1'>.</a></div></div><div class='para' id='class.conv.fct-6'><div class='marginalizedparent'><a class='marginalized' href='#class.conv.fct-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L980'>#</a></div><div id='class.conv.fct-6.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,deduced_return_type_of_user-defined'></a></span>A conversion function template shall not have a
<a href='dcl.spec.auto'>deduced return type</a><a class='hidden_link' href='#class.conv.fct-6.sentence-1'>.</a></div> <div id='class.conv.fct-6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.conv.fct-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S {
  operator auto() const { return 10; }      <span class='comment'>// OK
</span>  template&lt;class T&gt;
  operator auto() const { return 1.2; }     <span class='comment'>// error: conversion function template
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-116'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-116'>116)</a></div><div id='footnote-116.sentence-1' class='sentence'>These conversions are considered
as standard conversions for the purposes of overload resolution (<a href='over.best.ics'>[over.best.ics]</a>, <a href='over.ics.ref'>[over.ics.ref]</a>) and therefore initialization (<a href='dcl.init'>[dcl.init]</a>) and <a href='expr.static.cast'>explicit casts</a><a class='hidden_link' href='#footnote-116.sentence-1'>.</a></div> <div id='footnote-116.sentence-2' class='sentence'>A conversion to <span class='texttt'>void</span> does not invoke any conversion function (<a href='expr.static.cast'>[expr.static.cast]</a>)<a class='hidden_link' href='#footnote-116.sentence-2'>.</a></div> <div id='footnote-116.sentence-3' class='sentence'>Even though never directly called to perform a conversion,
such conversion functions can be declared and can potentially
be reached through a call to a virtual conversion function in a base class<a class='hidden_link' href='#footnote-116.sentence-3'>.</a></div></div></div></div><div id='class.dtor' class='section'><h2 ><a class='secnum' href='#class.dtor' style='min-width:88pt'>15.4</a> Destructors <a class='abbr_ref' href='class.dtor'>[class.dtor]</a></h2><span class='indexparent'><a class='index' id=':destructor'></a></span><div class='para' id='class.dtor-1'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L998'>#</a></div><div id='class.dtor-1.sentence-1' class='sentence'>In a declaration of a destructor, the <i ><a href='dcl.decl#nt:declarator'>declarator</a></i> is a
<a href='dcl.fct'>function declarator</a> of the form
<pre class='ncbnf'><i ><a href='dcl.decl#nt:ptr-declarator'>ptr-declarator</a></i> <span class='terminal'>(</span> <i ><a href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a></i> <span class='terminal'>)</span> <i ><a href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre>
where the <i ><a href='dcl.decl#nt:ptr-declarator'>ptr-declarator</a></i> consists solely of an
<i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i>, an optional <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i>,
and optional surrounding parentheses, and the <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> has
one of the following forms:</div><div id='class.dtor-1.sentence-2' class='sentence'><ul class='itemize'><li id='class.dtor-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-1.1'>(1.1)</a></div><div id='class.dtor-1.1.sentence-1' class='sentence'>in a <i ><a href='class.mem#nt:member-declaration'>member-declaration</a></i> that belongs to the
<i ><a href='class.mem#nt:member-specification'>member-specification</a></i> of a class or class template
but is not a friend
declaration (<a href='class.friend'>[class.friend]</a>), the <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> is
<span class='texttt'>~</span><i ><a href='class#nt:class-name'>class-name</a></i> and the <i ><a href='class#nt:class-name'>class-name</a></i> is the
injected-class-name (<a href='class'>[class]</a>) of the immediately-enclosing entity or</div></li><li id='class.dtor-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-1.2'>(1.2)</a></div><div id='class.dtor-1.2.sentence-1' class='sentence'>in a declaration at namespace scope or in a friend declaration, the
<i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i> is <i ><a href='expr.prim.id.qual#nt:nested-name-specifier'>nested-name-specifier</a></i>
<span class='texttt'>~</span><i ><a href='class#nt:class-name'>class-name</a></i> and the <i ><a href='class#nt:class-name'>class-name</a></i> names the
same class as the <i ><a href='expr.prim.id.qual#nt:nested-name-specifier'>nested-name-specifier</a></i><a class='hidden_link' href='#class.dtor-1.2.sentence-1'>.</a></div></li></ul></div><div id='class.dtor-1.sentence-3' class='sentence'>The <i ><a href='class#nt:class-name'>class-name</a></i> shall not be a <i ><a href='dcl.typedef#nt:typedef-name'>typedef-name</a></i><a class='hidden_link' href='#class.dtor-1.sentence-3'>.</a></div> <div id='class.dtor-1.sentence-4' class='sentence'>A
destructor shall take no arguments (<a href='dcl.fct'>[dcl.fct]</a>)<a class='hidden_link' href='#class.dtor-1.sentence-4'>.</a></div> <div id='class.dtor-1.sentence-5' class='sentence'>Each <i ><a href='dcl.spec#nt:decl-specifier'>decl-specifier</a></i> of the <i ><a href='dcl.spec#nt:decl-specifier-seq'>decl-specifier-seq</a></i>
of a destructor declaration (if any) shall be <span class='texttt'>friend</span>, <span class='texttt'>inline</span>, or
<span class='texttt'>virtual</span><a class='hidden_link' href='#class.dtor-1.sentence-5'>.</a></div></div><div class='para' id='class.dtor-2'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1031'>#</a></div><div id='class.dtor-2.sentence-1' class='sentence'>A destructor is used to destroy objects of its class type<a class='hidden_link' href='#class.dtor-2.sentence-1'>.</a></div> <div id='class.dtor-2.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':restriction,destructor'></a></span>The address of a destructor shall not be taken<a class='hidden_link' href='#class.dtor-2.sentence-2'>.</a></div> <div id='class.dtor-2.sentence-3' class='sentence'><span class='indexparent'><a class='index' id=':const,destructor_and'></a></span><span class='indexparent'><a class='index' id=':volatile,destructor_and'></a></span>A destructor can be invoked for a
<span class='texttt'>const</span>,
<span class='texttt'>volatile</span>
or
<span class='texttt'>const</span>
<span class='texttt'>volatile</span>
object<a class='hidden_link' href='#class.dtor-2.sentence-3'>.</a></div> <div id='class.dtor-2.sentence-4' class='sentence'><span class='texttt'>const</span>
and
<span class='texttt'>volatile</span>
semantics (<a href='dcl.type.cv'>[dcl.type.cv]</a>) are not applied on an object under destruction<a class='hidden_link' href='#class.dtor-2.sentence-4'>.</a></div> <div id='class.dtor-2.sentence-5' class='sentence'>They stop being in effect when the destructor for the
<a href='intro.object#def:most_derived_object'>most derived object</a> starts<a class='hidden_link' href='#class.dtor-2.sentence-5'>.</a></div></div><div class='para' id='class.dtor-3'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1051'>#</a></div><div id='class.dtor-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-3.sentence-1' class='sentence'>A declaration of a destructor that does not have a <i ><a href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a></i>
has the same exception specification as if it had been implicitly declared (<a href='except.spec'>[except.spec]</a>)<a class='hidden_link' href='#class.dtor-3.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.dtor-4'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1057'>#</a></div><div id='class.dtor-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':destructor,default'></a></span>If a class has no user-declared
destructor, a destructor is implicitly
declared as <a href='dcl.fct.def'>defaulted</a><a class='hidden_link' href='#class.dtor-4.sentence-1'>.</a></div> <div id='class.dtor-4.sentence-2' class='sentence'>An implicitly-declared destructor is an
inline public member of its class<a class='hidden_link' href='#class.dtor-4.sentence-2'>.</a></div></div><div class='para' id='class.dtor-5'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1066'>#</a></div><div id='class.dtor-5.sentence-1' class='sentence'>A defaulted destructor for a class
  <span class='texttt'>X</span> is defined as deleted if:
<ul class='itemize'><li id='class.dtor-5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-5.1'>(5.1)</a></div><div id='class.dtor-5.1.sentence-1' class='sentence'><span class='texttt'>X</span> is a union-like class that has a variant
  member with a non-trivial destructor,</div></li><li id='class.dtor-5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-5.2'>(5.2)</a></div><div id='class.dtor-5.2.sentence-1' class='sentence'>any potentially constructed subobject has class type
  <span class='texttt'>M</span> (or array thereof) and
  <span class='texttt'>M</span> has a deleted destructor or a destructor
  that is inaccessible from the defaulted destructor,</div></li><li id='class.dtor-5.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-5.3'>(5.3)</a></div><div id='class.dtor-5.3.sentence-1' class='sentence'>or, for a virtual destructor, lookup of the non-array deallocation
  function results in an ambiguity or in a function that is deleted or
  inaccessible from the defaulted destructor<a class='hidden_link' href='#class.dtor-5.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='class.dtor-6'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1083'>#</a></div><div id='class.dtor-6.sentence-1' class='sentence'>A destructor is trivial if it is not user-provided and if:</div><div id='class.dtor-6.sentence-2' class='sentence'><ul class='itemize'><li id='class.dtor-6.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-6.1'>(6.1)</a></div><div id='class.dtor-6.1.sentence-1' class='sentence'>the destructor is not <span class='texttt'>virtual</span>,</div></li><li id='class.dtor-6.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-6.2'>(6.2)</a></div><div id='class.dtor-6.2.sentence-1' class='sentence'>all of the direct base classes of its class have trivial destructors, and</div></li><li id='class.dtor-6.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-6.3'>(6.3)</a></div><div id='class.dtor-6.3.sentence-1' class='sentence'>for all of the non-static data members of its class that are of class
type (or array thereof), each such class has a trivial destructor<a class='hidden_link' href='#class.dtor-6.3.sentence-1'>.</a></div></li></ul></div><div id='class.dtor-6.sentence-3' class='sentence'>Otherwise, the destructor is
<a class='hidden_link' href='#def:destructor,non-trivial' id='def:destructor,non-trivial'><i >non-trivial</i></a><a class='hidden_link' href='#class.dtor-6.sentence-3'>.</a></div></div><div class='para' id='class.dtor-7'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1098'>#</a></div><div id='class.dtor-7.sentence-1' class='sentence'>A destructor
that is defaulted and not defined as deleted
is
<a class='hidden_link' href='#def:destructor,implicitly_defined' id='def:destructor,implicitly_defined'><i >implicitly defined</i></a>
when it is <a href='basic.def.odr'>odr-used</a>
or when it is explicitly defaulted after its first declaration<a class='hidden_link' href='#class.dtor-7.sentence-1'>.</a></div></div><div class='para' id='class.dtor-8'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1106'>#</a></div><div id='class.dtor-8.sentence-1' class='sentence'>Before the
defaulted destructor for a class is implicitly defined, all the non-user-provided
destructors for its base classes and its non-static data members shall have been
implicitly defined<a class='hidden_link' href='#class.dtor-8.sentence-1'>.</a></div></div><div class='para' id='class.dtor-9'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1112'>#</a></div><div id='class.dtor-9.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':order_of_execution,destructor'></a></span><span class='indexparent'><a class='index' id=':order_of_execution,base_class_destructor'></a></span><span class='indexparent'><a class='index' id=':order_of_execution,member_destructor'></a></span>After executing the body of the destructor and destroying
any automatic objects allocated within the body, a
destructor for class
<span class='texttt'>X</span>
calls the destructors for
<span class='texttt'>X</span>'s
direct non-variant non-static data members, the destructors for
<span class='texttt'>X</span>'s
non-virtual direct base classes and, if
<span class='texttt'>X</span>
is the type of the most derived class (<a href='#class.base.init'>[class.base.init]</a>),
its destructor calls the destructors for
<span class='texttt'>X</span>'s
virtual base classes<a class='hidden_link' href='#class.dtor-9.sentence-1'>.</a></div> <div id='class.dtor-9.sentence-2' class='sentence'>All destructors are called as if they were referenced with a qualified name,
that is, ignoring any possible virtual overriding destructors in more
derived classes<a class='hidden_link' href='#class.dtor-9.sentence-2'>.</a></div> <div id='class.dtor-9.sentence-3' class='sentence'>Bases and members are destroyed in the reverse order of the completion of
their constructor (see <a href='#class.base.init'>[class.base.init]</a>)<a class='hidden_link' href='#class.dtor-9.sentence-3'>.</a></div> <div id='class.dtor-9.sentence-4' class='sentence'>A
<a href='stmt.return'><span class='texttt'>return</span>
statement</a> in a destructor might not directly return to the
caller; before transferring control to the caller, the destructors for the
members and bases are called<a class='hidden_link' href='#class.dtor-9.sentence-4'>.</a></div> <div id='class.dtor-9.sentence-5' class='sentence'><span class='indexparent'><a class='index' id=':order_of_execution,destructor_and_array'></a></span>Destructors for elements of an array are called in reverse order of their
construction (see <a href='#class.init'>[class.init]</a>)<a class='hidden_link' href='#class.dtor-9.sentence-5'>.</a></div></div><div class='para' id='class.dtor-10'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1144'>#</a></div><div id='class.dtor-10.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':destructor,virtual'></a></span><span class='indexparent'><a class='index' id=':destructor,pure_virtual'></a></span>A destructor can be declared
<a href='class.virtual'><span class='texttt'>virtual</span></a>
or <a href='class.abstract'>pure <span class='texttt'>virtual</span></a>;
if any objects of that class or any derived class are created in the program,
the destructor shall be defined<a class='hidden_link' href='#class.dtor-10.sentence-1'>.</a></div> <div id='class.dtor-10.sentence-2' class='sentence'>If a class has a base class with a virtual destructor, its  destructor
(whether user- or implicitly-declared) is virtual<a class='hidden_link' href='#class.dtor-10.sentence-2'>.</a></div></div><div class='para' id='class.dtor-11'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1155'>#</a></div><div id='class.dtor-11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-11.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':member_function,destructor_and'></a></span>Some language constructs have special semantics when used during destruction;
see <a href='#class.cdtor'>[class.cdtor]</a><a class='hidden_link' href='#class.dtor-11.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.dtor-12'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1162'>#</a></div><div id='class.dtor-12.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':destructor,implicit_call'></a></span><span class='indexparent'><a class='index' id=':destructor,program_termination_and'></a></span>A destructor is invoked implicitly</div><div id='class.dtor-12.sentence-2' class='sentence'><ul class='itemize'><li id='class.dtor-12.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-12.1'>(12.1)</a></div><div id='class.dtor-12.1.sentence-1' class='sentence'>

for a constructed object with <a href='basic.stc.static'>static storage duration</a> at program <a href='basic.start.term'>termination</a>,</div></li><li id='class.dtor-12.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-12.2'>(12.2)</a></div><div id='class.dtor-12.2.sentence-1' class='sentence'>for a constructed object with <a href='basic.stc.thread'>thread storage duration</a> at thread exit,</div></li><li id='class.dtor-12.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-12.3'>(12.3)</a></div><div id='class.dtor-12.3.sentence-1' class='sentence'>for a constructed object with <a href='basic.stc.auto'>automatic storage duration</a> when the block in which an object is created exits (<a href='stmt.dcl'>[stmt.dcl]</a>),</div></li><li id='class.dtor-12.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.dtor-12.4'>(12.4)</a></div><div id='class.dtor-12.4.sentence-1' class='sentence'>for a constructed temporary object when its lifetime ends (<a href='conv.rval'>[conv.rval]</a>, <a href='#class.temporary'>[class.temporary]</a>)<a class='hidden_link' href='#class.dtor-12.4.sentence-1'>.</a></div></li></ul></div><div id='class.dtor-12.sentence-3' class='sentence'><span class='indexparent'><a class='index' id=':delete,destructor_and'></a></span><span class='indexparent'><a class='index' id=':destructor,explicit_call'></a></span>In each case, the context of the invocation is the context of the construction of
the object<a class='hidden_link' href='#class.dtor-12.sentence-3'>.</a></div> <div id='class.dtor-12.sentence-4' class='sentence'>A destructor may also be invoked implicitly through use of a
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i> for a constructed object allocated
by a <i ><a href='expr.new#nt:new-expression'>new-expression</a></i>; the context of the invocation is the
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i><a class='hidden_link' href='#class.dtor-12.sentence-4'>.</a></div> <div id='class.dtor-12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-12.sentence-8' class='sentence'>An array of class type contains several subobjects for each of which
the destructor is invoked<a class='hidden_link' href='#class.dtor-12.sentence-8'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.dtor-12.sentence-5' class='sentence'>
A destructor can also be invoked explicitly<a class='hidden_link' href='#class.dtor-12.sentence-5'>.</a></div> <div id='class.dtor-12.sentence-6' class='sentence'>A destructor is <a class='hidden_link' href='#def:potentially_invoked' id='def:potentially_invoked'><i>potentially invoked</i></a>
if it is invoked or as specified in <a href='expr.new'>[expr.new]</a>, <a href='dcl.init.aggr'>[dcl.init.aggr]</a>,
<a href='#class.base.init'>[class.base.init]</a>, and <a href='except.throw'>[except.throw]</a><a class='hidden_link' href='#class.dtor-12.sentence-6'>.</a></div> <div id='class.dtor-12.sentence-7' class='sentence'>A program is ill-formed if a destructor that is potentially invoked is deleted
or not accessible from the context of the invocation<a class='hidden_link' href='#class.dtor-12.sentence-7'>.</a></div></div><div class='para' id='class.dtor-13'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1193'>#</a></div><div id='class.dtor-13.sentence-1' class='sentence'>At the point of definition of a virtual destructor (including an
<a href='#def:destructor,implicitly_defined'>implicit definition</a>),
the non-array deallocation function is
determined as if for the expression <span class='texttt'>delete this</span> appearing in a
non-virtual destructor of the destructor's class (see <a href='expr.delete'>[expr.delete]</a>)<a class='hidden_link' href='#class.dtor-13.sentence-1'>.</a></div> <div id='class.dtor-13.sentence-2' class='sentence'>If the lookup fails or if the deallocation function has
a <a href='dcl.fct.def#def:deleted_definition'>deleted definition</a>, the program is ill-formed<a class='hidden_link' href='#class.dtor-13.sentence-2'>.</a></div> <div id='class.dtor-13.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-13.sentence-3' class='sentence'>This assures that a deallocation function corresponding to the dynamic type of an
object is available for the
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i> (<a href='#class.free'>[class.free]</a>)<a class='hidden_link' href='#class.dtor-13.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.dtor-14'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1207'>#</a></div><div id='class.dtor-14.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':destructor,explicit_call_'></a></span>In an explicit destructor call, the destructor is specified by a
<span class='texttt'>~</span>
followed by a
<i ><a href='dcl.type.simple#nt:type-name'>type-name</a></i> or <i ><a href='dcl.type.simple#nt:decltype-specifier'>decltype-specifier</a></i>
that denotes the destructor's class type<a class='hidden_link' href='#class.dtor-14.sentence-1'>.</a></div> <div id='class.dtor-14.sentence-2' class='sentence'>The invocation of a destructor is subject to the usual rules for <a href='class.mfct'>member
functions</a>;
that is, if the object is not of the destructor's class type and
not of a class derived from the destructor's class type (including when
the destructor is invoked via a null pointer value), the program has
undefined behavior<a class='hidden_link' href='#class.dtor-14.sentence-2'>.</a></div> <div id='class.dtor-14.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-14.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-14.sentence-3' class='sentence'>Invoking <span class='texttt'>delete</span> on a null pointer does not call the
destructor; see <a href='expr.delete'>[expr.delete]</a><a class='hidden_link' href='#class.dtor-14.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.dtor-14.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.dtor-14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct B {
  virtual ~B() { }
};
struct D : B {
  ~D() { }
};

D D_object;
typedef B B_alias;
B* B_ptr = &amp;D_object;

void f() {
  D_object.B::~B();             <span class='comment'>// calls <span class='tcode_in_codeblock'>B</span>'s destructor
</span>  B_ptr-&gt;~B();                  <span class='comment'>// calls <span class='tcode_in_codeblock'>D</span>'s destructor
</span>  B_ptr-&gt;~B_alias();            <span class='comment'>// calls <span class='tcode_in_codeblock'>D</span>'s destructor
</span>  B_ptr-&gt;B_alias::~B();         <span class='comment'>// calls <span class='tcode_in_codeblock'>B</span>'s destructor
</span>  B_ptr-&gt;B_alias::~B_alias();   <span class='comment'>// calls <span class='tcode_in_codeblock'>B</span>'s destructor
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.dtor-14.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-14.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-14.sentence-4' class='sentence'>An explicit destructor call must always be written using
a <a href='expr.ref'>member access</a> operator or a <i ><a href='expr.prim.id.qual#nt:qualified-id'>qualified-id</a></i>;
in particular, the
<i ><a href='expr.unary#nt:unary-expression'>unary-expression</a></i>
<span class='texttt'>~X()</span>
in a member function is not an explicit destructor call (<a href='expr.unary.op'>[expr.unary.op]</a>)<a class='hidden_link' href='#class.dtor-14.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.dtor-15'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1254'>#</a></div><div id='class.dtor-15.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-15.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object,destructor_and_placement_of'></a></span>Explicit calls of destructors are rarely needed<a class='hidden_link' href='#class.dtor-15.sentence-1'>.</a></div> <div id='class.dtor-15.sentence-2' class='sentence'>One use of such calls is for objects placed at specific
addresses using a placement
<i ><a href='expr.new#nt:new-expression'>new-expression</a></i><a class='hidden_link' href='#class.dtor-15.sentence-2'>.</a></div> <div id='class.dtor-15.sentence-3' class='sentence'>Such use of explicit placement and destruction of objects can be necessary
to cope with dedicated hardware resources and for writing memory management
facilities<a class='hidden_link' href='#class.dtor-15.sentence-3'>.</a></div> <div id='class.dtor-15.sentence-4' class='sentence'>For example,
<pre class='codeblock'>
void* operator new(std::size_t, void* p) { return p; }
struct X {
  X(int);
  ~X();
};
void f(X* p);

void g() {                      <span class='comment'>// rare, specialized use:
</span>  char* buf = new char[sizeof(X)];
  X* p = new(buf) X(222);       <span class='comment'>// use <span class='tcode_in_codeblock'>buf[]</span> and initialize
</span>  f(p);
  p-&gt;X::~X();                   <span class='comment'>// cleanup
</span>}</pre></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.dtor-16'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1282'>#</a></div><div id='class.dtor-16.sentence-1' class='sentence'>Once a destructor is invoked for an object, the object no longer exists;
the behavior is undefined if the destructor is invoked
for an object whose <a href='basic.life#def:lifetime'>lifetime</a> has ended<a class='hidden_link' href='#class.dtor-16.sentence-1'>.</a></div> <div id='class.dtor-16.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.dtor-16.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.dtor-16.sentence-2' class='sentence'>If the destructor for an automatic object is explicitly invoked,
and the block is subsequently left in a manner that would ordinarily
invoke implicit destruction of the object, the behavior is undefined<a class='hidden_link' href='#class.dtor-16.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.dtor-17'><div class='marginalizedparent'><a class='marginalized' href='#class.dtor-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1292'>#</a></div><div id='class.dtor-17.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.dtor-17.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.dtor-17.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':fundamental_type,destructor_and'></a></span>The notation for explicit call of a destructor can be used for any scalar type
name (<a href='expr.pseudo'>[expr.pseudo]</a>)<a class='hidden_link' href='#class.dtor-17.sentence-1'>.</a></div> <div id='class.dtor-17.sentence-2' class='sentence'>Allowing this makes it possible to write code without having to know if a
destructor exists for a given type<a class='hidden_link' href='#class.dtor-17.sentence-2'>.</a></div> <div id='class.dtor-17.sentence-3' class='sentence'>For example:
<pre class='codeblock'>
typedef int I;
I* p;
p-&gt;I::~I();</pre></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='class.free' class='section'><h2 ><a class='secnum' href='#class.free' style='min-width:88pt'>15.5</a> Free store <a class='abbr_ref' href='class.free'>[class.free]</a></h2><span class='indexparent'><a class='index' id=':free_store'></a></span><div class='para' id='class.free-1'><div class='marginalizedparent'><a class='marginalized' href='#class.free-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1310'>#</a></div><div id='class.free-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':new,type_of'></a></span>
Any allocation function for a class
<span class='texttt'>T</span>
is a static member (even if not explicitly declared
<span class='texttt'>static</span>)<a class='hidden_link' href='#class.free-1.sentence-1'>.</a></div></div><div class='para' id='class.free-2'><div class='marginalizedparent'><a class='marginalized' href='#class.free-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1317'>#</a></div><div id='class.free-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.free-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class Arena;
struct B {
  void* operator new(std::size_t, Arena*);
};
struct D1 : B {
};

Arena*  ap;
void foo(int i) {
  new (ap) D1;      <span class='comment'>// calls <span class='tcode_in_codeblock'>B&#x200b;::&#x200b;operator new(std&#x200b;::&#x200b;size_&shy;t, Arena*)</span>
</span>  new D1[i];        <span class='comment'>// calls <span class='tcode_in_codeblock'>&#x200b;::&#x200b;operator new[](std&#x200b;::&#x200b;size_&shy;t)</span>
</span>  new D1;           <span class='comment'>// ill-formed: <span class='tcode_in_codeblock'>&#x200b;::&#x200b;operator new(std&#x200b;::&#x200b;size_&shy;t)</span> hidden
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.free-3'><div class='marginalizedparent'><a class='marginalized' href='#class.free-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1336'>#</a></div><div id='class.free-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':delete'></a></span>When an object is deleted with a
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i>,
a deallocation function
<span class='indexparent'><a class='index' id=':function,deallocation'></a></span>(<span class='texttt'>operator delete()</span>
<span class='indexparent'><a class='index' id=':operator_delete'></a></span>for non-array objects or
<span class='texttt'>operator delete[]()</span>
<span class='indexparent'><a class='index' id=':operator_delete_'></a></span>for arrays) is (implicitly) called to reclaim the storage occupied by
the object (<a href='basic.stc.dynamic.deallocation'>[basic.stc.dynamic.deallocation]</a>)<a class='hidden_link' href='#class.free-3.sentence-1'>.</a></div></div><div class='para' id='class.free-4'><div class='marginalizedparent'><a class='marginalized' href='#class.free-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1350'>#</a></div><div id='class.free-4.sentence-1' class='sentence'>Class-specific deallocation function lookup is a part of general deallocation
function lookup (<a href='expr.delete'>[expr.delete]</a>) and occurs as follows<a class='hidden_link' href='#class.free-4.sentence-1'>.</a></div> <div id='class.free-4.sentence-2' class='sentence'>If the <i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i>
is used to deallocate a class object whose static type has a virtual
destructor, the deallocation function is the one selected at the point
of definition of the dynamic type's virtual
destructor (<a href='#class.dtor'>[class.dtor]</a>)<a class='hidden_link' href='#class.free-4.sentence-2'>.</a><a class='footnotenum' href='#footnote-117'>117</a></div> <div id='class.free-4.sentence-3' class='sentence'>
Otherwise, if the
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i>
is used to deallocate an object of class
<span class='texttt'>T</span>
or array thereof,
the deallocation function's name is looked up in the scope of
<span class='texttt'>T</span><a class='hidden_link' href='#class.free-4.sentence-3'>.</a></div> <div id='class.free-4.sentence-4' class='sentence'>If this lookup fails to find the name, general deallocation function
lookup (<a href='expr.delete'>[expr.delete]</a>) continues<a class='hidden_link' href='#class.free-4.sentence-4'>.</a></div> <div id='class.free-4.sentence-5' class='sentence'>If the result of the lookup is ambiguous or inaccessible, or if the lookup
selects a placement deallocation function, the program is ill-formed<a class='hidden_link' href='#class.free-4.sentence-5'>.</a></div></div><div class='para' id='class.free-5'><div class='marginalizedparent'><a class='marginalized' href='#class.free-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1374'>#</a></div><div id='class.free-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':delete,type_of'></a></span>Any deallocation function for a class
<span class='texttt'>X</span>
is a static member (even if not explicitly declared
<span class='texttt'>static</span>)<a class='hidden_link' href='#class.free-5.sentence-1'>.</a></div> <div id='class.free-5.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.free-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class X {
  void operator delete(void*);
  void operator delete[](void*, std::size_t);
};

class Y {
  void operator delete(void*, std::size_t);
  void operator delete[](void*);
};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.free-6'><div class='marginalizedparent'><a class='marginalized' href='#class.free-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1394'>#</a></div><div id='class.free-6.sentence-1' class='sentence'>Since member allocation and deallocation functions are
<span class='texttt'>static</span>
they cannot be virtual<a class='hidden_link' href='#class.free-6.sentence-1'>.</a></div> <div id='class.free-6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.free-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.free-6.sentence-2' class='sentence'>However, when the
<i ><a href='expr.cast#nt:cast-expression'>cast-expression</a></i>
of a
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i>
refers to an object of class type,
because the deallocation function actually called is looked up in the scope of
the class that is the dynamic type of the object
if the destructor is virtual, the effect is the same in that case<a class='hidden_link' href='#class.free-6.sentence-2'>.</a></div> <div id='class.free-6.sentence-3' class='sentence'>For example,
<pre class='codeblock'>
struct B {
  virtual ~B();
  void operator delete(void*, std::size_t);
};

struct D : B {
  void operator delete(void*);
};

struct E : B {
  void log_deletion();
  void operator delete(E *p, std::destroying_delete_t) {
    p-&gt;log_deletion();
    p-&gt;~E();
    ::operator delete(p);
  }
};

void f() {
  B* bp = new D;
  delete bp;        <span class='comment'>// 1: uses <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;operator delete(void*)</span>
</span>  bp = new E;
  delete bp;        <span class='comment'>// 2: uses <span class='tcode_in_codeblock'>E&#x200b;::&#x200b;operator delete(E*, std&#x200b;::&#x200b;destroying_&shy;delete_&shy;t)</span>
</span>}</pre>
Here, storage for the object of class
<span class='texttt'>D</span>
is deallocated by
<span class='texttt'>D&#x200b;::&#x200b;operator delete()</span>,
and
the object of class <span class='texttt'>E</span> is destroyed
and its storage is deallocated
by <span class='texttt'>E&#x200b;::&#x200b;operator delete()</span>,
due to the virtual destructor<a class='hidden_link' href='#class.free-6.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.free-6.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.free-6.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.free-6.sentence-4' class='sentence'>Virtual destructors have no effect on the deallocation function actually
called when the
<i ><a href='expr.cast#nt:cast-expression'>cast-expression</a></i>
of a
<i ><a href='expr.delete#nt:delete-expression'>delete-expression</a></i>
refers to an array of objects of class type<a class='hidden_link' href='#class.free-6.sentence-4'>.</a></div> <div id='class.free-6.sentence-5' class='sentence'>For example,
<pre class='codeblock'>
struct B {
  virtual ~B();
  void operator delete[](void*, std::size_t);
};

struct D : B {
  void operator delete[](void*, std::size_t);
};

void f(int i) {
  D* dp = new D[i];
  delete [] dp;     <span class='comment'>// uses <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;operator delete[](void*, std&#x200b;::&#x200b;size_&shy;t)</span>
</span>  B* bp = new D[i];
  delete[] bp;      <span class='comment'>// undefined behavior
</span>}</pre></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.free-7'><div class='marginalizedparent'><a class='marginalized' href='#class.free-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1471'>#</a></div><div id='class.free-7.sentence-1' class='sentence'>Access to the deallocation function is checked statically<a class='hidden_link' href='#class.free-7.sentence-1'>.</a></div> <div id='class.free-7.sentence-2' class='sentence'>Hence, even though a different one might actually be executed,
the statically visible deallocation function is required to be accessible<a class='hidden_link' href='#class.free-7.sentence-2'>.</a></div> <div id='class.free-7.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.free-7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.free-7.sentence-3' class='sentence'>For the call on line “// 1” above,
if
<span class='texttt'>B&#x200b;::&#x200b;operator delete()</span>
had been private, the delete expression would have been ill-formed<a class='hidden_link' href='#class.free-7.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.free-8'><div class='marginalizedparent'><a class='marginalized' href='#class.free-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1482'>#</a></div><div id='class.free-8.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.free-8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.free-8.sentence-1' class='sentence'>If a deallocation function has no explicit <i ><a href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a></i>, it
has a non-throwing <a href='except.spec'>exception specification</a><a class='hidden_link' href='#class.free-8.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-117'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-117'>117)</a></div><div id='footnote-117.sentence-1' class='sentence'>A similar provision is not needed for
the array version of <span class='texttt'>operator</span> <span class='texttt'>delete</span> because <a href='expr.delete'>[expr.delete]</a>
requires that in this situation, the static type of the object to be deleted be
the same as its dynamic type<a class='hidden_link' href='#footnote-117.sentence-1'>.</a></div></div></div><div id='class.init' class='section'><h2 ><a class='secnum' href='#class.init' style='min-width:88pt'>15.6</a> Initialization <a class='abbr_ref' href='class.init'>[class.init]</a></h2><span class='indexparent'><a class='index' id=':initialization,class_object'></a></span><span class='indexparent'><a class='index' id=':initialization,default_constructor_and'></a></span><span class='indexparent'><a class='index' id=':initialization,constructor_and'></a></span><div class='para' id='class.init-1'><div class='marginalizedparent'><a class='marginalized' href='#class.init-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1493'>#</a></div><div id='class.init-1.sentence-1' class='sentence'>When no initializer is specified for an object of (possibly
cv-qualified) class type (or array thereof), or the initializer has
the form
<span class='texttt'>()</span>,
the object is initialized as specified in <a href='dcl.init'>[dcl.init]</a><a class='hidden_link' href='#class.init-1.sentence-1'>.</a></div></div><div class='para' id='class.init-2'><div class='marginalizedparent'><a class='marginalized' href='#class.init-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1500'>#</a></div><div id='class.init-2.sentence-1' class='sentence'>An object of class type (or array thereof) can be explicitly initialized;
see <a href='#class.expl.init'>[class.expl.init]</a> and <a href='#class.base.init'>[class.base.init]</a><a class='hidden_link' href='#class.init-2.sentence-1'>.</a></div></div><div class='para' id='class.init-3'><div class='marginalizedparent'><a class='marginalized' href='#class.init-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1504'>#</a></div><div id='class.init-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':order_of_execution,constructor_and_array'></a></span>When an array of class objects is initialized
(either explicitly or implicitly) and the elements are initialized by constructor,
the constructor shall be called for each element of the array,
following the subscript order; see <a href='dcl.array'>[dcl.array]</a><a class='hidden_link' href='#class.init-3.sentence-1'>.</a></div> <div id='class.init-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.init-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.init-3.sentence-2' class='sentence'>Destructors for the array elements are called in reverse order of their
construction<a class='hidden_link' href='#class.init-3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div id='class.expl.init' class='section'><h3 ><a class='secnum' href='#class.expl.init' style='min-width:103pt'>15.6.1</a> Explicit initialization <a class='abbr_ref' href='class.expl.init'>[class.expl.init]</a></h3><span class='indexparent'><a class='index' id=':initialization,explicit'></a></span><span class='indexparent'><a class='index' id=':initialization,constructor_and_'></a></span><div class='para' id='class.expl.init-1'><div class='marginalizedparent'><a class='marginalized' href='#class.expl.init-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1519'>#</a></div><div id='class.expl.init-1.sentence-1' class='sentence'>An object of class type can be initialized with a parenthesized
<i ><a href='expr.post#nt:expression-list'>expression-list</a></i>,
where the
<i ><a href='expr.post#nt:expression-list'>expression-list</a></i>
is construed as an argument list for a constructor
that is called to initialize the object<a class='hidden_link' href='#class.expl.init-1.sentence-1'>.</a></div> <div id='class.expl.init-1.sentence-2' class='sentence'>Alternatively, a single
<i ><a href='expr.ass#nt:assignment-expression'>assignment-expression</a></i>
can be specified as an
<i ><a href='dcl.init#nt:initializer'>initializer</a></i>
using the
<span class='texttt'>=</span>
form of initialization<a class='hidden_link' href='#class.expl.init-1.sentence-2'>.</a></div> <div id='class.expl.init-1.sentence-3' class='sentence'>Either direct-initialization semantics or copy-initialization semantics apply;
see <a href='dcl.init'>[dcl.init]</a><a class='hidden_link' href='#class.expl.init-1.sentence-3'>.</a></div> <div id='class.expl.init-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.expl.init-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct complex {
  complex();
  complex(double);
  complex(double,double);
};

complex sqrt(complex,complex);

complex a(1);                   <span class='comment'>// initialized by calling <span class='tcode_in_codeblock'>complex(double)</span> with argument <span class='tcode_in_codeblock'>1</span>
</span>complex b = a;                  <span class='comment'>// initialized as a copy of <span class='tcode_in_codeblock'>a</span>
</span>complex c = complex(1,2);       <span class='comment'>// initialized by calling <span class='tcode_in_codeblock'>complex(double,double)</span> with arguments <span class='tcode_in_codeblock'>1</span> and <span class='tcode_in_codeblock'>2</span>
</span>complex d = sqrt(b,c);          <span class='comment'>// initialized by calling <span class='tcode_in_codeblock'>sqrt(complex,complex)</span> with <span class='tcode_in_codeblock'>d</span> as its result object
</span>complex e;                      <span class='comment'>// initialized by calling <span class='tcode_in_codeblock'>complex()</span>
</span>complex f = 3;                  <span class='comment'>// initialized by calling <span class='tcode_in_codeblock'>complex(double)</span> with argument <span class='tcode_in_codeblock'>3</span>
</span>complex g = { 1, 2 };           <span class='comment'>// initialized by calling <span class='tcode_in_codeblock'>complex(double, double)</span> with arguments <span class='tcode_in_codeblock'>1</span> and <span class='tcode_in_codeblock'>2</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.expl.init-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.expl.init-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.expl.init-1.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':initialization,overloaded_assignment_and'></a></span><a href='over.ass'>Overloading of the assignment operator</a>
has no effect on initialization<a class='hidden_link' href='#class.expl.init-1.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.expl.init-2'><div class='marginalizedparent'><a class='marginalized' href='#class.expl.init-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1560'>#</a></div><div id='class.expl.init-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,array_of_class_objects'></a></span><span class='indexparent'><a class='index' id=':constructor,array_of_class_objects_and'></a></span>An object of class type can also be initialized by a
<i ><a href='dcl.init#nt:braced-init-list'>braced-init-list</a></i><a class='hidden_link' href='#class.expl.init-2.sentence-1'>.</a></div> <div id='class.expl.init-2.sentence-2' class='sentence'>List-initialization semantics apply;
see <a href='dcl.init'>[dcl.init]</a> and <a href='dcl.init.list'>[dcl.init.list]</a><a class='hidden_link' href='#class.expl.init-2.sentence-2'>.</a></div> <div id='class.expl.init-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.expl.init-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
complex v[6] = { 1, complex(1,2), complex(), 2 };</pre><div id='class.expl.init-2.sentence-3' class='sentence'>Here,
<span class='texttt'>complex&#x200b;::&#x200b;complex(double)</span>
is called for the initialization of
<span class='texttt'>v[0]</span>
and
<span class='texttt'>v[3]</span>,
<span class='texttt'>complex&#x200b;::&#x200b;complex(&#x200b;double, double)</span>
is called for the initialization of
<span class='texttt'>v[1]</span>,
<span class='texttt'>complex&#x200b;::&#x200b;complex()</span>
is called for the initialization
<span class='texttt'>v[2]</span>,
<span class='texttt'>v[4]</span>,
and
<span class='texttt'>v[5]</span><a class='hidden_link' href='#class.expl.init-2.sentence-3'>.</a></div> <div id='class.expl.init-2.sentence-4' class='sentence'>For another example,</div><pre class='codeblock'>
struct X {
  int i;
  float f;
  complex c;
} x = { 99, 88.8, 77.7 };</pre><div id='class.expl.init-2.sentence-5' class='sentence'>Here,
<span class='texttt'>x.i</span>
is initialized with 99,
<span class='texttt'>x.f</span>
is initialized with 88.8, and
<span class='texttt'>complex&#x200b;::&#x200b;complex(double)</span>
is called for the initialization of
<span class='texttt'>x.c</span><a class='hidden_link' href='#class.expl.init-2.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.expl.init-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.expl.init-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.expl.init-2.sentence-6' class='sentence'>Braces can be elided in the
<i ><a href='dcl.init#nt:initializer-list'>initializer-list</a></i>
for any aggregate, even if the aggregate has members of a class type with
user-defined type conversions; see <a href='dcl.init.aggr'>[dcl.init.aggr]</a><a class='hidden_link' href='#class.expl.init-2.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.expl.init-3'><div class='marginalizedparent'><a class='marginalized' href='#class.expl.init-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1612'>#</a></div><div id='class.expl.init-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.expl.init-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.expl.init-3.sentence-1' class='sentence'>If
<span class='texttt'>T</span>
is a class type with no default constructor,
any declaration of an object of type
<span class='texttt'>T</span>
(or array thereof) is ill-formed if no
<i ><a href='dcl.init#nt:initializer'>initializer</a></i>
is explicitly specified (see <a href='#class.init'>[class.init]</a> and <a href='dcl.init'>[dcl.init]</a>)<a class='hidden_link' href='#class.expl.init-3.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.expl.init-4'><div class='marginalizedparent'><a class='marginalized' href='#class.expl.init-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1624'>#</a></div><div id='class.expl.init-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.expl.init-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.expl.init-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':order_of_execution,constructor_and_static_objects'></a></span>The order in which objects with static or thread storage duration
are initialized is described in <a href='basic.start.dynamic'>[basic.start.dynamic]</a> and <a href='stmt.dcl'>[stmt.dcl]</a><a class='hidden_link' href='#class.expl.init-4.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='class.base.init' class='section'><h3 ><a class='secnum' href='#class.base.init' style='min-width:103pt'>15.6.2</a> Initializing bases and members <a class='abbr_ref' href='class.base.init'>[class.base.init]</a></h3><span class='indexparent'><a class='index' id=':initialization,base_class'></a></span><span class='indexparent'><a class='index' id=':initialization,member'></a></span><div class='para' id='class.base.init-1'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1635'>#</a></div><div id='class.base.init-1.sentence-1' class='sentence'>In the definition of a constructor for a class,
initializers for direct and virtual base class subobjects and
non-static data members can be specified by a
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>,
which has the form</div><pre class='bnf'><a class='nontermdef' href='#nt:ctor-initializer' id='nt:ctor-initializer'>ctor-initializer:</a>
&#9;<span class='terminal'>:</span> <i ><a href='class.base.init#nt:mem-initializer-list'>mem-initializer-list</a></i>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:mem-initializer-list' id='nt:mem-initializer-list'>mem-initializer-list:</a>
&#9;<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> <span class='terminal'>...</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
&#9;<i ><a href='class.base.init#nt:mem-initializer-list'>mem-initializer-list</a></i> <span class='terminal'>,</span> <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> <span class='terminal'>...</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:mem-initializer' id='nt:mem-initializer'>mem-initializer:</a>
&#9;<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i> <span class='terminal'>(</span> <i ><a href='expr.post#nt:expression-list'>expression-list</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>)</span>
&#9;<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i> <i ><a href='dcl.init#nt:braced-init-list'>braced-init-list</a></i>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:mem-initializer-id' id='nt:mem-initializer-id'>mem-initializer-id:</a>
&#9;<i ><a href='class.derived#nt:class-or-decltype'>class-or-decltype</a></i>
&#9;<i ><a href='lex.name#nt:identifier'>identifier</a></i>
</pre></div><div class='para' id='class.base.init-2'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1665'>#</a></div><div id='class.base.init-2.sentence-1' class='sentence'>In a <i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i> an initial unqualified
<i ><a href='lex.name#nt:identifier'>identifier</a></i> is looked up in the scope of the constructor's class
and, if not found in that scope, it is looked up in the scope containing the
constructor's definition<a class='hidden_link' href='#class.base.init-2.sentence-1'>.</a></div> <div id='class.base.init-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-2.sentence-3' class='sentence'>If the constructor's class contains a member with the same name as a direct
or virtual base class of the class, a
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i>
naming the member or base class and composed of a single identifier
refers to the class member<a class='hidden_link' href='#class.base.init-2.sentence-3'>.</a></div> <div id='class.base.init-2.sentence-4' class='sentence'>A
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i>
for the hidden base class may be specified using a qualified name<a class='hidden_link' href='#class.base.init-2.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.base.init-2.sentence-2' class='sentence'>
Unless the
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i>
names the constructor's class,
a non-static data member of the constructor's class, or
a direct or virtual base of that class,
the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
is ill-formed<a class='hidden_link' href='#class.base.init-2.sentence-2'>.</a></div></div><div class='para' id='class.base.init-3'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1689'>#</a></div><div id='class.base.init-3.sentence-1' class='sentence'>A
<i ><a href='class.base.init#nt:mem-initializer-list'>mem-initializer-list</a></i>
can initialize a base class using any <i ><a href='class.derived#nt:class-or-decltype'>class-or-decltype</a></i> that denotes that base class type<a class='hidden_link' href='#class.base.init-3.sentence-1'>.</a></div> <div id='class.base.init-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A { A(); };
typedef A global_A;
struct B { };
struct C: public A, public B { C(); };
C::C(): global_A() { }          <span class='comment'>// mem-initializer for base <span class='tcode_in_codeblock'>A</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-4'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1704'>#</a></div><div id='class.base.init-4.sentence-1' class='sentence'>If a
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i>
is ambiguous because it designates both a direct non-virtual base class and
an inherited virtual base class, the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
is ill-formed<a class='hidden_link' href='#class.base.init-4.sentence-1'>.</a></div> <div id='class.base.init-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A { A(); };
struct B: public virtual A { };
struct C: public A, public B { C(); };
C::C(): A() { }                 <span class='comment'>// ill-formed: which <span class='tcode_in_codeblock'>A</span>?
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-5'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1721'>#</a></div><div id='class.base.init-5.sentence-1' class='sentence'>A
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>
may initialize a variant member of the
constructor's class<a class='hidden_link' href='#class.base.init-5.sentence-1'>.</a></div> <div id='class.base.init-5.sentence-2' class='sentence'>If a
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>
specifies more than one
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
for the same member or for the same base class,
the
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>
is ill-formed<a class='hidden_link' href='#class.base.init-5.sentence-2'>.</a></div></div><div class='para' id='class.base.init-6'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1735'>#</a></div><div id='class.base.init-6.sentence-1' class='sentence'>A <i ><a href='class.base.init#nt:mem-initializer-list'>mem-initializer-list</a></i> can delegate to another
constructor of the constructor's class using any
<i ><a href='class.derived#nt:class-or-decltype'>class-or-decltype</a></i> that denotes the constructor's class itself<a class='hidden_link' href='#class.base.init-6.sentence-1'>.</a></div> <div id='class.base.init-6.sentence-2' class='sentence'>If a
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i> designates the constructor's class,
it shall be the only <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>; the constructor
is a <a class='hidden_link' href='#def:delegating_constructor' id='def:delegating_constructor'><i>delegating constructor</i></a>, and the constructor selected by the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> is the <a class='hidden_link' href='#def:target_constructor' id='def:target_constructor'><i>target constructor</i></a><a class='hidden_link' href='#class.base.init-6.sentence-2'>.</a></div> <div id='class.base.init-6.sentence-3' class='sentence'>The target constructor is selected by overload resolution<a class='hidden_link' href='#class.base.init-6.sentence-3'>.</a></div> <div id='class.base.init-6.sentence-4' class='sentence'>Once the target constructor returns, the body of the delegating constructor
is executed<a class='hidden_link' href='#class.base.init-6.sentence-4'>.</a></div> <div id='class.base.init-6.sentence-5' class='sentence'>If a constructor delegates to itself directly or indirectly,
the program is ill-formed, no diagnostic required<a class='hidden_link' href='#class.base.init-6.sentence-5'>.</a></div> <div id='class.base.init-6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct C {
  C( int ) { }                  <span class='comment'>// #1: non-delegating constructor
</span>  C(): C(42) { }                <span class='comment'>// #2: delegates to #1
</span>  C( char c ) : C(42.0) { }     <span class='comment'>// #3: ill-formed due to recursion with #4
</span>  C( double d ) : C('a') { }    <span class='comment'>// #4: ill-formed due to recursion with #3
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-7'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1758'>#</a></div><div id='class.base.init-7.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,base_class_'></a></span><span class='indexparent'><a class='index' id=':initialization,member_object'></a></span>The
<i ><a href='expr.post#nt:expression-list'>expression-list</a></i>
or <i ><a href='dcl.init#nt:braced-init-list'>braced-init-list</a></i>
in a
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
is used to initialize the
designated subobject (or, in the case of a delegating constructor, the complete class object)
according to the initialization rules of <a href='dcl.init'>[dcl.init]</a> for direct-initialization<a class='hidden_link' href='#class.base.init-7.sentence-1'>.</a></div> <div id='class.base.init-7.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct B1 { B1(int); <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
struct B2 { B2(int); <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
struct D : B1, B2 {
  D(int);
  B1 b;
  const int c;
};

D::D(int a) : B2(a+1), B1(a+2), c(a+3), b(a+4) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }
D d(10);</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.base.init-7.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-7.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-7.sentence-3' class='sentence'><span class='setlength'></span><span class='emergencystretch'></span>1em
The initialization
performed by each <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
constitutes a <a href='intro.execution#def:full-expression'>full-expression</a><a class='hidden_link' href='#class.base.init-7.sentence-3'>.</a></div> <div id='class.base.init-7.sentence-4' class='sentence'>Any expression in
a
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
is evaluated as part of the full-expression that performs the initialization<a class='hidden_link' href='#class.base.init-7.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.base.init-7.sentence-2' class='sentence'>
A <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> where the <i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i> denotes
a virtual base class is ignored during execution of a constructor of any class that is
not the most derived class<a class='hidden_link' href='#class.base.init-7.sentence-2'>.</a></div></div><div class='para' id='class.base.init-8'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1797'>#</a></div><div id='class.base.init-8.sentence-1' class='sentence'>A temporary expression bound to a reference member in a <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
is ill-formed<a class='hidden_link' href='#class.base.init-8.sentence-1'>.</a></div> <div id='class.base.init-8.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  A() : v(42) { }   <span class='comment'>// error
</span>  const int&amp; v;
};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-9'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1809'>#</a></div><div id='class.base.init-9.sentence-1' class='sentence'>In a non-delegating constructor, if
a given potentially constructed subobject is not designated by a
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i>
(including the case where there is no
<i ><a href='class.base.init#nt:mem-initializer-list'>mem-initializer-list</a></i>
because the constructor has no
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>),
then
<ul class='itemize'><li id='class.base.init-9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-9.1'>(9.1)</a></div><div id='class.base.init-9.1.sentence-1' class='sentence'>if the entity is a non-static data member that has
a <a href='class.mem#def:default_member_initializer'>default member initializer</a> and either</div><div id='class.base.init-9.1.sentence-2' class='sentence'><ul class='itemize'><li id='class.base.init-9.1.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#class.base.init-9.1.1'>(9.1.1)</a></div><div id='class.base.init-9.1.1.sentence-1' class='sentence'>the constructor's class is a <a href='class.union'>union</a>, and no other variant
member of that union is designated by a <i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i> or</div></li><li id='class.base.init-9.1.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#class.base.init-9.1.2'>(9.1.2)</a></div><div id='class.base.init-9.1.2.sentence-1' class='sentence'>the constructor's class is not a union, and, if the entity is a member of an
anonymous union, no other member of that union is designated by a
<i ><a href='class.base.init#nt:mem-initializer-id'>mem-initializer-id</a></i>,</div></li></ul>
the entity is initialized from its default member initializer
as specified in <a href='dcl.init'>[dcl.init]</a>;</div></li><li id='class.base.init-9.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-9.2'>(9.2)</a></div><div id='class.base.init-9.2.sentence-1' class='sentence'>otherwise, if the entity is an anonymous union or a variant member (<a href='class.union.anon'>[class.union.anon]</a>), no initialization is performed;</div></li><li id='class.base.init-9.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-9.3'>(9.3)</a></div><div id='class.base.init-9.3.sentence-1' class='sentence'>otherwise, the entity is <a href='dcl.init#def:default-initialization'>default-initialized</a><a class='hidden_link' href='#class.base.init-9.3.sentence-1'>.</a></div></li></ul></div><div id='class.base.init-9.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-9.sentence-3' class='sentence'>An <a href='class.abstract'>abstract class</a> is never a most derived class, thus its constructors never initialize virtual base classes, therefore the
corresponding <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i><span class='textit'>s</span> may be omitted<a class='hidden_link' href='#class.base.init-9.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.base.init-9.sentence-2' class='sentence'>
An attempt to initialize more than one non-static data member of a union renders the
program ill-formed<a class='hidden_link' href='#class.base.init-9.sentence-2'>.</a></div> <span class='indexparent'><a class='index' id=':initialization,const_member'></a></span><span class='indexparent'><a class='index' id=':initialization,reference_member'></a></span><div id='class.base.init-9.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-9.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-9.sentence-4' class='sentence'>After the call to a constructor for class
<span class='texttt'>X</span>
for an object with automatic or dynamic storage duration
has completed, if
the constructor was not invoked as part of value-initialization and
a member of
<span class='texttt'>X</span>
is neither initialized nor
given a value
during execution of the <i ><a href='stmt.block#nt:compound-statement'>compound-statement</a></i> of the body of the constructor,
the member has an indeterminate value<a class='hidden_link' href='#class.base.init-9.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> 
<div id='class.base.init-9.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  A();
};

struct B {
  B(int);
};

struct C {
  C() { }               <span class='comment'>// initializes members as follows:
</span>  A a;                  <span class='comment'>// OK: calls <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;A()</span>
</span>  const B b;            <span class='comment'>// error: <span class='tcode_in_codeblock'>B</span> has no default constructor
</span>  int i;                <span class='comment'>// OK: <span class='tcode_in_codeblock'>i</span> has indeterminate value
</span>  int j = 5;            <span class='comment'>// OK: <span class='tcode_in_codeblock'>j</span> has the value <span class='tcode_in_codeblock'>5</span>
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-10'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1878'>#</a></div><div id='class.base.init-10.sentence-1' class='sentence'>If a given non-static data member has both a default member initializer
and a <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>, the initialization specified by the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> is performed, and the non-static data member's
default member initializer is ignored<a class='hidden_link' href='#class.base.init-10.sentence-1'>.</a></div> <div id='class.base.init-10.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-10.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.base.init-10.sentence-2' class='sentence'>Given
<pre class='codeblock'>
struct A {
  int i = /* some integer expression with side effects */ ;
  A(int arg) : i(arg) { }
  <span class='comment'>// ...
</span>};</pre>
the <span class='texttt'>A(int)</span> constructor will simply initialize <span class='texttt'>i</span> to the value of
<span class='texttt'>arg</span>, and the
<span class='indexparent'><a class='index' id=':side_effects_'></a></span>side effects in <span class='texttt'>i</span>'s default member initializer
will not take place<a class='hidden_link' href='#class.base.init-10.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-11'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1901'>#</a></div><div id='class.base.init-11.sentence-1' class='sentence'>A temporary expression bound to a reference member from a
default member initializer is ill-formed<a class='hidden_link' href='#class.base.init-11.sentence-1'>.</a></div> <div id='class.base.init-11.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A {
  A() = default;        <span class='comment'>// OK
</span>  A(int v) : v(v) { }   <span class='comment'>// OK
</span>  const int&amp; v = 42;    <span class='comment'>// OK
</span>};
A a1;                   <span class='comment'>// error: ill-formed binding of temporary to reference
</span>A a2(1);                <span class='comment'>// OK, unfortunately
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-12'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1916'>#</a></div><div id='class.base.init-12.sentence-1' class='sentence'>In a non-delegating constructor, the destructor for each potentially constructed
subobject of class type is <a href='#def:potentially_invoked'>potentially invoked</a><a class='hidden_link' href='#class.base.init-12.sentence-1'>.</a></div> <div id='class.base.init-12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-12.sentence-2' class='sentence'>This provision ensures that destructors can be called for fully-constructed
subobjects in case an exception is thrown (<a href='except.ctor'>[except.ctor]</a>)<a class='hidden_link' href='#class.base.init-12.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-13'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1922'>#</a></div><div id='class.base.init-13.sentence-1' class='sentence'>In a non-delegating constructor, initialization
proceeds in the following order:
<ul class='itemize'><li id='class.base.init-13.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-13.1'>(13.1)</a></div><div id='class.base.init-13.1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,order_of_virtual_base_class'></a></span>First, and only for the constructor of the <a href='intro.object#def:most_derived_class'>most derived class</a>,
virtual base classes are initialized in the order they appear on a
depth-first left-to-right traversal of the directed acyclic graph of
base classes,
where “left-to-right” is the order of appearance of the base classes
in the derived class
<i ><a href='class.derived#nt:base-specifier-list'>base-specifier-list</a></i><a class='hidden_link' href='#class.base.init-13.1.sentence-1'>.</a></div></li><li id='class.base.init-13.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-13.2'>(13.2)</a></div><div id='class.base.init-13.2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,order_of_base_class'></a></span>Then, direct base classes are initialized in declaration order
as they appear in the
<i ><a href='class.derived#nt:base-specifier-list'>base-specifier-list</a></i>
(regardless of the order of the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i><span class='textit'>s</span>)<a class='hidden_link' href='#class.base.init-13.2.sentence-1'>.</a></div></li><li id='class.base.init-13.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-13.3'>(13.3)</a></div><div id='class.base.init-13.3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,order_of_member'></a></span>Then, non-static data members are initialized in the order
they were declared in the class definition
(again regardless of the order of the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i><span class='textit'>s</span>)<a class='hidden_link' href='#class.base.init-13.3.sentence-1'>.</a></div></li><li id='class.base.init-13.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.base.init-13.4'>(13.4)</a></div><div id='class.base.init-13.4.sentence-1' class='sentence'>Finally, the <i ><a href='stmt.block#nt:compound-statement'>compound-statement</a></i> of the constructor
body  is executed<a class='hidden_link' href='#class.base.init-13.4.sentence-1'>.</a></div></li></ul></div><div id='class.base.init-13.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-13.sentence-2' class='sentence'>The declaration order is mandated to ensure that base and member
subobjects are destroyed in the reverse order of initialization<a class='hidden_link' href='#class.base.init-13.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-14'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1958'>#</a></div><div id='class.base.init-14.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct V {
  V();
  V(int);
};

struct A : virtual V {
  A();
  A(int);
};

struct B : virtual V {
  B();
  B(int);
};

struct C : A, B, virtual V {
  C();
  C(int);
};

A::A(int i) : V(i) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }
B::B(int i) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }
C::C(int i) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }

V v(1);             <span class='comment'>// use <span class='tcode_in_codeblock'>V(int)</span>
</span>A a(2);             <span class='comment'>// use <span class='tcode_in_codeblock'>V(int)</span>
</span>B b(3);             <span class='comment'>// use <span class='tcode_in_codeblock'>V()</span>
</span>C c(4);             <span class='comment'>// use <span class='tcode_in_codeblock'>V()</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-15'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L1992'>#</a></div><div id='class.base.init-15.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initializer,scope_of_member'></a></span>Names in the
<i ><a href='expr.post#nt:expression-list'>expression-list</a></i>
or <i ><a href='dcl.init#nt:braced-init-list'>braced-init-list</a></i>
of a
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
are evaluated in the scope of the constructor for which the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
is specified<a class='hidden_link' href='#class.base.init-15.sentence-1'>.</a></div> <div id='class.base.init-15.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-15.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class X {
  int a;
  int b;
  int i;
  int j;
public:
  const int&amp; r;
  X(int i): r(a), b(i), i(i), j(this-&gt;i) { }
};</pre><div id='class.base.init-15.sentence-2' class='sentence'>initializes
<span class='texttt'>X&#x200b;::&#x200b;r</span>
to refer to
<span class='texttt'>X&#x200b;::&#x200b;a</span>,
initializes
<span class='texttt'>X&#x200b;::&#x200b;b</span>
with the value of the constructor parameter
<span class='texttt'>i</span>,
initializes
<span class='texttt'>X&#x200b;::&#x200b;i</span>
with the value of the constructor parameter
<span class='texttt'>i</span>,
and initializes
<span class='texttt'>X&#x200b;::&#x200b;j</span>
with the value of
<span class='texttt'>X&#x200b;::&#x200b;i</span>;
this takes place each time an object of class
<span class='texttt'>X</span>
is created<a class='hidden_link' href='#class.base.init-15.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.base.init-15.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-15.sentence-3' class='sentence'>Because the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
are evaluated in the scope of the constructor, the
<span class='texttt'>this</span>
pointer can be used in the
<i ><a href='expr.post#nt:expression-list'>expression-list</a></i>
of a
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i>
to refer to the object being initialized<a class='hidden_link' href='#class.base.init-15.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-16'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2048'>#</a></div><div id='class.base.init-16.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,member_function_call_during'></a></span>Member functions (including <a href='class.virtual'>virtual member functions</a>) can be
called for an object under construction<a class='hidden_link' href='#class.base.init-16.sentence-1'>.</a></div> <div id='class.base.init-16.sentence-2' class='sentence'>Similarly, an object under construction can be the operand of the
<a href='expr.typeid'><span class='texttt'>typeid</span> operator</a> or of a
<a href='expr.dynamic.cast'><span class='texttt'>dynamic_&shy;cast</span></a><a class='hidden_link' href='#class.base.init-16.sentence-2'>.</a></div> <div id='class.base.init-16.sentence-3' class='sentence'>However, if these operations are performed in a
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>
(or in a function called directly or indirectly from a
<i ><a href='class.base.init#nt:ctor-initializer'>ctor-initializer</a></i>)
before all the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i><span class='textit'>s</span>
for base classes have completed, the program has undefined behavior<a class='hidden_link' href='#class.base.init-16.sentence-3'>.</a></div> <div id='class.base.init-16.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-16.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class A {
public:
  A(int);
};

class B : public A {
  int j;
public:
  int f();
  B() : A(f()),     <span class='comment'>// undefined: calls member function but base <span class='tcode_in_codeblock'>A</span> not yet initialized
</span>  j(f()) { }        <span class='comment'>// well-defined: bases are all initialized
</span>};

class C {
public:
  C(int);
};

class D : public B, C {
  int i;
public:
  D() : C(f()),     <span class='comment'>// undefined: calls member function but base <span class='tcode_in_codeblock'>C</span> not yet initialized
</span>  i(f()) { }        <span class='comment'>// well-defined: bases are all initialized
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-17'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2091'>#</a></div><div id='class.base.init-17.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.base.init-17.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.base.init-17.sentence-1' class='sentence'><a href='#class.cdtor'>[class.cdtor]</a> describes the result of virtual function calls,
<span class='texttt'>typeid</span>
and
<span class='texttt'>dynamic_&shy;cast</span>s
during construction for the well-defined cases;
that is, describes the
<a class='hidden_link' href='#def:polymorphic_behavior' id='def:polymorphic_behavior'><i>polymorphic behavior</i></a>
of an object under construction<a class='hidden_link' href='#class.base.init-17.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.base.init-18'><div class='marginalizedparent'><a class='marginalized' href='#class.base.init-18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2103'>#</a></div><div id='class.base.init-18.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initializer,pack_expansion'></a></span>A <i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> followed by an ellipsis is
a <a href='temp.variadic#def:pack_expansion'>pack expansion</a> that initializes the base
classes specified by a pack expansion in the <i ><a href='class.derived#nt:base-specifier-list'>base-specifier-list</a></i>
for the class<a class='hidden_link' href='#class.base.init-18.sentence-1'>.</a></div> <div id='class.base.init-18.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.base.init-18.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class... Mixins&gt;
class X : public Mixins... {
public:
  X(const Mixins&amp;... mixins) : Mixins(mixins)... { }
};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='class.inhctor.init' class='section'><h3 ><a class='secnum' href='#class.inhctor.init' style='min-width:103pt'>15.6.3</a> Initialization by inherited constructor <a class='abbr_ref' href='class.inhctor.init'>[class.inhctor.init]</a></h3><span class='indexparent'><a class='index' id=':initialization,by_inherited_constructor'></a></span><div class='para' id='class.inhctor.init-1'><div class='marginalizedparent'><a class='marginalized' href='#class.inhctor.init-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2123'>#</a></div><div id='class.inhctor.init-1.sentence-1' class='sentence'>When a constructor for type <span class='texttt'>B</span> is invoked
to initialize an object of a different type <span class='texttt'>D</span>
(that is, when the constructor was <a href='namespace.udecl#def:inherits'>inherited</a>),
initialization proceeds as if a defaulted default constructor
were used to initialize the <span class='texttt'>D</span> object and
each base class subobject from which the constructor was inherited,
except that the <span class='texttt'>B</span> subobject is initialized
by the invocation of the inherited constructor<a class='hidden_link' href='#class.inhctor.init-1.sentence-1'>.</a></div> <div id='class.inhctor.init-1.sentence-2' class='sentence'>The complete initialization is considered to be a single function call;
in particular, the initialization of the inherited constructor's parameters
is sequenced before the initialization of any part of the <span class='texttt'>D</span> object<a class='hidden_link' href='#class.inhctor.init-1.sentence-2'>.</a></div> <div id='class.inhctor.init-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.inhctor.init-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct B1 {
  B1(int, ...) { }
};

struct B2 {
  B2(double) { }
};

int get();

struct D1 : B1 {
  using B1::B1;     <span class='comment'>// inherits <span class='tcode_in_codeblock'>B1(int, ...)</span>
</span>  int x;
  int y = get();
};

void test() {
  D1 d(2, 3, 4);    <span class='comment'>// OK: <span class='tcode_in_codeblock'>B1</span> is initialized by calling <span class='tcode_in_codeblock'>B1(2, 3, 4)</span>,
</span>                    <span class='comment'>// then <span class='tcode_in_codeblock'>d.x</span> is default-initialized (no initialization is performed),
</span>                    <span class='comment'>// then <span class='tcode_in_codeblock'>d.y</span> is initialized by calling <span class='tcode_in_codeblock'>get()</span>
</span>  D1 e;             <span class='comment'>// error: <span class='tcode_in_codeblock'>D1</span> has a deleted default constructor
</span>}

struct D2 : B2 {
  using B2::B2;
  B1 b;
};

D2 f(1.0);          <span class='comment'>// error: <span class='tcode_in_codeblock'>B1</span> has a deleted default constructor
</span>
struct W { W(int); };
struct X : virtual W { using W::W; X() = delete; };
struct Y : X { using X::X; };
struct Z : Y, virtual W { using Y::Y; };
Z z(0);             <span class='comment'>// OK: initialization of <span class='tcode_in_codeblock'>Y</span> does not invoke default constructor of <span class='tcode_in_codeblock'>X</span>
</span>
template&lt;class T&gt; struct Log : T {
  using T::T;       <span class='comment'>// inherits all constructors from class <span class='tcode_in_codeblock'>T</span>
</span>  ~Log() { std::clog &lt;&lt; "Destroying wrapper" &lt;&lt; std::endl; }
};</pre> <div id='class.inhctor.init-1.sentence-3' class='sentence'>
Class template <span class='texttt'>Log</span> wraps any class and forwards all of its constructors,
while writing a message to the standard log
whenever an object of class <span class='texttt'>Log</span> is destroyed<a class='hidden_link' href='#class.inhctor.init-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.inhctor.init-2'><div class='marginalizedparent'><a class='marginalized' href='#class.inhctor.init-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2183'>#</a></div><div id='class.inhctor.init-2.sentence-1' class='sentence'>If the constructor was inherited from multiple base class subobjects
of type <span class='texttt'>B</span>, the program is ill-formed<a class='hidden_link' href='#class.inhctor.init-2.sentence-1'>.</a></div> <div id='class.inhctor.init-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.inhctor.init-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A { A(int); };
struct B : A { using A::A; };

struct C1 : B { using B::B; };
struct C2 : B { using B::B; };

struct D1 : C1, C2 {
  using C1::C1;
  using C2::C2;
};

struct V1 : virtual B { using B::B; };
struct V2 : virtual B { using B::B; };

struct D2 : V1, V2 {
  using V1::V1;
  using V2::V2;
};

D1 d1(0);       <span class='comment'>// ill-formed: ambiguous
</span>D2 d2(0);       <span class='comment'>// OK: initializes virtual <span class='tcode_in_codeblock'>B</span> base class, which initializes the <span class='tcode_in_codeblock'>A</span> base class
</span>                <span class='comment'>// then initializes the <span class='tcode_in_codeblock'>V1</span> and <span class='tcode_in_codeblock'>V2</span> base classes as if by a defaulted default constructor
</span>
struct M { M(); M(int); };
struct N : M { using M::M; };
struct O : M {};
struct P : N, O { using N::N; using O::O; };
P p(0);             <span class='comment'>// OK: use <span class='tcode_in_codeblock'>M(0)</span> to initialize <span class='tcode_in_codeblock'>N</span>'s base class,
</span>                    <span class='comment'>// use <span class='tcode_in_codeblock'>M()</span> to initialize <span class='tcode_in_codeblock'>O</span>'s base class
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.inhctor.init-3'><div class='marginalizedparent'><a class='marginalized' href='#class.inhctor.init-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2220'>#</a></div><div id='class.inhctor.init-3.sentence-1' class='sentence'>When an object is initialized by an inherited constructor,
initialization of the object is complete
when the initialization of all subobjects is complete<a class='hidden_link' href='#class.inhctor.init-3.sentence-1'>.</a></div> </div></div></div><div id='class.cdtor' class='section'><h2 ><a class='secnum' href='#class.cdtor' style='min-width:88pt'>15.7</a> Construction and destruction <a class='abbr_ref' href='class.cdtor'>[class.cdtor]</a></h2><span class='indexparent'><a class='index' id=':construction'></a></span><span class='indexparent'><a class='index' id=':destruction'></a></span><div class='para' id='class.cdtor-1'><div class='marginalizedparent'><a class='marginalized' href='#class.cdtor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2230'>#</a></div><div id='class.cdtor-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':construction,member_access'></a></span><span class='indexparent'><a class='index' id=':destruction,member_access'></a></span>For an object with a non-trivial constructor, referring to any non-static member
or base class of the object before the constructor begins execution results in
undefined behavior<a class='hidden_link' href='#class.cdtor-1.sentence-1'>.</a></div> <div id='class.cdtor-1.sentence-2' class='sentence'>For an object with a non-trivial destructor, referring to
any non-static member or base class of the object after the destructor finishes
execution results in undefined behavior<a class='hidden_link' href='#class.cdtor-1.sentence-2'>.</a></div> <div id='class.cdtor-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.cdtor-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X { int i; };
struct Y : X { Y(); };                  <span class='comment'>// non-trivial
</span>struct A { int a; };
struct B : public A { int j; Y y; };    <span class='comment'>// non-trivial
</span>
extern B bobj;
B* pb = &amp;bobj;                          <span class='comment'>// OK
</span>int* p1 = &amp;bobj.a;                      <span class='comment'>// undefined, refers to base class member
</span>int* p2 = &amp;bobj.y.i;                    <span class='comment'>// undefined, refers to member's member
</span>
A* pa = &amp;bobj;                          <span class='comment'>// undefined, upcast to a base class type
</span>B bobj;                                 <span class='comment'>// definition of <span class='tcode_in_codeblock'>bobj</span>
</span>
extern X xobj;
int* p3 = &amp;xobj.i;                      <span class='comment'>// OK, <span class='tcode_in_codeblock'>X</span> is a trivial class
</span>X xobj;</pre> <div id='class.cdtor-1.sentence-3' class='sentence'>
For another example,
<pre class='codeblock'>
struct W { int j; };
struct X : public virtual W { };
struct Y {
  int* p;
  X x;
  Y() : p(&amp;x.j) {   <span class='comment'>// undefined, <span class='tcode_in_codeblock'>x</span> is not yet constructed
</span>    }
};</pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.cdtor-2'><div class='marginalizedparent'><a class='marginalized' href='#class.cdtor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2270'>#</a></div><div id='class.cdtor-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':construction,pointer_to_member_or_base'></a></span><span class='indexparent'><a class='index' id=':destruction,pointer_to_member_or_base'></a></span>To explicitly or implicitly convert a pointer (a glvalue) referring to
an object of class
<span class='texttt'>X</span>
to a pointer (reference) to a direct or indirect base class
<span class='texttt'>B</span>
of
<span class='texttt'>X</span>,
the construction of
<span class='texttt'>X</span>
and the construction of all of its direct or indirect bases that directly or
indirectly derive from
<span class='texttt'>B</span>
shall have started and the destruction of these classes shall not have
completed, otherwise the conversion results in undefined behavior<a class='hidden_link' href='#class.cdtor-2.sentence-1'>.</a></div> <div id='class.cdtor-2.sentence-2' class='sentence'>To form a pointer to (or access the value of) a direct non-static member of
an object
<span class='texttt'>obj</span>,
the construction of
<span class='texttt'>obj</span>
shall have started and its destruction shall not have completed,
otherwise the computation of the pointer value (or accessing the member
value) results in undefined behavior<a class='hidden_link' href='#class.cdtor-2.sentence-2'>.</a></div> <div id='class.cdtor-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.cdtor-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct A { };
struct B : virtual A { };
struct C : B { };
struct D : virtual A { D(A*); };
struct X { X(A*); };

struct E : C, D, X {
  E() : D(this),    <span class='comment'>// undefined: upcast from <span class='tcode_in_codeblock'>E*</span> to <span class='tcode_in_codeblock'>A*</span> might use path <span class='tcode_in_codeblock'>E*</span> <span class='math'>→</span> <span class='tcode_in_codeblock'>D*</span> <span class='math'>→</span> <span class='tcode_in_codeblock'>A*</span>
</span>                    <span class='comment'>// but <span class='tcode_in_codeblock'>D</span> is not constructed
</span>
                    <span class='comment'>// “<span class='tcode_in_codeblock'>D((C*)this)</span>” would be defined: <span class='tcode_in_codeblock'>E*</span> <span class='math'>→</span> <span class='tcode_in_codeblock'>C*</span> is defined because <span class='tcode_in_codeblock'>E()</span> has started,
</span>                    <span class='comment'>// and <span class='tcode_in_codeblock'>C*</span> <span class='math'>→</span> <span class='tcode_in_codeblock'>A*</span> is defined because <span class='tcode_in_codeblock'>C</span> is fully constructed
</span>
  X(this) {}        <span class='comment'>// defined: upon construction of <span class='tcode_in_codeblock'>X</span>, <span class='tcode_in_codeblock'>C/B/D/A</span> sublattice is fully constructed
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.cdtor-3'><div class='marginalizedparent'><a class='marginalized' href='#class.cdtor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2315'>#</a></div><div id='class.cdtor-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':virtual_function_call,constructor_and'></a></span><span class='indexparent'><a class='index' id=':virtual_function_call,destructor_and'></a></span><span class='indexparent'><a class='index' id=':construction,virtual_function_call'></a></span><span class='indexparent'><a class='index' id=':destruction,virtual_function_call'></a></span>Member functions, including <a href='class.virtual'>virtual functions</a>, can be called
during construction or destruction (<a href='#class.base.init'>[class.base.init]</a>)<a class='hidden_link' href='#class.cdtor-3.sentence-1'>.</a></div> <div id='class.cdtor-3.sentence-2' class='sentence'>When a virtual function is called directly or indirectly from a constructor
or from a destructor,
including during the construction or destruction of the class's non-static data
members,
and the object to which the call applies is the object (call it <span class='texttt'>x</span>) under construction or
destruction,
the function called is the
final overrider in the constructor's or destructor's class and not one
overriding it in a more-derived class<a class='hidden_link' href='#class.cdtor-3.sentence-2'>.</a></div> <div id='class.cdtor-3.sentence-3' class='sentence'>If the virtual function call uses an explicit <a href='expr.ref'>class member access</a>
and the object expression refers to
the complete object of <span class='texttt'>x</span> or one of that object's base class subobjects
but not <span class='texttt'>x</span> or one of its base class subobjects, the behavior
is undefined<a class='hidden_link' href='#class.cdtor-3.sentence-3'>.</a></div> <div id='class.cdtor-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.cdtor-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct V {
  virtual void f();
  virtual void g();
};

struct A : virtual V {
  virtual void f();
};

struct B : virtual V {
  virtual void g();
  B(V*, A*);
};

struct D : A, B {
  virtual void f();
  virtual void g();
  D() : B((A*)this, this) { }
};

B::B(V* v, A* a) {
  f();              <span class='comment'>// calls <span class='tcode_in_codeblock'>V&#x200b;::&#x200b;f</span>, not <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;f</span>
</span>  g();              <span class='comment'>// calls <span class='tcode_in_codeblock'>B&#x200b;::&#x200b;g</span>, not <span class='tcode_in_codeblock'>D&#x200b;::&#x200b;g</span>
</span>  v-&gt;g();           <span class='comment'>// <span class='tcode_in_codeblock'>v</span> is base of <span class='tcode_in_codeblock'>B</span>, the call is well-defined, calls <span class='tcode_in_codeblock'>B&#x200b;::&#x200b;g</span>
</span>  a-&gt;f();           <span class='comment'>// undefined behavior, <span class='tcode_in_codeblock'>a</span>'s type not a base of <span class='tcode_in_codeblock'>B</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.cdtor-4'><div class='marginalizedparent'><a class='marginalized' href='#class.cdtor-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2368'>#</a></div><div id='class.cdtor-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':construction,typeid_operator'></a></span><span class='indexparent'><a class='index' id=':destruction,typeid_operator'></a></span><span class='indexparent'><a class='index' id=':typeid,construction_and'></a></span><span class='indexparent'><a class='index' id=':typeid,destruction_and'></a></span>The
<a href='expr.typeid'><span class='texttt'>typeid</span>
operator</a> can be used during construction or destruction (<a href='#class.base.init'>[class.base.init]</a>)<a class='hidden_link' href='#class.cdtor-4.sentence-1'>.</a></div> <div id='class.cdtor-4.sentence-2' class='sentence'>When
<span class='texttt'>typeid</span>
is used in a constructor (including the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> or <a href='class.mem#def:default_member_initializer'>default member initializer</a>
for a non-static data member)
or in a destructor, or used in a function called (directly or indirectly) from
a constructor or destructor, if the operand of
<span class='texttt'>typeid</span>
refers to the object under construction or destruction,
<span class='texttt'>typeid</span>
yields the
<span class='texttt'>std&#x200b;::&#x200b;type_&shy;info</span>
object representing the constructor or destructor's class<a class='hidden_link' href='#class.cdtor-4.sentence-2'>.</a></div> <div id='class.cdtor-4.sentence-3' class='sentence'>If the operand of
<span class='texttt'>typeid</span>
refers to the object under construction or destruction and the static type of
the operand is neither the constructor or destructor's class nor one of its
bases, the behavior is undefined<a class='hidden_link' href='#class.cdtor-4.sentence-3'>.</a></div></div><div class='para' id='class.cdtor-5'><div class='marginalizedparent'><a class='marginalized' href='#class.cdtor-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2395'>#</a></div><div id='class.cdtor-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':construction,dynamic_cast_and'></a></span><span class='indexparent'><a class='index' id=':destruction,dynamic_cast_and'></a></span><span class='indexparent'><a class='index' id=':cast,dynamic,construction_and'></a></span><span class='indexparent'><a class='index' id=':cast,dynamic,destruction_and'></a></span><a href='expr.dynamic.cast'><span class='texttt'>dynamic_&shy;cast</span>s</a> can be used during construction
or destruction (<a href='#class.base.init'>[class.base.init]</a>)<a class='hidden_link' href='#class.cdtor-5.sentence-1'>.</a></div> <div id='class.cdtor-5.sentence-2' class='sentence'>When a
<span class='texttt'>dynamic_&shy;cast</span>
is used in a constructor (including the
<i ><a href='class.base.init#nt:mem-initializer'>mem-initializer</a></i> or default member initializer
for a non-static data member)
or in a destructor, or used in a function called (directly or indirectly) from
a constructor or destructor, if the operand of the
<span class='texttt'>dynamic_&shy;cast</span>
refers to the object under construction or destruction, this object is
considered to be a most derived object that has the type of the constructor or
destructor's class<a class='hidden_link' href='#class.cdtor-5.sentence-2'>.</a></div> <div id='class.cdtor-5.sentence-3' class='sentence'>If the operand of the
<span class='texttt'>dynamic_&shy;cast</span>
refers to the object under construction or destruction and the static type of
the operand is not a pointer to or object of the constructor or destructor's
own class or one of its bases, the
<span class='texttt'>dynamic_&shy;cast</span>
results in undefined behavior<a class='hidden_link' href='#class.cdtor-5.sentence-3'>.</a></div> <div id='class.cdtor-5.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.cdtor-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct V {
  virtual void f();
};

struct A : virtual V { };

struct B : virtual V {
  B(V*, A*);
};

struct D : A, B {
  D() : B((A*)this, this) { }
};

B::B(V* v, A* a) {
  typeid(*this);        <span class='comment'>// <span class='tcode_in_codeblock'>type_&shy;info</span> for <span class='tcode_in_codeblock'>B</span>
</span>  typeid(*v);           <span class='comment'>// well-defined: <span class='tcode_in_codeblock'>*v</span> has type <span class='tcode_in_codeblock'>V</span>, a base of <span class='tcode_in_codeblock'>B</span> yields <span class='tcode_in_codeblock'>type_&shy;info</span> for <span class='tcode_in_codeblock'>B</span>
</span>  typeid(*a);           <span class='comment'>// undefined behavior: type <span class='tcode_in_codeblock'>A</span> not a base of <span class='tcode_in_codeblock'>B</span>
</span>  dynamic_cast&lt;B*&gt;(v);  <span class='comment'>// well-defined: <span class='tcode_in_codeblock'>v</span> of type <span class='tcode_in_codeblock'>V*</span>, <span class='tcode_in_codeblock'>V</span> base of <span class='tcode_in_codeblock'>B</span> results in <span class='tcode_in_codeblock'>B*</span>
</span>  dynamic_cast&lt;B*&gt;(a);  <span class='comment'>// undefined behavior, <span class='tcode_in_codeblock'>a</span> has type <span class='tcode_in_codeblock'>A*</span>, <span class='tcode_in_codeblock'>A</span> not a base of <span class='tcode_in_codeblock'>B</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  </div></div><div id='class.copy' class='section'><h2 ><a class='secnum' href='#class.copy' style='min-width:88pt'>15.8</a> Copying and moving class objects <a class='abbr_ref' href='class.copy'>[class.copy]</a></h2><div class='para' id='class.copy-1'><div class='marginalizedparent'><a class='marginalized' href='#class.copy-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2449'>#</a></div><div id='class.copy-1.sentence-1' class='sentence'>A class object can be copied or moved in two ways:
by initialization (<a href='#class.ctor'>[class.ctor]</a>, <a href='dcl.init'>[dcl.init]</a>), including for function argument passing (<a href='expr.call'>[expr.call]</a>) and for <a href='stmt.return'>function value return</a>;
and by <a href='expr.ass'>assignment</a><a class='hidden_link' href='#class.copy-1.sentence-1'>.</a></div> <div id='class.copy-1.sentence-2' class='sentence'>Conceptually, these two operations are implemented by a
copy/move constructor (<a href='#class.ctor'>[class.ctor]</a>)
and copy/move assignment operator (<a href='over.ass'>[over.ass]</a>)<a class='hidden_link' href='#class.copy-1.sentence-2'>.</a></div></div><div class='para' id='class.copy-2'><div class='marginalizedparent'><a class='marginalized' href='#class.copy-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2457'>#</a></div><div id='class.copy-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,copy,inaccessible'></a></span><span class='indexparent'><a class='index' id=':constructor,move,inaccessible'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,copy,inaccessible'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,move,inaccessible'></a></span>A program is ill-formed if the copy/move constructor or the copy/move assignment
operator for an object is implicitly odr-used and the special member function
is not <a href='class.access'>accessible</a><a class='hidden_link' href='#class.copy-2.sentence-1'>.</a></div> <div id='class.copy-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy-2.sentence-2' class='sentence'>Copying/moving one object into another using the copy/move constructor or
the copy/move assignment operator does not change the layout or size of either
object<a class='hidden_link' href='#class.copy-2.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div id='class.copy.ctor' class='section'><h3 ><a class='secnum' href='#class.copy.ctor' style='min-width:103pt'>15.8.1</a> Copy/move constructors <a class='abbr_ref' href='class.copy.ctor'>[class.copy.ctor]</a></h3><div class='para' id='class.copy.ctor-1'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2473'>#</a></div><div id='class.copy.ctor-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,copy__'></a></span><span class='indexparent'><a class='index' id=':constructor,move_'></a></span>A non-template constructor for class
<span class='texttt'>X</span>
is
a
<a class='hidden_link' href='#def:constructor,copy' id='def:constructor,copy'><i >copy constructor</i></a> if its first parameter is of type
<span class='texttt'>X&amp;</span>,
<span class='texttt'>const X&amp;</span>,
<span class='texttt'>volatile X&amp;</span>
or
<span class='texttt'>const volatile X&amp;</span>,
and either there are no other parameters
or else all other parameters have <a href='dcl.fct.default'>default arguments</a><a class='hidden_link' href='#class.copy.ctor-1.sentence-1'>.</a></div> <div id='class.copy.ctor-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.ctor-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.copy.ctor-1.sentence-2' class='sentence'><span class='texttt'>X&#x200b;::&#x200b;X(const X&amp;)</span>
and
<span class='texttt'>X&#x200b;::&#x200b;X(X&amp;,int=1)</span>
are copy constructors<a class='hidden_link' href='#class.copy.ctor-1.sentence-2'>.</a></div><pre class='codeblock'>
struct X {
  X(int);
  X(const X&amp;, int = 1);
};
X a(1);             <span class='comment'>// calls <span class='tcode_in_codeblock'>X(int);</span>
</span>X b(a, 0);          <span class='comment'>// calls <span class='tcode_in_codeblock'>X(const X&amp;, int);</span>
</span>X c = b;            <span class='comment'>// calls <span class='tcode_in_codeblock'>X(const X&amp;, int);</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-2'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2507'>#</a></div><div id='class.copy.ctor-2.sentence-1' class='sentence'>A non-template constructor for class <span class='texttt'>X</span> is a <a class='hidden_link' href='#def:constructor,move' id='def:constructor,move'><i >move constructor</i></a> if its
first parameter is of type <span class='texttt'>X&amp;&amp;</span>, <span class='texttt'>const X&amp;&amp;</span>,
<span class='texttt'>volatile X&amp;&amp;</span>, or <span class='texttt'>const volatile X&amp;&amp;</span>, and either there are
no other parameters or else all other parameters have <a href='dcl.fct.default'>default
arguments</a><a class='hidden_link' href='#class.copy.ctor-2.sentence-1'>.</a></div> <div id='class.copy.ctor-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.ctor-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.copy.ctor-2.sentence-2' class='sentence'><span class='texttt'>Y&#x200b;::&#x200b;Y(Y&amp;&amp;)</span> is a move constructor<a class='hidden_link' href='#class.copy.ctor-2.sentence-2'>.</a></div> <pre class='codeblock'>
struct Y {
  Y(const Y&amp;);
  Y(Y&amp;&amp;);
};
extern Y f(int);
Y d(f(1));          <span class='comment'>// calls <span class='tcode_in_codeblock'>Y(Y&amp;&amp;)</span>
</span>Y e = d;            <span class='comment'>// calls <span class='tcode_in_codeblock'>Y(const Y&amp;)</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-3'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2525'>#</a></div><div id='class.copy.ctor-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-3.sentence-1' class='sentence'>All forms of copy/move constructor may be declared for a class<a class='hidden_link' href='#class.copy.ctor-3.sentence-1'>.</a></div> <div id='class.copy.ctor-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.ctor-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X {
  X(const X&amp;);
  X(X&amp;);            <span class='comment'>// OK
</span>  X(X&amp;&amp;);
  X(const X&amp;&amp;);     <span class='comment'>// OK, but possibly not sensible
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-4'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2541'>#</a></div><div id='class.copy.ctor-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-4.sentence-1' class='sentence'>If a class
<span class='texttt'>X</span>
only has a copy constructor with a parameter of type
<span class='texttt'>X&amp;</span>,
an initializer of type
<span class='texttt'>const</span>
<span class='texttt'>X</span>
or
<span class='texttt'>volatile</span>
<span class='texttt'>X</span>
cannot initialize an object of type
(possibly
cv-qualified)
<span class='texttt'>X</span><a class='hidden_link' href='#class.copy.ctor-4.sentence-1'>.</a></div> <div id='class.copy.ctor-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.ctor-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X {
  X();              <span class='comment'>// default constructor
</span>  X(X&amp;);            <span class='comment'>// copy constructor with a non-const parameter
</span>};
const X cx;
X x = cx;           <span class='comment'>// error: <span class='tcode_in_codeblock'>X&#x200b;::&#x200b;X(X&amp;)</span> cannot copy <span class='tcode_in_codeblock'>cx</span> into <span class='tcode_in_codeblock'>x</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-5'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2570'>#</a></div><div id='class.copy.ctor-5.sentence-1' class='sentence'>A declaration of a constructor for a class
<span class='texttt'>X</span>
is ill-formed if its first parameter is of type (optionally cv-qualified)
<span class='texttt'>X</span>
and either there are no other parameters or else all other parameters have
default arguments<a class='hidden_link' href='#class.copy.ctor-5.sentence-1'>.</a></div> <div id='class.copy.ctor-5.sentence-2' class='sentence'>A member function template is never instantiated to
produce such a constructor signature<a class='hidden_link' href='#class.copy.ctor-5.sentence-2'>.</a></div> <div id='class.copy.ctor-5.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.ctor-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct S {
  template&lt;typename T&gt; S(T);
  S();
};

S g;

void h() {
  S a(g);           <span class='comment'>// does not instantiate the member template to produce <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;S&lt;S&gt;(S)</span>;
</span>                    <span class='comment'>// uses the implicitly declared copy constructor
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-6'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2595'>#</a></div><div id='class.copy.ctor-6.sentence-1' class='sentence'>If the class definition does not explicitly declare a copy constructor,
a non-explicit one is declared <a class='hidden_link' href='#def:constructor,copy,implicitly_declared' id='def:constructor,copy,implicitly_declared'><i >implicitly</i></a><a class='hidden_link' href='#class.copy.ctor-6.sentence-1'>.</a></div> <div id='class.copy.ctor-6.sentence-2' class='sentence'>If the class definition declares a move
constructor or move assignment operator, the implicitly declared copy
constructor is defined as deleted; otherwise, it is defined as
<a href='dcl.fct.def'>defaulted</a><a class='hidden_link' href='#class.copy.ctor-6.sentence-2'>.</a></div> <div id='class.copy.ctor-6.sentence-3' class='sentence'>The latter case is deprecated if the class has a user-declared copy assignment
operator or a user-declared destructor<a class='hidden_link' href='#class.copy.ctor-6.sentence-3'>.</a></div></div><div class='para' id='class.copy.ctor-7'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2605'>#</a></div><div id='class.copy.ctor-7.sentence-1' class='sentence'>The implicitly-declared copy constructor for a class
<span class='texttt'>X</span>
will have the form
<pre class='codeblock'>
X::X(const X&amp;)</pre>
if each potentially constructed subobject of a class type
<span class='texttt'>M</span>
(or array thereof)
has a copy constructor whose first parameter is of type
<span class='texttt'>const</span>
<span class='texttt'>M&amp;</span>
or
<span class='texttt'>const</span>
<span class='texttt'>volatile</span>
<span class='texttt'>M&amp;</span><a class='hidden_link' href='#class.copy.ctor-7.sentence-1'>.</a><a class='footnotenum' href='#footnote-118'>118</a></div> <div id='class.copy.ctor-7.sentence-2' class='sentence'>
Otherwise, the implicitly-declared copy constructor will have the form</div><pre class='codeblock'>
X::X(X&amp;)</pre></div><div class='para' id='class.copy.ctor-8'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2632'>#</a></div><div id='class.copy.ctor-8.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,move,implicitly_declared'></a></span>If the definition of a class <span class='texttt'>X</span> does not explicitly declare
a move constructor, a non-explicit one will be
implicitly declared as defaulted if and only if
<ul class='itemize'><li id='class.copy.ctor-8.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-8.1'>(8.1)</a></div><div id='class.copy.ctor-8.1.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared copy constructor,</div></li><li id='class.copy.ctor-8.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-8.2'>(8.2)</a></div><div id='class.copy.ctor-8.2.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared copy assignment operator,</div></li><li id='class.copy.ctor-8.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-8.3'>(8.3)</a></div><div id='class.copy.ctor-8.3.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared move assignment operator, and</div></li><li id='class.copy.ctor-8.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-8.4'>(8.4)</a></div><div id='class.copy.ctor-8.4.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared destructor<a class='hidden_link' href='#class.copy.ctor-8.4.sentence-1'>.</a></div></li></ul></div><div id='class.copy.ctor-8.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-8.sentence-2' class='sentence'>When the move constructor is not implicitly declared or explicitly supplied,
expressions that otherwise would have invoked the move constructor may instead invoke
a copy constructor<a class='hidden_link' href='#class.copy.ctor-8.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-9'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2655'>#</a></div><div id='class.copy.ctor-9.sentence-1' class='sentence'>The implicitly-declared move constructor for class <span class='texttt'>X</span> will have the form
<pre class='codeblock'>
X::X(X&amp;&amp;)</pre></div></div><div class='para' id='class.copy.ctor-10'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2661'>#</a></div><div id='class.copy.ctor-10.sentence-1' class='sentence'>An implicitly-declared copy/move constructor is an
inline public member of its class<a class='hidden_link' href='#class.copy.ctor-10.sentence-1'>.</a></div> <div id='class.copy.ctor-10.sentence-2' class='sentence'>A defaulted copy/&#x200b;move constructor for a class
  <span class='texttt'>X</span> is defined as <a href='dcl.fct.def.delete'>deleted</a> if <span class='texttt'>X</span> has:
<ul class='itemize'><li id='class.copy.ctor-10.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-10.1'>(10.1)</a></div><div id='class.copy.ctor-10.1.sentence-1' class='sentence'>a potentially constructed subobject type
  <span class='texttt'>M</span> (or array thereof) that cannot be copied/moved because
  <a href='over.match'>overload resolution</a>, as applied to find
  <span class='texttt'>M</span>'s
  corresponding constructor, results in an ambiguity or
  a function that is deleted or inaccessible from the
  defaulted constructor,</div></li><li id='class.copy.ctor-10.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-10.2'>(10.2)</a></div><div id='class.copy.ctor-10.2.sentence-1' class='sentence'>a variant member whose corresponding constructor
  as selected by overload resolution is non-trivial,</div></li><li id='class.copy.ctor-10.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-10.3'>(10.3)</a></div><div id='class.copy.ctor-10.3.sentence-1' class='sentence'>any potentially constructed subobject of a type
  with a destructor that is deleted or inaccessible from the defaulted
  constructor, or,</div></li><li id='class.copy.ctor-10.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-10.4'>(10.4)</a></div><div id='class.copy.ctor-10.4.sentence-1' class='sentence'>for the copy constructor, a non-static data member of rvalue reference type<a class='hidden_link' href='#class.copy.ctor-10.4.sentence-1'>.</a></div></li></ul></div><div id='class.copy.ctor-10.sentence-3' class='sentence'>A defaulted move constructor that is defined as deleted is ignored by overload
resolution (<a href='over.match'>[over.match]</a>, <a href='over.over'>[over.over]</a>)<a class='hidden_link' href='#class.copy.ctor-10.sentence-3'>.</a></div> <div id='class.copy.ctor-10.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-10.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-10.sentence-4' class='sentence'>A deleted move constructor would otherwise interfere with initialization from
an rvalue which can use the copy constructor instead<a class='hidden_link' href='#class.copy.ctor-10.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-11'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2692'>#</a></div><div id='class.copy.ctor-11.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,copy,trivial'></a></span><span class='indexparent'><a class='index' id=':constructor,move,trivial'></a></span>A copy/move constructor for class
<span class='texttt'>X</span>
is
trivial
if it is not user-provided and if:
<ul class='itemize'><li id='class.copy.ctor-11.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-11.1'>(11.1)</a></div><div id='class.copy.ctor-11.1.sentence-1' class='sentence'>class
<span class='texttt'>X</span>
has no <a href='class.virtual'>virtual functions</a>
and no <a href='class.mi#def:base_class,virtual'>virtual base classes</a>, and</div></li><li id='class.copy.ctor-11.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-11.2'>(11.2)</a></div><div id='class.copy.ctor-11.2.sentence-1' class='sentence'>the constructor selected to copy/move each direct base class subobject is trivial, and</div></li><li id='class.copy.ctor-11.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-11.3'>(11.3)</a></div><div id='class.copy.ctor-11.3.sentence-1' class='sentence'>for each non-static data member of
<span class='texttt'>X</span>
that is of class type (or array thereof),
the constructor selected to copy/move that member is trivial;</div></li></ul></div><div id='class.copy.ctor-11.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':constructor,move,non-trivial'></a></span>otherwise the copy/move constructor is
<a class='hidden_link' href='#def:constructor,copy,nontrivial' id='def:constructor,copy,nontrivial'><i >non-trivial</i></a><a class='hidden_link' href='#class.copy.ctor-11.sentence-2'>.</a></div></div><div class='para' id='class.copy.ctor-12'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2721'>#</a></div><div id='class.copy.ctor-12.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':constructor,copy,implicitly_defined'></a></span><span class='indexparent'><a class='index' id=':constructor,move,implicitly_defined'></a></span>A copy/move constructor
that is defaulted and not defined as deleted
is
<a class='hidden_link' href='#def:implicitly_defined' id='def:implicitly_defined'><i>implicitly defined</i></a>
when it is odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>),
when it is needed for constant evaluation (<a href='expr.const'>[expr.const]</a>), or
when it is explicitly defaulted after its first declaration<a class='hidden_link' href='#class.copy.ctor-12.sentence-1'>.</a></div> <div id='class.copy.ctor-12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-12.sentence-3' class='sentence'>The copy/move constructor is implicitly defined even if the implementation elided
its <a href='basic.def.odr'>odr-use</a> (<a href='#class.temporary'>[class.temporary]</a>)<a class='hidden_link' href='#class.copy.ctor-12.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.copy.ctor-12.sentence-2' class='sentence'>
If the implicitly-defined constructor would satisfy the requirements of a
<a href='dcl.constexpr#def:specifier,constexpr,constructor'>constexpr constructor</a>, the implicitly-defined
constructor is <span class='texttt'>constexpr</span><a class='hidden_link' href='#class.copy.ctor-12.sentence-2'>.</a></div></div><div class='para' id='class.copy.ctor-13'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2739'>#</a></div><div id='class.copy.ctor-13.sentence-1' class='sentence'>Before the defaulted copy/move constructor for a class is
implicitly defined,
all non-user-provided copy/move constructors for its
potentially constructed subobjects
shall have been implicitly defined<a class='hidden_link' href='#class.copy.ctor-13.sentence-1'>.</a></div> <div id='class.copy.ctor-13.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-13.sentence-2' class='sentence'>An implicitly-declared copy/move constructor has an
implied <a href='except.spec'>exception specification</a><a class='hidden_link' href='#class.copy.ctor-13.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.ctor-14'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2750'>#</a></div><div id='class.copy.ctor-14.sentence-1' class='sentence'>The implicitly-defined copy/move constructor for a non-union class
<span class='texttt'>X</span>
performs a memberwise copy/move of its bases and members<a class='hidden_link' href='#class.copy.ctor-14.sentence-1'>.</a></div> <div id='class.copy.ctor-14.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.ctor-14.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.ctor-14.sentence-5' class='sentence'>Default member initializers of non-static data members are ignored<a class='hidden_link' href='#class.copy.ctor-14.sentence-5'>.</a></div> <div id='class.copy.ctor-14.sentence-6' class='sentence'>See also the example in <a href='#class.base.init'>[class.base.init]</a><a class='hidden_link' href='#class.copy.ctor-14.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.copy.ctor-14.sentence-2' class='sentence'>
The order of initialization is the same as the order of initialization of bases
and members in a user-defined constructor (see <a href='#class.base.init'>[class.base.init]</a>)<a class='hidden_link' href='#class.copy.ctor-14.sentence-2'>.</a></div> <div id='class.copy.ctor-14.sentence-3' class='sentence'>Let <span class='texttt'>x</span> be either the parameter of the constructor or, for the move constructor, an
xvalue referring to the parameter<a class='hidden_link' href='#class.copy.ctor-14.sentence-3'>.</a></div> <div id='class.copy.ctor-14.sentence-4' class='sentence'>Each base or non-static data member
is copied/moved in the manner appropriate to its type:</div><div id='class.copy.ctor-14.sentence-7' class='sentence'><ul class='itemize'><li id='class.copy.ctor-14.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-14.1'>(14.1)</a></div><div id='class.copy.ctor-14.1.sentence-1' class='sentence'>if the member is an array, each element is
direct-initialized with the corresponding subobject of <span class='texttt'>x</span>;</div></li><li id='class.copy.ctor-14.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-14.2'>(14.2)</a></div><div id='class.copy.ctor-14.2.sentence-1' class='sentence'>if a member <span class='texttt'>m</span> has rvalue reference type <span class='texttt'>T&amp;&amp;</span>, it is direct-initialized with
<span class='texttt'>static_&shy;cast&lt;T&amp;&amp;&gt;(x.m)</span>;</div></li><li id='class.copy.ctor-14.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.ctor-14.3'>(14.3)</a></div><div id='class.copy.ctor-14.3.sentence-1' class='sentence'>otherwise, the base or member is direct-initialized with the corresponding base or member of <span class='texttt'>x</span><a class='hidden_link' href='#class.copy.ctor-14.3.sentence-1'>.</a></div></li></ul></div><div id='class.copy.ctor-14.sentence-8' class='sentence'><span class='indexparent'><a class='index' id=':initialization,virtual_base_class'></a></span>Virtual base class subobjects shall be initialized only once by
the implicitly-defined copy/move constructor (see <a href='#class.base.init'>[class.base.init]</a>)<a class='hidden_link' href='#class.copy.ctor-14.sentence-8'>.</a></div></div><div class='para' id='class.copy.ctor-15'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.ctor-15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2779'>#</a></div><div id='class.copy.ctor-15.sentence-1' class='sentence'>The implicitly-defined copy/move constructor for a union
<span class='texttt'>X</span> copies the <a href='basic.types#def:object_representation'>object representation</a> of <span class='texttt'>X</span><a class='hidden_link' href='#class.copy.ctor-15.sentence-1'>.</a></div> </div><div class='footnote' id='footnote-118'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-118'>118)</a></div><div id='footnote-118.sentence-1' class='sentence'>This implies that the reference parameter of the
implicitly-declared copy constructor
cannot bind to a
<span class='texttt'>volatile</span>
lvalue; see <a href='diff.special'>[diff.special]</a><a class='hidden_link' href='#footnote-118.sentence-1'>.</a></div></div></div><div id='class.copy.assign' class='section'><h3 ><a class='secnum' href='#class.copy.assign' style='min-width:103pt'>15.8.2</a> Copy/move assignment operator <a class='abbr_ref' href='class.copy.assign'>[class.copy.assign]</a></h3><div class='para' id='class.copy.assign-1'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2788'>#</a></div><div id='class.copy.assign-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,copy_'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,move_'></a></span>A user-declared <a class='hidden_link' href='#def:copy' id='def:copy'><i>copy</i></a> assignment operator <span class='texttt'>X&#x200b;::&#x200b;operator=</span> is a
non-static non-template member function of class <span class='texttt'>X</span> with exactly one
parameter of type <span class='texttt'>X</span>, <span class='texttt'>X&amp;</span>, <span class='texttt'>const</span> <span class='texttt'>X&amp;</span>,
<span class='texttt'>volatile</span> <span class='texttt'>X&amp;</span> or <span class='texttt'>const</span> <span class='texttt'>volatile</span>
<span class='texttt'>X&amp;</span><a class='hidden_link' href='#class.copy.assign-1.sentence-1'>.</a><a class='footnotenum' href='#footnote-119'>119</a></div> <div id='class.copy.assign-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.assign-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.assign-1.sentence-2' class='sentence'>An overloaded assignment operator must be declared to have only one parameter;
see <a href='over.ass'>[over.ass]</a><a class='hidden_link' href='#class.copy.assign-1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.copy.assign-1.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.assign-1.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.assign-1.sentence-3' class='sentence'>More than one form of copy assignment operator may be declared for a class<a class='hidden_link' href='#class.copy.assign-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.copy.assign-1.note-3' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.assign-1.note-3'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.assign-1.sentence-4' class='sentence'>If a class
<span class='texttt'>X</span>
only has a copy assignment operator with a parameter of type
<span class='texttt'>X&amp;</span>,
an expression of type const
<span class='texttt'>X</span>
cannot be assigned to an object of type
<span class='texttt'>X</span><a class='hidden_link' href='#class.copy.assign-1.sentence-4'>.</a></div> <div id='class.copy.assign-1.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.assign-1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X {
  X();
  X&amp; operator=(X&amp;);
};
const X cx;
X x;
void f() {
  x = cx;           <span class='comment'>// error: <span class='tcode_in_codeblock'>X&#x200b;::&#x200b;operator=(X&amp;)</span> cannot assign <span class='tcode_in_codeblock'>cx</span> into <span class='tcode_in_codeblock'>x</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.assign-2'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2838'>#</a></div><div id='class.copy.assign-2.sentence-1' class='sentence'>If the class definition does not explicitly declare a copy assignment operator,
one is declared <a class='hidden_link' href='#def:assignment_operator,copy,implicitly_declared' id='def:assignment_operator,copy,implicitly_declared'><i >implicitly</i></a><a class='hidden_link' href='#class.copy.assign-2.sentence-1'>.</a></div> <div id='class.copy.assign-2.sentence-2' class='sentence'>If the class definition declares a move
constructor or move assignment operator, the implicitly declared copy
assignment operator is defined as deleted; otherwise, it is defined as
<a href='dcl.fct.def'>defaulted</a><a class='hidden_link' href='#class.copy.assign-2.sentence-2'>.</a></div> <div id='class.copy.assign-2.sentence-3' class='sentence'>The latter case is deprecated if the class has a user-declared copy constructor
or a user-declared destructor<a class='hidden_link' href='#class.copy.assign-2.sentence-3'>.</a></div> <div id='class.copy.assign-2.sentence-4' class='sentence'>The implicitly-declared copy assignment operator for a class
<span class='texttt'>X</span>
will have the form
<pre class='codeblock'>
X&amp; X::operator=(const X&amp;)</pre>
if
<ul class='itemize'><li id='class.copy.assign-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-2.1'>(2.1)</a></div><div id='class.copy.assign-2.1.sentence-1' class='sentence'>each direct base class
<span class='texttt'>B</span>
of
<span class='texttt'>X</span>
has a copy assignment operator whose parameter is of type
<span class='texttt'>const</span>
<span class='texttt'>B&amp;</span>,
<span class='texttt'>const</span>
<span class='texttt'>volatile</span>
<span class='texttt'>B&amp;</span>
or
<span class='texttt'>B</span>,
and</div></li><li id='class.copy.assign-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-2.2'>(2.2)</a></div><div id='class.copy.assign-2.2.sentence-1' class='sentence'>for all the non-static data members of
<span class='texttt'>X</span>
that are of a class type
<span class='texttt'>M</span>
(or array thereof),
each such class type has a copy assignment operator whose parameter is of type
<span class='texttt'>const</span>
<span class='texttt'>M&amp;</span>,
<span class='texttt'>const</span>
<span class='texttt'>volatile</span>
<span class='texttt'>M&amp;</span>
or
<span class='texttt'>M</span><a class='hidden_link' href='#class.copy.assign-2.2.sentence-1'>.</a><a class='footnotenum' href='#footnote-120'>120</a></div></li></ul></div><div id='class.copy.assign-2.sentence-5' class='sentence'>Otherwise, the implicitly-declared copy
assignment operator
will have the form</div><pre class='codeblock'>
X&amp; X::operator=(X&amp;)</pre></div><div class='para' id='class.copy.assign-3'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2896'>#</a></div><div id='class.copy.assign-3.sentence-1' class='sentence'>A user-declared <a class='hidden_link' href='#def:assignment_operator,move' id='def:assignment_operator,move'><i >move</i></a> assignment operator <span class='texttt'>X&#x200b;::&#x200b;operator=</span> is
a non-static non-template member function of class <span class='texttt'>X</span> with exactly
one parameter of type <span class='texttt'>X&amp;&amp;</span>, <span class='texttt'>const X&amp;&amp;</span>, <span class='texttt'>volatile X&amp;&amp;</span>, or
<span class='texttt'>const volatile X&amp;&amp;</span><a class='hidden_link' href='#class.copy.assign-3.sentence-1'>.</a></div> <div id='class.copy.assign-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.assign-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.assign-3.sentence-2' class='sentence'>An overloaded assignment operator must be
declared to have only one parameter; see <a href='over.ass'>[over.ass]</a><a class='hidden_link' href='#class.copy.assign-3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  
<div id='class.copy.assign-3.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.assign-3.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.assign-3.sentence-3' class='sentence'>More
than one form of move assignment operator may be declared for a class<a class='hidden_link' href='#class.copy.assign-3.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.assign-4'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2905'>#</a></div><div id='class.copy.assign-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,move,implicitly_declared'></a></span>If the definition of a class <span class='texttt'>X</span> does not explicitly declare a
move assignment operator, one
will be implicitly declared as defaulted if and only if</div><div id='class.copy.assign-4.sentence-2' class='sentence'><ul class='itemize'><li id='class.copy.assign-4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-4.1'>(4.1)</a></div><div id='class.copy.assign-4.1.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared copy constructor,</div></li><li id='class.copy.assign-4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-4.2'>(4.2)</a></div><div id='class.copy.assign-4.2.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared move constructor,</div></li><li id='class.copy.assign-4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-4.3'>(4.3)</a></div><div id='class.copy.assign-4.3.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared copy assignment operator, and</div></li><li id='class.copy.assign-4.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-4.4'>(4.4)</a></div><div id='class.copy.assign-4.4.sentence-1' class='sentence'><span class='texttt'>X</span> does not have a user-declared destructor<a class='hidden_link' href='#class.copy.assign-4.4.sentence-1'>.</a></div></li></ul></div><div id='class.copy.assign-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.assign-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='class.copy.assign-4.sentence-3' class='sentence'>The class definition
<pre class='codeblock'>
struct S {
  int a;
  S&amp; operator=(const S&amp;) = default;
};</pre></div><div id='class.copy.assign-4.sentence-4' class='sentence'>will not have a default move assignment operator implicitly declared because the
copy assignment operator has been user-declared<a class='hidden_link' href='#class.copy.assign-4.sentence-4'>.</a></div> <div id='class.copy.assign-4.sentence-5' class='sentence'>The move assignment operator may
be explicitly defaulted<a class='hidden_link' href='#class.copy.assign-4.sentence-5'>.</a></div><pre class='codeblock'>
struct S {
  int a;
  S&amp; operator=(const S&amp;) = default;
  S&amp; operator=(S&amp;&amp;) = default;
};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.assign-5'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2946'>#</a></div><div id='class.copy.assign-5.sentence-1' class='sentence'>The implicitly-declared move assignment operator for a class <span class='texttt'>X</span> will have the form
<pre class='codeblock'>
X&amp; X::operator=(X&amp;&amp;);</pre></div></div><div class='para' id='class.copy.assign-6'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2952'>#</a></div><div id='class.copy.assign-6.sentence-1' class='sentence'>The implicitly-declared copy/move assignment operator for class
<span class='texttt'>X</span>
has the return type
<span class='texttt'>X&amp;</span>;
it returns the object for which the assignment operator is invoked, that is,
the object assigned to<a class='hidden_link' href='#class.copy.assign-6.sentence-1'>.</a></div> <div id='class.copy.assign-6.sentence-2' class='sentence'>An implicitly-declared copy/move assignment operator is an
inline public member of its class<a class='hidden_link' href='#class.copy.assign-6.sentence-2'>.</a></div></div><div class='para' id='class.copy.assign-7'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2962'>#</a></div><div id='class.copy.assign-7.sentence-1' class='sentence'>A defaulted copy/move assignment operator for
class <span class='texttt'>X</span> is defined as deleted if <span class='texttt'>X</span> has:
<ul class='itemize'><li id='class.copy.assign-7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-7.1'>(7.1)</a></div><div id='class.copy.assign-7.1.sentence-1' class='sentence'>a variant member with a non-trivial corresponding assignment operator and
  <span class='texttt'>X</span> is a union-like class, or</div></li><li id='class.copy.assign-7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-7.2'>(7.2)</a></div><div id='class.copy.assign-7.2.sentence-1' class='sentence'>a non-static data member of <span class='texttt'>const</span> non-class
  type (or array thereof), or</div></li><li id='class.copy.assign-7.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-7.3'>(7.3)</a></div><div id='class.copy.assign-7.3.sentence-1' class='sentence'>a non-static data member of reference type, or</div></li><li id='class.copy.assign-7.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-7.4'>(7.4)</a></div><div id='class.copy.assign-7.4.sentence-1' class='sentence'>a direct non-static data member of class type <span class='texttt'>M</span>
  (or array thereof) or a direct base class <span class='texttt'>M</span>
  that cannot be copied/moved because <a href='over.match'>overload resolution</a>,
  as applied to find <span class='texttt'>M</span>'s corresponding
  assignment operator, results in an ambiguity or
  a function that is deleted or inaccessible from the
  defaulted assignment operator<a class='hidden_link' href='#class.copy.assign-7.4.sentence-1'>.</a></div></li></ul></div><div id='class.copy.assign-7.sentence-2' class='sentence'>A defaulted move assignment operator that is defined as deleted is ignored by
overload resolution (<a href='over.match'>[over.match]</a>, <a href='over.over'>[over.over]</a>)<a class='hidden_link' href='#class.copy.assign-7.sentence-2'>.</a></div></div><div class='para' id='class.copy.assign-8'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L2986'>#</a></div><div id='class.copy.assign-8.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,copy,hidden'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,move,hidden'></a></span>Because a copy/move assignment operator is implicitly declared for a class
if not declared by the user,
a base class copy/move assignment operator is always hidden
by the corresponding assignment operator of a derived class (<a href='over.ass'>[over.ass]</a>)<a class='hidden_link' href='#class.copy.assign-8.sentence-1'>.</a></div> <div id='class.copy.assign-8.sentence-2' class='sentence'>A
<i ><a href='namespace.udecl#nt:using-declaration'>using-declaration</a></i> that brings in from a base class an assignment operator
with a parameter type that could be that of a
copy/move assignment operator for the
derived class is not considered an explicit declaration of such an
operator and does not suppress the implicit declaration of the derived class
operator;
the operator introduced by the
<i ><a href='namespace.udecl#nt:using-declaration'>using-declaration</a></i>
is hidden by the implicitly-declared operator in the derived
class<a class='hidden_link' href='#class.copy.assign-8.sentence-2'>.</a></div></div><div class='para' id='class.copy.assign-9'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3005'>#</a></div><div id='class.copy.assign-9.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,copy,trivial'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,move,trivial'></a></span>A copy/move assignment operator for class
<span class='texttt'>X</span>
is
trivial
if it is not user-provided and if:
<ul class='itemize'><li id='class.copy.assign-9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-9.1'>(9.1)</a></div><div id='class.copy.assign-9.1.sentence-1' class='sentence'>class
<span class='texttt'>X</span>
has no <a href='class.virtual'>virtual functions</a>
and no <a href='class.mi'>virtual base classes</a>, and</div></li><li id='class.copy.assign-9.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-9.2'>(9.2)</a></div><div id='class.copy.assign-9.2.sentence-1' class='sentence'>the assignment operator selected to copy/move each direct
base class subobject is trivial, and</div></li><li id='class.copy.assign-9.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-9.3'>(9.3)</a></div><div id='class.copy.assign-9.3.sentence-1' class='sentence'>for each non-static data member of
<span class='texttt'>X</span>
that is of class type (or array thereof),
the assignment operator selected to copy/move that member is trivial;</div></li></ul></div><div id='class.copy.assign-9.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,move,non-trivial'></a></span>otherwise the copy/move assignment operator is
<a class='hidden_link' href='#def:assignment_operator,copy,non-trivial' id='def:assignment_operator,copy,non-trivial'><i >non-trivial</i></a><a class='hidden_link' href='#class.copy.assign-9.sentence-2'>.</a></div></div><div class='para' id='class.copy.assign-10'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3034'>#</a></div><div id='class.copy.assign-10.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,copy,implicitly_defined'></a></span><span class='indexparent'><a class='index' id=':assignment_operator,move,implicitly_defined'></a></span>A copy/move assignment operator for a class <span class='texttt'>X</span>
that is defaulted and not defined as deleted
is
<a class='hidden_link' href='#def:implicitly_defined' id='def:implicitly_defined'><i>implicitly defined</i></a>
when it is odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>)
(e.g., when it is selected by overload resolution
to assign to an object of its class type),
when it is needed for constant evaluation (<a href='expr.const'>[expr.const]</a>), or
when it is explicitly defaulted after its first declaration<a class='hidden_link' href='#class.copy.assign-10.sentence-1'>.</a></div> <div id='class.copy.assign-10.sentence-2' class='sentence'>The implicitly-defined copy/move assignment operator is <span class='texttt'>constexpr</span> if
<ul class='itemize'><li id='class.copy.assign-10.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-10.1'>(10.1)</a></div><div id='class.copy.assign-10.1.sentence-1' class='sentence'><span class='texttt'>X</span> is a literal type, and</div></li><li id='class.copy.assign-10.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-10.2'>(10.2)</a></div><div id='class.copy.assign-10.2.sentence-1' class='sentence'>the assignment operator selected to copy/move each direct base class subobject
is a constexpr function, and</div></li><li id='class.copy.assign-10.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-10.3'>(10.3)</a></div><div id='class.copy.assign-10.3.sentence-1' class='sentence'>for each non-static data member of <span class='texttt'>X</span> that is of class type (or array
thereof), the assignment operator selected to copy/move that member is a
constexpr function<a class='hidden_link' href='#class.copy.assign-10.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='class.copy.assign-11'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3061'>#</a></div><div id='class.copy.assign-11.sentence-1' class='sentence'>Before the defaulted copy/move assignment operator for a class is
implicitly defined,
all non-user-provided copy/move assignment operators for
its direct base classes and
its non-static data members shall have been implicitly defined<a class='hidden_link' href='#class.copy.assign-11.sentence-1'>.</a></div> <div id='class.copy.assign-11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.assign-11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.assign-11.sentence-2' class='sentence'>An implicitly-declared copy/move assignment operator has an
implied <a href='except.spec'>exception specification</a><a class='hidden_link' href='#class.copy.assign-11.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.assign-12'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3072'>#</a></div><div id='class.copy.assign-12.sentence-1' class='sentence'>The implicitly-defined copy/move assignment operator for a
non-union class <span class='texttt'>X</span> performs memberwise copy/move assignment of its subobjects<a class='hidden_link' href='#class.copy.assign-12.sentence-1'>.</a></div> <div id='class.copy.assign-12.sentence-2' class='sentence'>The direct
base classes of <span class='texttt'>X</span> are assigned first, in the order of their declaration in the
<i ><a href='class.derived#nt:base-specifier-list'>base-specifier-list</a></i>, and then the immediate non-static data members of
<span class='texttt'>X</span> are assigned, in the order in which they were declared in the class
definition<a class='hidden_link' href='#class.copy.assign-12.sentence-2'>.</a></div> <div id='class.copy.assign-12.sentence-3' class='sentence'>Let <span class='texttt'>x</span> be either the parameter of the function or, for the move operator, an
xvalue referring to the parameter<a class='hidden_link' href='#class.copy.assign-12.sentence-3'>.</a></div> <div id='class.copy.assign-12.sentence-4' class='sentence'>Each subobject is assigned in the manner appropriate to its type:</div><div id='class.copy.assign-12.sentence-5' class='sentence'><ul class='itemize'><li id='class.copy.assign-12.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-12.1'>(12.1)</a></div><div id='class.copy.assign-12.1.sentence-1' class='sentence'>if the subobject is of class type,
as if by a call to <span class='texttt'>operator=</span> with the subobject as the object expression
and the corresponding subobject of <span class='texttt'>x</span> as a single function argument
(as if by explicit qualification; that is,
ignoring any possible virtual overriding functions in more derived classes);</div></li><li id='class.copy.assign-12.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-12.2'>(12.2)</a></div><div id='class.copy.assign-12.2.sentence-1' class='sentence'>if the subobject is an array, each element is assigned,
in the manner appropriate to the element type;</div></li><li id='class.copy.assign-12.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.assign-12.3'>(12.3)</a></div><div id='class.copy.assign-12.3.sentence-1' class='sentence'>if the subobject is of scalar type,
the built-in assignment operator is used<a class='hidden_link' href='#class.copy.assign-12.3.sentence-1'>.</a></div></li></ul></div><div id='class.copy.assign-12.sentence-6' class='sentence'><span class='indexparent'><a class='index' id=':assignment_operator,copy,virtual_bases_and'></a></span>It is unspecified whether subobjects representing virtual base classes
are assigned more than once by the implicitly-defined copy/move assignment
operator<a class='hidden_link' href='#class.copy.assign-12.sentence-6'>.</a></div> <div id='class.copy.assign-12.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.assign-12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct V { };
struct A : virtual V { };
struct B : virtual V { };
struct C : B, A { };</pre><div id='class.copy.assign-12.sentence-7' class='sentence'>It is unspecified whether the virtual base class subobject
<span class='texttt'>V</span>
is assigned twice by the implicitly-defined copy/move assignment operator for
<span class='texttt'>C</span><a class='hidden_link' href='#class.copy.assign-12.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.assign-13'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.assign-13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3117'>#</a></div><div id='class.copy.assign-13.sentence-1' class='sentence'>The implicitly-defined copy assignment operator for a
union <span class='texttt'>X</span> copies the <a href='basic.types#def:object_representation'>object representation</a> of <span class='texttt'>X</span><a class='hidden_link' href='#class.copy.assign-13.sentence-1'>.</a></div> </div><div class='footnote' id='footnote-119'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-119'>119)</a></div><div id='footnote-119.sentence-1' class='sentence'>Because a template assignment operator or an assignment
operator taking an rvalue reference parameter is never a copy assignment
operator, the presence of such an assignment operator does not suppress the
implicit declaration of a copy assignment operator<a class='hidden_link' href='#footnote-119.sentence-1'>.</a></div> <div id='footnote-119.sentence-2' class='sentence'>Such assignment operators
participate in overload resolution with other assignment operators, including
copy assignment operators, and, if selected, will be used to assign an object<a class='hidden_link' href='#footnote-119.sentence-2'>.</a></div></div><div class='footnote' id='footnote-120'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-120'>120)</a></div><div id='footnote-120.sentence-1' class='sentence'>This implies that the reference parameter of the
implicitly-declared copy assignment operator cannot bind to a
<span class='texttt'>volatile</span>
lvalue; see <a href='diff.special'>[diff.special]</a><a class='hidden_link' href='#footnote-120.sentence-1'>.</a></div></div></div><div id='class.copy.elision' class='section'><h3 ><a class='secnum' href='#class.copy.elision' style='min-width:103pt'>15.8.3</a> Copy/move elision <a class='abbr_ref' href='class.copy.elision'>[class.copy.elision]</a></h3><div class='para' id='class.copy.elision-1'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.elision-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3125'>#</a></div><div id='class.copy.elision-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':temporary,elimination_of_'></a></span><span class='indexparent'><a class='index' id=':constructor,copy,elision'></a></span><span class='indexparent'><a class='index' id=':constructor,move,elision'></a></span>When certain criteria are met, an implementation is
allowed to omit the copy/move construction of a class object,
even if the constructor selected for the copy/move operation and/or the
destructor for the object have
<span class='indexparent'><a class='index' id=':side_effects__'></a></span>side effects<a class='hidden_link' href='#class.copy.elision-1.sentence-1'>.</a></div> <div id='class.copy.elision-1.sentence-2' class='sentence'>In such cases, the
implementation treats the source and target of the
omitted copy/move operation as simply two different ways of
referring to the same object<a class='hidden_link' href='#class.copy.elision-1.sentence-2'>.</a></div> <div id='class.copy.elision-1.sentence-3' class='sentence'>If the first parameter of the
selected constructor is an rvalue reference to the object's type,
the destruction of that object occurs when the target would have been destroyed;
otherwise, the destruction occurs at the later of the times when the
two objects would have been destroyed without the
optimization<a class='hidden_link' href='#class.copy.elision-1.sentence-3'>.</a><a class='footnotenum' href='#footnote-121'>121</a></div> <div id='class.copy.elision-1.sentence-4' class='sentence'>
This elision of copy/move operations, called
<span class='indexparent'><a class='index' id=':constructor,copy,elision_'></a></span><span class='indexparent'><a class='index' id=':constructor,move,elision_'></a></span><a class='hidden_link' href='#def:copy_elision' id='def:copy_elision'><i>copy elision</i></a>,
is permitted in the
following circumstances (which may be combined to
eliminate multiple copies):</div><div id='class.copy.elision-1.sentence-5' class='sentence'><ul class='itemize'><li id='class.copy.elision-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.elision-1.1'>(1.1)</a></div><div id='class.copy.elision-1.1.sentence-1' class='sentence'>in a <span class='texttt'>return</span> statement in a function with a class return type,
when the <i ><a href='expr.comma#nt:expression'>expression</a></i> is the name of a non-volatile
automatic object (other than a function parameter or a variable
introduced by the <i ><a href='except#nt:exception-declaration'>exception-declaration</a></i> of a
<i ><a href='except#nt:handler'>handler</a></i> (<a href='except.handle'>[except.handle]</a>))
with the same type (ignoring cv-qualification) as
the function return type, the copy/move operation can be
omitted by constructing the automatic object directly
into the function call's return object</div></li><li id='class.copy.elision-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.elision-1.2'>(1.2)</a></div><div id='class.copy.elision-1.2.sentence-1' class='sentence'>in a <i ><a href='expr.throw#nt:throw-expression'>throw-expression</a></i>, when the operand
is the name of a non-volatile automatic object
(other than a function or catch-clause parameter)
whose scope does not extend beyond the end of the innermost enclosing
<i ><a href='except#nt:try-block'>try-block</a></i> (if there is one), the copy/move operation from the
operand to the <a href='except.throw#def:exception_handling,exception_object'>exception object</a> can be omitted by
constructing the automatic object directly into the exception object</div></li><li id='class.copy.elision-1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.elision-1.3'>(1.3)</a></div><div id='class.copy.elision-1.3.sentence-1' class='sentence'>when the <i ><a href='except#nt:exception-declaration'>exception-declaration</a></i> of an
exception handler (<a href='except'>[except]</a>) declares an object of the same
type (except for cv-qualification) as the
<a href='except.throw#def:exception_handling,exception_object'>exception object</a>,
the copy operation can be omitted by treating
the <i ><a href='except#nt:exception-declaration'>exception-declaration</a></i> as an alias for the exception
object if the meaning of the program will be unchanged except for the execution
of constructors and destructors for the object declared by the
<i ><a href='except#nt:exception-declaration'>exception-declaration</a></i><a class='hidden_link' href='#class.copy.elision-1.3.sentence-1'>.</a></div> <div id='class.copy.elision-1.3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.elision-1.3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.elision-1.3.sentence-2' class='sentence'>There cannot be a move from the exception object because it is
always an lvalue<a class='hidden_link' href='#class.copy.elision-1.3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul>
Copy elision is required
where an expression is evaluated in a context
requiring a <a href='expr.const'>constant expression</a>
and in <a href='basic.start.static#def:constant_initialization'>constant initialization</a><a class='hidden_link' href='#class.copy.elision-1.sentence-5'>.</a></div> <div id='class.copy.elision-1.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.elision-1.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.elision-1.sentence-6' class='sentence'>Copy elision might not be performed
if the same expression
is evaluated in another context<a class='hidden_link' href='#class.copy.elision-1.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.elision-2'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.elision-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3196'>#</a></div><div id='class.copy.elision-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.elision-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class Thing {
public:
  Thing();
  ~Thing();
  Thing(const Thing&amp;);
};

Thing f() {
  Thing t;
  return t;
}

Thing t2 = f();

struct A {
  void *p;
  constexpr A(): p(this) {}
};

constexpr A g() {
  A a;
  return a;
}

constexpr A a;          <span class='comment'>// well-formed, <span class='tcode_in_codeblock'>a.p</span> points to <span class='tcode_in_codeblock'>a</span>
</span>constexpr A b = g();    <span class='comment'>// well-formed, <span class='tcode_in_codeblock'>b.p</span> points to <span class='tcode_in_codeblock'>b</span>
</span>
void g() {
  A c = g();            <span class='comment'>// well-formed, <span class='tcode_in_codeblock'>c.p</span> may point to <span class='tcode_in_codeblock'>c</span> or to an ephemeral temporary
</span>}</pre> <div id='class.copy.elision-2.sentence-1' class='sentence'>
Here the criteria for elision can
eliminate
the copying of the local automatic object
<span class='texttt'>t</span>
into the result object for the function call
<span class='texttt'>f()</span>,
which is the global object
<span class='texttt'>t2</span><a class='hidden_link' href='#class.copy.elision-2.sentence-1'>.</a></div> <div id='class.copy.elision-2.sentence-2' class='sentence'>Effectively, the construction of the local object
<span class='texttt'>t</span>
can be viewed as directly initializing the global
object
<span class='texttt'>t2</span>,
and that object's destruction will occur at program
exit<a class='hidden_link' href='#class.copy.elision-2.sentence-2'>.</a></div> <div id='class.copy.elision-2.sentence-3' class='sentence'>Adding a move constructor to <span class='texttt'>Thing</span> has the same effect, but it is the
move construction from the local automatic object to <span class='texttt'>t2</span> that is elided<a class='hidden_link' href='#class.copy.elision-2.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.elision-3'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.elision-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3249'>#</a></div><div id='class.copy.elision-3.sentence-1' class='sentence'>In the following copy-initialization contexts, a move operation might be used instead of a copy operation:
<ul class='itemize'><li id='class.copy.elision-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.elision-3.1'>(3.1)</a></div><div id='class.copy.elision-3.1.sentence-1' class='sentence'>If the <i ><a href='expr.comma#nt:expression'>expression</a></i> in a <a href='stmt.return'><span class='texttt'>return</span> statement</a>
is a (possibly parenthesized) <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i>
that names an object with automatic storage duration declared in the body
or <i ><a href='dcl.fct#nt:parameter-declaration-clause'>parameter-declaration-clause</a></i> of the innermost enclosing
function or <i ><a href='expr.prim.lambda#nt:lambda-expression'>lambda-expression</a></i>, or</div></li><li id='class.copy.elision-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.copy.elision-3.2'>(3.2)</a></div><div id='class.copy.elision-3.2.sentence-1' class='sentence'>if the operand of a <i ><a href='expr.throw#nt:throw-expression'>throw-expression</a></i>
is the name of a non-volatile automatic object
(other than a function or catch-clause parameter)
whose scope does not extend beyond the end of the innermost enclosing
<i ><a href='except#nt:try-block'>try-block</a></i> (if there is one),</div></li></ul>
overload resolution to select the constructor
for the copy is first performed as if the object were designated by an
rvalue<a class='hidden_link' href='#class.copy.elision-3.sentence-1'>.</a></div> <div id='class.copy.elision-3.sentence-2' class='sentence'>If the first overload resolution fails or was not performed,
or if the type of the first parameter of the selected
constructor is not an rvalue reference to the object's type (possibly cv-qualified),
overload resolution is performed again, considering the object as an lvalue<a class='hidden_link' href='#class.copy.elision-3.sentence-2'>.</a></div> <div id='class.copy.elision-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.copy.elision-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.copy.elision-3.sentence-3' class='sentence'>This two-stage overload resolution must be performed regardless
of whether copy elision will occur<a class='hidden_link' href='#class.copy.elision-3.sentence-3'>.</a></div> <div id='class.copy.elision-3.sentence-4' class='sentence'>It determines the constructor to be called if
elision is not performed, and the selected constructor must be accessible even if
the call is elided<a class='hidden_link' href='#class.copy.elision-3.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='class.copy.elision-4'><div class='marginalizedparent'><a class='marginalized' href='#class.copy.elision-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3278'>#</a></div><div id='class.copy.elision-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.copy.elision-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
class Thing {
public:
  Thing();
  ~Thing();
  Thing(Thing&amp;&amp;);
private:
  Thing(const Thing&amp;);
};

Thing f(bool b) {
  Thing t;
  if (b)
    throw t;            <span class='comment'>// OK: <span class='tcode_in_codeblock'>Thing(Thing&amp;&amp;)</span> used (or elided) to throw <span class='tcode_in_codeblock'>t</span>
</span>  return t;             <span class='comment'>// OK: <span class='tcode_in_codeblock'>Thing(Thing&amp;&amp;)</span> used (or elided) to return <span class='tcode_in_codeblock'>t</span>
</span>}

Thing t2 = f(false);    <span class='comment'>// OK: no extra copy/move performed, <span class='tcode_in_codeblock'>t2</span> constructed by call to <span class='tcode_in_codeblock'>f</span>
</span>
struct Weird {
  Weird();
  Weird(Weird&amp;);
};

Weird g() {
  Weird w;
  return w;             <span class='comment'>// OK: first overload resolution fails, second overload resolution selects <span class='tcode_in_codeblock'>Weird(Weird&amp;)</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-121'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-121'>121)</a></div><div id='footnote-121.sentence-1' class='sentence'>Because only one object is destroyed instead of two,
and one copy/move constructor
is not executed, there is still one object destroyed for each one constructed<a class='hidden_link' href='#footnote-121.sentence-1'>.</a></div></div></div></div><div id='class.compare' class='section'><h2 ><a class='secnum' href='#class.compare' style='min-width:88pt'>15.9</a> Comparisons <a class='abbr_ref' href='class.compare'>[class.compare]</a></h2><div id='class.compare.default' class='section'><h3 ><a class='secnum' href='#class.compare.default' style='min-width:103pt'>15.9.1</a> Defaulted comparison operator functions <a class='abbr_ref' href='class.compare.default'>[class.compare.default]</a></h3><div class='para' id='class.compare.default-1'><div class='marginalizedparent'><a class='marginalized' href='#class.compare.default-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3315'>#</a></div><div id='class.compare.default-1.sentence-1' class='sentence'>A defaulted comparison operator function (<a href='expr.spaceship'>[expr.spaceship]</a>, <a href='expr.rel'>[expr.rel]</a>, <a href='expr.eq'>[expr.eq]</a>)
for some class <span class='texttt'>C</span>
shall be a non-template function
declared in the <i ><a href='class.mem#nt:member-specification'>member-specification</a></i> of <span class='texttt'>C</span>
that is
<ul class='itemize'><li id='class.compare.default-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.compare.default-1.1'>(1.1)</a></div><div id='class.compare.default-1.1.sentence-1' class='sentence'>a non-static member of <span class='texttt'>C</span> having one parameter of type <span class='texttt'>const C&amp;</span>, or</div></li><li id='class.compare.default-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.compare.default-1.2'>(1.2)</a></div><div id='class.compare.default-1.2.sentence-1' class='sentence'>a friend of <span class='texttt'>C</span> having two parameters of type <span class='texttt'>const C&amp;</span><a class='hidden_link' href='#class.compare.default-1.2.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='class.compare.default-2'><div class='marginalizedparent'><a class='marginalized' href='#class.compare.default-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3326'>#</a></div><div id='class.compare.default-2.sentence-1' class='sentence'>A three-way comparison operator for a class type <span class='texttt'>C</span>
is a <a class='hidden_link' href='#def:operator,structural_comparison' id='def:operator,structural_comparison'><i >structural comparison operator</i></a>
if it is defined as defaulted in the definition of <span class='texttt'>C</span>,
and all three-way comparison operators it invokes
are structural comparison operators<a class='hidden_link' href='#class.compare.default-2.sentence-1'>.</a></div> <div id='class.compare.default-2.sentence-2' class='sentence'>A type <span class='texttt'>T</span>
has <a class='hidden_link' href='#def:equality,strong_structural' id='def:equality,strong_structural'><i >strong structural equality</i></a>
if, for a glvalue <span class='texttt'>x</span> of type <span class='texttt'>const T</span>,
<span class='texttt'>x &lt;=&gt; x</span> is a valid expression
of type <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering</span> or <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality</span>
and either does not invoke a three-way comparison operator
or invokes a structural comparison operator<a class='hidden_link' href='#class.compare.default-2.sentence-2'>.</a></div></div></div><div id='class.spaceship' class='section'><h3 ><a class='secnum' href='#class.spaceship' style='min-width:103pt'>15.9.2</a> Three-way comparison <a class='abbr_ref' href='class.spaceship'>[class.spaceship]</a></h3><span class='indexparent'><a class='index' id=':operator,three-way_comparison,defaulted'></a></span><div class='para' id='class.spaceship-1'><div class='marginalizedparent'><a class='marginalized' href='#class.spaceship-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3345'>#</a></div><div id='class.spaceship-1.sentence-1' class='sentence'>The direct base class subobjects of <span class='texttt'>C</span>,
in the order of their declaration in the <i ><a href='class.derived#nt:base-specifier-list'>base-specifier-list</a></i> of <span class='texttt'>C</span>,
followed by the non-static data members of <span class='texttt'>C</span>,
in the order of their declaration in the <i ><a href='class.mem#nt:member-specification'>member-specification</a></i> of <span class='texttt'>C</span>,
form a list of subobjects<a class='hidden_link' href='#class.spaceship-1.sentence-1'>.</a></div> <div id='class.spaceship-1.sentence-2' class='sentence'>In that list, any subobject of array type is recursively expanded
to the sequence of its elements, in the order of increasing subscript<a class='hidden_link' href='#class.spaceship-1.sentence-2'>.</a></div> <div id='class.spaceship-1.sentence-3' class='sentence'>Let <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> be an lvalue denoting the <span class="mjx-chtml"><span class="mjx-math" aria-label="i Superscript th"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span><span class="mjx-sup" style="font-size: 70.7%; vertical-align: 0.513em; padding-left: 0px; padding-right: 0.071em;"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">th</span></span></span></span></span></span></span> element
in the expanded list of subobjects for an object <span class='texttt'>x</span>
(of length <span class='math'><span class='mathalpha'>n</span></span>),
where <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is
formed by a sequence of
derived-to-base conversions (<a href='over.best.ics'>[over.best.ics]</a>),
<a href='expr.ref'>class member access expressions</a>, and
<a href='expr.sub'>array subscript expressions</a> applied to <span class='texttt'>x</span><a class='hidden_link' href='#class.spaceship-1.sentence-3'>.</a></div> <div id='class.spaceship-1.sentence-4' class='sentence'>The type of the expression <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> <span class='texttt'>&lt;=&gt;</span> <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span>
is denoted by <span class='texttt'>R</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span><a class='hidden_link' href='#class.spaceship-1.sentence-4'>.</a></div> <div id='class.spaceship-1.sentence-5' class='sentence'>It is unspecified
whether virtual base class subobjects are compared more than once<a class='hidden_link' href='#class.spaceship-1.sentence-5'>.</a></div></div><div class='para' id='class.spaceship-2'><div class='marginalizedparent'><a class='marginalized' href='#class.spaceship-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3366'>#</a></div><div id='class.spaceship-2.sentence-1' class='sentence'>If the declared return type
of a defaulted three-way comparison operator function
is <span class='texttt'>auto</span>,
then the return type is deduced as
the common comparison type (see below) of
<span class='texttt'>R</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span>, <span class='texttt'>R</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, <span class='texttt'>R</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript n minus 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span><a class='hidden_link' href='#class.spaceship-2.sentence-1'>.</a></div> <div id='class.spaceship-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.spaceship-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.spaceship-2.sentence-3' class='sentence'>Otherwise,
the program will be ill-formed
if the expression <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> <span class='texttt'>&lt;=&gt;</span> <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span>
is not implicitly convertible to the declared return type for any <span class='math'><span class='mathalpha'>i</span></span><a class='hidden_link' href='#class.spaceship-2.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='class.spaceship-2.sentence-2' class='sentence'>
If the return type is deduced as <span class='texttt'>void</span>,
the operator function is defined as deleted<a class='hidden_link' href='#class.spaceship-2.sentence-2'>.</a></div></div><div class='para' id='class.spaceship-3'><div class='marginalizedparent'><a class='marginalized' href='#class.spaceship-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3382'>#</a></div><div id='class.spaceship-3.sentence-1' class='sentence'>The return value <span class='texttt'>V</span> of type <span class='texttt'>R</span>
of the defaulted three-way comparison operator function
with parameters <span class='texttt'>x</span> and <span class='texttt'>y</span> of the same type
is determined by comparing corresponding elements
<span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> and <span class='texttt'>y</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span>
in the expanded lists of subobjects for <span class='texttt'>x</span> and <span class='texttt'>y</span>
until the first index <span class='math'><span class='mathalpha'>i</span></span>
where <span class='texttt'>x</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> <span class='texttt'>&lt;=&gt;</span> <span class='texttt'>y</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span>
yields a result value <span class='texttt'>v</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> where <span class='texttt'>v</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i Baseline monospace exclamation-mark equals 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.298em;">!=</span></span></span></span></span></span><span class="mjx-mn MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span>,
contextually converted to <span class='texttt'>bool</span>, yields <span class='texttt'>true</span>;
<span class='texttt'>V</span> is <span class='texttt'>v</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> converted to <span class='texttt'>R</span><a class='hidden_link' href='#class.spaceship-3.sentence-1'>.</a></div> <div id='class.spaceship-3.sentence-2' class='sentence'>If no such index exists, <span class='texttt'>V</span> is
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;equal</span> converted to <span class='texttt'>R</span><a class='hidden_link' href='#class.spaceship-3.sentence-2'>.</a></div></div><div class='para' id='class.spaceship-4'><div class='marginalizedparent'><a class='marginalized' href='#class.spaceship-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3397'>#</a></div><div id='class.spaceship-4.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:common_comparison_type' id='def:common_comparison_type'><i >common comparison type</i></a> <span class='texttt'>U</span>
of a possibly-empty list of <span class='math'><span class='mathalpha'>n</span></span> types
<span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript 0"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span></span></span></span></span></span>, <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript n minus 1"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span></span></span>
is defined as follows:</div><div id='class.spaceship-4.sentence-2' class='sentence'><ul class='itemize'><li id='class.spaceship-4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.spaceship-4.1'>(4.1)</a></div><div id='class.spaceship-4.1.sentence-1' class='sentence'>If any <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span>
is not a <a href='cmp.categories#def:comparison_category_types'>comparison category type</a>,
<span class='texttt'>U</span> is <span class='texttt'>void</span><a class='hidden_link' href='#class.spaceship-4.1.sentence-1'>.</a></div></li><li id='class.spaceship-4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.spaceship-4.2'>(4.2)</a></div><div id='class.spaceship-4.2.sentence-1' class='sentence'>Otherwise, if
at least one <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>std&#x200b;::&#x200b;weak_&shy;equality</span>, or
at least one <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality</span> and
at least one <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript j"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span></span></span> is <span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering</span> or
                              <span class='texttt'>std&#x200b;::&#x200b;weak_&shy;ordering</span>,
<span class='texttt'>U</span> is <a href='cmp.weakeq'><span class='texttt'>std&#x200b;::&#x200b;weak_&shy;equality</span></a><a class='hidden_link' href='#class.spaceship-4.2.sentence-1'>.</a></div></li><li id='class.spaceship-4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.spaceship-4.3'>(4.3)</a></div><div id='class.spaceship-4.3.sentence-1' class='sentence'>Otherwise, if at least one <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality</span>,
<span class='texttt'>U</span> is <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality</span> (<a href='cmp.strongeq'>[cmp.strongeq]</a>)<a class='hidden_link' href='#class.spaceship-4.3.sentence-1'>.</a></div></li><li id='class.spaceship-4.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.spaceship-4.4'>(4.4)</a></div><div id='class.spaceship-4.4.sentence-1' class='sentence'>Otherwise, if at least one <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering</span>,
<span class='texttt'>U</span> is <span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering</span> (<a href='cmp.partialord'>[cmp.partialord]</a>)<a class='hidden_link' href='#class.spaceship-4.4.sentence-1'>.</a></div></li><li id='class.spaceship-4.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.spaceship-4.5'>(4.5)</a></div><div id='class.spaceship-4.5.sentence-1' class='sentence'>Otherwise, if at least one <span class='texttt'>T</span><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>std&#x200b;::&#x200b;weak_&shy;ordering</span>,
<span class='texttt'>U</span> is <span class='texttt'>std&#x200b;::&#x200b;weak_&shy;ordering</span> (<a href='cmp.weakord'>[cmp.weakord]</a>)<a class='hidden_link' href='#class.spaceship-4.5.sentence-1'>.</a></div></li><li id='class.spaceship-4.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.spaceship-4.6'>(4.6)</a></div><div id='class.spaceship-4.6.sentence-1' class='sentence'>Otherwise, <span class='texttt'>U</span> is <a href='cmp.strongord'><span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering</span></a><a class='hidden_link' href='#class.spaceship-4.6.sentence-1'>.</a></div> <div id='class.spaceship-4.6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#class.spaceship-4.6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='class.spaceship-4.6.sentence-2' class='sentence'>In particular, this is the result when <span class='math'><span class='mathalpha'>n</span></span> is 0<a class='hidden_link' href='#class.spaceship-4.6.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul></div></div></div><div id='class.rel.eq' class='section'><h3 ><a class='secnum' href='#class.rel.eq' style='min-width:103pt'>15.9.3</a> Other comparison operators <a class='abbr_ref' href='class.rel.eq'>[class.rel.eq]</a></h3><span class='indexparent'><a class='index' id=':operator,relational,defaulted'></a></span><span class='indexparent'><a class='index' id=':operator,equality,defaulted'></a></span><span class='indexparent'><a class='index' id=':operator,inequality,defaulted'></a></span><div class='para' id='class.rel.eq-1'><div class='marginalizedparent'><a class='marginalized' href='#class.rel.eq-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3441'>#</a></div><div id='class.rel.eq-1.sentence-1' class='sentence'>A defaulted relational (<a href='expr.rel'>[expr.rel]</a>) or equality (<a href='expr.eq'>[expr.eq]</a>) operator function
for some operator <span class='texttt'>@</span>
shall have a declared return type <span class='texttt'>bool</span><a class='hidden_link' href='#class.rel.eq-1.sentence-1'>.</a></div></div><div class='para' id='class.rel.eq-2'><div class='marginalizedparent'><a class='marginalized' href='#class.rel.eq-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3446'>#</a></div><div id='class.rel.eq-2.sentence-1' class='sentence'>The operator function with parameters <span class='texttt'>x</span> and <span class='texttt'>y</span>
is defined as deleted if</div><div id='class.rel.eq-2.sentence-2' class='sentence'><ul class='itemize'><li id='class.rel.eq-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.rel.eq-2.1'>(2.1)</a></div><div id='class.rel.eq-2.1.sentence-1' class='sentence'>overload resolution (<a href='over.match'>[over.match]</a>),
as applied to <span class='texttt'>x &lt;=&gt; y</span>
(also considering synthesized candidates with reversed order of parameters (<a href='over.match.oper'>[over.match.oper]</a>)),
results in an ambiguity
or a function that is deleted or inaccessible from the operator function,
or</div></li><li id='class.rel.eq-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#class.rel.eq-2.2'>(2.2)</a></div><div id='class.rel.eq-2.2.sentence-1' class='sentence'>the operator <span class='texttt'>@</span>
cannot be applied to the return type of <span class='texttt'>x &lt;=&gt; y</span> or <span class='texttt'>y &lt;=&gt; x</span><a class='hidden_link' href='#class.rel.eq-2.2.sentence-1'>.</a></div></li></ul></div><div id='class.rel.eq-2.sentence-3' class='sentence'>Otherwise, the operator function yields
<span class='texttt'>x &lt;=&gt; y @ 0</span>
if an <span class='texttt'>operator&lt;=&gt;</span>
with the original order of parameters was selected, or
<span class='texttt'>0 @ y &lt;=&gt; x</span>
otherwise<a class='hidden_link' href='#class.rel.eq-2.sentence-3'>.</a></div></div><div class='para' id='class.rel.eq-3'><div class='marginalizedparent'><a class='marginalized' href='#class.rel.eq-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7231f47876a82200e7eeb000a1e90f0af19cdab1/source/special.tex#L3471'>#</a></div><div id='class.rel.eq-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#class.rel.eq-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct C {
  friend std::strong_equality operator&lt;=&gt;(const C&amp;, const C&amp;);
  friend bool operator==(const C&amp; x, const C&amp; y) = default; <span class='comment'>// OK, returns <span class='tcode_in_codeblock'>x &lt;=&gt; y == 0</span>
</span>  bool operator&lt;(const C&amp;) = default;                       <span class='comment'>// OK, function is deleted
</span>};</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div></div></body></html>