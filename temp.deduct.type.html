<!DOCTYPE html><html lang='en'><head><title>[temp.deduct.type]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>17</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>17.9</a> Function template specializations <a class='abbr_ref' href='temp.fct.spec#temp.deduct.type'>[temp.fct.spec]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>17.9.2</a> Template argument deduction <a class='abbr_ref' href='temp.deduct#type'>[temp.deduct]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>17.9.2.5</a> Deducing template arguments from a type <a class='abbr_ref'>[temp.deduct.type]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L7853'>#</a></div><div id='1.sentence-1' class='sentence'>Template arguments can be deduced in several different contexts, but
in each case a type that is specified in terms of template parameters
(call it
<span class='texttt'>P</span>)
is compared with an actual type (call it
<span class='texttt'>A</span>),
and an attempt is made to find template argument values (a type for a type
parameter, a value for a non-type parameter, or a template for a
template parameter) that will make
<span class='texttt'>P</span>,
after substitution of the deduced values (call it the deduced
<span class='texttt'>A</span>),
compatible with
<span class='texttt'>A</span><a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L7869'>#</a></div><div id='2.sentence-1' class='sentence'>In some cases, the deduction is done using a single set of types
<span class='texttt'>P</span>
and
<span class='texttt'>A</span>,
in other cases, there will be a set of corresponding types
<span class='texttt'>P</span>
and
<span class='texttt'>A</span><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Type deduction is done
independently for each
<span class='texttt'>P/A</span>
pair, and the deduced template
argument values are then combined<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>If type deduction cannot be done
for any
<span class='texttt'>P/A</span>
pair, or if for any pair the deduction leads to more than
one possible set of deduced values, or if different pairs yield
different deduced values, or if any template argument remains neither
deduced nor explicitly specified, template argument deduction fails<a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'>The type of a type parameter
is only deduced from an array bound
if it is not otherwise deduced<a class='hidden_link' href='#2.sentence-4'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L7894'>#</a></div><div id='3.sentence-1' class='sentence'>A given type
<span class='texttt'>P</span>
can be composed from a number of other
types, templates, and non-type values:</div><div id='3.sentence-2' class='sentence'><ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><div id='3.1.sentence-1' class='sentence'>A function type includes the types of each of the function parameters
and the return type<a class='hidden_link' href='#3.1.sentence-1'>.</a></div></li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div><div id='3.2.sentence-1' class='sentence'>A pointer to member type includes the type of the class object pointed to
and the type of the member pointed to<a class='hidden_link' href='#3.2.sentence-1'>.</a></div></li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div><div id='3.3.sentence-1' class='sentence'>A type that is a specialization of a class template (e.g.,
<span class='texttt'>A&lt;int&gt;</span>)
includes the types, templates, and non-type values referenced by the
template argument list of the specialization<a class='hidden_link' href='#3.3.sentence-1'>.</a></div></li><li id='3.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.4'>(3.4)</a></div><div id='3.4.sentence-1' class='sentence'>An array type includes the array element type and the value of the
array bound<a class='hidden_link' href='#3.4.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L7917'>#</a></div><div id='4.sentence-1' class='sentence'>In most cases, the types, templates, and non-type values that are used
to compose
<span class='texttt'>P</span>
participate in template argument deduction<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>That is,
they may be used to determine the value of a template argument, and
template argument deduction fails if
the value so determined is not consistent with the values determined
elsewhere<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>In certain contexts, however, the value does not
participate in type deduction, but instead uses the values of template
arguments that were either deduced elsewhere or explicitly specified<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>If a template parameter is used only in non-deduced contexts and is not
explicitly specified, template argument deduction fails<a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='4.sentence-5' class='sentence'>Under <a href='temp.deduct.call'>[temp.deduct.call]</a> and <a href='temp.deduct.partial'>[temp.deduct.partial]</a>,
if <span class='texttt'>P</span> contains no <i ><a href='temp.param#nt:template-parameter'>template-parameter</a></i><span class='textit'>s</span> that appear
in deduced contexts, no deduction is done, so <span class='texttt'>P</span> and <span class='texttt'>A</span>
need not have the same form<a class='hidden_link' href='#4.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L7939'>#</a></div><div id='5.sentence-1' class='sentence'>The non-deduced contexts are:</div><div id='5.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':context,non-deduced'></a></span><ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><div id='5.1.sentence-1' class='sentence'>The
<i ><a href='expr.prim.id.qual#nt:nested-name-specifier'>nested-name-specifier</a></i>
of a type that was specified using a
<i ><a href='expr.prim.id.qual#nt:qualified-id'>qualified-id</a></i><a class='hidden_link' href='#5.1.sentence-1'>.</a></div></li><li id='5.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.2'>(5.2)</a></div><div id='5.2.sentence-1' class='sentence'>The <i ><a href='expr.comma#nt:expression'>expression</a></i> of a <i ><a href='dcl.type.simple#nt:decltype-specifier'>decltype-specifier</a></i><a class='hidden_link' href='#5.2.sentence-1'>.</a></div></li><li id='5.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.3'>(5.3)</a></div><div id='5.3.sentence-1' class='sentence'>A non-type template argument or an array bound in which a subexpression
references a template parameter<a class='hidden_link' href='#5.3.sentence-1'>.</a></div></li><li id='5.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.4'>(5.4)</a></div><div id='5.4.sentence-1' class='sentence'>A template parameter used in the parameter type of a function parameter that
has a default argument that is being used in the call for which argument
deduction is being done<a class='hidden_link' href='#5.4.sentence-1'>.</a></div></li><li id='5.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.5'>(5.5)</a></div><div id='5.5.sentence-1' class='sentence'>A function parameter for which argument deduction cannot be done because the
associated function argument is a function, or a set of overloaded
functions (<a href='over.over'>[over.over]</a>), and one or more of the following apply:
<ul class='itemize'><li id='5.5.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#5.5.1'>(5.5.1)</a></div><div id='5.5.1.sentence-1' class='sentence'>more than one function matches the function parameter type (resulting in
an ambiguous deduction), or</div></li><li id='5.5.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#5.5.2'>(5.5.2)</a></div><div id='5.5.2.sentence-1' class='sentence'>no function matches the function parameter type, or</div></li><li id='5.5.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#5.5.3'>(5.5.3)</a></div><div id='5.5.3.sentence-1' class='sentence'>the set of functions supplied as an argument contains one or more function templates<a class='hidden_link' href='#5.5.3.sentence-1'>.</a></div></li></ul></div></li><li id='5.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.6'>(5.6)</a></div><div id='5.6.sentence-1' class='sentence'>A function parameter for which the associated argument is an initializer
list (<a href='dcl.init.list'>[dcl.init.list]</a>) but the parameter does not have
a type for which deduction from an initializer list is specified (<a href='temp.deduct.call'>[temp.deduct.call]</a>)<a class='hidden_link' href='#5.6.sentence-1'>.</a></div> <div id='5.6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#5.6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class T&gt; void g(T);
g({1,2,3});                 <span class='comment'>// error: no argument deduced for <span class='tcode_in_codeblock'>T</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </li><li id='5.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.7'>(5.7)</a></div><div id='5.7.sentence-1' class='sentence'>A function parameter pack that does not occur at the end of the
<i ><a href='dcl.fct#nt:parameter-declaration-list'>parameter-declaration-list</a></i><a class='hidden_link' href='#5.7.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L7984'>#</a></div><div id='6.sentence-1' class='sentence'>When a type name is specified in a way that includes a non-deduced
context, all of the types that comprise that type name are also
non-deduced<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>However, a compound type can include both deduced and non-deduced types<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='6.sentence-3' class='sentence'>If a type is specified as
<span class='texttt'>A&lt;T&gt;&#x200b;::&#x200b;B&lt;T2&gt;</span>,
both
<span class='texttt'>T</span>
and
<span class='texttt'>T2</span>
are non-deduced<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.sentence-4' class='sentence'>Likewise, if a type is specified as
<span class='texttt'>A&lt;I+J&gt;&#x200b;::&#x200b;X&lt;T&gt;</span>,
<span class='texttt'>I</span>,
<span class='texttt'>J</span>,
and
<span class='texttt'>T</span>
are non-deduced<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='6.sentence-5' class='sentence'>If a type is specified as
<span class='texttt'>void</span>
<span class='texttt'>f(typename</span>
<span class='texttt'>A&lt;T&gt;&#x200b;::&#x200b;B,</span>
<span class='texttt'>A&lt;T&gt;)</span>,
the
<span class='texttt'>T</span>
in
<span class='texttt'>A&lt;T&gt;&#x200b;::&#x200b;B</span>
is non-deduced but
the
<span class='texttt'>T</span>
in
<span class='texttt'>A&lt;T&gt;</span>
is deduced<a class='hidden_link' href='#6.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8021'>#</a></div><div id='7.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='7.sentence-1' class='sentence'>Here is an example in which different parameter/argument pairs produce
inconsistent template argument deductions:</div><pre class='codeblock'>
template&lt;class T&gt; void f(T x, T y) { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> }
struct A { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
struct B : A { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
void g(A a, B b) {
  f(a,b);           <span class='comment'>// error: <span class='tcode_in_codeblock'>T</span> could be <span class='tcode_in_codeblock'>A</span> or <span class='tcode_in_codeblock'>B</span>
</span>  f(b,a);           <span class='comment'>// error: <span class='tcode_in_codeblock'>T</span> could be <span class='tcode_in_codeblock'>A</span> or <span class='tcode_in_codeblock'>B</span>
</span>  f(a,a);           <span class='comment'>// OK: <span class='tcode_in_codeblock'>T</span> is <span class='tcode_in_codeblock'>A</span>
</span>  f(b,b);           <span class='comment'>// OK: <span class='tcode_in_codeblock'>T</span> is <span class='tcode_in_codeblock'>B</span>
</span>}</pre><div id='7.sentence-2' class='sentence'>Here is an example where two template arguments are deduced from a
single function parameter/argument pair<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>This can lead to conflicts
that cause type deduction to fail:</div><pre class='codeblock'>
template &lt;class T, class U&gt; void f(  T (*)( T, U, U )  );

int g1( int, float, float);
char g2( int, float, float);
int g3( int, char, float);

void r() {
  f(g1);            <span class='comment'>// OK: <span class='tcode_in_codeblock'>T</span> is <span class='tcode_in_codeblock'>int</span> and <span class='tcode_in_codeblock'>U</span> is <span class='tcode_in_codeblock'>float</span>
</span>  f(g2);            <span class='comment'>// error: <span class='tcode_in_codeblock'>T</span> could be <span class='tcode_in_codeblock'>char</span> or <span class='tcode_in_codeblock'>int</span>
</span>  f(g3);            <span class='comment'>// error: <span class='tcode_in_codeblock'>U</span> could be <span class='tcode_in_codeblock'>char</span> or <span class='tcode_in_codeblock'>float</span>
</span>}</pre><div id='7.sentence-4' class='sentence'>Here is an example where a qualification conversion applies between the
argument type on the function call and the deduced template argument type:</div><pre class='codeblock'>
template&lt;class T&gt; void f(const T*) { }
int* p;
void s() {
  f(p);             <span class='comment'>// <span class='tcode_in_codeblock'>f(const int*)</span>
</span>}</pre><div id='7.sentence-5' class='sentence'>Here is an example where the template argument is used to instantiate
a derived class type of the corresponding function parameter type:</div><pre class='codeblock'>
template &lt;class T&gt; struct B { };
template &lt;class T&gt; struct D : public B&lt;T&gt; {};
struct D2 : public B&lt;int&gt; {};
template &lt;class T&gt; void f(B&lt;T&gt;&amp;){}
void t() {
  D&lt;int&gt; d;
  D2     d2;
  f(d);             <span class='comment'>// calls <span class='tcode_in_codeblock'>f(B&lt;int&gt;&amp;)</span>
</span>  f(d2);            <span class='comment'>// calls <span class='tcode_in_codeblock'>f(B&lt;int&gt;&amp;)</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8085'>#</a></div><div id='8.sentence-1' class='sentence'>A template type argument
<span class='texttt'>T</span>,
a template template argument
<span class='texttt'>TT</span>
or a template non-type argument
<span class='texttt'>i</span>
can be deduced if
<span class='texttt'>P</span>
and
<span class='texttt'>A</span>
have one of the following forms:</div><pre class='codeblock'>
T
<span class='textit'>cv</span> T
T*
T&amp;
T&amp;&amp;
T[<span class='textit'>integer-constant</span>]
<span class='grammarterm'>template-name</span>&lt;T&gt;  <span class='textrm'>(where <span class='tcode_in_codeblock'><span class='grammarterm'>template-name</span></span> refers to a class template)</span>
<span class='textit'>type</span>(T)
T()
T(T)
T <span class='textit'>type</span>::*
<span class='textit'>type</span> T::*
T T::*
T (<span class='textit'>type</span>::*)()
<span class='textit'>type</span> (T::*)()
<span class='textit'>type</span> (<span class='textit'>type</span>::*)(T)
<span class='textit'>type</span> (T::*)(T)
T (<span class='textit'>type</span>::*)(T)
T (T::*)()
T (T::*)(T)
<span class='textit'>type</span>[i]
<span class='grammarterm'>template-name</span>&lt;i&gt;  <span class='textrm'>(where <span class='tcode_in_codeblock'><span class='grammarterm'>template-name</span></span> refers to a class template)</span>
TT&lt;T&gt;
TT&lt;i&gt;
TT&lt;&gt;</pre><div id='8.sentence-2' class='sentence'>where
<span class='texttt'>(T)</span>
represents
a parameter-type-list (<a href='dcl.fct'>[dcl.fct]</a>)
where at least one parameter type contains a
<span class='texttt'>T</span>,
and
<span class='texttt'>()</span>
represents
a parameter-type-list
where no parameter type contains a
<span class='texttt'>T</span><a class='hidden_link' href='#8.sentence-2'>.</a></div> <div id='8.sentence-3' class='sentence'>Similarly,
<span class='texttt'>&lt;T&gt;</span>
represents template argument lists where at least one argument contains a
<span class='texttt'>T</span>,
<span class='texttt'>&lt;i&gt;</span>
represents template argument lists where at least one argument contains an
<span class='texttt'>i</span>
and
<span class='texttt'>&lt;&gt;</span>
represents template argument lists where no argument contains a
<span class='texttt'>T</span>
or an
<span class='texttt'>i</span><a class='hidden_link' href='#8.sentence-3'>.</a></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8152'>#</a></div><div id='9.sentence-1' class='sentence'>If <span class='texttt'>P</span> has a form that contains <span class='texttt'>&lt;T&gt;</span>
or <span class='texttt'>&lt;i&gt;</span>, then each argument <span class="mjx-chtml"><span class="mjx-math" aria-label="\mathtt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> of the
respective template argument list of <span class='texttt'>P</span> is compared with the
corresponding argument <span class="mjx-chtml"><span class="mjx-math" aria-label="\mathtt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> of the corresponding
template argument list of <span class='texttt'>A</span><a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>If the template argument list
of <span class='texttt'>P</span> contains a pack expansion that is not the last
template argument, the entire template argument list is a non-deduced
context<a class='hidden_link' href='#9.sentence-2'>.</a></div> <div id='9.sentence-3' class='sentence'>If <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is a pack expansion, then the pattern
of <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is compared with each remaining argument in the
template argument list of <span class='texttt'>A</span><a class='hidden_link' href='#9.sentence-3'>.</a></div> <div id='9.sentence-4' class='sentence'>Each comparison deduces
template arguments for subsequent positions in the template parameter
packs expanded by <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span><a class='hidden_link' href='#9.sentence-4'>.</a></div> <div id='9.sentence-5' class='sentence'>During <a href='temp.deduct.partial'>partial ordering</a>, if <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> was
originally a pack expansion:</div><div id='9.sentence-6' class='sentence'><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.1'>(9.1)</a></div><div id='9.1.sentence-1' class='sentence'>if <span class='texttt'>P</span> does not contain a template argument corresponding to
<span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> then <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is ignored;</div></li><li id='9.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.2'>(9.2)</a></div><div id='9.2.sentence-1' class='sentence'>otherwise, if <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is not a pack expansion, template argument
deduction fails<a class='hidden_link' href='#9.2.sentence-1'>.</a></div></li></ul></div> <div id='9.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class T1, class... Z&gt; class S;                               <span class='comment'>// #1
</span>template&lt;class T1, class... Z&gt; class S&lt;T1, const Z&amp;...&gt; { };          <span class='comment'>// #2
</span>template&lt;class T1, class T2&gt;   class S&lt;T1, const T2&amp;&gt; { };            <span class='comment'>// #3
</span>S&lt;int, const int&amp;&gt; s;         <span class='comment'>// both #2 and #3 match; #3 is more specialized
</span>
template&lt;class T, class... U&gt;            struct A { };                <span class='comment'>// #1
</span>template&lt;class T1, class T2, class... U&gt; struct A&lt;T1, T2*, U...&gt; { }; <span class='comment'>// #2
</span>template&lt;class T1, class T2&gt;             struct A&lt;T1, T2&gt; { };        <span class='comment'>// #3
</span>template struct A&lt;int, int*&gt;; <span class='comment'>// selects #2
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8189'>#</a></div><div id='10.sentence-1' class='sentence'>Similarly, if <span class='texttt'>P</span> has a form that contains
<span class='texttt'>(T)</span>, then each parameter type <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span>
of the respective parameter-type-list (<a href='dcl.fct'>[dcl.fct]</a>) of
<span class='texttt'>P</span> is compared with the corresponding parameter type
<span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> of the corresponding parameter-type-list
of <span class='texttt'>A</span><a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'>If <span class='texttt'>P</span> and <span class='texttt'>A</span> are function types that originated from deduction when
taking the address of a function template (<a href='temp.deduct.funcaddr'>[temp.deduct.funcaddr]</a>) or when
deducing template arguments from a function declaration (<a href='temp.deduct.decl'>[temp.deduct.decl]</a>)
and <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> and <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> are parameters of the top-level
parameter-type-list of <span class='texttt'>P</span> and <span class='texttt'>A</span>, respectively,
<span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is adjusted if it is a forwarding reference (<a href='temp.deduct.call'>[temp.deduct.call]</a>)
and <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is an lvalue reference, in which case the type of
<span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is changed to be the template parameter type (i.e., <span class='texttt'>T&amp;&amp;</span> is
changed to simply <span class='texttt'>T</span>)<a class='hidden_link' href='#10.sentence-2'>.</a></div> <div id='10.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#10.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='10.sentence-3' class='sentence'>As a result, when <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>T&amp;&amp;</span>
and <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is <span class='texttt'>X&amp;</span>, the adjusted <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> will be <span class='texttt'>T</span>,
causing <span class='texttt'>T</span> to be deduced as <span class='texttt'>X&amp;</span><a class='hidden_link' href='#10.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='10.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#10.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template &lt;class T&gt; void f(T&amp;&amp;);
template &lt;&gt; void f(int&amp;) { }    <span class='comment'>// #1
</span>template &lt;&gt; void f(int&amp;&amp;) { }   <span class='comment'>// #2
</span>void g(int i) {
  f(i);                         <span class='comment'>// calls <span class='tcode_in_codeblock'>f&lt;int&amp;&gt;(int&amp;)</span>, i.e., #1
</span>  f(0);                         <span class='comment'>// calls <span class='tcode_in_codeblock'>f&lt;int&gt;(int&amp;&amp;)</span>, i.e., #2
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> <div id='10.sentence-4' class='sentence'>If the <i ><a href='dcl.fct#nt:parameter-declaration'>parameter-declaration</a></i>
corresponding to <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is a function parameter pack,
then the type of its <i ><a href='dcl.decl#nt:declarator-id'>declarator-id</a></i> is compared with
each remaining parameter type in the parameter-type-list
of <span class='texttt'>A</span><a class='hidden_link' href='#10.sentence-4'>.</a></div> <div id='10.sentence-5' class='sentence'>Each comparison deduces template arguments for
subsequent positions in the template parameter packs expanded by the
function parameter pack<a class='hidden_link' href='#10.sentence-5'>.</a></div> <div id='10.sentence-6' class='sentence'>During <a href='temp.deduct.partial'>partial ordering</a>, if <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> was
originally a function parameter pack:</div><div id='10.sentence-7' class='sentence'><ul class='itemize'><li id='10.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#10.1'>(10.1)</a></div><div id='10.1.sentence-1' class='sentence'>if <span class='texttt'>P</span> does not contain a function parameter type corresponding to
<span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> then <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{A}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;">A</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is ignored;</div></li><li id='10.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#10.2'>(10.2)</a></div><div id='10.2.sentence-1' class='sentence'>otherwise, if <span class="mjx-chtml"><span class="mjx-math" aria-label="\texttt{P}_i"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">P</span></span></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span> is not a function parameter pack, template
argument deduction fails<a class='hidden_link' href='#10.2.sentence-1'>.</a></div></li></ul></div> <div id='10.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#10.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class T, class... U&gt; void f(T*, U...) { }  <span class='comment'>// #1
</span>template&lt;class T&gt;             void f(T) { }         <span class='comment'>// #2
</span>template void f(int*);                              <span class='comment'>// selects #1
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8244'>#</a></div><div id='11.sentence-1' class='sentence'>These forms can be used in the same way as
<span class='texttt'>T</span>
is for further composition of types<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
X&lt;int&gt; (*)(char[6])</pre><div id='11.sentence-2' class='sentence'>is of the form</div><pre class='codeblock'>
<span class='grammarterm'>template-name</span>&lt;T&gt; (*)(<span class='textit'>type</span>[i])</pre><div id='11.sentence-3' class='sentence'>which is a variant of</div><pre class='codeblock'>
<span class='textit'>type</span> (*)(T)</pre><div id='11.sentence-4' class='sentence'>where type is
<span class='texttt'>X&lt;int&gt;</span>
and
<span class='texttt'>T</span>
is
<span class='texttt'>char[6]</span><a class='hidden_link' href='#11.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8274'>#</a></div><div id='12.sentence-1' class='sentence'>Template arguments cannot be deduced from function arguments involving
constructs other than the ones specified above<a class='hidden_link' href='#12.sentence-1'>.</a></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8278'>#</a></div><div id='13.sentence-1' class='sentence'>When the value of the argument
corresponding to a non-type template parameter <span class='texttt'>P</span>
that is declared with a dependent type
is deduced from an expression,
the template parameters in the type of <span class='texttt'>P</span>
are deduced from the type of the value<a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#13.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;long n&gt; struct A { };

template&lt;typename T&gt; struct C;
template&lt;typename T, T n&gt; struct C&lt;A&lt;n&gt;&gt; {
  using Q = T;
};

using R = long;
using R = C&lt;A&lt;2&gt;&gt;::Q;           <span class='comment'>// OK; <span class='tcode_in_codeblock'>T</span> was deduced to <span class='tcode_in_codeblock'>long</span> from the
</span>                                <span class='comment'>// template argument value in the type <span class='tcode_in_codeblock'>A&lt;2&gt;</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='13.sentence-2' class='sentence'>
The type of <span class='texttt'>N</span> in the type <span class='texttt'>T[N]</span> is <span class='texttt'>std&#x200b;::&#x200b;size_&shy;t</span><a class='hidden_link' href='#13.sentence-2'>.</a></div> <div id='13.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#13.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;typename T&gt; struct S;
template&lt;typename T, T n&gt; struct S&lt;int[n]&gt; {
  using Q = T;
};

using V = decltype(sizeof 0);
using V = S&lt;int[42]&gt;::Q;        <span class='comment'>// OK; <span class='tcode_in_codeblock'>T</span> was deduced to <span class='tcode_in_codeblock'>std&#x200b;::&#x200b;size_&shy;t</span> from the type <span class='tcode_in_codeblock'>int[42]</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8312'>#</a></div><div id='14.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class T, T i&gt; void f(int (&amp;a)[i]);
int v[10];
void g() {
  f(v);                         <span class='comment'>// OK: <span class='tcode_in_codeblock'>T</span> is <span class='tcode_in_codeblock'>std&#x200b;::&#x200b;size_&shy;t</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8323'>#</a></div><div id='15.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='15.sentence-1' class='sentence'>Except for reference and pointer types, a major array bound is not part of a
function parameter type and cannot be deduced from an argument:
<pre class='codeblock'>
template&lt;int i&gt; void f1(int a[10][i]);
template&lt;int i&gt; void f2(int a[i][20]);
template&lt;int i&gt; void f3(int (&amp;a)[i][20]);

void g() {
  int v[10][20];
  f1(v);                        <span class='comment'>// OK: <span class='tcode_in_codeblock'>i</span> deduced to be <span class='tcode_in_codeblock'>20</span>
</span>  f1&lt;20&gt;(v);                    <span class='comment'>// OK
</span>  f2(v);                        <span class='comment'>// error: cannot deduce template-argument <span class='tcode_in_codeblock'>i</span>
</span>  f2&lt;10&gt;(v);                    <span class='comment'>// OK
</span>  f3(v);                        <span class='comment'>// OK: <span class='tcode_in_codeblock'>i</span> deduced to be <span class='tcode_in_codeblock'>10</span>
</span>}</pre></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8343'>#</a></div><div id='16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='16.sentence-1' class='sentence'>If, in the declaration of a function template with a non-type
template parameter, the non-type template parameter
is used in a subexpression in the function parameter list,
the expression is a non-deduced context as specified above<a class='hidden_link' href='#16.sentence-1'>.</a></div> <div id='16.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#16.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template &lt;int i&gt; class A { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
template &lt;int i&gt; void g(A&lt;i+1&gt;);
template &lt;int i&gt; void f(A&lt;i&gt;, A&lt;i+1&gt;);
void k() {
  A&lt;1&gt; a1;
  A&lt;2&gt; a2;
  g(a1);                        <span class='comment'>// error: deduction fails for expression <span class='tcode_in_codeblock'>i+1</span>
</span>  g&lt;0&gt;(a1);                     <span class='comment'>// OK
</span>  f(a1, a2);                    <span class='comment'>// OK
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8365'>#</a></div><div id='17.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#17.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='17.sentence-1' class='sentence'>Template parameters do not participate in template argument deduction if
they are used only in non-deduced contexts<a class='hidden_link' href='#17.sentence-1'>.</a></div> <div id='17.sentence-2' class='sentence'>For example,</div><pre class='codeblock'>
template&lt;int i, typename T&gt;
T deduce(typename A&lt;T&gt;::X x,    <span class='comment'>// <span class='tcode_in_codeblock'>T</span> is not deduced here
</span>         T t,                   <span class='comment'>// but <span class='tcode_in_codeblock'>T</span> is deduced here
</span>         typename B&lt;i&gt;::Y y);   <span class='comment'>// <span class='tcode_in_codeblock'>i</span> is not deduced here
</span>A&lt;int&gt; a;
B&lt;77&gt;  b;

int    x = deduce&lt;77&gt;(a.xm, 62, b.ym);
<span class='comment'>// <span class='tcode_in_codeblock'>T</span> is deduced to be <span class='tcode_in_codeblock'>int</span>, <span class='tcode_in_codeblock'>a.xm</span> must be convertible to <span class='tcode_in_codeblock'>A&lt;int&gt;&#x200b;::&#x200b;X</span>
</span><span class='comment'>// <span class='tcode_in_codeblock'>i</span> is explicitly specified to be <span class='tcode_in_codeblock'>77</span>, <span class='tcode_in_codeblock'>b.ym</span> must be convertible to <span class='tcode_in_codeblock'>B&lt;77&gt;&#x200b;::&#x200b;Y</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8385'>#</a></div><div id='18.sentence-1' class='sentence'>If <span class='texttt'>P</span> has a form that contains <span class='texttt'>&lt;i&gt;</span>, and
if the type of <span class='texttt'>i</span> differs from the type
of the corresponding template parameter
of the template named by the enclosing <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>,
deduction fails<a class='hidden_link' href='#18.sentence-1'>.</a></div> <div id='18.sentence-2' class='sentence'>If <span class='texttt'>P</span> has a form that contains <span class='texttt'>[i]</span>, and if the type of
<span class='texttt'>i</span> is not an integral type, deduction fails<a class='hidden_link' href='#18.sentence-2'>.</a><a class='footnotenum' href='#footnote-143'>143</a></div> <div id='18.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#18.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;int i&gt; class A { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
template&lt;short s&gt; void f(A&lt;s&gt;);
void k1() {
  A&lt;1&gt; a;
  f(a);             <span class='comment'>// error: deduction fails for conversion from <span class='tcode_in_codeblock'>int</span> to <span class='tcode_in_codeblock'>short</span>
</span>  f&lt;1&gt;(a);          <span class='comment'>// OK
</span>}

template&lt;const short cs&gt; class B { };
template&lt;short s&gt; void g(B&lt;s&gt;);
void k2() {
  B&lt;1&gt; b;
  g(b);             <span class='comment'>// OK: cv-qualifiers are ignored on template parameter types
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8420'>#</a></div><div id='19.sentence-1' class='sentence'>A
<i ><a href='temp.names#nt:template-argument'>template-argument</a></i>
can be deduced from a function, pointer to function, or pointer to
member function type<a class='hidden_link' href='#19.sentence-1'>.</a></div><div style='height:0.6em;display:block'></div><div id='19.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#19.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class T&gt; void f(void(*)(T,int));
template&lt;class T&gt; void foo(T,int);
void g(int,int);
void g(char,int);

void h(int,int,int);
void h(char,int);
int m() {
  f(&amp;g);            <span class='comment'>// error: ambiguous
</span>  f(&amp;h);            <span class='comment'>// OK: void <span class='tcode_in_codeblock'>h(char,int)</span> is a unique match
</span>  f(&amp;foo);          <span class='comment'>// error: type deduction fails because <span class='tcode_in_codeblock'>foo</span> is a template
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8443'>#</a></div><div id='20.sentence-1' class='sentence'>A template
<i ><a href='temp.param#nt:type-parameter'>type-parameter</a></i>
cannot be deduced from the type of a function default argument<a class='hidden_link' href='#20.sentence-1'>.</a></div> <div id='20.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#20.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template &lt;class T&gt; void f(T = 5, T = 7);
void g() {
  f(1);             <span class='comment'>// OK: call <span class='tcode_in_codeblock'>f&lt;int&gt;(1,7)</span>
</span>  f();              <span class='comment'>// error: cannot deduce <span class='tcode_in_codeblock'>T</span>
</span>  f&lt;int&gt;();         <span class='comment'>// OK: call <span class='tcode_in_codeblock'>f&lt;int&gt;(5,7)</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8458'>#</a></div><div id='21.sentence-1' class='sentence'>The
<i ><a href='temp.names#nt:template-argument'>template-argument</a></i>
corresponding to a template
<i ><a href='temp.param#nt:template-parameter'>template-parameter</a></i>
is deduced from the type of the
<i ><a href='temp.names#nt:template-argument'>template-argument</a></i>
of a class template specialization used in the argument list of a function call<a class='hidden_link' href='#21.sentence-1'>.</a></div> <div id='21.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#21.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template &lt;template &lt;class T&gt; class X&gt; struct A { };
template &lt;template &lt;class T&gt; class X&gt; void f(A&lt;X&gt;) { }
template&lt;class T&gt; struct B { };
A&lt;B&gt; ab;
f(ab);              <span class='comment'>// calls <span class='tcode_in_codeblock'>f(A&lt;B&gt;)</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='22'><div class='marginalizedparent'><a class='marginalized' href='#22'>22</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d0d225c5bc338d256990fc20e415a2a617eb86c4/source/templates.tex#L8476'>#</a></div><div id='22.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#22.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='22.sentence-1' class='sentence'>Template argument deduction involving parameter
packs (<a href='temp.variadic'>[temp.variadic]</a>) can deduce zero or more arguments for
each parameter pack<a class='hidden_link' href='#22.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='22.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#22.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
template&lt;class&gt; struct X { };
template&lt;class R, class ... ArgTypes&gt; struct X&lt;R(int, ArgTypes ...)&gt; { };
template&lt;class ... Types&gt; struct Y { };
template&lt;class T, class ... Types&gt; struct Y&lt;T, Types&amp; ...&gt; { };

template&lt;class ... Types&gt; int f(void (*)(Types ...));
void g(int, float);

X&lt;int&gt; x1;                      <span class='comment'>// uses primary template
</span>X&lt;int(int, float, double)&gt; x2;  <span class='comment'>// uses partial specialization; <span class='tcode_in_codeblock'>ArgTypes</span> contains <span class='tcode_in_codeblock'>float</span>, <span class='tcode_in_codeblock'>double</span>
</span>X&lt;int(float, int)&gt; x3;          <span class='comment'>// uses primary template
</span>Y&lt;&gt; y1;                         <span class='comment'>// use primary template; <span class='tcode_in_codeblock'>Types</span> is empty
</span>Y&lt;int&amp;, float&amp;, double&amp;&gt; y2;    <span class='comment'>// uses partial specialization; <span class='tcode_in_codeblock'>T</span> is <span class='tcode_in_codeblock'>int&amp;</span>, <span class='tcode_in_codeblock'>Types</span> contains <span class='tcode_in_codeblock'>float</span>, <span class='tcode_in_codeblock'>double</span>
</span>Y&lt;int, float, double&gt; y3;       <span class='comment'>// uses primary template; <span class='tcode_in_codeblock'>Types</span> contains <span class='tcode_in_codeblock'>int</span>, <span class='tcode_in_codeblock'>float</span>, <span class='tcode_in_codeblock'>double</span>
</span>int fv = f(g);                  <span class='comment'>// OK; <span class='tcode_in_codeblock'>Types</span> contains <span class='tcode_in_codeblock'>int</span>, <span class='tcode_in_codeblock'>float</span>
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='footnote' id='footnote-143'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-143'>143)</a></div><div id='footnote-143.sentence-1' class='sentence'>Although the
<i ><a href='temp.names#nt:template-argument'>template-argument</a></i>
corresponding to a
<i ><a href='temp.param#nt:template-parameter'>template-parameter</a></i>
of type
<span class='texttt'>bool</span>
may be deduced from an array bound, the resulting value will always be
<span class='texttt'>true</span>
because the array bound will be nonzero<a class='hidden_link' href='#footnote-143.sentence-1'>.</a></div></div></div></body></html>