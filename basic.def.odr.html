<!DOCTYPE html><html lang='en'><head><title>[basic.def.odr]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>6.2</a> One-definition rule <a class='abbr_ref'>[basic.def.odr]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L278'>#</a></div><div id='1.sentence-1' class='sentence'>No translation unit shall contain more than one definition of any
variable, function, class type, enumeration type, or template<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L282'>#</a></div><div id='2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':expression,potentially_evaluated'></a></span>An expression is <a class='hidden_link' href='#def:potentially_evaluated' id='def:potentially_evaluated'><i >potentially evaluated</i></a> unless it is an
<a href='expr.prop#def:unevaluated_operand'>unevaluated operand</a> or a subexpression thereof<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>The set of <a class='hidden_link' href='#def:potential_results' id='def:potential_results'><i >potential results</i></a> of an expression <span class='texttt'>e</span> is
defined as follows:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div><div id='2.1.sentence-1' class='sentence'>If <span class='texttt'>e</span> is an
<i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i>, the set
contains only <span class='texttt'>e</span><a class='hidden_link' href='#2.1.sentence-1'>.</a></div></li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div><div id='2.2.sentence-1' class='sentence'>If <span class='texttt'>e</span> is a <a href='expr.sub'>subscripting operation</a> with
an array operand, the set contains the potential results of that operand<a class='hidden_link' href='#2.2.sentence-1'>.</a></div></li><li id='2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.3'>(2.3)</a></div><div id='2.3.sentence-1' class='sentence'>If <span class='texttt'>e</span> is a <a href='expr.ref'>class member access</a> expression,
the set contains the potential results of
the object expression<a class='hidden_link' href='#2.3.sentence-1'>.</a></div></li><li id='2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.4'>(2.4)</a></div><div id='2.4.sentence-1' class='sentence'>If <span class='texttt'>e</span> is a <a href='expr.mptr.oper'>pointer-to-member</a>
expression whose second operand is a constant
expression, the set contains the potential results of the object
expression<a class='hidden_link' href='#2.4.sentence-1'>.</a></div></li><li id='2.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.5'>(2.5)</a></div><div id='2.5.sentence-1' class='sentence'>If <span class='texttt'>e</span> has the form <span class='texttt'>(e1)</span>, the set contains the
potential results of <span class='texttt'>e1</span><a class='hidden_link' href='#2.5.sentence-1'>.</a></div></li><li id='2.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.6'>(2.6)</a></div><div id='2.6.sentence-1' class='sentence'>If <span class='texttt'>e</span> is a glvalue <a href='expr.cond'>conditional</a>
expression, the set is the union of the sets of
potential results of the second and third operands<a class='hidden_link' href='#2.6.sentence-1'>.</a></div></li><li id='2.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.7'>(2.7)</a></div><div id='2.7.sentence-1' class='sentence'>If <span class='texttt'>e</span> is a <a href='expr.comma'>comma expression</a>, the set
contains the potential results of the right operand<a class='hidden_link' href='#2.7.sentence-1'>.</a></div></li><li id='2.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.8'>(2.8)</a></div><div id='2.8.sentence-1' class='sentence'>Otherwise, the set is empty<a class='hidden_link' href='#2.8.sentence-1'>.</a></div></li></ul></div> <div id='2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-3' class='sentence'>This set is a (possibly-empty) set of <i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i><span class='textit'>s</span>,
each of which is either <span class='texttt'>e</span> or a subexpression of <span class='texttt'>e</span><a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='2.sentence-4' class='sentence'>In the following example, the set of potential results of the initializer
of <span class='texttt'>n</span> contains the first <span class='texttt'>S&#x200b;::&#x200b;x</span> subexpression, but not the second
<span class='texttt'>S&#x200b;::&#x200b;x</span> subexpression<a class='hidden_link' href='#2.sentence-4'>.</a></div> <pre class='codeblock'>
struct S { static const int x = 0; };
const int &amp;f(const int &amp;r);
int n = b ? (1, S::x)           <span class='comment'>// <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;x</span> is not odr-used here
</span>          : f(S::x);            <span class='comment'>// <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;x</span> is odr-used here, so a definition is required
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L326'>#</a></div><div id='3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':function,named_by_an_expression'></a></span>A function is <a class='hidden_link' href='#def:named_by_an_expression' id='def:named_by_an_expression'><i >named by an expression</i></a> as follows:
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><div id='3.1.sentence-1' class='sentence'>A function whose name appears in an expression
  is named by that expression
  if it is the unique lookup result or the selected member
  of a set of overloaded functions (<a href='basic.lookup'>[basic.lookup]</a>, <a href='over.match'>[over.match]</a>, <a href='over.over'>[over.over]</a>),
  unless it is a pure virtual function and either
  its name is not explicitly qualified or
  the expression forms a pointer to member (<a href='expr.unary.op'>[expr.unary.op]</a>)<a class='hidden_link' href='#3.1.sentence-1'>.</a></div> <div id='3.1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#3.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.1.sentence-2' class='sentence'>This covers
  taking the address of functions (<a href='conv.func'>[conv.func]</a>, <a href='expr.unary.op'>[expr.unary.op]</a>),
  calls to named functions (<a href='expr.call'>[expr.call]</a>),
  operator overloading (<a href='over'>[over]</a>),
  user-defined conversions (<a href='class.conv.fct'>[class.conv.fct]</a>),
  allocation functions for placement <i ><a href='expr.new#nt:new-expression'>new-expression</a></i><span class='textit'>s</span>, as well as
  non-default initialization (<a href='dcl.init'>[dcl.init]</a>)<a class='hidden_link' href='#3.1.sentence-2'>.</a></div> <div id='3.1.sentence-3' class='sentence'>A constructor selected to copy or move an object of class type
  is considered to be named by an expression
  even if the call is actually elided by the implementation (<a href='class.copy'>[class.copy]</a>)<a class='hidden_link' href='#3.1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div><div id='3.2.sentence-1' class='sentence'>An allocation or deallocation function for a class
  is named by a <i ><a href='expr.new#nt:new-expression'>new-expression</a></i>
  as specified in <a href='expr.new'>[expr.new]</a> and <a href='class.free'>[class.free]</a><a class='hidden_link' href='#3.2.sentence-1'>.</a></div></li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div><div id='3.3.sentence-1' class='sentence'>A deallocation function for a class
  is named by a delete expression
  as specified in <a href='expr.delete'>[expr.delete]</a> and <a href='class.free'>[class.free]</a><a class='hidden_link' href='#3.3.sentence-1'>.</a></div></li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L358'>#</a></div><div id='4.sentence-1' class='sentence'>A variable <span class='texttt'>x</span> whose name appears as a
potentially-evaluated expression <span class='texttt'>ex</span> is <a class='hidden_link' href='#def:odr-used' id='def:odr-used'><i >odr-used</i></a> by <span class='texttt'>ex</span> unless
applying the <a href='conv.lval'>lvalue-to-rvalue conversion</a> to <span class='texttt'>x</span> yields
a <a href='expr.const'>constant expression</a> that does not invoke any non-trivial
functions
and, if <span class='texttt'>x</span> is an object, <span class='texttt'>ex</span> is an element of
the set of potential results of an expression <span class='texttt'>e</span>, where either the lvalue-to-rvalue
conversion (<a href='conv.lval'>[conv.lval]</a>) is applied to <span class='texttt'>e</span>, or <span class='texttt'>e</span> is
a discarded-value expression (<a href='expr.prop'>[expr.prop]</a>)<a class='hidden_link' href='#4.sentence-1'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L369'>#</a></div><div id='5.sentence-1' class='sentence'>A structured binding is odr-used if it appears as a potentially-evaluated expression<a class='hidden_link' href='#5.sentence-1'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L372'>#</a></div><div id='6.sentence-1' class='sentence'><span class='texttt'>*this</span> is odr-used if <span class='texttt'>this</span> appears as a potentially-evaluated expression
(including as the result of the implicit transformation in the body of a non-static
member function (<a href='class.mfct.non-static'>[class.mfct.non-static]</a>))<a class='hidden_link' href='#6.sentence-1'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L377'>#</a></div><div id='7.sentence-1' class='sentence'>A virtual member
function is odr-used if it is not pure<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>A function is odr-used if it is named by a potentially-evaluated expression<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.sentence-3' class='sentence'>A non-placement allocation or deallocation
function for a class is odr-used by the definition of a constructor of that
class<a class='hidden_link' href='#7.sentence-3'>.</a></div> <div id='7.sentence-4' class='sentence'>A non-placement deallocation function for a class is odr-used by the
definition of the destructor of that class, or by being selected by the
lookup at the point of definition of a virtual
destructor (<a href='class.dtor'>[class.dtor]</a>)<a class='hidden_link' href='#7.sentence-4'>.</a><a class='footnotenum' href='#footnote-22'>22</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L391'>#</a></div><div id='8.sentence-1' class='sentence'>An assignment operator function in a class is odr-used by an
implicitly-defined
copy-assignment or move-assignment function for another class as specified
in <a href='class.copy'>[class.copy]</a><a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>A constructor for a class is odr-used as specified
in <a href='dcl.init'>[dcl.init]</a><a class='hidden_link' href='#8.sentence-2'>.</a></div> <div id='8.sentence-3' class='sentence'>A destructor for a class is odr-used if it is
<a href='class.dtor#def:potentially_invoked'>potentially invoked</a><a class='hidden_link' href='#8.sentence-3'>.</a></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L400'>#</a></div><div id='9.sentence-1' class='sentence'>A local entity (<a href='basic'>[basic]</a>)
is <a class='hidden_link' href='#def:odr-usable' id='def:odr-usable'><i >odr-usable</i></a> in a declarative region (<a href='basic.scope.declarative'>[basic.scope.declarative]</a>) if:</div><div id='9.sentence-2' class='sentence'><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.1'>(9.1)</a></div><div id='9.1.sentence-1' class='sentence'>the local entity is either
not <span class='texttt'>*this</span>, or
an enclosing class or non-lambda function parameter scope exists and,
if the innermost such scope is a function parameter scope,
it corresponds to a non-static member function, and</div></li><li id='9.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.2'>(9.2)</a></div><div id='9.2.sentence-1' class='sentence'>for each intervening declarative region (<a href='basic.scope.declarative'>[basic.scope.declarative]</a>)
between the point at which the entity is introduced and the region
(where <span class='texttt'>*this</span> is considered to be introduced
within the innermost enclosing class or non-lambda function definition scope),
either:
<ul class='itemize'><li id='9.2.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#9.2.1'>(9.2.1)</a></div><div id='9.2.1.sentence-1' class='sentence'>the declarative region is a block scope, or</div></li><li id='9.2.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#9.2.2'>(9.2.2)</a></div><div id='9.2.2.sentence-1' class='sentence'>the declarative region is the function parameter scope of a <i ><a href='expr.prim.lambda#nt:lambda-expression'>lambda-expression</a></i>
that has a <i ><a href='expr.prim.lambda.capture#nt:simple-capture'>simple-capture</a></i> naming the entity or has a <i ><a href='expr.prim.lambda.capture#nt:capture-default'>capture-default</a></i><a class='hidden_link' href='#9.2.2.sentence-1'>.</a></div></li></ul></div></li></ul></div><div id='9.sentence-3' class='sentence'>If a local entity is odr-used
in a declarative region in which it is not odr-usable,
the program is ill-formed<a class='hidden_link' href='#9.sentence-3'>.</a></div> <div id='9.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
void f(int n) {
  [] { n = 1; };                <span class='comment'>// error, <span class='tcode_in_codeblock'>n</span> is not odr-usable due to intervening lambda-expression
</span>  struct A {
    void f() { n = 2; }         <span class='comment'>// error, <span class='tcode_in_codeblock'>n</span> is not odr-usable due to intervening function definition scope
</span>  };
  void g(int = n);              <span class='comment'>// error, <span class='tcode_in_codeblock'>n</span> is not odr-usable due to intervening function parameter scope
</span>  [&amp;] { [n]{ return n; }; };    <span class='comment'>// OK
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L439'>#</a></div><div id='10.sentence-1' class='sentence'>Every program shall contain exactly one definition of every non-inline
function or variable that is odr-used in that program
outside of a <a href='stmt.if#def:discarded_statement'>discarded statement</a>; no diagnostic required<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'>The definition can appear explicitly in the program, it can be found in
the standard or a user-defined library, or (when appropriate) it is
implicitly defined (see <a href='class.ctor'>[class.ctor]</a>, <a href='class.dtor'>[class.dtor]</a> and
<a href='class.copy'>[class.copy]</a>)<a class='hidden_link' href='#10.sentence-2'>.</a></div> <div id='10.sentence-3' class='sentence'>An inline function or variable shall be defined in every
translation unit in which it is odr-used outside of a discarded statement<a class='hidden_link' href='#10.sentence-3'>.</a></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L449'>#</a></div><div id='11.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':type,incomplete'></a></span>Exactly one definition of a class is required in a translation unit if
the class is used in a way that requires the class type to be complete<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#11.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='11.sentence-2' class='sentence'>The following complete translation unit is well-formed,
even though it never defines <span class='texttt'>X</span>:
<pre class='codeblock'>
struct X;                       <span class='comment'>// declare <span class='tcode_in_codeblock'>X</span> as a struct type
</span>struct X* x1;                   <span class='comment'>// use <span class='tcode_in_codeblock'>X</span> in pointer formation
</span>X* x2;                          <span class='comment'>// use <span class='tcode_in_codeblock'>X</span> in pointer formation
</span></pre></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='11.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='11.sentence-3' class='sentence'>The rules for declarations and expressions
describe in which contexts complete class types are required<a class='hidden_link' href='#11.sentence-3'>.</a></div> <div id='11.sentence-4' class='sentence'>A class
type <span class='texttt'>T</span> must be complete if:
<ul class='itemize'><li id='11.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.1'>(11.1)</a></div><div id='11.1.sentence-1' class='sentence'>an object of type <span class='texttt'>T</span> is <a href='basic.def'>defined</a>, or</div></li><li id='11.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.2'>(11.2)</a></div><div id='11.2.sentence-1' class='sentence'>a non-static class <a href='class.mem#def:data_member'>data member</a> of
type <span class='texttt'>T</span> is declared, or</div></li><li id='11.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.3'>(11.3)</a></div><div id='11.3.sentence-1' class='sentence'><span class='texttt'>T</span> is used as the allocated type or array element type in a
<i ><a href='expr.new#nt:new-expression'>new-expression</a></i>, or</div></li><li id='11.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.4'>(11.4)</a></div><div id='11.4.sentence-1' class='sentence'>an lvalue-to-rvalue conversion is applied to
a glvalue referring
to an object of type <span class='texttt'>T</span> (<a href='conv.lval'>[conv.lval]</a>), or</div></li><li id='11.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.5'>(11.5)</a></div><div id='11.5.sentence-1' class='sentence'>an expression is converted (either implicitly or explicitly) to
type <span class='texttt'>T</span> (<a href='conv'>[conv]</a>, <a href='expr.type.conv'>[expr.type.conv]</a>,
<a href='expr.dynamic.cast'>[expr.dynamic.cast]</a>, <a href='expr.static.cast'>[expr.static.cast]</a>, <a href='expr.cast'>[expr.cast]</a>), or</div></li><li id='11.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.6'>(11.6)</a></div><div id='11.6.sentence-1' class='sentence'>an expression that is not a null pointer constant, and has type
other than <span class='mathit'>cv</span> <span class='texttt'>void*</span>, is converted to the type pointer to <span class='texttt'>T</span>
or reference to <span class='texttt'>T</span> using a <a href='conv'>standard conversion</a>,
a <a href='expr.dynamic.cast'><span class='texttt'>dynamic_&shy;cast</span></a> or
a <a href='expr.static.cast'><span class='texttt'>static_&shy;cast</span></a>, or</div></li><li id='11.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.7'>(11.7)</a></div><div id='11.7.sentence-1' class='sentence'>a <a href='expr.ref'>class member access</a> operator is applied to an expression of type
<span class='texttt'>T</span>, or</div></li><li id='11.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.8'>(11.8)</a></div><div id='11.8.sentence-1' class='sentence'>the <a href='expr.typeid'><span class='texttt'>typeid</span> operator</a> or the
<a href='expr.sizeof'><span class='texttt'>sizeof</span> operator</a> is applied to an operand of
type <span class='texttt'>T</span>, or</div></li><li id='11.9'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.9'>(11.9)</a></div><div id='11.9.sentence-1' class='sentence'>a function with a return type or argument type of type <span class='texttt'>T</span>
is defined (<a href='basic.def'>[basic.def]</a>) or <a href='expr.call'>called</a>, or</div></li><li id='11.10'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.10'>(11.10)</a></div><div id='11.10.sentence-1' class='sentence'>a class with a base class of type <span class='texttt'>T</span> is
defined (<a href='class.derived'>[class.derived]</a>), or</div></li><li id='11.11'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.11'>(11.11)</a></div><div id='11.11.sentence-1' class='sentence'>an lvalue of type <span class='texttt'>T</span> is <a href='expr.ass'>assigned to</a>, or</div></li><li id='11.12'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.12'>(11.12)</a></div><div id='11.12.sentence-1' class='sentence'>the type <span class='texttt'>T</span> is the subject of an
<a href='expr.alignof'><span class='texttt'>alignof</span> expression</a>, or</div></li><li id='11.13'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.13'>(11.13)</a></div><div id='11.13.sentence-1' class='sentence'>an <i ><a href='except#nt:exception-declaration'>exception-declaration</a></i> has type <span class='texttt'>T</span>, reference to
<span class='texttt'>T</span>, or pointer to <span class='texttt'>T</span> (<a href='except.handle'>[except.handle]</a>)<a class='hidden_link' href='#11.13.sentence-1'>.</a></div></li></ul></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b25c662399e7ebd126ee6771126aa29fed407e/source/basic.tex#L498'>#</a></div><div id='12.sentence-1' class='sentence'>There can be more than one definition of a <a href='class'>class type</a>,
<a href='dcl.enum'>enumeration type</a>, inline function
with external linkage (<a href='dcl.inline'>[dcl.inline]</a>), inline variable with external
linkage (<a href='dcl.inline'>[dcl.inline]</a>), <a href='temp'>class template</a>,
non-static <a href='temp.fct'>function template</a>,
concept (<a href='temp.concept'>[temp.concept]</a>),
<a href='temp.static'>static data member of a class template</a>,
<a href='temp.mem.func'>member function of a class template</a>,
or template specialization for which some template parameters are not
specified (<a href='temp.spec'>[temp.spec]</a>, <a href='temp.class.spec'>[temp.class.spec]</a>) in a program provided
that each definition appears in a different translation unit, and
provided the definitions satisfy the following requirements<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>Given such
an entity named <span class='texttt'>D</span> defined in more than one translation unit,
then
<ul class='itemize'><li id='12.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.1'>(12.1)</a></div><div id='12.1.sentence-1' class='sentence'>each definition of <span class='texttt'>D</span> shall consist of the same sequence of
tokens; and</div></li><li id='12.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.2'>(12.2)</a></div><div id='12.2.sentence-1' class='sentence'>in each definition of <span class='texttt'>D</span>, corresponding names, looked up
according to <a href='basic.lookup'>[basic.lookup]</a>, shall refer to an entity defined within
the definition of <span class='texttt'>D</span>, or shall refer to the same entity, after
<a href='over.match'>overload resolution</a> and after matching of partial
template specialization (<a href='temp.over'>[temp.over]</a>), except that a name can refer to
<ul class='itemize'><li id='12.2.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#12.2.1'>(12.2.1)</a></div><div id='12.2.1.sentence-1' class='sentence'>a non-volatile const object with internal or no linkage if the object
<ul class='itemize'><li id='12.2.1.1'><div class='marginalizedparent' style='left:-11em'><a class='marginalized' href='#12.2.1.1'>(12.2.1.1)</a></div><div id='12.2.1.1.sentence-1' class='sentence'>has the same literal type in all definitions of <span class='texttt'>D</span>,</div></li><li id='12.2.1.2'><div class='marginalizedparent' style='left:-11em'><a class='marginalized' href='#12.2.1.2'>(12.2.1.2)</a></div><div id='12.2.1.2.sentence-1' class='sentence'>is initialized with a <a href='expr.const'>constant expression</a>,</div></li><li id='12.2.1.3'><div class='marginalizedparent' style='left:-11em'><a class='marginalized' href='#12.2.1.3'>(12.2.1.3)</a></div><div id='12.2.1.3.sentence-1' class='sentence'>is not odr-used in any definition of <span class='texttt'>D</span>, and</div></li><li id='12.2.1.4'><div class='marginalizedparent' style='left:-11em'><a class='marginalized' href='#12.2.1.4'>(12.2.1.4)</a></div><div id='12.2.1.4.sentence-1' class='sentence'>has the same value in all definitions of <span class='texttt'>D</span>,</div></li></ul>
or</div></li><li id='12.2.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#12.2.2'>(12.2.2)</a></div><div id='12.2.2.sentence-1' class='sentence'>a reference with internal or no linkage
initialized with a constant expression such that
the reference refers to the same entity in all definitions of <span class='texttt'>D</span>;</div></li></ul>
and</div></li><li id='12.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.3'>(12.3)</a></div><div id='12.3.sentence-1' class='sentence'>in each definition of <span class='texttt'>D</span>, corresponding entities shall have the
same language linkage; and</div></li><li id='12.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.4'>(12.4)</a></div><div id='12.4.sentence-1' class='sentence'>in each definition of <span class='texttt'>D</span>, the overloaded operators referred
to, the implicit calls to conversion functions, constructors, operator
new functions and operator delete functions, shall refer to the same
function, or to a function defined within the definition of <span class='texttt'>D</span>;
and</div></li><li id='12.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.5'>(12.5)</a></div><div id='12.5.sentence-1' class='sentence'>in each definition of <span class='texttt'>D</span>, a default argument used by an
(implicit or explicit) function call is treated as if its token sequence
were present in the definition of <span class='texttt'>D</span>; that is, the default
argument is subject to the requirements described in this paragraph (and, if
the default argument has subexpressions with default arguments, this
requirement applies recursively)<a class='footnotenum' href='#footnote-23'>23</a>; and</div></li><li id='12.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.6'>(12.6)</a></div><div id='12.6.sentence-1' class='sentence'>if <span class='texttt'>D</span> invokes a function with a precondition,
or is a function
that contains an assertion or has a contract condition (<a href='dcl.attr.contract'>[dcl.attr.contract]</a>),
it is <span class='indexparent'><a class='index' id=':consistency_of_build_level_and_violation_continuation_mode'></a></span>implementation-defined
under which conditions all definitions of <span class='texttt'>D</span>
shall be translated using the same build level
and violation continuation mode; and</div></li><li id='12.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#12.7'>(12.7)</a></div><div id='12.7.sentence-1' class='sentence'>if <span class='texttt'>D</span> is a class with an implicitly-declared
<a href='class.ctor'>constructor</a>, it is as if the constructor was
implicitly defined in every translation unit where it is odr-used, and the
implicit definition in every translation unit shall call the same
constructor for a subobject of <span class='texttt'>D</span><a class='hidden_link' href='#12.7.sentence-1'>.</a></div> <div id='12.7.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#12.7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='comment'>// translation unit 1:
</span>struct X {
  X(int, int);
  X(int, int, int);
};
X::X(int, int = 0) { }
class D {
  X x = 0;
};
D d1;                           <span class='comment'>// <span class='tcode_in_codeblock'>X(int, int)</span> called by <span class='tcode_in_codeblock'>D()</span>
</span>
<span class='comment'>// translation unit 2:
</span>struct X {
  X(int, int);
  X(int, int, int);
};
X::X(int, int = 0, int = 0) { }
class D {
  X x = 0;
};
D d2;                           <span class='comment'>// <span class='tcode_in_codeblock'>X(int, int, int)</span> called by <span class='tcode_in_codeblock'>D()</span>;
</span>                                <span class='comment'>// <span class='tcode_in_codeblock'>D()</span>'s implicit definition violates the ODR
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </li></ul>
If <span class='texttt'>D</span> is a template and is defined in more than one
translation unit, then the preceding requirements
shall apply both to names from the template's enclosing scope used in the
template definition (<a href='temp.nondep'>[temp.nondep]</a>), and also to dependent names at
the point of instantiation (<a href='temp.dep'>[temp.dep]</a>)<a class='hidden_link' href='#12.sentence-2'>.</a></div> <div id='12.sentence-3' class='sentence'>If the definitions of
<span class='texttt'>D</span> satisfy all these requirements, then the behavior is
as if there were a single definition of <span class='texttt'>D</span><a class='hidden_link' href='#12.sentence-3'>.</a></div> <div id='12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='12.sentence-5' class='sentence'>The entity is still declared in multiple translation units, and <a href='basic.link'>[basic.link]</a>
still applies to these declarations<a class='hidden_link' href='#12.sentence-5'>.</a></div> <div id='12.sentence-6' class='sentence'>In particular,
<i ><a href='expr.prim.lambda#nt:lambda-expression'>lambda-expression</a></i><span class='textit'>s</span>
appearing in the type of <span class='texttt'>D</span> may result
in the different declarations having distinct types<a class='hidden_link' href='#12.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='12.sentence-4' class='sentence'>
If the definitions of
<span class='texttt'>D</span> do not satisfy these requirements, then the behavior is
undefined<a class='hidden_link' href='#12.sentence-4'>.</a></div> </div><div class='footnote' id='footnote-22'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-22'>22)</a></div><div id='footnote-22.sentence-1' class='sentence'>An implementation is not required
to call allocation and
deallocation functions from constructors or destructors; however, this
is a permissible implementation technique<a class='hidden_link' href='#footnote-22.sentence-1'>.</a></div></div><div class='footnote' id='footnote-23'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-23'>23)</a></div><div id='footnote-23.sentence-1' class='sentence'><a href='dcl.fct.default'>[dcl.fct.default]</a>
describes how default argument names are looked up<a class='hidden_link' href='#footnote-23.sentence-1'>.</a></div></div></div></body></html>