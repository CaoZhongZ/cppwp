<!DOCTYPE html><html lang='en'><head><title>[optional.object]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>20</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>20.6</a> Optional objects <a class='abbr_ref' href='optional#object'>[optional]</a></h2><div id='optional.object'><h3 ><a class='secnum' style='min-width:103pt'>20.6.3</a> <span class='texttt'>optional</span> for object types <a class='abbr_ref'>[optional.object]</a></h3><p ><span class='indexparent'><a class='index' id='optional'></a></span></p><pre class='codeblock'>
template &lt;class T&gt; class optional {
public:
  using value_type = T;

  <span class='comment'>// <a href='optional.object.ctor'>[optional.object.ctor]</a>, constructors
</span>  constexpr optional() noexcept;
  constexpr optional(nullopt_t) noexcept;
  optional(const optional &amp;);
  optional(optional &amp;&amp;) noexcept(<i><span class='texttt'>see below</span></i>);
  constexpr optional(const T &amp;);
  constexpr optional(T &amp;&amp;);
  template &lt;class... Args&gt; constexpr explicit optional(in_place_t, Args &amp;&amp;...);
  template &lt;class U, class... Args&gt;
    constexpr explicit optional(in_place_t, initializer_list&lt;U&gt;, Args &amp;&amp;...);

  <span class='comment'>// <a href='optional.object.dtor'>[optional.object.dtor]</a>, destructor
</span>  ~optional();

  <span class='comment'>// <a href='optional.object.assign'>[optional.object.assign]</a>, assignment
</span>  optional &amp;operator=(nullopt_t) noexcept;
  optional &amp;operator=(const optional &amp;);
  optional &amp;operator=(optional &amp;&amp;) noexcept(<i><span class='texttt'>see below</span></i>);
  template &lt;class U&gt; optional &amp;operator=(U &amp;&amp;);
  template &lt;class... Args&gt; void emplace(Args &amp;&amp;...);
  template &lt;class U, class... Args&gt;
    void emplace(initializer_list&lt;U&gt;, Args &amp;&amp;...);

  <span class='comment'>// <a href='optional.object.swap'>[optional.object.swap]</a>, swap
</span>  void swap(optional &amp;) noexcept(<i><span class='texttt'>see below</span></i>);

  <span class='comment'>// <a href='optional.object.observe'>[optional.object.observe]</a>, observers
</span>  constexpr T const *operator-&gt;() const;
  constexpr T *operator-&gt;();
  constexpr T const &amp;operator*() const &amp;;
  constexpr T &amp;operator*() &amp;;
  constexpr T &amp;&amp;operator*() &amp;&amp;;
  constexpr const T &amp;&amp;operator*() const &amp;&amp;;
  constexpr explicit operator bool() const noexcept;
  constexpr bool has_value() const noexcept;
  constexpr T const &amp;value() const &amp;;
  constexpr T &amp;value() &amp;;
  constexpr T &amp;&amp;value() &amp;&amp;;
  constexpr const T &amp;&amp;value() const &amp;&amp;;
  template &lt;class U&gt; constexpr T value_or(U &amp;&amp;) const &amp;;
  template &lt;class U&gt; constexpr T value_or(U &amp;&amp;) &amp;&amp;;

  <span class='comment'>// <a href='optional.object.mod'>[optional.object.mod]</a>, modifiers
</span>  void reset() noexcept;

private:
  T *val; <span class='comment'>// <i>exposition only</i>
</span>};
</pre><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p >Any instance of <span class='texttt'>optional&lt;T&gt;</span> at any given time either contains a value or does not contain a value.
When an instance of <span class='texttt'>optional&lt;T&gt;</span> <a id='contains a value!optional'><i>contains a value</i></a>,
it means that an object of type <span class='texttt'>T</span>, referred to as the optional object's <a id='contained value!optional'><i>contained value</i></a>,
is allocated within the storage of the optional object.
Implementations are not permitted to use additional storage, such as dynamic memory, to allocate its contained value.
The contained value shall be allocated in a region of the <span class='texttt'>optional&lt;T&gt;</span> storage suitably aligned for the type <span class='texttt'>T</span>.
When an object of type <span class='texttt'>optional&lt;T&gt;</span> is contextually converted to <span class='texttt'>bool</span>,
the conversion returns <span class='texttt'>true</span> if the object contains a value;
otherwise the conversion returns <span class='texttt'>false</span>.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><p >Member <span class='texttt'>val</span> is provided for exposition only. When an <span class='texttt'>optional&lt;T&gt;</span> object contains a value, <span class='texttt'>val</span> points to the contained value.</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><p ><span class='texttt'>T</span> shall be an object type and shall satisfy the requirements of <span class='texttt'>Destructible</span> (Table <a href='utility.arg.requirements#tab:destructible'>[tab:destructible]</a>).</p></div><div id='ctor'><h4 ><a class='secnum' href='#ctor' style='min-width:118pt'>20.6.3.1</a> Constructors <a class='abbr_ref' href='optional.object.ctor'>[optional.object.ctor]</a></h4><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
constexpr optional() noexcept;
constexpr optional(nullopt_t) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='ctor-1'><div class='marginalizedparent'><a class='marginalized' href='#ctor-1'>1</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> does not contain a value.</p></div></div><div class='para' id='ctor-2'><div class='marginalizedparent'><a class='marginalized' href='#ctor-2'>2</a></div><div class='itemdescr'><p ><i>Remarks:</i>
No contained value is initialized.
For every object type <span class='texttt'>T</span> these constructors shall be <span class='texttt'>constexpr</span> constructors (<a href='dcl.constexpr'>[dcl.constexpr]</a>).
</p></div></div><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
optional(const optional&amp; rhs);
</code></p><div class='itemdescr'></div><div class='para' id='ctor-3'><div class='marginalizedparent'><a class='marginalized' href='#ctor-3'>3</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_copy_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='ctor-4'><div class='marginalizedparent'><a class='marginalized' href='#ctor-4'>4</a></div><div class='itemdescr'><p ><i>Effects:</i>
If <span class='texttt'>rhs</span> contains a value, initializes the contained value as if
direct-non-list-initializing an object of type <span class='texttt'>T</span> with the expression <span class='texttt'>*rhs</span>.</p></div></div><div class='para' id='ctor-5'><div class='marginalizedparent'><a class='marginalized' href='#ctor-5'>5</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>bool(rhs) == bool(*this)</span>.</p></div></div><div class='para' id='ctor-6'><div class='marginalizedparent'><a class='marginalized' href='#ctor-6'>6</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
optional(optional&amp;&amp; rhs) noexcept(<i><span class='texttt'>see below</span></i>);
</code></p><div class='itemdescr'></div><div class='para' id='ctor-7'><div class='marginalizedparent'><a class='marginalized' href='#ctor-7'>7</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_move_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='ctor-8'><div class='marginalizedparent'><a class='marginalized' href='#ctor-8'>8</a></div><div class='itemdescr'><p ><i>Effects:</i>
If <span class='texttt'>rhs</span> contains a value, initializes the contained value as if
direct-non-list-initializing an object of type <span class='texttt'>T</span> with the expression <span class='texttt'>std::move(*rhs)</span>.
<span class='texttt'>bool(rhs)</span> is unchanged.</p></div></div><div class='para' id='ctor-9'><div class='marginalizedparent'><a class='marginalized' href='#ctor-9'>9</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>bool(rhs) == bool(*this)</span>.</p></div></div><div class='para' id='ctor-10'><div class='marginalizedparent'><a class='marginalized' href='#ctor-10'>10</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='ctor-11'><div class='marginalizedparent'><a class='marginalized' href='#ctor-11'>11</a></div><div class='itemdescr'><p ><i>Remarks:</i>
The expression inside <span class='texttt'>noexcept</span> is equivalent to
<span class='texttt'>is_nothrow_move_constructible_v&lt;T&gt;</span>.
</p></div></div><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
constexpr optional(const T&amp; v);
</code></p><div class='itemdescr'></div><div class='para' id='ctor-12'><div class='marginalizedparent'><a class='marginalized' href='#ctor-12'>12</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_copy_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='ctor-13'><div class='marginalizedparent'><a class='marginalized' href='#ctor-13'>13</a></div><div class='itemdescr'><p ><i>Effects:</i>
Initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with the expression <span class='texttt'>v</span>.</p></div></div><div class='para' id='ctor-14'><div class='marginalizedparent'><a class='marginalized' href='#ctor-14'>14</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='ctor-15'><div class='marginalizedparent'><a class='marginalized' href='#ctor-15'>15</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='ctor-16'><div class='marginalizedparent'><a class='marginalized' href='#ctor-16'>16</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If <span class='texttt'>T</span>'s selected constructor is a <span class='texttt'>constexpr</span> constructor, this constructor shall be a <span class='texttt'>constexpr</span> constructor.
</p></div></div><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
constexpr optional(T&amp;&amp; v);
</code></p><div class='itemdescr'></div><div class='para' id='ctor-17'><div class='marginalizedparent'><a class='marginalized' href='#ctor-17'>17</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_move_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='ctor-18'><div class='marginalizedparent'><a class='marginalized' href='#ctor-18'>18</a></div><div class='itemdescr'><p ><i>Effects:</i>
Initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with the expression <span class='texttt'>std::move(v)</span>.</p></div></div><div class='para' id='ctor-19'><div class='marginalizedparent'><a class='marginalized' href='#ctor-19'>19</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='ctor-20'><div class='marginalizedparent'><a class='marginalized' href='#ctor-20'>20</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='ctor-21'><div class='marginalizedparent'><a class='marginalized' href='#ctor-21'>21</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If <span class='texttt'>T</span>'s selected constructor is a <span class='texttt'>constexpr</span> constructor, this constructor shall be a <span class='texttt'>constexpr</span> constructor.
</p></div></div><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
template &lt;class... Args&gt; constexpr explicit optional(in_place_t, Args&amp;&amp;... args);
</code></p><div class='itemdescr'></div><div class='para' id='ctor-22'><div class='marginalizedparent'><a class='marginalized' href='#ctor-22'>22</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_constructible_v&lt;T, Args&amp;&amp;...&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='ctor-23'><div class='marginalizedparent'><a class='marginalized' href='#ctor-23'>23</a></div><div class='itemdescr'><p ><i>Effects:</i>
Initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with the arguments <span class='texttt'>std::forward&lt;Args&gt;(args)...</span>.</p></div></div><div class='para' id='ctor-24'><div class='marginalizedparent'><a class='marginalized' href='#ctor-24'>24</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='ctor-25'><div class='marginalizedparent'><a class='marginalized' href='#ctor-25'>25</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='ctor-26'><div class='marginalizedparent'><a class='marginalized' href='#ctor-26'>26</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If <span class='texttt'>T</span>'s constructor selected for the initialization is a <span class='texttt'>constexpr</span> constructor, this constructor shall be a <span class='texttt'>constexpr</span> constructor.
</p></div></div><p ><span class='indexparent'><a class='index' id='optional!constructor'></a></span><code class='itemdecl'>
template &lt;class U, class... Args&gt;
  constexpr explicit optional(in_place_t, initializer_list&lt;U&gt; il, Args&amp;&amp;... args);
</code></p><div class='itemdescr'></div><div class='para' id='ctor-27'><div class='marginalizedparent'><a class='marginalized' href='#ctor-27'>27</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_constructible_v&lt;T, initializer_list&lt;U&gt;&amp;, Args&amp;&amp;...&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='ctor-28'><div class='marginalizedparent'><a class='marginalized' href='#ctor-28'>28</a></div><div class='itemdescr'><p ><i>Effects:</i>
Initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with the arguments <span class='texttt'>il, std::forward&lt;Args&gt;(args)...</span>.</p></div></div><div class='para' id='ctor-29'><div class='marginalizedparent'><a class='marginalized' href='#ctor-29'>29</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='ctor-30'><div class='marginalizedparent'><a class='marginalized' href='#ctor-30'>30</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='ctor-31'><div class='marginalizedparent'><a class='marginalized' href='#ctor-31'>31</a></div><div class='itemdescr'><p ><i>Remarks:</i>
The function shall not participate in overload resolution unless <span class='texttt'>is_constructible_v&lt;T, initializer_list&lt;U&gt;&amp;, Args&amp;&amp;...&gt;</span> is <span class='texttt'>true</span>.
If <span class='texttt'>T</span>'s constructor selected for the initialization is a <span class='texttt'>constexpr</span> constructor, this constructor shall be a <span class='texttt'>constexpr</span> constructor.
</p></div></div></div><div id='dtor'><h4 ><a class='secnum' href='#dtor' style='min-width:118pt'>20.6.3.2</a> Destructor <a class='abbr_ref' href='optional.object.dtor'>[optional.object.dtor]</a></h4><p ><span class='indexparent'><a class='index' id='optional!destructor'></a></span><code class='itemdecl'>
~optional();
</code></p><div class='itemdescr'></div><div class='para' id='dtor-1'><div class='marginalizedparent'><a class='marginalized' href='#dtor-1'>1</a></div><div class='itemdescr'><p ><i>Effects:</i>
If <span class='texttt'>is_trivially_destructible_v&lt;T&gt; != true</span> and <span class='texttt'>*this</span> contains a value, calls <span class='texttt'>val-&gt;T::~T()</span>.</p></div></div><div class='para' id='dtor-2'><div class='marginalizedparent'><a class='marginalized' href='#dtor-2'>2</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If <span class='texttt'>is_trivially_destructible_v&lt;T&gt; == true</span> then this destructor shall be a trivial destructor.
</p></div></div></div><div id='assign'><h4 ><a class='secnum' href='#assign' style='min-width:118pt'>20.6.3.3</a> Assignment <a class='abbr_ref' href='optional.object.assign'>[optional.object.assign]</a></h4><p ><span class='indexparent'><a class='index' id='operator=!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator='></a></span><code class='itemdecl'>
optional&lt;T&gt;&amp; operator=(nullopt_t) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='assign-1'><div class='marginalizedparent'><a class='marginalized' href='#assign-1'>1</a></div><div class='itemdescr'><p ><i>Effects:</i>
If <span class='texttt'>*this</span> contains a value, calls <span class='texttt'>val-&gt;T::~T()</span> to destroy the contained value; otherwise no effect.</p></div></div><div class='para' id='assign-2'><div class='marginalizedparent'><a class='marginalized' href='#assign-2'>2</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>*this</span>.</p></div></div><div class='para' id='assign-3'><div class='marginalizedparent'><a class='marginalized' href='#assign-3'>3</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> does not contain a value.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator=!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator='></a></span><code class='itemdecl'>
optional&lt;T&gt;&amp; operator=(const optional&amp; rhs);
</code></p><div class='itemdescr'></div><div class='para' id='assign-4'><div class='marginalizedparent'><a class='marginalized' href='#assign-4'>4</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_copy_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span> and <span class='texttt'>is_copy_assignable_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='assign-5'><div class='marginalizedparent'><a class='marginalized' href='#assign-5'>5</a></div><div class='itemdescr'><p ><i>Effects:</i>
See Table <a href='#tab:optional.assign.copy'>[tab:optional.assign.copy]</a>.

 
     
 
 
 
 
 
 
  <div class='table'>
 
 <span class='center'>
 <div class='tabular'>
  
 <td colspan='1'></td>&amp;&amp;<td colspan='1'><b><span class='texttt'>*this</span> contains a value</b></td>&amp;<td colspan='1'><b><span class='texttt'>*this</span> does not contain a value</b></td><br/>
 



<b><span class='texttt'>rhs</span> contains a value</b>&amp; &amp;
assigns <span class='texttt'>*rhs</span> to the contained value &amp;
initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with <span class='texttt'>*rhs</span> <br/>


<b><span class='texttt'>rhs</span> does not contain a value</b>&amp; &amp;
destroys the contained value by calling <span class='texttt'>val-&gt;T::~T()</span> &amp;
no effect <br/>

 
 
 </div>
 </span>
 </div>

</p></div></div><div class='para' id='assign-6'><div class='marginalizedparent'><a class='marginalized' href='#assign-6'>6</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>*this</span>.</p></div></div><div class='para' id='assign-7'><div class='marginalizedparent'><a class='marginalized' href='#assign-7'>7</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>bool(rhs) == bool(*this)</span>.</p></div></div><div class='para' id='assign-8'><div class='marginalizedparent'><a class='marginalized' href='#assign-8'>8</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If any exception is thrown, the result of the expression <span class='texttt'>bool(*this)</span> remains unchanged.
If an exception is thrown during the call to <span class='texttt'>T</span>'s copy constructor, no effect.
If an exception is thrown during the call to <span class='texttt'>T</span>'s copy assignment,
the state of its contained value is as defined by the exception safety guarantee of <span class='texttt'>T</span>'s copy assignment.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator=!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator='></a></span><code class='itemdecl'>
optional&lt;T&gt;&amp; operator=(optional&amp;&amp; rhs) noexcept(<i><span class='texttt'>see below</span></i>);
</code></p><div class='itemdescr'></div><div class='para' id='assign-9'><div class='marginalizedparent'><a class='marginalized' href='#assign-9'>9</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_move_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span> and <span class='texttt'>is_move_assignable_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='assign-10'><div class='marginalizedparent'><a class='marginalized' href='#assign-10'>10</a></div><div class='itemdescr'><p ><i>Effects:</i>
See Table <a href='#tab:optional.assign.move'>[tab:optional.assign.move]</a>.
The result of the expression <span class='texttt'>bool(rhs)</span> remains unchanged.

 
     
 
 
 
 
 
 
  <div class='table'>
 
 <span class='center'>
 <div class='tabular'>
  
 <td colspan='1'></td>&amp;&amp;<td colspan='1'><b><span class='texttt'>*this</span> contains a value</b></td>&amp;<td colspan='1'><b><span class='texttt'>*this</span> does not contain a value</b></td><br/>
 



<b><span class='texttt'>rhs</span> contains a value</b>&amp; &amp;
assigns <span class='texttt'>std::move(*rhs)</span> to the contained value &amp;
initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with <span class='texttt'>std::move(*rhs)</span> <br/>


<b><span class='texttt'>rhs</span> does not contain a value</b>&amp; &amp;
destroys the contained value by calling <span class='texttt'>val-&gt;T::~T()</span> &amp;
no effect <br/>

 
 
 </div>
 </span>
 </div>

</p></div></div><div class='para' id='assign-11'><div class='marginalizedparent'><a class='marginalized' href='#assign-11'>11</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>*this</span>.</p></div></div><div class='para' id='assign-12'><div class='marginalizedparent'><a class='marginalized' href='#assign-12'>12</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>bool(rhs) == bool(*this)</span>.</p></div></div><div class='para' id='assign-13'><div class='marginalizedparent'><a class='marginalized' href='#assign-13'>13</a></div><div class='itemdescr'><p ><i>Remarks:</i>
The expression inside <span class='texttt'>noexcept</span> is equivalent to:
</p><pre class='codeblock'>
is_nothrow_move_assignable_v&lt;T&gt; &amp;&amp; is_nothrow_move_constructible_v&lt;T&gt;
</pre></div></div><div class='para' id='assign-14'><div class='marginalizedparent'><a class='marginalized' href='#assign-14'>14</a></div><div class='itemdescr'><p >If any exception is thrown, the result of the expression <span class='texttt'>bool(*this)</span> remains unchanged.
If an exception is thrown during the call to <span class='texttt'>T</span>'s move constructor,
the state of <span class='texttt'>*rhs.val</span> is determined by the exception safety guarantee of <span class='texttt'>T</span>'s move constructor.
If an exception is thrown during the call to <span class='texttt'>T</span>'s move assignment,
the state of <span class='texttt'>*val</span> and <span class='texttt'>*rhs.val</span> is determined by the exception safety guarantee of <span class='texttt'>T</span>'s move assignment.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator=!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator='></a></span><code class='itemdecl'>
template &lt;class U&gt; optional&lt;T&gt;&amp; operator=(U&amp;&amp; v);
</code></p><div class='itemdescr'></div><div class='para' id='assign-15'><div class='marginalizedparent'><a class='marginalized' href='#assign-15'>15</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_constructible_v&lt;T, U&gt;</span> is <span class='texttt'>true</span> and <span class='texttt'>is_assignable_v&lt;T&amp;, U&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='assign-16'><div class='marginalizedparent'><a class='marginalized' href='#assign-16'>16</a></div><div class='itemdescr'><p ><i>Effects:</i>
If <span class='texttt'>*this</span> contains a value, assigns <span class='texttt'>std::forward&lt;U&gt;(v)</span> to the contained value; otherwise initializes the contained value as if direct-non-list-initializing object of type <span class='texttt'>T</span> with <span class='texttt'>std::forward&lt;U&gt;(v)</span>.</p></div></div><div class='para' id='assign-17'><div class='marginalizedparent'><a class='marginalized' href='#assign-17'>17</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>*this</span>.</p></div></div><div class='para' id='assign-18'><div class='marginalizedparent'><a class='marginalized' href='#assign-18'>18</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='assign-19'><div class='marginalizedparent'><a class='marginalized' href='#assign-19'>19</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If any exception is thrown, the result of the expression <span class='texttt'>bool(*this)</span> remains unchanged. If an exception is thrown during the call to <span class='texttt'>T</span>'s constructor, the state of <span class='texttt'>v</span> is determined by the exception safety guarantee of <span class='texttt'>T</span>'s constructor. If an exception is thrown during the call to <span class='texttt'>T</span>'s assignment, the state of <span class='texttt'>*val</span> and <span class='texttt'>v</span> is determined by the exception safety guarantee of <span class='texttt'>T</span>'s assignment.
The function shall not participate in overload resolution unless
<span class='texttt'>is_same_v&lt;decay_t&lt;U&gt;, T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='assign-20'><div class='marginalizedparent'><a class='marginalized' href='#assign-20'>20</a></div><div class='itemdescr'><p ><i>Notes:</i>
The reason for providing such generic assignment and then constraining it so that effectively <span class='texttt'>T</span> == <span class='texttt'>U</span> is to guarantee that assignment of the form <span class='texttt'>o = {}</span> is unambiguous.
</p></div></div><p ><span class='indexparent'><a class='index' id='emplace!optional'></a></span><span class='indexparent'><a class='index' id='optional!emplace'></a></span><code class='itemdecl'>
template &lt;class... Args&gt; void emplace(Args&amp;&amp;... args);
</code></p><div class='itemdescr'></div><div class='para' id='assign-21'><div class='marginalizedparent'><a class='marginalized' href='#assign-21'>21</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>is_constructible_v&lt;T, Args&amp;&amp;...&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='assign-22'><div class='marginalizedparent'><a class='marginalized' href='#assign-22'>22</a></div><div class='itemdescr'><p ><i>Effects:</i>
Calls <span class='texttt'>*this = nullopt</span>. Then initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with the arguments <span class='texttt'>std::forward&lt;Args&gt;(args)...</span>.</p></div></div><div class='para' id='assign-23'><div class='marginalizedparent'><a class='marginalized' href='#assign-23'>23</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='assign-24'><div class='marginalizedparent'><a class='marginalized' href='#assign-24'>24</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='assign-25'><div class='marginalizedparent'><a class='marginalized' href='#assign-25'>25</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If an exception is thrown during the call to <span class='texttt'>T</span>'s constructor, <span class='texttt'>*this</span> does not contain a value, and the previous <span class='texttt'>*val</span> (if any) has been destroyed.
</p></div></div><p ><span class='indexparent'><a class='index' id='emplace!optional'></a></span><span class='indexparent'><a class='index' id='optional!emplace'></a></span><code class='itemdecl'>
template &lt;class U, class... Args&gt; void emplace(initializer_list&lt;U&gt; il, Args&amp;&amp;... args);
</code></p><div class='itemdescr'></div><div class='para' id='assign-26'><div class='marginalizedparent'><a class='marginalized' href='#assign-26'>26</a></div><div class='itemdescr'><p ><i>Effects:</i>
Calls <span class='texttt'>*this = nullopt</span>. Then initializes the contained value as if direct-non-list-initializing an object of type <span class='texttt'>T</span> with the arguments <span class='texttt'>il, std::forward&lt;Args&gt;(args)...</span>.</p></div></div><div class='para' id='assign-27'><div class='marginalizedparent'><a class='marginalized' href='#assign-27'>27</a></div><div class='itemdescr'><p ><i>Postcondition:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='assign-28'><div class='marginalizedparent'><a class='marginalized' href='#assign-28'>28</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exception thrown by the selected constructor of <span class='texttt'>T</span>.</p></div></div><div class='para' id='assign-29'><div class='marginalizedparent'><a class='marginalized' href='#assign-29'>29</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If an exception is thrown during the call to <span class='texttt'>T</span>'s constructor, <span class='texttt'>*this</span> does not contain a value, and the previous <span class='texttt'>*val</span> (if any) has been destroyed.
This function shall not participate in overload resolution unless <span class='texttt'>is_constructible_v&lt;T, initializer_list&lt;U&gt;&amp;, Args&amp;&amp;...&gt;</span> is <span class='texttt'>true</span>.
</p></div></div></div><div id='swap'><h4 ><a class='secnum' href='#swap' style='min-width:118pt'>20.6.3.4</a> Swap <a class='abbr_ref' href='optional.object.swap'>[optional.object.swap]</a></h4><p ><span class='indexparent'><a class='index' id='swap!optional'></a></span><span class='indexparent'><a class='index' id='optional!swap'></a></span><code class='itemdecl'>
void swap(optional&amp; rhs) noexcept(<i><span class='texttt'>see below</span></i>);
</code></p><div class='itemdescr'></div><div class='para' id='swap-1'><div class='marginalizedparent'><a class='marginalized' href='#swap-1'>1</a></div><div class='itemdescr'><p ><i>Requires:</i>
Lvalues of type <span class='texttt'>T</span> shall be swappable and <span class='texttt'>is_move_constructible_v&lt;T&gt;</span> is <span class='texttt'>true</span>.</p></div></div><div class='para' id='swap-2'><div class='marginalizedparent'><a class='marginalized' href='#swap-2'>2</a></div><div class='itemdescr'><p ><i>Effects:</i>
See Table <a href='#tab:optional.swap'>[tab:optional.swap]</a>.

 
     
 
 
 
 
 
 
  <div class='table'>
 
 <span class='center'>
 <div class='tabular'>
  
 <td colspan='1'></td>&amp;&amp;<td colspan='1'><b><span class='texttt'>*this</span> contains a value</b></td>&amp;<td colspan='1'><b><span class='texttt'>*this</span> does not contain a value</b></td><br/>
 



<b><span class='texttt'>rhs</span> contains a value</b>&amp; &amp;
calls <span class='texttt'>swap(*(*this), *rhs)</span> &amp;
initializes the contained value of <span class='texttt'>*this</span> as if
direct-non-list-initializing an object of type <span class='texttt'>T</span> with the expression <span class='texttt'>std::move(*rhs)</span>,
followed by <span class='texttt'>rhs.val-&gt;T::~T()</span>;
postcondition is that <span class='texttt'>*this</span> contains a value and <span class='texttt'>rhs</span> does not contain a value <br/>


<b><span class='texttt'>rhs</span> does not contain a value</b>&amp; &amp;
initializes the contained value of <span class='texttt'>rhs</span> as if
direct-non-list-initializing an object of type <span class='texttt'>T</span> with the expression <span class='texttt'>std::move(*(*this))</span>,
followed by <span class='texttt'>val-&gt;T::~T()</span>;
postcondition is that <span class='texttt'>*this</span> does not contain a value and <span class='texttt'>rhs</span> contains a value &amp;
no effect <br/>

 
 
 </div>
 </span>
 </div>

</p></div></div><div class='para' id='swap-3'><div class='marginalizedparent'><a class='marginalized' href='#swap-3'>3</a></div><div class='itemdescr'><p ><i>Throws:</i>
Any exceptions thrown by the operations in the relevant part of Table <a href='#tab:optional.swap'>[tab:optional.swap]</a>.</p></div></div><div class='para' id='swap-4'><div class='marginalizedparent'><a class='marginalized' href='#swap-4'>4</a></div><div class='itemdescr'><p ><i>Remarks:</i>
The expression inside <span class='texttt'>noexcept</span> is equivalent to:
</p><pre class='codeblock'>
is_nothrow_move_constructible_v&lt;T&gt; &amp;&amp; noexcept(swap(declval&lt;T&amp;&gt;(), declval&lt;T&amp;&gt;()))
</pre><p >If any exception is thrown, the results of the expressions <span class='texttt'>bool(*this)</span> and <span class='texttt'>bool(rhs)</span> remain unchanged.
If an exception is thrown during the call to function <span class='texttt'>swap</span>,
the state of <span class='texttt'>*val</span> and <span class='texttt'>*rhs.val</span> is determined by the exception safety guarantee of <span class='texttt'>swap</span> for lvalues of <span class='texttt'>T</span>.
If an exception is thrown during the call to <span class='texttt'>T</span>'s move constructor,
the state of <span class='texttt'>*val</span> and <span class='texttt'>*rhs.val</span> is determined by the exception safety guarantee of <span class='texttt'>T</span>'s move constructor.
</p></div></div></div><div id='observe'><h4 ><a class='secnum' href='#observe' style='min-width:118pt'>20.6.3.5</a> Observers <a class='abbr_ref' href='optional.object.observe'>[optional.object.observe]</a></h4><p ><span class='indexparent'><a class='index' id='operator->!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator->'></a></span><code class='itemdecl'>
constexpr T const* operator-&gt;() const;
constexpr T* operator-&gt;();
</code></p><div class='itemdescr'></div><div class='para' id='observe-1'><div class='marginalizedparent'><a class='marginalized' href='#observe-1'>1</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='observe-2'><div class='marginalizedparent'><a class='marginalized' href='#observe-2'>2</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>val</span>.</p></div></div><div class='para' id='observe-3'><div class='marginalizedparent'><a class='marginalized' href='#observe-3'>3</a></div><div class='itemdescr'><p ><i>Throws:</i>
Nothing.</p></div></div><div class='para' id='observe-4'><div class='marginalizedparent'><a class='marginalized' href='#observe-4'>4</a></div><div class='itemdescr'><p ><i>Remarks:</i>
Unless <span class='texttt'>T</span> is a user-defined type with overloaded unary <span class='texttt'>operator&amp;</span>, these functions shall be <span class='texttt'>constexpr</span> functions.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator*!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator*'></a></span><code class='itemdecl'>
constexpr T const&amp; operator*() const &amp;;
constexpr T&amp; operator*() &amp;;
</code></p><div class='itemdescr'></div><div class='para' id='observe-5'><div class='marginalizedparent'><a class='marginalized' href='#observe-5'>5</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='observe-6'><div class='marginalizedparent'><a class='marginalized' href='#observe-6'>6</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>*val</span>.</p></div></div><div class='para' id='observe-7'><div class='marginalizedparent'><a class='marginalized' href='#observe-7'>7</a></div><div class='itemdescr'><p ><i>Throws:</i>
Nothing.</p></div></div><div class='para' id='observe-8'><div class='marginalizedparent'><a class='marginalized' href='#observe-8'>8</a></div><div class='itemdescr'><p ><i>Remarks:</i>
These functions shall be <span class='texttt'>constexpr</span> functions.
</p></div></div><p ><span class='indexparent'><a class='index' id='operator*!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator*'></a></span><code class='itemdecl'>
constexpr T&amp;&amp; operator*() &amp;&amp;;
constexpr const T&amp;&amp; operator*() const &amp;&amp;;
</code></p><div class='itemdescr'></div><div class='para' id='observe-9'><div class='marginalizedparent'><a class='marginalized' href='#observe-9'>9</a></div><div class='itemdescr'><p ><i>Requires:</i>
<span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='observe-10'><div class='marginalizedparent'><a class='marginalized' href='#observe-10'>10</a></div><div class='itemdescr'><p ><i>Effects:</i>
Equivalent to: <span class='texttt'>return std::move(*val);</span>
</p></div></div><p ><span class='indexparent'><a class='index' id='operator bool!optional'></a></span><span class='indexparent'><a class='index' id='optional!operator bool'></a></span><code class='itemdecl'>
constexpr explicit operator bool() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='observe-11'><div class='marginalizedparent'><a class='marginalized' href='#observe-11'>11</a></div><div class='itemdescr'><p ><i>Returns:</i>
<span class='texttt'>true</span> if and only if <span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='observe-12'><div class='marginalizedparent'><a class='marginalized' href='#observe-12'>12</a></div><div class='itemdescr'><p ><i>Remarks:</i>
This function shall be a <span class='texttt'>constexpr</span> function.
</p></div></div><p ><span class='indexparent'><a class='index' id='has_value!optional'></a></span><span class='indexparent'><a class='index' id='optional!has_value'></a></span><code class='itemdecl'>
constexpr bool has_value() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='observe-13'><div class='marginalizedparent'><a class='marginalized' href='#observe-13'>13</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>true</span> if and only if <span class='texttt'>*this</span> contains a value.</p></div></div><div class='para' id='observe-14'><div class='marginalizedparent'><a class='marginalized' href='#observe-14'>14</a></div><div class='itemdescr'><p ><i>Remarks:</i> This function shall be a <span class='texttt'>constexpr</span> function.
</p></div></div><p ><span class='indexparent'><a class='index' id='value!optional'></a></span><span class='indexparent'><a class='index' id='optional!value'></a></span><code class='itemdecl'>
constexpr T const&amp; value() const &amp;;
constexpr T&amp; value() &amp;;
</code></p><div class='itemdescr'></div><div class='para' id='observe-15'><div class='marginalizedparent'><a class='marginalized' href='#observe-15'>15</a></div><div class='itemdescr'><p ><i>Effects:</i>
Equivalent to:
</p><pre class='codeblock'>
return bool(*this) ? *val : throw bad_optional_access();
</pre></div></div><p ><span class='indexparent'><a class='index' id='value!optional'></a></span><span class='indexparent'><a class='index' id='optional!value'></a></span><code class='itemdecl'>
constexpr T&amp;&amp; value() &amp;&amp;;
constexpr const T&amp;&amp; value() const &amp;&amp;;
</code></p><div class='itemdescr'></div><div class='para' id='observe-16'><div class='marginalizedparent'><a class='marginalized' href='#observe-16'>16</a></div><div class='itemdescr'><p ><i>Effects:</i>
Equivalent to:
</p><pre class='codeblock'>
return bool(*this) ? std::move(*val) : throw bad_optional_access();
</pre></div></div><p ><span class='indexparent'><a class='index' id='value_or!optional'></a></span><span class='indexparent'><a class='index' id='optional!value_or'></a></span><code class='itemdecl'>
template &lt;class U&gt; constexpr T value_or(U&amp;&amp; v) const &amp;;
</code></p><div class='itemdescr'></div><div class='para' id='observe-17'><div class='marginalizedparent'><a class='marginalized' href='#observe-17'>17</a></div><div class='itemdescr'><p ><i>Effects:</i>
Equivalent to:
</p><pre class='codeblock'>
return bool(*this) ? **this : static_cast&lt;T&gt;(std::forward&lt;U&gt;(v));
</pre></div></div><div class='para' id='observe-18'><div class='marginalizedparent'><a class='marginalized' href='#observe-18'>18</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If <span class='texttt'>is_copy_constructible_v&lt;T&gt; &amp;&amp; is_convertible_v&lt;U&amp;&amp;, T&gt;</span> is <span class='texttt'>false</span>,
the program is ill-formed.
</p></div></div><p ><span class='indexparent'><a class='index' id='value_or!optional'></a></span><span class='indexparent'><a class='index' id='optional!value_or'></a></span><code class='itemdecl'>
template &lt;class U&gt; constexpr T value_or(U&amp;&amp; v) &amp;&amp;;
</code></p><div class='itemdescr'></div><div class='para' id='observe-19'><div class='marginalizedparent'><a class='marginalized' href='#observe-19'>19</a></div><div class='itemdescr'><p ><i>Effects:</i>
Equivalent to:
</p><pre class='codeblock'>
return bool(*this) ? std::move(**this) : static_cast&lt;T&gt;(std::forward&lt;U&gt;(v));
</pre></div></div><div class='para' id='observe-20'><div class='marginalizedparent'><a class='marginalized' href='#observe-20'>20</a></div><div class='itemdescr'><p ><i>Remarks:</i>
If <span class='texttt'>is_move_constructible_v&lt;T&gt; &amp;&amp; is_convertible_v&lt;U&amp;&amp;, T&gt;</span> is <span class='texttt'>false</span>,
the program is ill-formed.
</p></div></div></div><div id='mod'><h4 ><a class='secnum' href='#mod' style='min-width:118pt'>20.6.3.6</a> Modifiers <a class='abbr_ref' href='optional.object.mod'>[optional.object.mod]</a></h4><p ><span class='indexparent'><a class='index' id='reset!optional'></a></span><span class='indexparent'><a class='index' id='optional!reset'></a></span><code class='itemdecl'>
void reset() noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='mod-1'><div class='marginalizedparent'><a class='marginalized' href='#mod-1'>1</a></div><div class='itemdescr'><p ><i>Effects:</i>
If <span class='texttt'>*this</span> contains a value, calls <span class='texttt'>val-&gt;T::~T()</span> to destroy the contained value;
otherwise no effect.</p></div></div><div class='para' id='mod-2'><div class='marginalizedparent'><a class='marginalized' href='#mod-2'>2</a></div><div class='itemdescr'><p ><i>Postconditions:</i>
<span class='texttt'>*this</span> does not contain a value.
</p></div></div></div></div></div></body></html>