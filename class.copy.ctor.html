<!DOCTYPE html><html lang='en'><head><title>[class.copy.ctor]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>12</a> Special member functions <a class='abbr_ref' href='./#special'>[special]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>12.8</a> Copying and moving class objects <a class='abbr_ref' href='class.copy#ctor'>[class.copy]</a></h2><div id='class.copy.ctor'><h3 ><a class='secnum' style='min-width:103pt'>12.8.1</a> Copy/move constructors <a class='abbr_ref'>[class.copy.ctor]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2423'>#</a></div><p ><span class='indexparent'><a class='index' id='constructor,copy'></a></span><span class='indexparent'><a class='index' id='constructor,move'></a></span>A non-template constructor for class
<span class='texttt'>X</span>
is
a
copy
constructor if its first parameter is of type
<span class='texttt'>X&amp;</span>,
<span class='texttt'>const X&amp;</span>,
<span class='texttt'>volatile X&amp;</span>
or
<span class='texttt'>const volatile X&amp;</span>,
and either there are no other parameters
or else all other parameters have <a href='dcl.fct.default'>default arguments</a>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span>
<span class='texttt'>X&#x200b;::&#x200b;X(const X&amp;)</span>
and
<span class='texttt'>X&#x200b;::&#x200b;X(X&amp;,int=1)</span>
are copy constructors.</p><p ><pre class='codeblock'>
struct X {
  X(int);
  X(const X&amp;, int = 1);
};
X a(1);             <span class='comment'>// calls <span class='tcode_in_codeblock'>X(int);</span>
</span>X b(a, 0);          <span class='comment'>// calls <span class='tcode_in_codeblock'>X(const X&amp;, int);</span>
</span>X c = b;            <span class='comment'>// calls <span class='tcode_in_codeblock'>X(const X&amp;, int);</span>
</span></pre></p><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2456'>#</a></div><p >A non-template constructor for class <span class='texttt'>X</span> is a move constructor if its
first parameter is of type <span class='texttt'>X&amp;&amp;</span>, <span class='texttt'>const X&amp;&amp;</span>,
<span class='texttt'>volatile X&amp;&amp;</span>, or <span class='texttt'>const volatile X&amp;&amp;</span>, and either there are
no other parameters or else all other parameters have <a href='dcl.fct.default'>default 
arguments</a>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span> <span class='texttt'>Y&#x200b;::&#x200b;Y(Y&amp;&amp;)</span> is a move constructor.
</p><p ><pre class='codeblock'>
struct Y {
  Y(const Y&amp;);
  Y(Y&amp;&amp;);
};
extern Y f(int);
Y d(f(1));          <span class='comment'>// calls <span class='tcode_in_codeblock'>Y(Y&amp;&amp;)</span>
</span>Y e = d;            <span class='comment'>// calls <span class='tcode_in_codeblock'>Y(const Y&amp;)</span>
</span></pre></p><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2474'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
All forms of copy/move constructor may be declared for a class.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><p ><pre class='codeblock'>
struct X {
  X(const X&amp;);
  X(X&amp;);            <span class='comment'>// OK
</span>  X(X&amp;&amp;);
  X(const X&amp;&amp;);     <span class='comment'>// OK, but possibly not sensible
</span>};</pre></p><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2490'>#</a></div><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
If a class
<span class='texttt'>X</span>
only has a copy constructor with a parameter of type
<span class='texttt'>X&amp;</span>,
an initializer of type
<span class='texttt'>const</span>
<span class='texttt'>X</span>
or
<span class='texttt'>volatile</span>
<span class='texttt'>X</span>
cannot initialize an object of type
(possibly
cv-qualified)
<span class='texttt'>X</span>.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span></p><p ><pre class='codeblock'>
struct X {
  X();              <span class='comment'>// default constructor
</span>  X(X&amp;);            <span class='comment'>// copy constructor with a non-const parameter
</span>};
const X cx;
X x = cx;           <span class='comment'>// error: <span class='tcode_in_codeblock'>X&#x200b;::&#x200b;X(X&amp;)</span> cannot copy <span class='tcode_in_codeblock'>cx</span> into <span class='tcode_in_codeblock'>x</span>
</span></pre></p><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2519'>#</a></div><p >A declaration of a constructor for a class
<span class='texttt'>X</span>
is ill-formed if its first parameter is of type (optionally cv-qualified)
<span class='texttt'>X</span>
and either there are no other parameters or else all other parameters have
default arguments.
A member function template is never instantiated to
produce such a constructor signature.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Example:</span>
</p><p ><pre class='codeblock'>
struct S {
  template&lt;typename T&gt; S(T);
  S();
};

S g;

void h() {
  S a(g);           <span class='comment'>// does not instantiate the member template to produce <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;S&lt;S&gt;(S)</span>;
</span>                    <span class='comment'>// uses the implicitly declared copy constructor
</span>}</pre></p><p ><span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end example</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2544'>#</a></div><p >If the class definition does not explicitly declare a copy constructor,
a non-explicit one is declared <a class='hidden_link' href='#def:constructor,copy,implicitly_declared' id='def:constructor,copy,implicitly_declared'><i>implicitly</i></a>.
If the class definition declares a move
constructor or move assignment operator, the implicitly declared copy
constructor is defined as deleted; otherwise, it is defined as
<a href='dcl.fct.def'>defaulted</a>.
The latter case is deprecated if the class has a user-declared copy assignment
operator or a user-declared destructor.</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2554'>#</a></div><p >The implicitly-declared copy constructor for a class
<span class='texttt'>X</span>
will have the form</p><p ><pre class='codeblock'>
X::X(const X&amp;)</pre></p><p >if each potentially constructed subobject of a class type
<span class='texttt'>M</span>
(or array thereof)
has a copy constructor whose first parameter is of type
<span class='texttt'>const</span>
<span class='texttt'>M&amp;</span>
or
<span class='texttt'>const</span>
<span class='texttt'>volatile</span>
<span class='texttt'>M&amp;</span>.<a class='footnotenum' href='#footnote-119'>119</a>
Otherwise, the implicitly-declared copy constructor will have the form</p><p ><pre class='codeblock'>
X::X(X&amp;)</pre></p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2583'>#</a></div><p ><span class='indexparent'><a class='index' id='constructor,move,implicitly_declared'></a></span>If the definition of a class <span class='texttt'>X</span> does not explicitly declare
a move constructor, a non-explicit one will be
implicitly declared as defaulted if and only if</p><ul class='itemize'><li id='8.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.1'>(8.1)</a></div><p ><span class='texttt'>X</span> does not have a user-declared copy constructor,</p></li><li id='8.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.2'>(8.2)</a></div><p ><span class='texttt'>X</span> does not have a user-declared copy assignment operator,</p></li><li id='8.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.3'>(8.3)</a></div><p ><span class='texttt'>X</span> does not have a user-declared move assignment operator, and</p></li><li id='8.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.4'>(8.4)</a></div><p ><span class='texttt'>X</span> does not have a user-declared destructor.
</p></li></ul><p >[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> When the move constructor is not implicitly declared or explicitly supplied,
expressions that otherwise would have invoked the move constructor may instead invoke
a copy constructor. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2607'>#</a></div><p >The implicitly-declared move constructor for class <span class='texttt'>X</span> will have the form
</p><p ><pre class='codeblock'>
X::X(X&amp;&amp;)</pre></p></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2613'>#</a></div><p >An implicitly-declared copy/move constructor is an
<span class='texttt'>inline</span>
<span class='texttt'>public</span>
member of its class.
A defaulted copy/&#x200b;move constructor for a class
  <span class='texttt'>X</span> is defined as <a href='dcl.fct.def.delete'>deleted</a> if <span class='texttt'>X</span> has:
</p><ul class='itemize'><li id='10.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#10.1'>(10.1)</a></div><p >a variant member with a non-trivial corresponding constructor and
  <span class='texttt'>X</span> is a union-like class,</p></li><li id='10.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#10.2'>(10.2)</a></div><p >a potentially constructed subobject type
  <span class='texttt'>M</span> (or array thereof) that cannot be copied/moved because
  <a href='over.match'>overload resolution</a>, as applied to find
  <span class='texttt'>M</span>'s 
  corresponding constructor, results in an ambiguity or 
  a function that is deleted or inaccessible from the
  defaulted constructor,</p></li><li id='10.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#10.3'>(10.3)</a></div><p >any potentially constructed subobject of a type
  with a destructor that is deleted or inaccessible from the defaulted
  constructor, or,</p></li><li id='10.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#10.4'>(10.4)</a></div><p >for the copy constructor, a non-static data member of rvalue reference type.
</p></li></ul><p >A defaulted move constructor that is defined as deleted is ignored by overload
resolution (<a href='over.match'>[over.match]</a>, <a href='over.over'>[over.over]</a>).
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
A deleted move constructor would otherwise interfere with initialization from
an rvalue which can use the copy constructor instead.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2646'>#</a></div><p ><span class='indexparent'><a class='index' id='constructor,copy,trivial'></a></span><span class='indexparent'><a class='index' id='constructor,move,trivial'></a></span>A copy/move constructor for class
<span class='texttt'>X</span>
is
trivial
if it is not user-provided and if:</p><ul class='itemize'><li id='11.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.1'>(11.1)</a></div><p >class
<span class='texttt'>X</span>
has no <a href='class.virtual'>virtual functions</a>
and no <a href='class.mi#def:base_class,virtual'>virtual base classes</a>, and</p></li><li id='11.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.2'>(11.2)</a></div><p >the constructor selected to copy/move each direct base class subobject is trivial, and</p></li><li id='11.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#11.3'>(11.3)</a></div><p >for each non-static data member of
<span class='texttt'>X</span>
that is of class type (or array thereof),
the constructor selected to copy/move that member is trivial;
</p></li></ul><p >otherwise the copy/move constructor is
<span class='grammarterm'>non-trivial</span>.</p></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2675'>#</a></div><p ><span class='indexparent'><a class='index' id='constructor,copy,implicitly_defined'></a></span><span class='indexparent'><a class='index' id='constructor,move,implicitly_defined'></a></span>A copy/move constructor
that is defaulted and not defined as deleted
is
<a class='hidden_link' href='#def:implicitly_defined' id='def:implicitly_defined'><i>implicitly defined</i></a>
if it is <a href='basic.def.odr'>odr-used</a>
or when it is explicitly defaulted after its first declaration.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
The copy/move constructor is implicitly defined even if the implementation elided
its <a href='basic.def.odr'>odr-use</a> (<a href='class.temporary'>[class.temporary]</a>).
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
If the implicitly-defined constructor would satisfy the requirements of a
constexpr constructor (<a href='dcl.constexpr'>[dcl.constexpr]</a>), the implicitly-defined
constructor is <span class='texttt'>constexpr</span>.</p></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2692'>#</a></div><p >Before the defaulted copy/move constructor for a class is
implicitly defined,
all non-user-provided copy/move constructors for its
potentially constructed subobjects
shall have been implicitly defined.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
An implicitly-declared copy/move constructor has an
implied <a href='except.spec'>exception specification</a>.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2703'>#</a></div><p >The implicitly-defined copy/move constructor for a non-union class
<span class='texttt'>X</span>
performs a memberwise copy/move of its bases and members.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> Default member initializers of non-static data members are ignored. See also the example in <a href='class.base.init'>[class.base.init]</a>. <span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]
The order of initialization is the same as the order of initialization of bases
and members in a user-defined constructor (see <a href='class.base.init'>[class.base.init]</a>).
Let <span class='texttt'>x</span> be either the parameter of the constructor or, for the move constructor, an
xvalue referring to the parameter.
Each base or non-static data member
is copied/moved in the manner appropriate to its type:</p><ul class='itemize'><li id='14.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.1'>(14.1)</a></div><p >if the member is an array, each element is
direct-initialized with the corresponding subobject of <span class='texttt'>x</span>;</p></li><li id='14.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.2'>(14.2)</a></div><p >if a member <span class='texttt'>m</span> has rvalue reference type <span class='texttt'>T&amp;&amp;</span>, it is direct-initialized with
<span class='texttt'>static_&shy;cast&lt;T&amp;&amp;&gt;(x.m)</span>;</p></li><li id='14.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.3'>(14.3)</a></div><p >otherwise, the base or member is direct-initialized with the corresponding base or member of <span class='texttt'>x</span>.
</p></li></ul><p ><span class='indexparent'><a class='index' id='initialization,virtual_base_class'></a></span>Virtual base class subobjects shall be initialized only once by
the implicitly-defined copy/move constructor (see <a href='class.base.init'>[class.base.init]</a>).</p></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/cdefe2d0e11ad1081871542bc312fd93bbfd6ca0/source/special.tex#L2732'>#</a></div><p >The implicitly-defined copy/move constructor for a union
<span class='texttt'>X</span> copies the <a href='basic.types#def:object_representation'>object representation</a> of <span class='texttt'>X</span>.</p></div><div class='footnote' id='footnote-119'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-119'>119)</a></div><p >This implies that the reference parameter of the
implicitly-declared copy constructor
cannot bind to a
<span class='texttt'>volatile</span>
lvalue; see <a href='diff.special'>[diff.special]</a>.</p></div></div></div></body></html>