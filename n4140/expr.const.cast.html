<!DOCTYPE html><html lang='en'><head><title>[expr.const.cast]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>5</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>5.2</a> Postfix expressions <a class='abbr_ref' href='expr.post#expr.const.cast'>[expr.post]</a></h2><div id='expr.const.cast'><h3 ><a class='secnum' style='min-width:103pt'>5.2.11</a> Const cast <a class='abbr_ref'>[expr.const.cast]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p ><span class='indexparent'><a class='index' id='expression,const_cast'></a></span><span class='indexparent'><a class='index' id='cast,const'></a></span>The result of the expression <span class='texttt'>const_cast&lt;T&gt;(v)</span> is of type
<span class='texttt'>T</span>. If <span class='texttt'>T</span> is an lvalue reference to object type, the result is an
lvalue;
if <span class='texttt'>T</span> is an rvalue reference to object type, the result is an xvalue;
otherwise, the result is a prvalue and the
lvalue-to-rvalue (<a href='conv.lval'>[conv.lval]</a>), array-to-pointer (<a href='conv.array'>[conv.array]</a>),
and function-to-pointer (<a href='conv.func'>[conv.func]</a>) standard conversions are
performed on the expression <span class='texttt'>v</span>. Conversions that can be performed explicitly using
<span class='texttt'>const_cast</span> are listed below. No other conversion shall be
performed explicitly using <span class='texttt'>const_cast</span>.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><p >[&nbsp;<i>Note:</i> 
Subject to the restrictions in this section, an expression may be cast
to its own type using a <span class='texttt'>const_cast</span> operator.
<i>&nbsp;—&nbsp;end note</i>&nbsp;] </p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><p >For two pointer types <span class='texttt'>T1</span> and <span class='texttt'>T2</span> where</p><p ><div class='indented'>
<a class='hidden_link' href='#def:T1' id='def:T1'><i>T1</i></a> is <span class='math'><span class='mathit'>cv</span><sub >1,0</sub></span> pointer to <span class='math'><span class='mathit'>cv</span><sub >1,1</sub></span> pointer
to <span class='math'>⋯ <span class='mathit'>cv</span><sub >1,<span class='mathalpha'>n</span>-1</sub></span> pointer to <span class='math'><span class='mathit'>cv</span><sub >1,<span class='mathalpha'>n</span></sub></span> <a class='hidden_link' href='#def:T' id='def:T'><i>T</i></a>
</div></p><p >and</p><p ><div class='indented'>
<a class='hidden_link' href='#def:T2' id='def:T2'><i>T2</i></a> is <span class='math'><span class='mathit'>cv</span><sub >2,0</sub></span> pointer to <span class='math'><span class='mathit'>cv</span><sub >2,1</sub></span> pointer
to <span class='math'>⋯ <span class='mathit'>cv</span><sub >2,<span class='mathalpha'>n</span>-1</sub></span> pointer to <span class='math'><span class='mathit'>cv</span><sub >2,<span class='mathalpha'>n</span></sub></span> <a class='hidden_link' href='#def:T' id='def:T'><i>T</i></a>
</div></p><p >where
<span class='texttt'>T</span> is any object type or the <span class='texttt'>void</span> type and where
<span class='math'><span class='mathit'>cv</span><sub >1,<span class='mathalpha'>k</span></sub></span> and <span class='math'><span class='mathit'>cv</span><sub >2,<span class='mathalpha'>k</span></sub></span> may be different
cv-qualifications, a prvalue of type <span class='texttt'>T1</span> may be explicitly
converted to the type <span class='texttt'>T2</span> using a <span class='texttt'>const_cast</span>. The result
of a pointer <span class='texttt'>const_cast</span> refers to the original object.</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><p >For two object types <span class='texttt'>T1</span> and <span class='texttt'>T2</span>, if a pointer to <span class='texttt'>T1</span> can
be explicitly converted to the type “pointer to <span class='texttt'>T2</span>” using a
<span class='texttt'>const_cast</span>, then the following conversions can also be made:</p><ul ><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><p >an lvalue of type <span class='texttt'>T1</span> can be explicitly converted to an lvalue
of type <span class='texttt'>T2</span> using the cast <span class='texttt'>const_cast&lt;T2&amp;&gt;</span>;</p></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><p >a glvalue of type <span class='texttt'>T1</span> can be explicitly converted to an xvalue
of type <span class='texttt'>T2</span> using the cast <span class='texttt'>const_cast&lt;T2&amp;&amp;&gt;</span>; and</p></li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div><p >if <span class='texttt'>T1</span> is a class type, a prvalue of type <span class='texttt'>T1</span> can be
explicitly converted to an xvalue of type <span class='texttt'>T2</span> using the cast
<span class='texttt'>const_cast&lt;T2&amp;&amp;&gt;</span>.
</p></li></ul><p >The result of a reference <span class='texttt'>const_cast</span> refers
to the original object.</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><p >For a <span class='texttt'>const_cast</span> involving pointers to data members, multi-level
pointers to data members and multi-level mixed pointers and pointers to
data members (<a href='conv.qual'>[conv.qual]</a>), the rules for <span class='texttt'>const_cast</span> are the
same as those used for pointers; the “member” aspect of a pointer to
member is ignored when determining where the cv-qualifiers are added or
removed by the <span class='texttt'>const_cast</span>. The result of a pointer to data
member <span class='texttt'>const_cast</span> refers to the same member as the original
(uncast) pointer to data member.</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><p >A null pointer value (<a href='conv.ptr'>[conv.ptr]</a>) is converted to the null pointer
value of the destination type. The null member pointer
value (<a href='conv.mem'>[conv.mem]</a>) is converted to the null member pointer value of
the destination type.</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><p >[&nbsp;<i>Note:</i> 
Depending on the type of the object, a write operation through the
pointer, lvalue or pointer to data member resulting from a
<span class='texttt'>const_cast</span> that casts away a const-qualifier<a class='footnotenum' href='#footnote-74'>74</a>
may produce undefined behavior (<a href='dcl.type.cv'>[dcl.type.cv]</a>).
<i>&nbsp;—&nbsp;end note</i>&nbsp;] </p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><p >The following rules define the process known as <a class='hidden_link' href='#def:casting_away
constness' id='def:casting_away
constness'><i>casting away
constness</i></a>. In these rules <span class='texttt'>T<a class='hidden_link' href='#def:n' id='def:n'><i>n</i></a> </span> and <span class='texttt'>X<a class='hidden_link' href='#def:n' id='def:n'><i>n</i></a> </span>
represent types. For two pointer types:</p><p ><div class='indented'>
<span class='texttt'>X1</span> is <span class='texttt'>T1</span><span class='math'><span class='mathit'>cv</span><sub >1,1</sub></span> <span class='texttt'>*</span> <span class='math'>⋯</span>
<span class='math'><span class='mathit'>cv</span><sub >1,<span class='mathalpha'>N</span></sub></span> <span class='texttt'>*</span> where <span class='texttt'>T1</span> is not a pointer type
</div></p><p ><div class='indented'>
<span class='texttt'>X2</span> is <span class='texttt'>T2</span><span class='math'><span class='mathit'>cv</span><sub >2,1</sub></span> <span class='texttt'>*</span> <span class='math'>⋯</span>
<span class='math'><span class='mathit'>cv</span><sub >2,<span class='mathalpha'>M</span></sub></span> <span class='texttt'>*</span> where <span class='texttt'>T2</span> is not a pointer type
</div></p><p ><div class='indented'>
<span class='math'><span class='mathalpha'>K</span></span> is <span class='math'><span class="mathrm">min</span> (<span class='mathalpha'>N</span>,<span class='mathalpha'>M</span>)</span>
</div></p><p >casting from <span class='texttt'>X1</span> to <span class='texttt'>X2</span> casts away constness if, for a
non-pointer type <span class='texttt'>T</span> there does not exist an implicit conversion
(Clause <a href='conv'>[conv]</a>) from:</p><p ><div class='indented'>
<span class='texttt'>T</span><span class='math'><span class='mathit'>cv</span><sub >1,(<span class='mathalpha'>N</span>-<span class='mathalpha'>K</span>+1)</sub></span> <span class='texttt'>*</span> <span class='math'><span class='mathit'>cv</span><sub >1,(<span class='mathalpha'>N</span>-<span class='mathalpha'>K</span>+2)</sub></span>
<span class='texttt'>*</span> <span class='math'>⋯</span> <span class='math'><span class='mathit'>cv</span><sub >1,<span class='mathalpha'>N</span></sub></span> <span class='texttt'>*</span>
</div></p><p >to</p><p ><div class='indented'>
<span class='texttt'>T</span><span class='math'><span class='mathit'>cv</span><sub >2,(<span class='mathalpha'>M</span>-<span class='mathalpha'>K</span>+1)</sub></span> <span class='texttt'>*</span> <span class='math'><span class='mathit'>cv</span><sub >2,(<span class='mathalpha'>M</span>-<span class='mathalpha'>K</span>+2)</sub></span>
<span class='texttt'>*</span> <span class='math'>⋯</span> <span class='math'><span class='mathit'>cv</span><sub >2,<span class='mathalpha'>M</span></sub></span> <span class='texttt'>*</span>
</div></p></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><p >Casting from an lvalue of type <span class='texttt'>T1</span> to an lvalue of type
<span class='texttt'>T2</span> using an lvalue reference cast
or casting from an expression of type <span class='texttt'>T1</span> to an xvalue of type <span class='texttt'>T2</span> using
an rvalue reference cast
casts away constness if a cast from a prvalue of type “pointer to <span class='texttt'>T1</span>” to the type “pointer to
<span class='texttt'>T2</span>” casts away constness.</p></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><p >Casting from a prvalue of type “pointer to data member of <span class='texttt'>X</span> of
type <span class='texttt'>T1</span>” to the type “pointer to data member of <span class='texttt'>Y</span> of
type <span class='texttt'>T2</span>” casts away constness if a cast from a prvalue of type
“pointer to <span class='texttt'>T1</span>” to the type “pointer to <span class='texttt'>T2</span>” casts
away constness.</p></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><p >For multi-level pointer to members and multi-level mixed pointers and
pointer to members (<a href='conv.qual'>[conv.qual]</a>), the “member” aspect of a pointer
to member level is ignored when determining if a <span class='texttt'>const</span>
cv-qualifier has been cast away.</p></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><p >[&nbsp;<i>Note:</i> 
some conversions which involve only changes in cv-qualification cannot
be done using <span class='texttt'>const_cast.</span> For instance, conversions between
pointers to functions are not covered because such conversions lead to
values whose use causes undefined behavior. For the same reasons,
conversions between pointers to member functions, and in particular, the
conversion from a pointer to a const member function to a pointer to a
non-const member function, are not covered.
<i>&nbsp;—&nbsp;end note</i>&nbsp;]<span class='indexparent'><a class='index' id='expression,postfix'></a></span></p></div><div class='footnote' id='footnote-74'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-74'>74)</a></div><p ><span class='texttt'>const_cast</span>
is not limited to conversions that cast away a
const-qualifier.</p></div></div></div></body></html>