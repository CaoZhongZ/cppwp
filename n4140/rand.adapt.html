<!DOCTYPE html><html lang='en'><head><title>[rand.adapt]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>26</a> Numerics library <a class='abbr_ref' href='./#numerics'>[numerics]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>26.5</a> Random number generation <a class='abbr_ref' href='rand#adapt'>[rand]</a></h2><div id='rand.adapt'><h3 ><a class='secnum' style='min-width:103pt'>26.5.4</a> Random number engine adaptor class templates <a class='abbr_ref'>[rand.adapt]</a></h3><div id='general'><h4 ><a class='secnum' href='#general' style='min-width:118pt'>26.5.4.1</a> In general <a class='abbr_ref' href='rand.adapt.general'>[rand.adapt.general]</a></h4><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><p >Each type instantiated
from a class template specified in this section <a href='rand.eng'>[rand.eng]</a>
satisfies the requirements
of a random number engine adaptor (<a href='rand.req.adapt'>[rand.req.adapt]</a>) type.</p></div><div class='para' id='general-2'><div class='marginalizedparent'><a class='marginalized' href='#general-2'>2</a></div><p >Except where specified otherwise,
the complexity of each function
specified in this section <a href='rand.adapt'>[rand.adapt]</a>
is constant.</p></div><div class='para' id='general-3'><div class='marginalizedparent'><a class='marginalized' href='#general-3'>3</a></div><p >Except
where specified otherwise,
no function described in this section <a href='rand.adapt'>[rand.adapt]</a>
throws an exception.</p></div><div class='para' id='general-4'><div class='marginalizedparent'><a class='marginalized' href='#general-4'>4</a></div><p >Descriptions are provided in this section <a href='rand.adapt'>[rand.adapt]</a>
only for adaptor operations
that are not described in section <a href='rand.req.adapt'>[rand.req.adapt]</a>
or for operations where there is additional semantic information.
In particular,
declarations for copy constructors,
for copy assignment operators,
for streaming operators,
and for equality and inequality operators
are not shown in the synopses.</p></div><div class='para' id='general-5'><div class='marginalizedparent'><a class='marginalized' href='#general-5'>5</a></div><p >Each template specified in this section <a href='rand.adapt'>[rand.adapt]</a>
requires one or more relationships,
involving the value(s) of its non-type template parameter(s), to hold.
A program instantiating any of these templates
is ill-formed
if any such required relationship fails to hold.</p></div></div><div id='disc'><h4 ><a class='secnum' href='#disc' style='min-width:118pt'>26.5.4.2</a> Class template <span class='texttt'>discard_block_engine</span> <a class='abbr_ref' href='rand.adapt.disc'>[rand.adapt.disc]</a></h4><p ><span class='indexparent'><a class='index' id='discard_block_engine'></a></span><span class='indexparent'><a class='index' id='random_number_engine_adaptor,discard_block_engine'></a></span></p><div class='para' id='disc-1'><div class='marginalizedparent'><a class='marginalized' href='#disc-1'>1</a></div><p >A <span class='texttt'>discard_block_engine</span> random number engine adaptor
produces random numbers
selected from those produced by some base engine <span class='math'><span class='mathalpha'>e</span></span>.
The state<span class='indexparent'><a class='index' id='discard_block_engine,state'></a></span><span class='indexparent'><a class='index' id='state,discard_block_engine'></a></span>
<span class='texttt'>x</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span>
of a <span class='texttt'>discard_block_engine</span> engine adaptor object <span class='texttt'>x</span>
consists of the state <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span> of its base engine <span class='texttt'>e</span>
and an additional integer <span class='math'><span class='mathalpha'>n</span></span>.
The size of the state is
 the size of <span class='math'><span class='mathalpha'>e</span></span>'s state plus <span class='math'>1</span>.</p></div><div class='para' id='disc-2'><div class='marginalizedparent'><a class='marginalized' href='#disc-2'>2</a></div><p >The transition algorithm<span class='indexparent'><a class='index' id='discard_block_engine,transition_algorithm'></a></span><span class='indexparent'><a class='index' id='transition_algorithm,discard_block_engine'></a></span>
discards all but <span class='math'><span class='mathalpha'>r</span> &gt; 0</span> values
from each block of <span class='math'><span class='mathalpha'>p</span> ≥ <span class='mathalpha'>r</span></span> values delivered by <span class='math'><span class='mathalpha'>e</span></span>.
The state transition is performed as follows:
If <span class='math'><span class='mathalpha'>n</span> ≥ <span class='mathalpha'>r</span></span>,
 advance the state of <span class='texttt'>e</span> from <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span> to <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>i</span>+<span class='mathalpha'>p</span>-<span class='mathalpha'>r</span></sub></span>
 and set <span class='math'><span class='mathalpha'>n</span></span> to <span class='math'>0</span>.
In any case,
 then increment <span class='math'><span class='mathalpha'>n</span></span>
 and advance <span class='texttt'>e</span>'s then-current state <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>j</span></sub></span>
 to <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>j</span>+1</sub></span>.</p></div><div class='para' id='disc-3'><div class='marginalizedparent'><a class='marginalized' href='#disc-3'>3</a></div><p >The generation algorithm<span class='indexparent'><a class='index' id='discard_block_engine,generation_algorithm'></a></span><span class='indexparent'><a class='index' id='generation_algorithm,discard_block_engine'></a></span>
yields the value returned by the last invocation of <span class='texttt'>e()</span>
 while advancing <span class='texttt'>e</span>'s state as described above.</p><pre class='codeblock'>
template&lt;class Engine, size_t p, size_t r&gt;
 class discard_block_engine{
public:
 <span class='comment'>// types
</span> typedef typename Engine::result_type result_type;

 <span class='comment'>// engine characteristics
</span> static constexpr size_t block_size = p;
 static constexpr size_t used_block = r;
 static constexpr result_type min() { return Engine::min(); }
 static constexpr result_type max() { return Engine::max(); }

 <span class='comment'>// constructors and seeding functions
</span> discard_block_engine();
 explicit discard_block_engine(const Engine&amp; e);
 explicit discard_block_engine(Engine&amp;&amp; e);
 explicit discard_block_engine(result_type s);
 template&lt;class Sseq&gt; explicit discard_block_engine(Sseq&amp; q);
 void seed();
 void seed(result_type s);
 template&lt;class Sseq&gt; void seed(Sseq&amp; q);

 <span class='comment'>// generating functions
</span> result_type operator()();
 void discard(unsigned long long z);

 <span class='comment'>// property functions
</span> const Engine&amp; base() const noexcept { return e; };

private:
 Engine e;   <span class='comment'>// <i>exposition only</i>
</span> int n;      <span class='comment'>// <i>exposition only</i>
</span>};
</pre></div><div class='para' id='disc-4'><div class='marginalizedparent'><a class='marginalized' href='#disc-4'>4</a></div><p >The following relations shall hold:
  <span class='texttt'>0 &lt; r</span>
and
  <span class='texttt'>r &lt;= p</span>.</p></div><div class='para' id='disc-5'><div class='marginalizedparent'><a class='marginalized' href='#disc-5'>5</a></div><p >The textual representation<span class='indexparent'><a class='index' id='discard_block_engine,textual_representation'></a></span><span class='indexparent'><a class='index' id='textual_representation,discard_block_engine'></a></span>
consists of
 the textual representation of <span class='texttt'>e</span>
followed by
 the value of <span class='texttt'>n</span>.</p></div><div class='para' id='disc-6'><div class='marginalizedparent'><a class='marginalized' href='#disc-6'>6</a></div><p >In addition to its behavior
pursuant to section <a href='rand.req.adapt'>[rand.req.adapt]</a>,
each constructor<span class='indexparent'><a class='index' id='discard_block_engine,constructor'></a></span>
that is not a copy constructor
sets <span class='texttt'>n</span> to <span class='math'>0</span>.</p></div></div><div id='ibits'><h4 ><a class='secnum' href='#ibits' style='min-width:118pt'>26.5.4.3</a> Class template <span class='texttt'>independent_bits_engine</span> <a class='abbr_ref' href='rand.adapt.ibits'>[rand.adapt.ibits]</a></h4><p ><span class='indexparent'><a class='index' id='independent_bits_engine'></a></span><span class='indexparent'><a class='index' id='random_number_engine_adaptor,independent_bits_engine'></a></span></p><div class='para' id='ibits-1'><div class='marginalizedparent'><a class='marginalized' href='#ibits-1'>1</a></div><p >An <span class='texttt'>independent_bits_engine</span>
random number engine adaptor
combines random numbers
that are produced by some base engine <span class='math'><span class='mathalpha'>e</span></span>,
so as to produce random numbers
with a specified number of bits <span class='math'><span class='mathalpha'>w</span></span>.
The state<span class='indexparent'><a class='index' id='independent_bits_engine,state'></a></span><span class='indexparent'><a class='index' id='state,independent_bits_engine'></a></span>
<span class='texttt'>x</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span>
of an <span class='texttt'>independent_bits_engine</span>
engine adaptor object <span class='texttt'>x</span>
consists of
 the state <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span> of its base engine <span class='texttt'>e</span>;
the size of the state is
 the size of <span class='math'><span class='mathalpha'>e</span></span>'s state.</p></div><div class='para' id='ibits-2'><div class='marginalizedparent'><a class='marginalized' href='#ibits-2'>2</a></div><p >The transition and generation algorithms
are described in terms
of the following integral constants:</p><ol class='enumeratea'><li ><p >Let
     <span class='math'> <span class='mathalpha'>R</span> = <span class='texttt'>e.max() - e.min() + 1</span> </span>
   and
     <span class='math'> <span class='mathalpha'>m</span> = <span class='left'></span>⌊ <span class="mathrm">log</span><sub >2</sub> <span class='mathalpha'>R</span> <span class='right'></span>⌋ </span>.
 </p></li><li ><p >With <span class='math'><span class='mathalpha'>n</span></span> as determined below,
   let
     <span class='math'> <span class='mathalpha'>w</span><sub >0</sub> = <span class='left'></span>⌊ <span class='mathalpha'>w</span> / <span class='mathalpha'>n</span> <span class='right'></span>⌋ </span>,
     <span class='math'> <span class='mathalpha'>n</span><sub >0</sub> = <span class='mathalpha'>n</span> - <span class='mathalpha'>w</span> <span class="mathrm">mod</span> <span class='mathalpha'>n</span> </span>,
     <span class='math'> <span class='mathalpha'>y</span><sub >0</sub> = 2<sup ><span class='mathalpha'>w</span><sub >0</sub></sup> <span class='left'></span>⌊ <span class='mathalpha'>R</span> / 2<sup ><span class='mathalpha'>w</span><sub >0</sub></sup> <span class='right'></span>⌋ </span>,
   and
     <span class='math'> <span class='mathalpha'>y</span><sub >1</sub> = 2<sup ><span class='mathalpha'>w</span><sub >0</sub> + 1</sup> <span class='left'></span>⌊ <span class='mathalpha'>R</span> / 2<sup ><span class='mathalpha'>w</span><sub >0</sub> + 1</sup> <span class='right'></span>⌋ </span>.
 </p></li><li ><p >Let
     <span class='math'> <span class='mathalpha'>n</span> = <span class='left'></span>⌈ <span class='mathalpha'>w</span> / <span class='mathalpha'>m</span> <span class='right'></span>⌉ </span>
   if and only if the relation
     <span class='math'> <span class='mathalpha'>R</span> - <span class='mathalpha'>y</span><sub >0</sub> ≤ <span class='left'></span>⌊ <span class='mathalpha'>y</span><sub >0</sub> / <span class='mathalpha'>n</span> <span class='right'></span>⌋ </span>
   holds as a result.
   Otherwise let
     <span class='math'> <span class='mathalpha'>n</span> = 1 + <span class='left'></span>⌈ <span class='mathalpha'>w</span> / <span class='mathalpha'>m</span> <span class='right'></span>⌉ </span>.
</p></li></ol><p >[&nbsp;<i>Note:</i>
 The relation
 <span class='math'> <span class='mathalpha'>w</span> = <span class='mathalpha'>n</span><sub >0</sub> <span class='mathalpha'>w</span><sub >0</sub> + (<span class='mathalpha'>n</span> - <span class='mathalpha'>n</span><sub >0</sub>)(<span class='mathalpha'>w</span><sub >0</sub> + 1) </span>
 always holds.
<i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div><div class='para' id='ibits-3'><div class='marginalizedparent'><a class='marginalized' href='#ibits-3'>3</a></div><p >The transition algorithm<span class='indexparent'><a class='index' id='independent_bits_engine,transition_algorithm'></a></span><span class='indexparent'><a class='index' id='transition_algorithm,independent_bits_engine'></a></span>
is carried out
by invoking <span class='texttt'>e()</span>
as often as needed
to obtain
 <span class='math'> <span class='mathalpha'>n</span><sub >0</sub> </span>
values less than
<span class='math'> <span class='mathalpha'>y</span><sub >0</sub> </span> <span class='math'> + <span class='texttt'>e.min()</span> </span>
and
 <span class='math'> <span class='mathalpha'>n</span> - <span class='mathalpha'>n</span><sub >0</sub> </span>
values less than <span class='math'> <span class='mathalpha'>y</span><sub >1</sub> + <span class='texttt'>e.min()</span> </span>.</p></div><div class='para' id='ibits-4'><div class='marginalizedparent'><a class='marginalized' href='#ibits-4'>4</a></div><p >The generation algorithm<span class='indexparent'><a class='index' id='independent_bits_engine,generation_algorithm'></a></span><span class='indexparent'><a class='index' id='generation_algorithm,independent_bits_engine'></a></span>
uses the values produced
while advancing the state as described above
to yield a quantity <span class='math'><span class='mathalpha'>S</span></span>
obtained as if by the following algorithm:
</p><pre class='codeblock'>
<span class='math'><span class='mathalpha'>S</span></span> = 0;
for (<span class='math'><span class='mathalpha'>k</span></span> = <span class='math'>0</span>; <span class='math'><span class='mathalpha'>k</span> ≠ <span class='mathalpha'>n</span><sub >0</sub></span>; <span class='math'><span class='mathalpha'>k</span></span> += <span class='math'>1</span>)  {
 do <span class='math'><span class='mathalpha'>u</span></span> = e() - e.min(); while (<span class='math'> <span class='mathalpha'>u</span> ≥ <span class='mathalpha'>y</span><sub >0</sub> </span>);
 <span class='math'><span class='mathalpha'>S</span></span> = <span class='math'> 2<sup ><span class='mathalpha'>w</span><sub >0</sub></sup> · <span class='mathalpha'>S</span> + <span class='mathalpha'>u</span> <span class="mathrm">mod</span> 2<sup ><span class='mathalpha'>w</span><sub >0</sub></sup> </span>;
}
for (<span class='math'><span class='mathalpha'>k</span></span> = <span class='math'><span class='mathalpha'>n</span><sub >0</sub></span>; <span class='math'><span class='mathalpha'>k</span> ≠ <span class='mathalpha'>n</span></span>; <span class='math'><span class='mathalpha'>k</span></span> += <span class='math'>1</span>)  {
 do <span class='math'><span class='mathalpha'>u</span></span> = e() - e.min(); while (<span class='math'> <span class='mathalpha'>u</span> ≥ <span class='mathalpha'>y</span><sub >1</sub> </span>);
 <span class='math'><span class='mathalpha'>S</span></span> = <span class='math'> 2<sup ><span class='mathalpha'>w</span><sub >0</sub> + 1</sup> · <span class='mathalpha'>S</span> + <span class='mathalpha'>u</span> <span class="mathrm">mod</span> 2<sup ><span class='mathalpha'>w</span><sub >0</sub> + 1</sup> </span>;
}
</pre><pre class='codeblock'>
template&lt;class Engine, size_t w, class UIntType&gt;
class independent_bits_engine{
public:
 <span class='comment'>// types
</span> typedef UIntType result_type;

 <span class='comment'>// engine characteristics
</span> static constexpr result_type min() { return 0; }
 static constexpr result_type max() { return <span class='math'>2<sup ><span class='mathalpha'>w</span></sup> - 1</span>; }

 <span class='comment'>// constructors and seeding functions
</span> independent_bits_engine();
 explicit independent_bits_engine(const Engine&amp; e);
 explicit independent_bits_engine(Engine&amp;&amp; e);
 explicit independent_bits_engine(result_type s);
 template&lt;class Sseq&gt; explicit independent_bits_engine(Sseq&amp; q);
 void seed();
 void seed(result_type s);
 template&lt;class Sseq&gt; void seed(Sseq&amp; q);

 <span class='comment'>// generating functions
</span> result_type operator()();
 void discard(unsigned long long z);

 <span class='comment'>// property functions
</span> const Engine&amp; base() const noexcept { return e; };

private:
 Engine e;   <span class='comment'>// <i>exposition only</i>
</span>};
</pre></div><div class='para' id='ibits-5'><div class='marginalizedparent'><a class='marginalized' href='#ibits-5'>5</a></div><p >The following relations shall hold:
  <span class='texttt'>0 &lt; w</span>
and
  <span class='texttt'>w &lt;= numeric_limits&lt;result_type&gt;::digits</span>.</p></div><div class='para' id='ibits-6'><div class='marginalizedparent'><a class='marginalized' href='#ibits-6'>6</a></div><p >The textual representation<span class='indexparent'><a class='index' id='independent_bits_engine,textual_representation'></a></span><span class='indexparent'><a class='index' id='textual_representation,independent_bits_engine'></a></span>
consists of
 the textual representation of <span class='texttt'>e</span>.</p></div></div><div id='shuf'><h4 ><a class='secnum' href='#shuf' style='min-width:118pt'>26.5.4.4</a> Class template <span class='texttt'>shuffle_order_engine</span> <a class='abbr_ref' href='rand.adapt.shuf'>[rand.adapt.shuf]</a></h4><p ><span class='indexparent'><a class='index' id='shuffle_order_engine'></a></span><span class='indexparent'><a class='index' id='random_number_engine_adaptor,shuffle_order_engine'></a></span></p><div class='para' id='shuf-1'><div class='marginalizedparent'><a class='marginalized' href='#shuf-1'>1</a></div><p >A <span class='texttt'>shuffle_order_engine</span> random number engine adaptor
produces the same random numbers
that are produced by some base engine <span class='math'><span class='mathalpha'>e</span></span>,
but delivers them in a different sequence.
The state<span class='indexparent'><a class='index' id='shuffle_order_engine,state'></a></span><span class='indexparent'><a class='index' id='state,shuffle_order_engine'></a></span>
<span class='texttt'>x</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span>
of a <span class='texttt'>shuffle_order_engine</span> engine adaptor object <span class='texttt'>x</span>
consists of
 the state <span class='texttt'>e</span><span class='math'><sub ><span class='mathalpha'>i</span></sub></span> of its base engine <span class='texttt'>e</span>,
 an additional value <span class='math'><span class='mathalpha'>Y</span></span> of the type delivered by <span class='texttt'>e</span>,
and
 an additional sequence <span class='math'><span class='mathalpha'>V</span></span> of <span class='math'><span class='mathalpha'>k</span></span> values
 also of the type delivered by <span class='texttt'>e</span>.
The size of the state is
 the size of <span class='math'><span class='mathalpha'>e</span></span>'s state plus <span class='math'><span class='mathalpha'>k</span>+1</span>.</p></div><div class='para' id='shuf-2'><div class='marginalizedparent'><a class='marginalized' href='#shuf-2'>2</a></div><p >The transition algorithm<span class='indexparent'><a class='index' id='shuffle_order_engine,transition_algorithm'></a></span><span class='indexparent'><a class='index' id='transition_algorithm,shuffle_order_engine'></a></span>
permutes the values produced by <span class='math'><span class='mathalpha'>e</span></span>.
The state transition is performed as follows:
</p><ol class='enumeratea'><li ><p >Calculate an integer
   <img src='math/8482866468370349167.png' class='mathinlineimg' alt='$j = \left\lfloor \frac{k \cdot (Y - e_{\min})}
                          {e_{\max} - e_{\min} +1}
        \right\rfloor
   $'/>   .
 </p></li><li ><p >Set <span class='math'><span class='mathalpha'>Y</span></span> to <span class='math'><span class='mathalpha'>V</span><sub ><span class='mathalpha'>j</span></sub></span> and then set <span class='math'><span class='mathalpha'>V</span><sub ><span class='mathalpha'>j</span></sub></span> to <span class='math'><span class='texttt'>e()</span></span>.
</p></li></ol></div><div class='para' id='shuf-3'><div class='marginalizedparent'><a class='marginalized' href='#shuf-3'>3</a></div><p >The generation algorithm<span class='indexparent'><a class='index' id='shuffle_order_engine,generation_algorithm'></a></span><span class='indexparent'><a class='index' id='generation_algorithm,shuffle_order_engine'></a></span>
yields the last value of <span class='texttt'>Y</span>
 produced while advancing <span class='texttt'>e</span>'s state as described above.</p><pre class='codeblock'>
template&lt;class Engine, size_t k&gt;
 class shuffle_order_engine{
public:
 <span class='comment'>// types
</span> typedef typename Engine::result_type result_type;

 <span class='comment'>// engine characteristics
</span> static constexpr size_t table_size = k;
 static constexpr result_type min() { return Engine::min(); }
 static constexpr result_type max() { return Engine::max(); }

 <span class='comment'>// constructors and seeding functions
</span> shuffle_order_engine();
 explicit shuffle_order_engine(const Engine&amp; e);
 explicit shuffle_order_engine(Engine&amp;&amp; e);
 explicit shuffle_order_engine(result_type s);
 template&lt;class Sseq&gt; explicit shuffle_order_engine(Sseq&amp; q);
 void seed();
 void seed(result_type s);
 template&lt;class Sseq&gt; void seed(Sseq&amp; q);

 <span class='comment'>// generating functions
</span> result_type operator()();
 void discard(unsigned long long z);

 <span class='comment'>// property functions
</span> const Engine&amp; base() const noexcept { return e; };

private:
 Engine e;           <span class='comment'>// <i>exposition only</i>
</span> result_type Y;      <span class='comment'>// <i>exposition only</i>
</span> result_type V[k];   <span class='comment'>// <i>exposition only</i>
</span>};
</pre></div><div class='para' id='shuf-4'><div class='marginalizedparent'><a class='marginalized' href='#shuf-4'>4</a></div><p >The following relation shall hold:
  <span class='texttt'>0 &lt; k</span>.</p></div><div class='para' id='shuf-5'><div class='marginalizedparent'><a class='marginalized' href='#shuf-5'>5</a></div><p >The textual representation<span class='indexparent'><a class='index' id='shuffle_order_engine,textual_representation'></a></span><span class='indexparent'><a class='index' id='textual_representation,shuffle_order_engine'></a></span>
consists of
 the textual representation of <span class='texttt'>e</span>,
followed by
 the <span class='texttt'>k</span> values of <span class='math'><span class='mathalpha'>V</span></span>,
followed by
 the value of <span class='math'><span class='mathalpha'>Y</span></span>.</p></div><div class='para' id='shuf-6'><div class='marginalizedparent'><a class='marginalized' href='#shuf-6'>6</a></div><p >In addition to its behavior
pursuant to section <a href='rand.req.adapt'>[rand.req.adapt]</a>,
each constructor<span class='indexparent'><a class='index' id='shuffle_order_engine,constructor'></a></span>
that is not a copy constructor
initializes <span class='math'><span class='texttt'>V[0]</span>, &hellip;, <span class='texttt'>V[k-1]</span></span> and <span class='math'><span class='mathalpha'>Y</span></span>,
in that order,
with values returned by successive invocations of <span class='texttt'>e()</span>.<span class='indexparent'><a class='index' id='random_number_generation,engines'></a></span></p></div></div></div></div></body></html>