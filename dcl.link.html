<!DOCTYPE html><html lang='en'><head><title>[dcl.link]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>9</a> Declarations <a class='abbr_ref' href='./#dcl.dcl'>[dcl.dcl]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>9.10</a> Linkage specifications <a class='abbr_ref'>[dcl.link]</a></h2><span class='indexparent'><a class='index' id=':specification,linkage'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7565'>#</a></div><div id='1.sentence-1' class='sentence'>All function types, function names with external linkage, and variable
names with external linkage have a <a class='hidden_link' href='#def:language_linkage' id='def:language_linkage'><i >language linkage</i></a><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-2' class='sentence'>Some of the properties associated with an entity with language linkage
are specific to each implementation and are not described here<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>For
example, a particular language linkage may be associated with a
particular form of representing names of objects and functions with
external linkage, or with a particular calling convention, etc<a class='hidden_link' href='#1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='1.sentence-4' class='sentence'>
The default language linkage of all function types, function names, and
variable names is C++ language linkage<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='1.sentence-5' class='sentence'>Two function types with
different language linkages are distinct types even if they are
otherwise identical<a class='hidden_link' href='#1.sentence-5'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7580'>#</a></div><div id='2.sentence-1' class='sentence'><a href='basic.link'>Linkage</a> between C++ and  non-C++ code fragments can
be achieved using a <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>:</div><span class='indexparent'><a class='index' id=':linkage-specification'></a></span><span class='indexparent'><a class='index' id=':specification,linkage,extern'></a></span><pre class='bnf'><a class='nontermdef' href='#nt:linkage-specification' id='nt:linkage-specification'>linkage-specification:</a>
&#9;<span class='terminal'>extern</span> <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> <span class='terminal'>{</span> <i ><a href='dcl.dcl#nt:declaration-seq'>declaration-seq</a></i><span class="mjx-chtml"><span class="mjx-math" aria-label="Subscript o p t"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>}</span>
&#9;<span class='terminal'>extern</span> <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> <i ><a href='dcl.dcl#nt:declaration'>declaration</a></i>
</pre><div id='2.sentence-2' class='sentence'>The <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> indicates the required language linkage<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>This document specifies the semantics for the
<i ><a href='lex.string#nt:string-literal'>string-literal</a></i><span class='textit'>s</span> <span class='texttt'>"C"</span> and <span class='texttt'>"C++"</span><a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'>Use of a
<i ><a href='lex.string#nt:string-literal'>string-literal</a></i> other than <span class='texttt'>"C"</span> or <span class='texttt'>"C++"</span> is
conditionally-supported, with <span class='indexparent'><a class='index' id=':semantics_of_linkage_specifiers'></a></span>implementation-defined semantics<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-5' class='sentence'>Therefore, a linkage-specification with a <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> that
is unknown to the implementation requires a diagnostic<a class='hidden_link' href='#2.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='2.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-6' class='sentence'>It is recommended that the spelling of the <i ><a href='lex.string#nt:string-literal'>string-literal</a></i> be
taken from the document defining that language<a class='hidden_link' href='#2.sentence-6'>.</a></div> <div id='2.sentence-7' class='sentence'>For example, <span class='texttt'>Ada</span>
(not <span class='texttt'>ADA</span>) and <span class='texttt'>Fortran</span> or <span class='texttt'>FORTRAN</span>, depending on
the vintage<a class='hidden_link' href='#2.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7609'>#</a></div><div id='3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':specification,linkage,implementation-defined'></a></span>Every implementation shall provide for linkage to functions written in
the C programming language,
<span class='indexparent'><a class='index' id=':C,linkage_to'></a></span><span class='texttt'>"C"</span>, and linkage to C++ functions, <span class='texttt'>"C++"</span><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
complex sqrt(complex);          <span class='comment'>// C++ linkage by default
</span>extern "C" {
  double sqrt(double);          <span class='comment'>// C linkage
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7624'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':specification,linkage,nesting'></a></span>Linkage specifications nest<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>When linkage specifications nest, the
innermost one determines the language linkage<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>A linkage specification
does not establish a scope<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'>A <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i> shall
occur only in <a href='basic.scope.namespace'>namespace scope</a><a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.sentence-5' class='sentence'>In a
<i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>, the specified language linkage applies
to the function types of all function declarators, function names with
external linkage, and variable names with external linkage declared
within the <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i><a class='hidden_link' href='#4.sentence-5'>.</a></div> <div id='4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
extern "C"                      <span class='comment'>// the name <span class='tcode_in_codeblock'>f1</span> and its function type have C language linkage;
</span>  void f1(void(*pf)(int));      <span class='comment'>// <span class='tcode_in_codeblock'>pf</span> is a pointer to a C function
</span>
extern "C" typedef void FUNC();
FUNC f2;                        <span class='comment'>// the name <span class='tcode_in_codeblock'>f2</span> has C++ language linkage and the
</span>                                <span class='comment'>// function's type has C language linkage
</span>
extern "C" FUNC f3;             <span class='comment'>// the name of function <span class='tcode_in_codeblock'>f3</span> and the function's type have C language linkage
</span>
void (*pf2)(FUNC*);             <span class='comment'>// the name of the variable <span class='tcode_in_codeblock'>pf2</span> has C++ linkage and the type
</span>                                <span class='comment'>// of <span class='tcode_in_codeblock'>pf2</span> is “pointer to C++ function that takes one parameter of type
</span>                                <span class='comment'>// pointer to C function”
</span>extern "C" {
  static void f4();             <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>f4</span> has internal linkage (not C language linkage)
</span>                                <span class='comment'>// and the function's type has C language linkage.
</span>}

extern "C" void f5() {
  extern void f4();             <span class='comment'>// OK: Name linkage (internal) and function type linkage (C language linkage)
</span>                                <span class='comment'>// obtained from previous declaration.
</span>}

extern void f4();               <span class='comment'>// OK: Name linkage (internal) and function type linkage (C language linkage)
</span>                                <span class='comment'>// obtained from previous declaration.
</span>
void f6() {
  extern void f4();             <span class='comment'>// OK: Name linkage (internal) and function type linkage (C language linkage)
</span>                                <span class='comment'>// obtained from previous declaration.
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='4.sentence-6' class='sentence'><span class='indexparent'><a class='index' id=':class,linkage_specification'></a></span>A C language linkage is ignored
in determining the language linkage of
the names of class members and the
function type of class member functions<a class='hidden_link' href='#4.sentence-6'>.</a></div> <div id='4.example-2' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#4.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
extern "C" typedef void FUNC_c();

class C {
  void mf1(FUNC_c*);            <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf1</span> and the member function's type have
</span>                                <span class='comment'>// C++ language linkage; the parameter has type “pointer to C function”
</span>
  FUNC_c mf2;                   <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf2</span> and the member function's type have
</span>                                <span class='comment'>// C++ language linkage
</span>
  static FUNC_c* q;             <span class='comment'>// the name of the data member <span class='tcode_in_codeblock'>q</span> has C++ language linkage and
</span>                                <span class='comment'>// the data member's type is “pointer to C function”
</span>};

extern "C" {
  class X {
    void mf();                  <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf</span> and the member function's type have
</span>                                <span class='comment'>// C++ language linkage
</span>    void mf2(void(*)());        <span class='comment'>// the name of the function <span class='tcode_in_codeblock'>mf2</span> has C++ language linkage;
</span>                                <span class='comment'>// the parameter has type “pointer to C function”
</span>  };
}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7698'>#</a></div><div id='5.sentence-1' class='sentence'>If two declarations declare functions with the same name and
<a href='dcl.fct#def:parameter-type-list'>parameter-type-list</a> to be members of the same
namespace or declare objects with the same name to be members of the same
namespace and the declarations give the names different language linkages, the
program is ill-formed; no diagnostic is required if the declarations appear in
different translation units<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':consistency,linkage_specification'></a></span>Except for functions with C++ linkage, a function declaration without a
linkage specification shall not precede the first linkage specification
for that function<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>A function can be declared without a linkage
specification after an explicit linkage specification has been seen; the
linkage explicitly specified in the earlier declaration is not affected
by such a function declaration<a class='hidden_link' href='#5.sentence-3'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7713'>#</a></div><div id='6.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':function,linkage_specification_overloaded'></a></span>At most one function with a particular name can have C language linkage<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>Two declarations for a function with C language linkage with the same
function name (ignoring the namespace names that qualify it) that appear
in different namespace scopes refer to the same function<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>Two
declarations for a variable with C language linkage with the same name
(ignoring the namespace names that qualify it) that appear in different
namespace scopes refer to the same variable<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.sentence-4' class='sentence'>An entity with C language linkage shall not be declared with the same name
as a variable in global scope, unless both declarations denote the same entity;
no diagnostic is required if the declarations appear in different translation units<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='6.sentence-5' class='sentence'>A variable with C language linkage shall not be declared with the same name as a
function with C language linkage (ignoring the namespace names that qualify the
respective names); no diagnostic is required if the declarations appear in
different translation units<a class='hidden_link' href='#6.sentence-5'>.</a></div> <div id='6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='6.sentence-6' class='sentence'>Only
one definition for an entity with a given name
with C language linkage may appear in the
program (see <a href='basic.def.odr'>[basic.def.odr]</a>);
this implies that such an entity
must not be defined in more
than one namespace scope<a class='hidden_link' href='#6.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='6.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
int x;
namespace A {
  extern "C" int f();
  extern "C" int g() { return 1; }
  extern "C" int h();
  extern "C" int x();               <span class='comment'>// ill-formed: same name as global-space object <span class='tcode_in_codeblock'>x</span>
</span>}

namespace B {
  extern "C" int f();               <span class='comment'>// <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;f</span> and <span class='tcode_in_codeblock'>B&#x200b;::&#x200b;f</span> refer to the same function
</span>  extern "C" int g() { return 1; }  <span class='comment'>// ill-formed, the function <span class='tcode_in_codeblock'>g</span> with C language linkage has two definitions
</span>}

int A::f() { return 98; }           <span class='comment'>// definition for the function <span class='tcode_in_codeblock'>f</span> with C language linkage
</span>extern "C" int h() { return 97; }   <span class='comment'>// definition for the function <span class='tcode_in_codeblock'>h</span> with C language linkage
</span>                                    <span class='comment'>// <span class='tcode_in_codeblock'>A&#x200b;::&#x200b;h</span> and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;h</span> refer to the same function
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7759'>#</a></div><div id='7.sentence-1' class='sentence'>A declaration directly contained in a
<i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>
is treated as if it contains the
<a href='dcl.stc#:extern'><span class='texttt'>extern</span>
specifier</a> for the purpose of determining the linkage of the
declared name and whether it is a definition<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>Such a declaration shall
not specify a storage class<a class='hidden_link' href='#7.sentence-2'>.</a></div> <div id='7.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
extern "C" double f();
static double f();                  <span class='comment'>// error
</span>extern "C" int i;                   <span class='comment'>// declaration
</span>extern "C" {
  int i;                            <span class='comment'>// definition
</span>}
extern "C" static void g();         <span class='comment'>// error
</span></pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7780'>#</a></div><div id='8.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='8.sentence-1' class='sentence'>Because the language linkage is part of a function type, when
indirecting through a pointer to C function, the function to
which the resulting lvalue refers is considered a C function<a class='hidden_link' href='#8.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/72f1bb19b4700cf4c6478b84a517150a43a91dd2/source/declarations.tex#L7787'>#</a></div><div id='9.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object,linkage_specification'></a></span><span class='indexparent'><a class='index' id=':linkage,implementation-defined_object'></a></span>Linkage from C++ to objects defined in other languages and to objects
defined in C++ from other languages is <span class='indexparent'><a class='index' id=':linkage_of_objects_between_C++_and_other_languages'></a></span>implementation-defined and
language-dependent<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>Only where the object layout strategies of two
language implementations are similar enough can such linkage be
achieved<a class='hidden_link' href='#9.sentence-2'>.</a></div> </div></div></body></html>