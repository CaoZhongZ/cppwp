<!DOCTYPE html><html lang='en'><head><title>[diff.cpp17]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:73pt'>Annex C&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>C.5</a> C++ and ISO C++ 2017 <a class='abbr_ref'>[diff.cpp17]</a></h2><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/61b6c21f218e3cbb9d15426975f1a26d8b72a7fe/source/compatibility.tex#L1830'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':summary,compatibility_with_ISO_C++_2017'></a></span>This subclause lists the differences between C++ and
ISO C++ 2017 (ISO/IEC 14882:2017, <span class='textit'>Programming Languages â€” C++</span>),
by the chapters of this document<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div id='lex' class='section'><h3 ><a class='secnum' href='#lex' style='min-width:103pt'>C.5.1</a> <a href='lex'>[lex]</a>: lexical conventions <a class='abbr_ref' href='diff.cpp17.lex'>[diff.cpp17.lex]</a></h3><div class='para' id='lex-1'><div class='marginalizedparent'><a class='marginalized' href='#lex-1'>1</a></div><div id='lex-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='lex.key'>[lex.key]</a>
<br/><b>Change:</b> New keywords<a class='hidden_link' href='#lex-1.sentence-1'>.</a></div> <div id='lex-1.sentence-2' class='sentence'><br/><b>Rationale:</b> Required for new features<a class='hidden_link' href='#lex-1.sentence-2'>.</a></div> <div id='lex-1.sentence-3' class='sentence'>The <span class='texttt'>requires</span> keyword is added
to introduce constraints through a <i ><a href='temp#nt:requires-clause'>requires-clause</a></i> or
a <i ><a href='expr.prim.req#nt:requires-expression'>requires-expression</a></i><a class='hidden_link' href='#lex-1.sentence-3'>.</a></div> <div id='lex-1.sentence-4' class='sentence'>The <span class='texttt'>concept</span> keyword is
added to enable the definition of concepts (<a href='temp.concept'>[temp.concept]</a>)<a class='hidden_link' href='#lex-1.sentence-4'>.</a></div> <div id='lex-1.sentence-5' class='sentence'><br/><b>Effect on original feature:</b> 
Valid ISO C++ 2017 code using <span class='texttt'>concept</span> or <span class='texttt'>requires</span>
as an identifier is not valid in this International Standard<a class='hidden_link' href='#lex-1.sentence-5'>.</a></div></div><div class='para' id='lex-2'><div class='marginalizedparent'><a class='marginalized' href='#lex-2'>2</a></div><div id='lex-2.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='lex.operators'>[lex.operators]</a>
<br/><b>Change:</b> New operator <span class='texttt'>&lt;=&gt;</span><a class='hidden_link' href='#lex-2.sentence-1'>.</a></div> <div id='lex-2.sentence-2' class='sentence'><br/><b>Rationale:</b> Necessary for new functionality<a class='hidden_link' href='#lex-2.sentence-2'>.</a></div> <div id='lex-2.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> Valid C++ 2017 code that contains a <span class='texttt'>&lt;=</span> token
immediately followed by a <span class='texttt'>&gt;</span> token
may be ill-formed or have different semantics in this International Standard:
<pre class='codeblock'>
namespace N {
  struct X {};
  bool operator&lt;=(X, X);
  template&lt;bool(X, X)&gt; struct Y {};
  Y&lt;operator&lt;=&gt; y;              <span class='comment'>// ill-formed; previously well-formed
</span>}</pre></div></div></div><div id='expr' class='section'><h3 ><a class='secnum' href='#expr' style='min-width:103pt'>C.5.2</a> <a href='expr'>[expr]</a>: expressions <a class='abbr_ref' href='diff.cpp17.expr'>[diff.cpp17.expr]</a></h3><div class='para' id='expr-1'><div class='marginalizedparent'><a class='marginalized' href='#expr-1'>1</a></div><div id='expr-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='expr.prim.lambda.capture'>[expr.prim.lambda.capture]</a>
<br/><b>Change:</b> Implicit lambda capture may capture additional entities<a class='hidden_link' href='#expr-1.sentence-1'>.</a></div> <div id='expr-1.sentence-2' class='sentence'><br/><b>Rationale:</b> Rule simplification, necessary to resolve interactions with constexpr if<a class='hidden_link' href='#expr-1.sentence-2'>.</a></div> <div id='expr-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> Lambdas with a <i ><a href='expr.prim.lambda.capture#nt:capture-default'>capture-default</a></i>
may capture local entities
that were not captured in C++ 2017
if those entities are only referenced in contexts
that do not result in an odr-use<a class='hidden_link' href='#expr-1.sentence-3'>.</a></div></div></div><div id='special' class='section'><h3 ><a class='secnum' href='#special' style='min-width:103pt'>C.5.3</a> <a href='special'>[special]</a>: special member functions <a class='abbr_ref' href='diff.cpp17.special'>[diff.cpp17.special]</a></h3><div class='para' id='special-1'><div class='marginalizedparent'><a class='marginalized' href='#special-1'>1</a></div><div id='special-1.sentence-1' class='sentence'><b>Affected subclauses:</b> <a href='class.ctor'>[class.ctor]</a>, <a href='class.dtor'>[class.dtor]</a>
<br/><b>Change:</b> 
A <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>
is no longer valid as the <i ><a href='dcl.decl#nt:declarator-id'>declarator-id</a></i> of a constructor or destructor<a class='hidden_link' href='#special-1.sentence-1'>.</a></div> <div id='special-1.sentence-2' class='sentence'><br/><b>Rationale:</b> 
Remove potentially error-prone option for redundancy<a class='hidden_link' href='#special-1.sentence-2'>.</a></div> <div id='special-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Valid C++ 2017 code may fail to compile
in this International Standard<a class='hidden_link' href='#special-1.sentence-3'>.</a></div> <div id='special-1.sentence-4' class='sentence'>For example:
<pre class='codeblock'>
template&lt;class T&gt;
struct A {
  A&lt;T&gt;();          <span class='comment'>// error: <span class='grammarterm'>simple-template-id</span> not allowed for constructor
</span>  A(int);          <span class='comment'>// OK, <span class='grammarterm'>injected-class-name</span> used
</span>  ~A&lt;T&gt;();         <span class='comment'>// error: <span class='grammarterm'>simple-template-id</span> not allowed for destructor
</span>};</pre></div></div></div><div id='temp' class='section'><h3 ><a class='secnum' href='#temp' style='min-width:103pt'>C.5.4</a> <a href='temp'>[temp]</a>: templates <a class='abbr_ref' href='diff.cpp17.temp'>[diff.cpp17.temp]</a></h3><div class='para' id='temp-1'><div class='marginalizedparent'><a class='marginalized' href='#temp-1'>1</a></div><div id='temp-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='temp.names'>[temp.names]</a>
<br/><b>Change:</b> 
An <i ><a href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a></i>
that is followed by a <span class='texttt'>&lt;</span>
and for which name lookup
finds nothing or finds a function
will be treated as a <i ><a href='temp.names#nt:template-name'>template-name</a></i>
in order to potentially cause argument dependent lookup to be performed<a class='hidden_link' href='#temp-1.sentence-1'>.</a></div> <div id='temp-1.sentence-2' class='sentence'><br/><b>Rationale:</b> 
It was problematic to call a function template
with an explicit template argument list
via argument dependent lookup
because of the need to have a template with the same name
visible via normal lookup<a class='hidden_link' href='#temp-1.sentence-2'>.</a></div> <div id='temp-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Previously valid code that uses a function name
as the left operand of a <span class='texttt'>&lt;</span> operator
would become ill-formed<a class='hidden_link' href='#temp-1.sentence-3'>.</a></div> <pre class='codeblock'>
struct A {};
bool operator&lt;(void (*fp)(), A);
void f() {}
int main() {
  A a;
  f &lt; a;    <span class='comment'>// ill-formed; previously well-formed
</span>  (f) &lt; a;  <span class='comment'>// still well formed
</span>}</pre></div></div><div id='library' class='section'><h3 ><a class='secnum' href='#library' style='min-width:103pt'>C.5.5</a> <a href='library'>[library]</a>: library introduction <a class='abbr_ref' href='diff.cpp17.library'>[diff.cpp17.library]</a></h3><div class='para' id='library-1'><div class='marginalizedparent'><a class='marginalized' href='#library-1'>1</a></div><div id='library-1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='headers'>[headers]</a>
<br/><b>Change:</b> New headers<a class='hidden_link' href='#library-1.sentence-1'>.</a></div> <div id='library-1.sentence-2' class='sentence'><br/><b>Rationale:</b> New functionality<a class='hidden_link' href='#library-1.sentence-2'>.</a></div> <div id='library-1.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
The following C++ headers are new:
<span class='texttt'>&lt;compare&gt;</span>,
<span class='texttt'>&lt;span&gt;</span>,
<span class='texttt'>&lt;syncstream&gt;</span>, and
<span class='texttt'>&lt;version&gt;</span><a class='hidden_link' href='#library-1.sentence-3'>.</a></div> <div id='library-1.sentence-4' class='sentence'>Valid C++ 2017 code that <span class='texttt'>#include</span>s headers with these names may be
invalid in this International Standard<a class='hidden_link' href='#library-1.sentence-4'>.</a></div></div></div></div></body></html>