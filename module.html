<!DOCTYPE html><html lang='en'><head><title>[module]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>10</a> Modules <a class='abbr_ref' href='./#module'>[module]</a></h1><div id='unit' class='section'><h2 ><a class='secnum' href='#unit' style='min-width:88pt'>10.1</a> Module units and purviews <a class='abbr_ref' href='module.unit'>[module.unit]</a></h2><pre class='bnf'><a class='nontermdef' href='#nt:module-declaration' id='nt:module-declaration'>module-declaration:</a>
&#9;<span class='texttt'><span class='keyword'>export</span></span><span class='indexparent'><a class='index' id=':export'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='texttt'><span class='keyword'>module</span></span><span class='indexparent'><a class='index' id=':module'></a></span> <i ><a href='#nt:module-name'>module-name</a></i> <i ><a href='#nt:module-partition'>module-partition</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:module-name' id='nt:module-name'>module-name:</a>
&#9;<i ><a href='#nt:module-name-qualifier'>module-name-qualifier</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <i ><a href='lex.name#nt:identifier'>identifier</a></i>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:module-partition' id='nt:module-partition'>module-partition:</a>
&#9;<span class='terminal'><span class='operator'>:</span></span> <i ><a href='#nt:module-name-qualifier'>module-name-qualifier</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <i ><a href='lex.name#nt:identifier'>identifier</a></i>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:module-name-qualifier' id='nt:module-name-qualifier'>module-name-qualifier:</a>
&#9;<i ><a href='lex.name#nt:identifier'>identifier</a></i> <span class='terminal'><span class='operator'>.</span></span>
&#9;<i ><a href='#nt:module-name-qualifier'>module-name-qualifier</a></i> <i ><a href='lex.name#nt:identifier'>identifier</a></i> <span class='terminal'><span class='operator'>.</span></span>
</pre><div class='para' id='unit-1'><div class='marginalizedparent'><a class='marginalized' href='#unit-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L29'>#</a></div><div id='unit-1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module_unit' id='def:module_unit'><i >module unit</i></a> is a translation unit that contains
a <i ><a href='#nt:module-declaration'>module-declaration</a></i><a class='hidden_link' href='#unit-1.sentence-1'>.</a></div> <div id='unit-1.sentence-2' class='sentence'>A <a class='hidden_link' href='#def:module,named' id='def:module,named'><i >named module</i></a> is the
collection of module units with the same <i ><a href='#nt:module-name'>module-name</a></i><a class='hidden_link' href='#unit-1.sentence-2'>.</a></div> <div id='unit-1.sentence-3' class='sentence'>The identifiers <span class='texttt'><span class='keyword'>module</span></span> and <span class='texttt'><span class='keyword'>import</span></span>
shall not appear as <i ><a href='lex.name#nt:identifier'>identifier</a></i><span class='textit'>s</span>
in a <i ><a href='#nt:module-name'>module-name</a></i> or <i ><a href='#nt:module-partition'>module-partition</a></i><a class='hidden_link' href='#unit-1.sentence-3'>.</a></div> <div id='unit-1.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':module,reserved_name_of'></a></span>All <i ><a href='#nt:module-name'>module-name</a></i><span class='textit'>s</span> either beginning with an <i ><a href='lex.name#nt:identifier'>identifier</a></i>
consisting of <span class='texttt'>std</span> followed by zero or more <i ><a href='lex.name#nt:digit'>digit</a></i><span class='textit'>s</span> or
containing a reserved identifier (<a href='lex.name'>[lex.name]</a>)
are reserved and shall not be specified in a <i ><a href='#nt:module-declaration'>module-declaration</a></i>;
no diagnostic is required<a class='hidden_link' href='#unit-1.sentence-4'>.</a></div> <div id='unit-1.sentence-5' class='sentence'>If any <i ><a href='lex.name#nt:identifier'>identifier</a></i> in a reserved <i ><a href='#nt:module-name'>module-name</a></i>
is a reserved identifier,
the module name is reserved for use by C++ implementations;
otherwise it is reserved for future standardization<a class='hidden_link' href='#unit-1.sentence-5'>.</a></div> <div id='unit-1.sentence-6' class='sentence'>The optional <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i>
appertains to the <i ><a href='#nt:module-declaration'>module-declaration</a></i><a class='hidden_link' href='#unit-1.sentence-6'>.</a></div></div><div class='para' id='unit-2'><div class='marginalizedparent'><a class='marginalized' href='#unit-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L50'>#</a></div><div id='unit-2.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module_interface_unit' id='def:module_interface_unit'><i >module interface unit</i></a> is a module unit whose
<i ><a href='#nt:module-declaration'>module-declaration</a></i> contains the <span class='texttt'><span class='keyword'>export</span></span> keyword;
any other module unit is a <a class='hidden_link' href='#def:module_implementation_unit' id='def:module_implementation_unit'><i >module implementation unit</i></a><a class='hidden_link' href='#unit-2.sentence-1'>.</a></div> <div id='unit-2.sentence-2' class='sentence'>A named module shall contain exactly one module interface unit
with no <i ><a href='#nt:module-partition'>module-partition</a></i>, known as the
<a class='hidden_link' href='#def:primary_module_interface_unit' id='def:primary_module_interface_unit'><i >primary module interface unit</i></a> of the module;
no diagnostic is required<a class='hidden_link' href='#unit-2.sentence-2'>.</a></div></div><div class='para' id='unit-3'><div class='marginalizedparent'><a class='marginalized' href='#unit-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L59'>#</a></div><div id='unit-3.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module_partition' id='def:module_partition'><i >module partition</i></a> is
a module unit whose <i ><a href='#nt:module-declaration'>module-declaration</a></i> contains
a <i ><a href='#nt:module-partition'>module-partition</a></i><a class='hidden_link' href='#unit-3.sentence-1'>.</a></div> <div id='unit-3.sentence-2' class='sentence'>A named module shall not contain multiple module partitions with
the same <i ><a href='#nt:module-partition'>module-partition</a></i><a class='hidden_link' href='#unit-3.sentence-2'>.</a></div> <div id='unit-3.sentence-3' class='sentence'>All module partitions of a module
that are module interface units
shall be directly or indirectly exported
by the primary module interface unit (<a href='#import'>[module.import]</a>)<a class='hidden_link' href='#unit-3.sentence-3'>.</a></div> <div id='unit-3.sentence-4' class='sentence'>No diagnostic is required for a violation of these rules<a class='hidden_link' href='#unit-3.sentence-4'>.</a></div> <div id='unit-3.note-1' class='note'>[&nbsp;<a class='note_link' href='#unit-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='unit-3.sentence-5' class='sentence'>Module partitions can be imported only by
other module units in the same module<a class='hidden_link' href='#unit-3.sentence-5'>.</a></div> <div id='unit-3.sentence-6' class='sentence'>The division of a module into module units
is not visible outside the module<a class='hidden_link' href='#unit-3.sentence-6'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='unit-4'><div class='marginalizedparent'><a class='marginalized' href='#unit-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L77'>#</a></div><div id='unit-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#unit-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> A;
<span class='keyword'>export</span> <span class='keyword'>import</span> <span class='operator'>:</span>Foo;
<span class='keyword'>export</span> <span class='keyword'>int</span> baz<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> A<span class='operator'>:</span>Foo;
<span class='keyword'>import</span> <span class='operator'>:</span>Internals;
<span class='keyword'>export</span> <span class='keyword'>int</span> foo<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span>bar<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> <span class='literal'>1</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>module</span> A<span class='operator'>:</span>Internals;
<span class='keyword'>int</span> bar<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #4:<pre class='codeblock'>
<span class='keyword'>module</span> A;
<span class='keyword'>import</span> <span class='operator'>:</span>Internals;
<span class='keyword'>int</span> bar<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> baz<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>-</span> <span class='literal'>10</span>; <span class='curlybracket'>}</span>
<span class='keyword'>int</span> baz<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>30</span>; <span class='curlybracket'>}</span>
</pre><div id='unit-4.sentence-1' class='sentence'>Module <span class='texttt'>A</span> contains four translation units:
<ul class='itemize'><li >a primary module interface unit,</li><li >a module partition <span class='texttt'>A<span class='operator'>:</span>Foo</span>, which is a module interface unit
forming part of the interface of module <span class='texttt'>A</span>,</li><li >a module partition <span class='texttt'>A<span class='operator'>:</span>Internals</span>, which does not contribute
to the external interface of module <span class='texttt'>A</span>, and</li><li >a module implementation unit providing
a definition of <span class='texttt'>bar</span> and <span class='texttt'>baz</span>,
which cannot be imported because
it does not have a partition name<a class='hidden_link' href='#unit-4.sentence-1'>.</a></li></ul></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='unit-5'><div class='marginalizedparent'><a class='marginalized' href='#unit-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L117'>#</a></div><div id='unit-5.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:purview,module_unit' id='def:purview,module_unit'><i >module unit purview</i></a> is
the sequence of <i ><a href='lex.token#nt:token'>token</a></i><span class='textit'>s</span>
starting at the <i ><a href='#nt:module-declaration'>module-declaration</a></i>
and extending to the end of the translation unit<a class='hidden_link' href='#unit-5.sentence-1'>.</a></div> <div id='unit-5.sentence-2' class='sentence'>The <a class='hidden_link' href='#def:purview,named_module' id='def:purview,named_module'><i >purview</i></a>
of a named module <span class='texttt'>M</span> is the set of module unit purviews
of <span class='texttt'>M</span>'s module units<a class='hidden_link' href='#unit-5.sentence-2'>.</a></div></div><div class='para' id='unit-6'><div class='marginalizedparent'><a class='marginalized' href='#unit-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L126'>#</a></div><div id='unit-6.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:module,global' id='def:module,global'><i >global module</i></a> is the collection of all
<i ><a href='#nt:global-module-fragment'>global-module-fragment</a></i><span class='textit'>s</span>
and all translation units that are not module units<a class='hidden_link' href='#unit-6.sentence-1'>.</a></div> <div id='unit-6.sentence-2' class='sentence'>Declarations appearing in such a context
are said to be in the <a class='hidden_link' href='#def:purview,global_module' id='def:purview,global_module'><i >purview</i></a> of the global module<a class='hidden_link' href='#unit-6.sentence-2'>.</a></div> <div id='unit-6.note-1' class='note'>[&nbsp;<a class='note_link' href='#unit-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='unit-6.sentence-3' class='sentence'>The global module has no name, no module interface unit, and is not
introduced by any <i ><a href='#nt:module-declaration'>module-declaration</a></i><a class='hidden_link' href='#unit-6.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='unit-7'><div class='marginalizedparent'><a class='marginalized' href='#unit-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L137'>#</a></div><div id='unit-7.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module' id='def:module'><i >module</i></a> is either a named module or the global module<a class='hidden_link' href='#unit-7.sentence-1'>.</a></div> <div id='unit-7.sentence-2' class='sentence'>A declaration is <a class='hidden_link' href='#def:attached,declaration' id='def:attached,declaration'><i >attached</i></a> to a module as follows:
<ul class='itemize'><li id='unit-7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#unit-7.1'>(7.1)</a></div>If the declaration
<ul class='itemize'><li id='unit-7.1.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#unit-7.1.1'>(7.1.1)</a></div>is a replaceable global allocation or deallocation
function (<a href='new.delete.single'>[new.delete.single]</a>, <a href='new.delete.array'>[new.delete.array]</a>), or</li><li id='unit-7.1.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#unit-7.1.2'>(7.1.2)</a></div>is a <i ><a href='namespace.def#nt:namespace-definition'>namespace-definition</a></i> with external linkage, or</li><li id='unit-7.1.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#unit-7.1.3'>(7.1.3)</a></div>appears within a <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>,</li></ul>
it is attached to the global module.</li><li id='unit-7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#unit-7.2'>(7.2)</a></div>Otherwise, the declaration is
attached to the module in whose purview it appears.</li></ul></div></div><div class='para' id='unit-8'><div class='marginalizedparent'><a class='marginalized' href='#unit-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L154'>#</a></div><div id='unit-8.sentence-1' class='sentence'>A <i ><a href='#nt:module-declaration'>module-declaration</a></i>
that contains neither <span class='texttt'><span class='keyword'>export</span></span>
nor a <i ><a href='#nt:module-partition'>module-partition</a></i>
implicitly imports the primary module interface unit of the module
as if by a <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i><a class='hidden_link' href='#unit-8.sentence-1'>.</a></div> <div id='unit-8.example-1' class='example'>[&nbsp;<a class='example_link' href='#unit-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>module</span> B<span class='operator'>:</span>Y;                     <span class='comment'>// does not implicitly import <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>int</span> y<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> B;
<span class='keyword'>import</span> <span class='operator'>:</span>Y;                      <span class='comment'>// OK, does not create interface dependency cycle</span>
<span class='keyword'>int</span> n <span class='operator'>=</span> y<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>module</span> B<span class='operator'>:</span>X1;                    <span class='comment'>// does not implicitly import <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>int</span> <span class='operator'>&amp;</span>a <span class='operator'>=</span> n;                     <span class='comment'>// error: <span class='tcode_in_codeblock'>n</span> not visible here</span>
</pre><p>Translation unit #4:<pre class='codeblock'>
<span class='keyword'>module</span> B<span class='operator'>:</span>X2;                    <span class='comment'>// does not implicitly import <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>import</span> B;
<span class='keyword'>int</span> <span class='operator'>&amp;</span>b <span class='operator'>=</span> n;                     <span class='comment'>// OK</span>
</pre><p>Translation unit #5:<pre class='codeblock'>
<span class='keyword'>module</span> B;                       <span class='comment'>// implicitly imports <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>int</span> <span class='operator'>&amp;</span>c <span class='operator'>=</span> n;                     <span class='comment'>// OK</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div><div id='interface' class='section'><h2 ><a class='secnum' href='#interface' style='min-width:88pt'>10.2</a> Export declaration <a class='abbr_ref' href='module.interface'>[module.interface]</a></h2><pre class='bnf'><a class='nontermdef' href='#nt:export-declaration' id='nt:export-declaration'>export-declaration:</a>
&#9;<span class='texttt'><span class='keyword'>export</span></span><span class='indexparent'><a class='index' id=':export_'></a></span> <i ><a href='dcl.pre#nt:declaration'>declaration</a></i>
&#9;<span class='texttt'><span class='keyword'>export</span></span><span class='indexparent'><a class='index' id=':export__'></a></span> <span class='terminal'><span class='curlybracket'>{</span></span> <i ><a href='dcl.pre#nt:declaration-seq'>declaration-seq</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='curlybracket'>}</span></span>
</pre><div class='para' id='interface-1'><div class='marginalizedparent'><a class='marginalized' href='#interface-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L197'>#</a></div><div id='interface-1.sentence-1' class='sentence'>An <i ><a href='#nt:export-declaration'>export-declaration</a></i> shall appear only
at namespace scope and only in the purview of a module interface unit<a class='hidden_link' href='#interface-1.sentence-1'>.</a></div> <div id='interface-1.sentence-2' class='sentence'>An <i ><a href='#nt:export-declaration'>export-declaration</a></i> shall not appear directly
or indirectly within an unnamed namespace
or a <i ><a href='basic.link#nt:private-module-fragment'>private-module-fragment</a></i><a class='hidden_link' href='#interface-1.sentence-2'>.</a></div> <div id='interface-1.sentence-3' class='sentence'>An <i ><a href='#nt:export-declaration'>export-declaration</a></i>
has the declarative effects of its <i ><a href='dcl.pre#nt:declaration'>declaration</a></i>
or its <i ><a href='dcl.pre#nt:declaration-seq'>declaration-seq</a></i> (if any)<a class='hidden_link' href='#interface-1.sentence-3'>.</a></div> <div id='interface-1.sentence-4' class='sentence'>An <i ><a href='#nt:export-declaration'>export-declaration</a></i> does not
establish a scope and its <i ><a href='dcl.pre#nt:declaration'>declaration</a></i>
or <i ><a href='dcl.pre#nt:declaration-seq'>declaration-seq</a></i>
shall not contain an <i ><a href='#nt:export-declaration'>export-declaration</a></i><a class='hidden_link' href='#interface-1.sentence-4'>.</a></div></div><div class='para' id='interface-2'><div class='marginalizedparent'><a class='marginalized' href='#interface-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L211'>#</a></div><div id='interface-2.sentence-1' class='sentence'>A declaration is <a class='hidden_link' href='#def:declaration,exported' id='def:declaration,exported'><i >exported</i></a> if it is
<ul class='itemize'><li id='interface-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#interface-2.1'>(2.1)</a></div>a namespace-scope declaration declared within an
      <i ><a href='#nt:export-declaration'>export-declaration</a></i>, or</li><li id='interface-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#interface-2.2'>(2.2)</a></div>a <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> declared with
      the <span class='texttt'><span class='keyword'>export</span></span> keyword (<a href='#import'>[module.import]</a>), or</li><li id='interface-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#interface-2.3'>(2.3)</a></div>a <i ><a href='namespace.def#nt:namespace-definition'>namespace-definition</a></i> that contains an
      exported declaration, or</li><li id='interface-2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#interface-2.4'>(2.4)</a></div>a declaration within a header unit (<a href='#import'>[module.import]</a>)
      that introduces at least one name<a class='hidden_link' href='#interface-2.sentence-1'>.</a></li></ul></div></div><div class='para' id='interface-3'><div class='marginalizedparent'><a class='marginalized' href='#interface-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L224'>#</a></div><div id='interface-3.sentence-1' class='sentence'>An exported declaration shall declare at least one name<a class='hidden_link' href='#interface-3.sentence-1'>.</a></div> <div id='interface-3.sentence-2' class='sentence'>If the declaration is not within a header unit,
it shall not declare a name with internal linkage<a class='hidden_link' href='#interface-3.sentence-2'>.</a></div></div><div class='para' id='interface-4'><div class='marginalizedparent'><a class='marginalized' href='#interface-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L229'>#</a></div><div id='interface-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#interface-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Source file <span class='texttt'><span class='literal'>"a.h"</span></span>:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>int</span> x;
</pre><p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>module</span>;
<span class='preprocessordirective'>#include</span> <span class='literal'>"a.h"</span>                  <span class='comment'>// error: declaration of <span class='tcode_in_codeblock'>x</span> is not in the</span>
                                <span class='comment'>// purview of a module interface unit</span>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>export</span> <span class='keyword'>namespace</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>             <span class='comment'>// error: does not introduce any names</span>
<span class='keyword'>export</span> <span class='keyword'>namespace</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> a1;                       <span class='comment'>// error: export of name with internal linkage</span>
<span class='curlybracket'>}</span>
<span class='keyword'>namespace</span> <span class='curlybracket'>{</span>
  <span class='keyword'>export</span> <span class='keyword'>int</span> a2;                <span class='comment'>// error: export of name with internal linkage</span>
<span class='curlybracket'>}</span>
<span class='keyword'>export</span> <span class='keyword'>static</span> <span class='keyword'>int</span> b;            <span class='comment'>// error: b explicitly declared static</span>
<span class='keyword'>export</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                 <span class='comment'>// OK</span>
<span class='keyword'>export</span> <span class='keyword'>namespace</span> N <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>          <span class='comment'>// OK</span>
<span class='keyword'>export</span> <span class='keyword'>using</span> <span class='keyword'>namespace</span> N;       <span class='comment'>// error: does not declare a name</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='interface-5'><div class='marginalizedparent'><a class='marginalized' href='#interface-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L254'>#</a></div><div id='interface-5.sentence-1' class='sentence'>If the declaration is a <i ><a href='namespace.udecl#nt:using-declaration'>using-declaration</a></i>
and is not within a header unit,
all entities to which all of the
<i ><a href='namespace.udecl#nt:using-declarator'>using-declarator</a></i><span class='textit'>s</span> ultimately refer (if any)
shall have been introduced with a name having external linkage<a class='hidden_link' href='#interface-5.sentence-1'>.</a></div> <div id='interface-5.example-1' class='example'>[&nbsp;<a class='example_link' href='#interface-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Source file <span class='texttt'><span class='literal'>"b.h"</span></span>:<pre class='codeblock'>
<span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Importable header <span class='texttt'><span class='literal'>"c.h"</span></span>:<pre class='codeblock'>
<span class='keyword'>int</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> X;
<span class='keyword'>export</span> <span class='keyword'>int</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>module</span>;
<span class='preprocessordirective'>#include</span> <span class='literal'>"b.h"</span>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>import</span> <span class='literal'>"c.h"</span>;
<span class='keyword'>import</span> X;
<span class='keyword'>export</span> <span class='keyword'>using</span> <span class='operator'>::</span>f, <span class='operator'>::</span>g, <span class='operator'>::</span>h;     <span class='comment'>// OK</span>
<span class='keyword'>struct</span> S;
<span class='keyword'>export</span> <span class='keyword'>using</span> <span class='operator'>::</span>S;               <span class='comment'>// error: <span class='tcode_in_codeblock'>S</span> has module linkage</span>
<span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>export</span> <span class='keyword'>int</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>static</span> <span class='keyword'>int</span> h<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;            <span class='comment'>// #1</span>
<span class='curlybracket'>}</span>
<span class='keyword'>export</span> <span class='keyword'>using</span> N<span class='operator'>::</span>h;              <span class='comment'>// error: #1 has internal linkage</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='interface-5.note-1' class='note'>[&nbsp;<a class='note_link' href='#interface-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='interface-5.sentence-2' class='sentence'>These constraints do not apply to
type names introduced by <span class='texttt'><span class='keyword'>typedef</span></span> declarations
and <i ><a href='dcl.pre#nt:alias-declaration'>alias-declaration</a></i><span class='textit'>s</span><a class='hidden_link' href='#interface-5.sentence-2'>.</a></div> <div id='interface-5.example-2' class='example'>[&nbsp;<a class='example_link' href='#interface-5.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>struct</span> S;
<span class='keyword'>export</span> <span class='keyword'>using</span> T <span class='operator'>=</span> S;             <span class='comment'>// OK, exports name <span class='tcode_in_codeblock'>T</span> denoting type <span class='tcode_in_codeblock'>S</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='interface-6'><div class='marginalizedparent'><a class='marginalized' href='#interface-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L303'>#</a></div><div id='interface-6.sentence-1' class='sentence'>A redeclaration of an exported declaration of an entity
is implicitly exported<a class='hidden_link' href='#interface-6.sentence-1'>.</a></div> <div id='interface-6.sentence-2' class='sentence'>An exported redeclaration of a non-exported declaration
of an entity is ill-formed<a class='hidden_link' href='#interface-6.sentence-2'>.</a></div> <div id='interface-6.example-1' class='example'>[&nbsp;<a class='example_link' href='#interface-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='keyword'>int</span> n; <span class='curlybracket'>}</span>;
<span class='keyword'>typedef</span> S S;
<span class='keyword'>export</span> <span class='keyword'>typedef</span> S S;             <span class='comment'>// OK, does not redeclare an entity</span>
<span class='keyword'>export</span> <span class='keyword'>struct</span> S;                <span class='comment'>// error: exported declaration follows non-exported declaration</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='interface-7'><div class='marginalizedparent'><a class='marginalized' href='#interface-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L318'>#</a></div><div id='interface-7.sentence-1' class='sentence'>A name is <a class='hidden_link' href='#def:name,exported' id='def:name,exported'><i >exported</i></a> by a module
if it is introduced or redeclared
by an exported declaration in the purview of that module<a class='hidden_link' href='#interface-7.sentence-1'>.</a></div> <div id='interface-7.note-1' class='note'>[&nbsp;<a class='note_link' href='#interface-7.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='interface-7.sentence-2' class='sentence'>Exported names have either external linkage or no linkage; see <a href='basic.link'>[basic.link]</a><a class='hidden_link' href='#interface-7.sentence-2'>.</a></div> <div id='interface-7.sentence-3' class='sentence'>Namespace-scope names exported by a module are visible to name lookup
in any translation unit importing that module; see <a href='basic.scope.namespace'>[basic.scope.namespace]</a><a class='hidden_link' href='#interface-7.sentence-3'>.</a></div> <div id='interface-7.sentence-4' class='sentence'>Class and enumeration member names are visible to name lookup in any
context in which a definition of the type is reachable<a class='hidden_link' href='#interface-7.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='interface-7.example-1' class='example'>[&nbsp;<a class='example_link' href='#interface-7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Interface unit of <span class='texttt'>M</span>:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>export</span> <span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>static</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>struct</span> Y <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>namespace</span> <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>export</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>S<span class='parenthesis'>)</span>;               <span class='comment'>// OK</span>
<span class='keyword'>struct</span> T <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>export</span> T id<span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>;                 <span class='comment'>// OK</span>

<span class='keyword'>export</span> <span class='keyword'>struct</span> A;                <span class='comment'>// <span class='tcode_in_codeblock'>A</span> exported as incomplete</span>

<span class='keyword'>export</span> <span class='keyword'>auto</span> rootFinder<span class='parenthesis'>(</span><span class='keyword'>double</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>return</span> <span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>double</span> x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='parenthesis'>(</span>x <span class='operator'>+</span> a<span class='operator'>/</span>x<span class='parenthesis'>)</span><span class='operator'>/</span><span class='literal'>2</span>; <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>export</span> <span class='keyword'>const</span> <span class='keyword'>int</span> n <span class='operator'>=</span> <span class='literal'>5</span>;         <span class='comment'>// OK, <span class='tcode_in_codeblock'>n</span> has external linkage</span>
</pre><p>Implementation unit of <span class='texttt'>M</span>:<pre class='codeblock'>
<span class='keyword'>module</span> M;
<span class='keyword'>struct</span> A <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> value;
<span class='curlybracket'>}</span>;
</pre><p>Main program:<pre class='codeblock'>
<span class='keyword'>import</span> M;
<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  X<span class='operator'>::</span>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                       <span class='comment'>// OK, <span class='tcode_in_codeblock'>X</span> is exported and definition of <span class='tcode_in_codeblock'>X</span> is reachable</span>
  X<span class='operator'>::</span>Y y;                       <span class='comment'>// OK, <span class='tcode_in_codeblock'>X&#x200b;::&#x200b;Y</span> is exported as a complete type</span>
  <span class='keyword'>auto</span> f <span class='operator'>=</span> rootFinder<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span>;       <span class='comment'>// OK</span>
  <span class='keyword'>return</span> A<span class='curlybracket'>{</span><span class='literal'>45</span><span class='curlybracket'>}</span><span class='operator'>.</span>value;           <span class='comment'>// error: <span class='tcode_in_codeblock'>A</span> is incomplete</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='interface-8'><div class='marginalizedparent'><a class='marginalized' href='#interface-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L371'>#</a></div><div id='interface-8.note-1' class='note'>[&nbsp;<a class='note_link' href='#interface-8.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='interface-8.sentence-1' class='sentence'>Redeclaring a name in an <i ><a href='#nt:export-declaration'>export-declaration</a></i>
cannot change the linkage of the name (<a href='basic.link'>[basic.link]</a>)<a class='hidden_link' href='#interface-8.sentence-1'>.</a></div> <div id='interface-8.example-1' class='example'>[&nbsp;<a class='example_link' href='#interface-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Interface unit of <span class='texttt'>M</span>:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>static</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                 <span class='comment'>// #1</span>
<span class='keyword'>export</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                 <span class='comment'>// error: #1 gives internal linkage</span>
<span class='keyword'>struct</span> S;                       <span class='comment'>// #2</span>
<span class='keyword'>export</span> <span class='keyword'>struct</span> S;                <span class='comment'>// error: #2 gives module linkage</span>
<span class='keyword'>namespace</span> <span class='curlybracket'>{</span>
  <span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
    <span class='keyword'>extern</span> <span class='keyword'>int</span> x;               <span class='comment'>// #3</span>
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>
<span class='keyword'>export</span> <span class='keyword'>int</span> N<span class='operator'>::</span>x;                <span class='comment'>// error: #3 gives internal linkage</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='interface-9'><div class='marginalizedparent'><a class='marginalized' href='#interface-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L392'>#</a></div><div id='interface-9.note-1' class='note'>[&nbsp;<a class='note_link' href='#interface-9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='interface-9.sentence-1' class='sentence'>Declarations in an exported <i ><a href='namespace.def#nt:namespace-definition'>namespace-definition</a></i>
or in an exported <i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i>
are exported and subject to the rules of exported declarations<a class='hidden_link' href='#interface-9.sentence-1'>.</a></div> <div id='interface-9.example-1' class='example'>[&nbsp;<a class='example_link' href='#interface-9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>export</span> <span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> x;                        <span class='comment'>// OK</span>
  <span class='keyword'>static_assert</span><span class='parenthesis'>(</span><span class='literal'>1</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;        <span class='comment'>// error: does not declare a name</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div></div><div id='import' class='section'><h2 ><a class='secnum' href='#import' style='min-width:88pt'>10.3</a> Import declaration <a class='abbr_ref' href='module.import'>[module.import]</a></h2><pre class='bnf'><a class='nontermdef' href='#nt:module-import-declaration' id='nt:module-import-declaration'>module-import-declaration:</a>
&#9;<span class='texttt'><span class='keyword'>export</span></span><span class='indexparent'><a class='index' id=':export___'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> import-keyword <i ><a href='#nt:module-name'>module-name</a></i> <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span>
&#9;<span class='texttt'><span class='keyword'>export</span></span><span class='indexparent'><a class='index' id=':export____'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> import-keyword <i ><a href='#nt:module-partition'>module-partition</a></i> <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span>
&#9;<span class='texttt'><span class='keyword'>export</span></span><span class='indexparent'><a class='index' id=':export_____'></a></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> import-keyword <i ><a href='lex.header#nt:header-name'>header-name</a></i> <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span>
</pre><div class='para' id='import-1'><div class='marginalizedparent'><a class='marginalized' href='#import-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L417'>#</a></div><div id='import-1.sentence-1' class='sentence'>In a module unit, all <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i><span class='textit'>s</span>
shall precede all other <i ><a href='basic.link#nt:top-level-declaration'>top-level-declaration</a></i><span class='textit'>s</span> in
the <i ><a href='basic.link#nt:top-level-declaration-seq'>top-level-declaration-seq</a></i> of the
<i ><a href='basic.link#nt:translation-unit'>translation-unit</a></i>
and of the <i ><a href='basic.link#nt:private-module-fragment'>private-module-fragment</a></i> (if any)<a class='hidden_link' href='#import-1.sentence-1'>.</a></div> <div id='import-1.sentence-2' class='sentence'>The optional <i ><a href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a></i>
appertains to the <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i><a class='hidden_link' href='#import-1.sentence-2'>.</a></div></div><div class='para' id='import-2'><div class='marginalizedparent'><a class='marginalized' href='#import-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L426'>#</a></div><div id='import-2.sentence-1' class='sentence'>A <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> <a class='hidden_link' href='#def:import' id='def:import'><i >imports</i></a> a set of
translation units determined as described below<a class='hidden_link' href='#import-2.sentence-1'>.</a></div> <div id='import-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#import-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='import-2.sentence-2' class='sentence'>Namespace-scope names exported by the imported translation units
become visible (<a href='basic.scope.namespace'>[basic.scope.namespace]</a>)
in the importing translation unit
and declarations within the imported translation units
become reachable (<a href='#reach'>[module.reach]</a>)
in the importing translation unit
after the import declaration<a class='hidden_link' href='#import-2.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='import-3'><div class='marginalizedparent'><a class='marginalized' href='#import-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L439'>#</a></div><div id='import-3.sentence-1' class='sentence'>A <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> that specifies
a <i ><a href='#nt:module-name'>module-name</a></i> <span class='texttt'>M</span>
imports all module interface units of <span class='texttt'>M</span><a class='hidden_link' href='#import-3.sentence-1'>.</a></div></div><div class='para' id='import-4'><div class='marginalizedparent'><a class='marginalized' href='#import-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L444'>#</a></div><div id='import-4.sentence-1' class='sentence'>A <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> that specifies
a <i ><a href='#nt:module-partition'>module-partition</a></i> shall only appear after
the <i ><a href='#nt:module-declaration'>module-declaration</a></i> in a module unit of
some module <span class='texttt'>M</span><a class='hidden_link' href='#import-4.sentence-1'>.</a></div> <div id='import-4.sentence-2' class='sentence'>Such a declaration imports the so-named
module partition of <span class='texttt'>M</span><a class='hidden_link' href='#import-4.sentence-2'>.</a></div></div><div class='para' id='import-5'><div class='marginalizedparent'><a class='marginalized' href='#import-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L452'>#</a></div><div id='import-5.sentence-1' class='sentence'>A <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> that specifies
a <i ><a href='lex.header#nt:header-name'>header-name</a></i> <span class='texttt'>H</span> imports
a synthesized <a class='hidden_link' href='#def:header_unit' id='def:header_unit'><i >header unit</i></a>,
which is a translation unit formed by applying
phases 1 to 7 of translation (<a href='lex.phases'>[lex.phases]</a>)
to the source file or header nominated by <span class='texttt'>H</span>,
which shall not contain a <i ><a href='#nt:module-declaration'>module-declaration</a></i><a class='hidden_link' href='#import-5.sentence-1'>.</a></div> <div id='import-5.note-1' class='note'>[&nbsp;<a class='note_link' href='#import-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='import-5.sentence-2' class='sentence'>All declarations within a header unit are implicitly
exported (<a href='#interface'>[module.interface]</a>),
and are attached to the global module (<a href='#unit'>[module.unit]</a>)<a class='hidden_link' href='#import-5.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='import-5.sentence-3' class='sentence'>
An <a class='hidden_link' href='#def:header,importable' id='def:header,importable'><i >importable header</i></a> is a member of an
<span class='indexparent'><a class='index' id=':how_the_set_of_importable_headers_is_determined'></a></span>implementation-defined
set of headers that
includes all importable C++ library headers (<a href='headers'>[headers]</a>)<a class='hidden_link' href='#import-5.sentence-3'>.</a></div> <div id='import-5.sentence-4' class='sentence'><span class='texttt'>H</span> shall identify an importable header<a class='hidden_link' href='#import-5.sentence-4'>.</a></div> <div id='import-5.sentence-5' class='sentence'>Two
<i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i><span class='textit'>s</span>
import the same header unit if and only if
their <i ><a href='lex.header#nt:header-name'>header-name</a></i><span class='textit'>s</span> identify the same
header or source file (<a href='cpp.include'>[cpp.include]</a>)<a class='hidden_link' href='#import-5.sentence-5'>.</a></div> <div id='import-5.note-2' class='note'>[&nbsp;<a class='note_link' href='#import-5.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='import-5.sentence-6' class='sentence'>A <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> nominating
a <i ><a href='lex.header#nt:header-name'>header-name</a></i> is also recognized by the
preprocessor, and results in macros defined at the
end of phase 4 of translation of the header unit
being made visible as described in <a href='cpp.import'>[cpp.import]</a><a class='hidden_link' href='#import-5.sentence-6'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='import-5.sentence-7' class='sentence'>
A declaration of a name with internal linkage is
permitted within a header unit despite all
declarations being implicitly exported (<a href='#interface'>[module.interface]</a>)<a class='hidden_link' href='#import-5.sentence-7'>.</a></div> <div id='import-5.sentence-8' class='sentence'>If such a declaration declares an entity
that is odr-used outside the
header unit, or by a template
instantiation whose point of instantiation is outside
the header unit, the program is ill-formed<a class='hidden_link' href='#import-5.sentence-8'>.</a></div></div><div class='para' id='import-6'><div class='marginalizedparent'><a class='marginalized' href='#import-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L491'>#</a></div><div id='import-6.sentence-1' class='sentence'>When a <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> imports
a translation unit <span class='math'><span class='mathalpha'>T</span></span>, it also imports
all translation units imported by
exported <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i><span class='textit'>s</span>
in <span class='math'><span class='mathalpha'>T</span></span>; such translation units are
said to be <a class='hidden_link' href='#def:module,exported' id='def:module,exported'><i >exported</i></a> by <span class='math'><span class='mathalpha'>T</span></span><a class='hidden_link' href='#import-6.sentence-1'>.</a></div> <div id='import-6.sentence-2' class='sentence'>When a <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> in a module unit imports
another module unit of the same module, it also imports
all translation units imported by
all <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i><span class='textit'>s</span>
in that module unit<a class='hidden_link' href='#import-6.sentence-2'>.</a></div> <div id='import-6.sentence-3' class='sentence'>These rules may in turn lead to the importation of yet more
translation units<a class='hidden_link' href='#import-6.sentence-3'>.</a></div></div><div class='para' id='import-7'><div class='marginalizedparent'><a class='marginalized' href='#import-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L506'>#</a></div><div id='import-7.sentence-1' class='sentence'>A module implementation unit shall not be exported<a class='hidden_link' href='#import-7.sentence-1'>.</a></div> <div id='import-7.example-1' class='example'>[&nbsp;<a class='example_link' href='#import-7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>module</span> M<span class='operator'>:</span>Part;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>export</span> <span class='keyword'>import</span> <span class='operator'>:</span>Part;    <span class='comment'>// error: exported partition <span class='tcode_in_codeblock'>:Part</span> is an implementation unit</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='import-8'><div class='marginalizedparent'><a class='marginalized' href='#import-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L519'>#</a></div><div id='import-8.sentence-1' class='sentence'>A module implementation unit of a module <span class='texttt'>M</span>
that is not a module partition
shall not contain a <i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i>
nominating <span class='texttt'>M</span><a class='hidden_link' href='#import-8.sentence-1'>.</a></div> <div id='import-8.example-1' class='example'>[&nbsp;<a class='example_link' href='#import-8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>module</span> M;
<span class='keyword'>import</span> M;               <span class='comment'>// error: cannot import <span class='tcode_in_codeblock'>M</span> in its own unit</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='import-9'><div class='marginalizedparent'><a class='marginalized' href='#import-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L531'>#</a></div><div id='import-9.sentence-1' class='sentence'>A translation unit has an <a class='hidden_link' href='#def:interface_dependency' id='def:interface_dependency'><i >interface dependency</i></a> on a module unit <span class='texttt'>U</span>
if it contains a <i ><a href='#nt:module-declaration'>module-declaration</a></i> or
<i ><a href='#nt:module-import-declaration'>module-import-declaration</a></i> that imports <span class='texttt'>U</span> or if it has
an interface dependency on a module unit that has an interface dependency on <span class='texttt'>U</span><a class='hidden_link' href='#import-9.sentence-1'>.</a></div> <div id='import-9.sentence-2' class='sentence'>A translation unit shall not have an interface dependency on itself<a class='hidden_link' href='#import-9.sentence-2'>.</a></div> <div id='import-9.example-1' class='example'>[&nbsp;<a class='example_link' href='#import-9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Interface unit of <span class='texttt'>M1</span>:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M1;
<span class='keyword'>import</span> M2;
</pre><p>Interface unit of <span class='texttt'>M2</span>:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M2;
<span class='keyword'>import</span> M3;
</pre><p>Interface unit of <span class='texttt'>M3</span>:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M3;
<span class='keyword'>import</span> M1;              <span class='comment'>// error: cyclic interface dependency <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">M</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.298em;"><span class='literal'>3</span></span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">M</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;"><span class='literal'>1</span></span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">M</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.225em;"><span class='literal'>2</span></span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">→</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.372em; padding-bottom: 0.225em;">M</span></span><span class="mjx-mn"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.446em; padding-bottom: 0.298em;"><span class='literal'>3</span></span></span></span></span></span></span></span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div><div id='global.frag' class='section'><h2 ><a class='secnum' href='#global.frag' style='min-width:88pt'>10.4</a> Global module fragment <a class='abbr_ref' href='module.global.frag'>[module.global.frag]</a></h2><pre class='bnf'><a class='nontermdef' href='#nt:global-module-fragment' id='nt:global-module-fragment'>global-module-fragment:</a>
&#9;<span class='texttt'><span class='keyword'>module</span></span><span class='indexparent'><a class='index' id=':module_'></a></span> <span class='terminal'>;</span> <i ><a href='basic.link#nt:top-level-declaration-seq'>top-level-declaration-seq</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre><div class='para' id='global.frag-1'><div class='marginalizedparent'><a class='marginalized' href='#global.frag-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L561'>#</a></div><div id='global.frag-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#global.frag-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='global.frag-1.sentence-1' class='sentence'>Prior to phase 4 of translation,
only preprocessing directives can appear
in the <i ><a href='basic.link#nt:top-level-declaration-seq'>top-level-declaration-seq</a></i> (<a href='cpp.global.frag'>[cpp.global.frag]</a>)<a class='hidden_link' href='#global.frag-1.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='global.frag-2'><div class='marginalizedparent'><a class='marginalized' href='#global.frag-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L568'>#</a></div><div id='global.frag-2.sentence-1' class='sentence'>A <i ><a href='#nt:global-module-fragment'>global-module-fragment</a></i> specifies the contents of the
<a class='hidden_link' href='#def:global_module_fragment' id='def:global_module_fragment'><i >global module fragment</i></a> for a module unit<a class='hidden_link' href='#global.frag-2.sentence-1'>.</a></div> <div id='global.frag-2.sentence-2' class='sentence'>The global module fragment can be used to provide declarations
that are attached to the global module and usable within the module unit<a class='hidden_link' href='#global.frag-2.sentence-2'>.</a></div></div><div class='para' id='global.frag-3'><div class='marginalizedparent'><a class='marginalized' href='#global.frag-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L574'>#</a></div><div id='global.frag-3.sentence-1' class='sentence'>A declaration <span class='math'><span class='mathalpha'>D</span></span> is <a class='hidden_link' href='#def:decl-reachable' id='def:decl-reachable'><i >decl-reachable</i></a> from a declaration <span class='math'><span class='mathalpha'>S</span></span>
in the same translation unit if:
<ul class='itemize'><li id='global.frag-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.1'>(3.1)</a></div><span class='math'><span class='mathalpha'>D</span></span> does not declare a function or function template and
<span class='math'><span class='mathalpha'>S</span></span> contains an
<i ><a href='expr.prim.id#nt:id-expression'>id-expression</a></i>,
<i ><a href='namespace.def#nt:namespace-name'>namespace-name</a></i>,
<i ><a href='dcl.type.simple#nt:type-name'>type-name</a></i>,
<i ><a href='temp.names#nt:template-name'>template-name</a></i>, or
<i ><a href='temp.pre#nt:concept-name'>concept-name</a></i>
naming <span class='math'><span class='mathalpha'>D</span></span>, or</li><li id='global.frag-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.2'>(3.2)</a></div><span class='math'><span class='mathalpha'>D</span></span> declares a function or function template that
is named by an expression (<a href='basic.def.odr'>[basic.def.odr]</a>)
appearing in <span class='math'><span class='mathalpha'>S</span></span>, or</li><li id='global.frag-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.3'>(3.3)</a></div><span class='math'><span class='mathalpha'>S</span></span> contains an expression <span class='texttt'>E</span> of the form<pre class='ncsimplebnf'><i ><a href='expr.post#nt:postfix-expression'>postfix-expression</a></i> <span class='terminal'><span class='parenthesis'>(</span></span> <i ><a href='expr.post#nt:expression-list'>expression-list</a></i><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='parenthesis'>)</span></span>
</pre>
whose <i ><a href='expr.post#nt:postfix-expression'>postfix-expression</a></i> denotes a dependent name,
or for an operator expression whose operator denotes a dependent name,
and <span class='math'><span class='mathalpha'>D</span></span> is found by name lookup for the corresponding name
in an expression synthesized from <span class='texttt'>E</span>
by replacing each type-dependent argument or operand
with a value of a placeholder type
with no associated namespaces or entities, or</li><li id='global.frag-3.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.4'>(3.4)</a></div><span class='math'><span class='mathalpha'>S</span></span> contains an expression that
takes the address of an overloaded function (<a href='over.over'>[over.over]</a>)
whose set of overloads contains <span class='math'><span class='mathalpha'>D</span></span> and
for which the target type is dependent, or</li><li id='global.frag-3.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.5'>(3.5)</a></div>there exists a declaration <span class='math'><span class='mathalpha'>M</span></span> that is not a <i ><a href='namespace.def#nt:namespace-definition'>namespace-definition</a></i>
for which <span class='math'><span class='mathalpha'>M</span></span> is decl-reachable from <span class='math'><span class='mathalpha'>S</span></span> and either
<ul class='itemize'><li id='global.frag-3.5.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.1'>(3.5.1)</a></div><span class='math'><span class='mathalpha'>D</span></span> is decl-reachable from <span class='math'><span class='mathalpha'>M</span></span>, or</li><li id='global.frag-3.5.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.2'>(3.5.2)</a></div><span class='math'><span class='mathalpha'>D</span></span> redeclares the entity declared by <span class='math'><span class='mathalpha'>M</span></span> or
<span class='math'><span class='mathalpha'>M</span></span> redeclares the entity declared by <span class='math'><span class='mathalpha'>D</span></span>,
and <span class='math'><span class='mathalpha'>D</span></span> is neither a friend declaration
nor a block-scope declaration, or</li><li id='global.frag-3.5.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.3'>(3.5.3)</a></div><span class='math'><span class='mathalpha'>D</span></span> declares a namespace <span class='math'><span class='mathalpha'>N</span></span> and <span class='math'><span class='mathalpha'>M</span></span> is a member of <span class='math'><span class='mathalpha'>N</span></span>, or</li><li id='global.frag-3.5.4'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.4'>(3.5.4)</a></div>one of <span class='math'><span class='mathalpha'>M</span></span> and <span class='math'><span class='mathalpha'>D</span></span> declares a class or class template <span class='math'><span class='mathalpha'>C</span></span>
and the other declares a member or friend of <span class='math'><span class='mathalpha'>C</span></span>, or</li><li id='global.frag-3.5.5'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.5'>(3.5.5)</a></div>one of <span class='math'><span class='mathalpha'>D</span></span> and <span class='math'><span class='mathalpha'>M</span></span> declares an enumeration <span class='math'><span class='mathalpha'>E</span></span>
and the other declares an enumerator of <span class='math'><span class='mathalpha'>E</span></span>, or</li><li id='global.frag-3.5.6'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.6'>(3.5.6)</a></div><span class='math'><span class='mathalpha'>D</span></span> declares a function or variable and <span class='math'><span class='mathalpha'>M</span></span> is declared in <span class='math'><span class='mathalpha'>D</span></span>,<a class='footnotenum' href='#footnote-100' id='footnoteref-100'>100</a> or</li><li id='global.frag-3.5.7'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.7'>(3.5.7)</a></div>one of <span class='math'><span class='mathalpha'>M</span></span> and <span class='math'><span class='mathalpha'>D</span></span> declares a template and the other declares
a partial or explicit specialization or
an implicit or explicit instantiation of that template, or</li><li id='global.frag-3.5.8'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#global.frag-3.5.8'>(3.5.8)</a></div>one of <span class='math'><span class='mathalpha'>M</span></span> and <span class='math'><span class='mathalpha'>D</span></span> declares a class or enumeration type
and the other introduces a typedef name for linkage purposes for that type<a class='hidden_link' href='#global.frag-3.sentence-1'>.</a></li></ul></li></ul></div> <div id='global.frag-3.sentence-2' class='sentence'>
In this determination, it is unspecified
<ul class='itemize'><li id='global.frag-3.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.6'>(3.6)</a></div>whether a reference to an
<i ><a href='dcl.pre#nt:alias-declaration'>alias-declaration</a></i>,
<span class='texttt'><span class='keyword'>typedef</span></span> declaration,
<i ><a href='namespace.udecl#nt:using-declaration'>using-declaration</a></i>, or
<span class='grammarterm'>namespace-alias-declaration</span>
is replaced by the declarations they name
prior to this determination,</li><li id='global.frag-3.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.7'>(3.7)</a></div>whether a <i ><a href='temp.names#nt:simple-template-id'>simple-template-id</a></i>
that does not denote a dependent type
and whose <i ><a href='temp.names#nt:template-name'>template-name</a></i> names an alias template
is replaced by its denoted type
prior to this determination,</li><li id='global.frag-3.8'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.8'>(3.8)</a></div>whether a <i ><a href='dcl.type.decltype#nt:decltype-specifier'>decltype-specifier</a></i>
that does not denote a dependent type
is replaced by its denoted type
prior to this determination,
and</li><li id='global.frag-3.9'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#global.frag-3.9'>(3.9)</a></div>whether a non-value-dependent constant expression
is replaced by the result of constant evaluation
prior to this determination<a class='hidden_link' href='#global.frag-3.sentence-2'>.</a></li></ul></div></div><div class='para' id='global.frag-4'><div class='marginalizedparent'><a class='marginalized' href='#global.frag-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L676'>#</a></div><div id='global.frag-4.sentence-1' class='sentence'>A declaration <span class='texttt'>D</span> in a global module fragment of a module unit
is <a class='hidden_link' href='#def:discarded,declaration' id='def:discarded,declaration'><i >discarded</i></a> if <span class='texttt'>D</span>
is not decl-reachable from any <i ><a href='basic.link#nt:top-level-declaration'>top-level-declaration</a></i>
in the <i ><a href='basic.link#nt:top-level-declaration-seq'>top-level-declaration-seq</a></i>
of the <span class='grammarterm'>translation unit</span><a class='hidden_link' href='#global.frag-4.sentence-1'>.</a></div> <div id='global.frag-4.note-1' class='note'>[&nbsp;<a class='note_link' href='#global.frag-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='global.frag-4.sentence-2' class='sentence'>A discarded declaration is neither reachable
nor visible to name lookup outside the module unit,
nor in template instantiations whose points of instantiation (<a href='temp.point'>[temp.point]</a>)
are outside the module unit,
even when the instantiation context (<a href='#context'>[module.context]</a>)
includes the module unit<a class='hidden_link' href='#global.frag-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='global.frag-5'><div class='marginalizedparent'><a class='marginalized' href='#global.frag-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L691'>#</a></div><div id='global.frag-5.example-1' class='example'>[&nbsp;<a class='example_link' href='#global.frag-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>const</span> <span class='keyword'>int</span> size <span class='operator'>=</span> <span class='literal'>2</span>;
<span class='keyword'>int</span> ary1<span class='squarebracket'>[</span>size<span class='squarebracket'>]</span>;                 <span class='comment'>// unspecified whether <span class='tcode_in_codeblock'>size</span> is decl-reachable from <span class='tcode_in_codeblock'>ary1</span></span>
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> identity<span class='parenthesis'>(</span><span class='keyword'>int</span> x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> x; <span class='curlybracket'>}</span>
<span class='keyword'>int</span> ary2<span class='squarebracket'>[</span>identity<span class='parenthesis'>(</span><span class='literal'>2</span><span class='parenthesis'>)</span><span class='squarebracket'>]</span>;          <span class='comment'>// unspecified whether <span class='tcode_in_codeblock'>identity</span> is decl-reachable from <span class='tcode_in_codeblock'>ary2</span></span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span>, <span class='keyword'>int</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S2;
<span class='keyword'>constexpr</span> <span class='keyword'>int</span> g<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T, <span class='keyword'>int</span> N<span class='anglebracket'>&gt;</span>
S<span class='anglebracket'>&lt;</span>S2<span class='anglebracket'>&lt;</span>T, g<span class='parenthesis'>(</span>N<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;             <span class='comment'>// <span class='tcode_in_codeblock'>S</span>, <span class='tcode_in_codeblock'>S2</span>, <span class='tcode_in_codeblock'>g</span>, and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;</span> are decl-reachable from <span class='tcode_in_codeblock'>f</span></span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span> N<span class='anglebracket'>&gt;</span>
<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>g<span class='parenthesis'>(</span>N<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> N<span class='parenthesis'>)</span>;   <span class='comment'>// <span class='tcode_in_codeblock'>g</span> and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;</span> are decl-reachable from <span class='tcode_in_codeblock'>h</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='global.frag-6'><div class='marginalizedparent'><a class='marginalized' href='#global.frag-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L711'>#</a></div><div id='global.frag-6.example-1' class='example'>[&nbsp;<a class='example_link' href='#global.frag-6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Source file <span class='texttt'><span class='literal'>"foo.h"</span></span>:<pre class='codeblock'>
<span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> X <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
  <span class='keyword'>int</span> d<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>int</span> e<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>inline</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span>X, <span class='keyword'>int</span> <span class='operator'>=</span> d<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> e<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
  <span class='keyword'>int</span> g<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span>;
  <span class='keyword'>int</span> h<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre><p>Module <span class='texttt'>M</span> interface:<pre class='codeblock'>
<span class='keyword'>module</span>;
<span class='preprocessordirective'>#include</span> <span class='literal'>"foo.h"</span>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> use_f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  N<span class='operator'>::</span>X x;                       <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;X</span>, <span class='tcode_in_codeblock'>N</span>, and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;</span> are decl-reachable from <span class='tcode_in_codeblock'>use_&shy;f</span></span>
  <span class='keyword'>return</span> f<span class='parenthesis'>(</span>x, <span class='literal'>123</span><span class='parenthesis'>)</span>;             <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;f</span> is decl-reachable from <span class='tcode_in_codeblock'>use_&shy;f</span>,</span>
                                <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;e</span> is indirectly decl-reachable from <span class='tcode_in_codeblock'>use_&shy;f</span></span>
                                <span class='comment'>//   because it is decl-reachable from <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;f</span>, and</span>
                                <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;d</span> is decl-reachable from <span class='tcode_in_codeblock'>use_&shy;f</span></span>
                                <span class='comment'>//   because it is decl-reachable from <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;f</span></span>
                                <span class='comment'>//   even though it is not used in this call</span>
<span class='curlybracket'>}</span>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> use_g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  N<span class='operator'>::</span>X x;                       <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;X</span>, <span class='tcode_in_codeblock'>N</span>, and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;</span> are decl-reachable from <span class='tcode_in_codeblock'>use_&shy;g</span></span>
  <span class='keyword'>return</span> g<span class='parenthesis'>(</span><span class='parenthesis'>(</span>T<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, x<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;           <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;g</span> is not decl-reachable from <span class='tcode_in_codeblock'>use_&shy;g</span></span>
<span class='curlybracket'>}</span>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> use_h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  N<span class='operator'>::</span>X x;                       <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;X</span>, <span class='tcode_in_codeblock'>N</span>, and <span class='tcode_in_codeblock'>&#x200b;::&#x200b;</span> are decl-reachable from <span class='tcode_in_codeblock'>use_&shy;h</span></span>
  <span class='keyword'>return</span> h<span class='parenthesis'>(</span><span class='parenthesis'>(</span>T<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, x<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;           <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;h</span> is not decl-reachable from <span class='tcode_in_codeblock'>use_&shy;h</span>, but</span>
                                <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;h</span> is decl-reachable from <span class='tcode_in_codeblock'>use_&shy;h&lt;int&gt;</span></span>
<span class='curlybracket'>}</span>
<span class='keyword'>int</span> k <span class='operator'>=</span> use_h<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='comment'>// <span class='tcode_in_codeblock'>use_&shy;h&lt;int&gt;</span> is decl-reachable from <span class='tcode_in_codeblock'>k</span>, so</span>
  <span class='comment'>// <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;h</span> is decl-reachable from <span class='tcode_in_codeblock'>k</span></span>
</pre><p>Module <span class='texttt'>M</span> implementation:<pre class='codeblock'>
<span class='keyword'>module</span> M;
<span class='keyword'>int</span> a <span class='operator'>=</span> use_f<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;           <span class='comment'>// OK</span>
<span class='keyword'>int</span> b <span class='operator'>=</span> use_g<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;           <span class='comment'>// error: no viable function for call to <span class='tcode_in_codeblock'>g</span>;</span>
                                <span class='comment'>// <span class='tcode_in_codeblock'>g</span> is not decl-reachable from purview of</span>
                                <span class='comment'>// module <span class='tcode_in_codeblock'>M</span>'s interface, so is discarded</span>
<span class='keyword'>int</span> c <span class='operator'>=</span> use_h<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;           <span class='comment'>// OK</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='footnote' id='footnote-100'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-100'>100)</a></div><div id='footnote-100.sentence-1' class='sentence'>A declaration can appear within a <i ><a href='expr.prim.lambda#nt:lambda-expression'>lambda-expression</a></i>
in the initializer of a variable<a class='hidden_link' href='#footnote-100.sentence-1'>.</a></div> <a href='#footnoteref-100'>⮥</a></div></div><div id='context' class='section'><h2 ><a class='secnum' href='#context' style='min-width:88pt'>10.5</a> Instantiation context <a class='abbr_ref' href='module.context'>[module.context]</a></h2><div class='para' id='context-1'><div class='marginalizedparent'><a class='marginalized' href='#context-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L763'>#</a></div><div id='context-1.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:instantiation_context' id='def:instantiation_context'><i >instantiation context</i></a> is a set of points within the program
that determines which names are visible
to argument-dependent name lookup (<a href='basic.lookup.argdep'>[basic.lookup.argdep]</a>)
and which declarations are reachable (<a href='#reach'>[module.reach]</a>)
in the context of a particular declaration or template instantiation<a class='hidden_link' href='#context-1.sentence-1'>.</a></div></div><div class='para' id='context-2'><div class='marginalizedparent'><a class='marginalized' href='#context-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L770'>#</a></div><div id='context-2.sentence-1' class='sentence'>During the implicit definition of
a defaulted special member function (<a href='special'>[special]</a>),
the instantiation context is the union of
the instantiation context from the definition of the class and
the instantiation context of the program construct that
resulted in the implicit definition of the special member function<a class='hidden_link' href='#context-2.sentence-1'>.</a></div></div><div class='para' id='context-3'><div class='marginalizedparent'><a class='marginalized' href='#context-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L778'>#</a></div><div id='context-3.sentence-1' class='sentence'>During the implicit instantiation of a template
whose point of instantiation is specified as
that of an enclosing specialization (<a href='temp.point'>[temp.point]</a>),
the instantiation context is the union of
the instantiation context of the enclosing specialization and,
if the template is defined in a module interface unit of a module <span class='math'><span class='mathalpha'>M</span></span>
and the point of instantiation is not in a module interface unit of <span class='math'><span class='mathalpha'>M</span></span>,
the point at the end of the
<i ><a href='basic.link#nt:top-level-declaration-seq'>top-level-declaration-seq</a></i> of the
primary module interface unit of <span class='math'><span class='mathalpha'>M</span></span>
(prior to the <i ><a href='basic.link#nt:private-module-fragment'>private-module-fragment</a></i>, if any)<a class='hidden_link' href='#context-3.sentence-1'>.</a></div></div><div class='para' id='context-4'><div class='marginalizedparent'><a class='marginalized' href='#context-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L791'>#</a></div><div id='context-4.sentence-1' class='sentence'>During the implicit instantiation of a template
that is implicitly instantiated because it is referenced
from within the implicit definition of a defaulted special member function,
the instantiation context is the instantiation context of
the defaulted special member function<a class='hidden_link' href='#context-4.sentence-1'>.</a></div></div><div class='para' id='context-5'><div class='marginalizedparent'><a class='marginalized' href='#context-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L798'>#</a></div><div id='context-5.sentence-1' class='sentence'>During the instantiation of any other template specialization,
the instantiation context comprises the point of instantiation
of the template<a class='hidden_link' href='#context-5.sentence-1'>.</a></div></div><div class='para' id='context-6'><div class='marginalizedparent'><a class='marginalized' href='#context-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L803'>#</a></div><div id='context-6.sentence-1' class='sentence'>In any other case, the instantiation context
at a point within the program
comprises that point<a class='hidden_link' href='#context-6.sentence-1'>.</a></div></div><div class='para' id='context-7'><div class='marginalizedparent'><a class='marginalized' href='#context-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L808'>#</a></div><div id='context-7.example-1' class='example'>[&nbsp;<a class='example_link' href='#context-7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> stuff;
<span class='keyword'>export</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T, <span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> foo<span class='parenthesis'>(</span>T, U u<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>auto</span> v <span class='operator'>=</span> u; <span class='curlybracket'>}</span>
<span class='keyword'>export</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T, <span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> bar<span class='parenthesis'>(</span>T, U u<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>auto</span> v <span class='operator'>=</span> <span class='operator'>*</span>u; <span class='curlybracket'>}</span>
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M1;
<span class='keyword'>import</span> <span class='literal'>"defn.h"</span>;        <span class='comment'>// provides <span class='tcode_in_codeblock'>struct X {};</span></span>
<span class='keyword'>import</span> stuff;
<span class='keyword'>export</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  X x;
  foo<span class='parenthesis'>(</span>t, x<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M2;
<span class='keyword'>import</span> <span class='literal'>"decl.h"</span>;        <span class='comment'>// provides <span class='tcode_in_codeblock'>struct X;</span> (not a definition)</span>
<span class='keyword'>import</span> stuff;
<span class='keyword'>export</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span>T t<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  X <span class='operator'>*</span>x;
  bar<span class='parenthesis'>(</span>t, x<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre><p>Translation unit #4:<pre class='codeblock'>
<span class='keyword'>import</span> M1;
<span class='keyword'>import</span> M2;
<span class='keyword'>void</span> test<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
  g<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre> <div id='context-7.sentence-1' class='sentence'>
The call to <span class='texttt'>f<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span></span> is valid;
the instantiation context of <span class='texttt'>foo<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>, X<span class='anglebracket'>&gt;</span></span> comprises
<ul class='itemize'><li >the point at the end of translation unit #1,</li><li >the point at the end of translation unit #2, and</li><li >the point of the call to <span class='texttt'>f<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span></span>,</li></ul>
so the definition of <span class='texttt'>X</span> is reachable (<a href='#reach'>[module.reach]</a>)<a class='hidden_link' href='#context-7.sentence-1'>.</a></div><div style='height:0.6em;display:block'></div><div id='context-7.sentence-2' class='sentence'>It is unspecified whether the call to <span class='texttt'>g<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span></span> is valid:
the instantiation context of <span class='texttt'>bar<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>, X<span class='anglebracket'>&gt;</span></span> comprises
<ul class='itemize'><li >the point at the end of translation unit #1,</li><li >the point at the end of translation unit #3, and</li><li >the point of the call to <span class='texttt'>g<span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span></span>,</li></ul>
so the definition of <span class='texttt'>X</span> need not be reachable,
as described in <a href='#reach'>[module.reach]</a><a class='hidden_link' href='#context-7.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div><div id='reach' class='section'><h2 ><a class='secnum' href='#reach' style='min-width:88pt'>10.6</a> Reachability <a class='abbr_ref' href='module.reach'>[module.reach]</a></h2><div class='para' id='reach-1'><div class='marginalizedparent'><a class='marginalized' href='#reach-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L867'>#</a></div><div id='reach-1.sentence-1' class='sentence'>A translation unit <span class='math'><span class='mathalpha'>U</span></span> is
<a class='hidden_link' href='#def:reachable,necessarily,translation_unit' id='def:reachable,necessarily,translation_unit'><i >necessarily reachable</i></a>
from a point <span class='math'><span class='mathalpha'>P</span></span> if
<span class='math'><span class='mathalpha'>U</span></span> is a module interface unit on which the translation unit containing <span class='math'><span class='mathalpha'>P</span></span>
has an interface dependency, or
the translation unit containing <span class='math'><span class='mathalpha'>P</span></span> imports <span class='math'><span class='mathalpha'>U</span></span>,
in either case prior to <span class='math'><span class='mathalpha'>P</span></span> (<a href='#import'>[module.import]</a>)<a class='hidden_link' href='#reach-1.sentence-1'>.</a></div> <div id='reach-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#reach-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='reach-1.sentence-2' class='sentence'>While module interface units are reachable even when they are only
transitively imported via a non-exported import declaration,
namespace-scope names from such module interface units are not visible
to name lookup (<a href='basic.scope.namespace'>[basic.scope.namespace]</a>)<a class='hidden_link' href='#reach-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='reach-2'><div class='marginalizedparent'><a class='marginalized' href='#reach-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L882'>#</a></div><div id='reach-2.sentence-1' class='sentence'>All translation units that are necessarily reachable are
<a class='hidden_link' href='#def:reachable,translation_unit' id='def:reachable,translation_unit'><i >reachable</i></a><a class='hidden_link' href='#reach-2.sentence-1'>.</a></div> <div id='reach-2.sentence-2' class='sentence'>It is unspecified whether additional translation units on which the
point within the program has an interface dependency are considered reachable,
and under what circumstances<a class='hidden_link' href='#reach-2.sentence-2'>.</a><a class='footnotenum' href='#footnote-101' id='footnoteref-101'>101</a></div> <div id='reach-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#reach-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='reach-2.sentence-3' class='sentence'>It is advisable to avoid
depending on the reachability of any additional translation units
in programs intending to be portable<a class='hidden_link' href='#reach-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='reach-3'><div class='marginalizedparent'><a class='marginalized' href='#reach-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L897'>#</a></div><div id='reach-3.sentence-1' class='sentence'>A declaration <span class='math'><span class='mathalpha'>D</span></span> is
<a class='hidden_link' href='#def:reachable,declaration' id='def:reachable,declaration'><i >reachable</i></a> if,
for any point <span class='math'><span class='mathalpha'>P</span></span> in the
instantiation context (<a href='#context'>[module.context]</a>),
<ul class='itemize'><li id='reach-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#reach-3.1'>(3.1)</a></div><span class='math'><span class='mathalpha'>D</span></span> appears prior to <span class='math'><span class='mathalpha'>P</span></span> in the same translation unit, or</li><li id='reach-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#reach-3.2'>(3.2)</a></div><span class='math'><span class='mathalpha'>D</span></span> is not discarded (<a href='#global.frag'>[module.global.frag]</a>),
appears in a translation unit that is
reachable from <span class='math'><span class='mathalpha'>P</span></span>,
and
either does not appear within a <i ><a href='basic.link#nt:private-module-fragment'>private-module-fragment</a></i>
or appears in a <i ><a href='basic.link#nt:private-module-fragment'>private-module-fragment</a></i>
of the module containing <span class='math'><span class='mathalpha'>P</span></span>.</li></ul></div> <div id='reach-3.note-1' class='note'>[&nbsp;<a class='note_link' href='#reach-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='reach-3.sentence-2' class='sentence'>Whether a declaration is exported has no bearing on whether it is reachable<a class='hidden_link' href='#reach-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='reach-4'><div class='marginalizedparent'><a class='marginalized' href='#reach-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L916'>#</a></div><div id='reach-4.sentence-1' class='sentence'>The accumulated properties of all reachable declarations of
an entity within a context
determine the behavior of the entity within that context<a class='hidden_link' href='#reach-4.sentence-1'>.</a></div> <div id='reach-4.note-1' class='note'>[&nbsp;<a class='note_link' href='#reach-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='reach-4.sentence-2' class='sentence'>These reachable semantic properties include type completeness,
type definitions, initializers,
default arguments of functions or template declarations, attributes,
visibility of class or enumeration member names to ordinary lookup,
etc<a class='hidden_link' href='#reach-4.sentence-2'>.</a></div> <div id='reach-4.sentence-3' class='sentence'>Since default arguments are evaluated in the context of the call expression,
the reachable semantic properties of the corresponding parameter types apply in
that context<a class='hidden_link' href='#reach-4.sentence-3'>.</a></div> <div id='reach-4.example-1' class='example'>[&nbsp;<a class='example_link' href='#reach-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M<span class='operator'>:</span>A;
<span class='keyword'>export</span> <span class='keyword'>struct</span> B;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>module</span> M<span class='operator'>:</span>B;
<span class='keyword'>struct</span> B <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>module</span> M<span class='operator'>:</span>C;
<span class='keyword'>import</span> <span class='operator'>:</span>A;
B b1;                           <span class='comment'>// error: no reachable definition of <span class='tcode_in_codeblock'>struct B</span></span>
</pre><p>Translation unit #4:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>export</span> <span class='keyword'>import</span> <span class='operator'>:</span>A;
<span class='keyword'>import</span> <span class='operator'>:</span>B;
B b2;
<span class='keyword'>export</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>B b <span class='operator'>=</span> B<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #5:<pre class='codeblock'>
<span class='keyword'>module</span> X;
<span class='keyword'>import</span> M;
B b3;                           <span class='comment'>// error: no reachable definition of <span class='tcode_in_codeblock'>struct B</span></span>
<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>               <span class='comment'>// error: no reachable definition of <span class='tcode_in_codeblock'>struct B</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='reach-5'><div class='marginalizedparent'><a class='marginalized' href='#reach-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/81f1d689f51fe823d7f6faa659f03b2d787aebf6/source/modules.tex#L965'>#</a></div><div id='reach-5.note-1' class='note'>[&nbsp;<a class='note_link' href='#reach-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='reach-5.sentence-1' class='sentence'>An entity can have reachable declarations
even if it is not visible to name lookup<a class='hidden_link' href='#reach-5.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='reach-5.example-1' class='example'>[&nbsp;<a class='example_link' href='#reach-5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> A;
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
<span class='keyword'>export</span> <span class='keyword'>using</span> Y <span class='operator'>=</span> X;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>module</span> B;
<span class='keyword'>import</span> A;
Y y;                <span class='comment'>// OK, definition of <span class='tcode_in_codeblock'>X</span> is reachable</span>
X x;                <span class='comment'>// ill-formed: <span class='tcode_in_codeblock'>X</span> not visible to unqualified lookup</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='footnote' id='footnote-101'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-101'>101)</a></div><div id='footnote-101.sentence-1' class='sentence'>Implementations are therefore not required to prevent the semantic
effects of additional translation units involved in the compilation from being
observed<a class='hidden_link' href='#footnote-101.sentence-1'>.</a></div> <a href='#footnoteref-101'>⮥</a></div></div></div></body></html>