<!DOCTYPE html><html lang='en'><head><title>[diff.n3351.distance_algo]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:73pt'>Annex D&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>D.2</a> Ranges and the Palo Alto TR (N3351) <a class='abbr_ref' href='diff.n3351#distance_algo'>[diff.n3351]</a></h2><div id='diff.n3351.distance_algo'><h3 ><a class='secnum' style='min-width:103pt'>D.2.4</a> Distance Primitive is O(1) for Random Access Iterators <a class='abbr_ref'>[diff.n3351.distance_algo]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p >In the Palo Alto report, the <span class='texttt'>distance</span> iterator primitive for computing the distance from one
iterator position to another is not implemented in terms of <span class='texttt'>operator-</span> for random access
iterators. <span class='texttt'>distance</span>, according to the report, should always be <span class='math'>ÎŸ(<span class='math'><span class='mathalpha'>N</span></span>)</span>. It reads:</p><p ><div class='quote'>
The standard mandates a different definition for random access iterators:
<span class='texttt'>distance(i, j) == j - i</span>. We see this as a specification error; the guarantees of the
<span class='texttt'>distance</span> operation have been weakened for an iterator specialization.

In our design, we consider the two operations to be distinct.
</div></p><p >The design presented in this document keeps the specialization for random access iterators. To do
otherwise would be to silently break complexity guarantees in an unknown amount of working code.</p><p >To address the concern about weakened guarantees of the <span class='texttt'>distance</span> primitive, the design
presented here requires that random access iterators model
<span class='texttt'>SizedSentinel</span> (<a href='iterators.sizedsentinel'>[iterators.sizedsentinel]</a>). The <span class='texttt'>SizedSentinel</span>
concept requires that <span class='texttt'>b - a</span> return the number of times <span class='texttt'>a</span> would have to be
incremented to make it compare equal to <span class='texttt'>b</span>. Any type purporting to be a random access
iterator that fails to meet that requirement is by definition not a valid random access iterator.</p></div></div></div></body></html>