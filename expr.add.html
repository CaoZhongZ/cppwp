<!DOCTYPE html><html lang='en'><head><title>[expr.add]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>5</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><div id='expr.add'><h2 ><a class='secnum' style='min-width:88pt'>5.7</a> Additive operators <a class='abbr_ref'>[expr.add]</a></h2><p ><span class='indexparent'><a class='index' id='expression,additive_operators'></a></span><span class='indexparent'><a class='index' id='operator,additive'></a></span></p><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4001'>#</a></div><p >The additive operators <span class='texttt'>+</span> and <span class='texttt'>-</span> group left-to-right. The
usual arithmetic conversions are performed for operands of arithmetic or
enumeration type.</p><p ><span class='indexparent'><a class='index' id='operator,addition'></a></span><span class='indexparent'><a class='index' id='addition_operator'></a></span><span class='indexparent'><a class='index' id='+'></a></span><span class='indexparent'><a class='index' id='operator,subtraction'></a></span><span class='indexparent'><a class='index' id='subtraction_operator'></a></span><span class='indexparent'><a class='index' id='-'></a></span></p><pre class='bnf'><a class='nontermdef' id='nt:additive-expression'>additive-expression:</a>
&#9;<i ><a href='expr.mul#nt:multiplicative-expression'>multiplicative-expression</a></i>
&#9;<i ><a href='expr.add#nt:additive-expression'>additive-expression</a></i> <span class='terminal'>+</span> <i ><a href='expr.mul#nt:multiplicative-expression'>multiplicative-expression</a></i>
&#9;<i ><a href='expr.add#nt:additive-expression'>additive-expression</a></i> <span class='terminal'>-</span> <i ><a href='expr.mul#nt:multiplicative-expression'>multiplicative-expression</a></i>
</pre><p ><span class='indexparent'><a class='index' id='incomplete'></a></span>For addition, either both operands shall have arithmetic or unscoped enumeration
type, or one operand shall be a pointer to a completely-defined object
type and the other shall have integral or unscoped enumeration type.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4025'>#</a></div><p >For subtraction, one of the following shall hold:</p><ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div><p >both operands have arithmetic or unscoped enumeration type; or</p><p ><span class='indexparent'><a class='index' id='arithmetic,pointer'></a></span></p></li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div><p >both operands are pointers to cv-qualified or cv-unqualified
versions of the same completely-defined object type; or</p></li><li id='2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.3'>(2.3)</a></div><p >the left operand is a pointer to a completely-defined object type
and the right operand has integral or unscoped enumeration type.
</p></li></ul></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4039'>#</a></div><p >The result of the binary <span class='texttt'>+</span> operator is the sum of the operands.
The result of the binary <span class='texttt'>-</span> operator is the difference resulting
from the subtraction of the second operand from the first.</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4044'>#</a></div><p ><span class='indexparent'><a class='index' id='arithmetic,pointer'></a></span>When an expression that has integral type is added to or subtracted from
a pointer, the result has the type of the pointer operand.
If the expression <span class='texttt'>P</span> points to element <span class='math'><span class='mathtt'>x[</span><span class='mathalpha'>i</span><span class='mathtt'>]</span></span>
of an array object <span class='texttt'>x</span> with <span class='math'><span class='mathalpha'>n</span></span> elements<a class='footnotenum' href='#footnote-86'>86</a>,
the expressions <span class='texttt'>P + J</span> and <span class='texttt'>J + P</span>
(where <span class='texttt'>J</span> has the value <span class='math'><span class='mathalpha'>j</span></span>)
point to the (possibly-hypothetical) element
<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.519em; padding-bottom: 0.372em;">[</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.519em; padding-bottom: 0.372em;">]</span></span></span></span></span></span></span> if <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>;
otherwise, the behavior is undefined.
Likewise, the expression <span class='texttt'>P - J</span>
points to the (possibly-hypothetical) element
<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.519em; padding-bottom: 0.372em;">[</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mo"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.519em; padding-bottom: 0.372em;">]</span></span></span></span></span></span></span> if <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">0</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-mi MJXc-space3"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span></span>;
otherwise, the behavior is undefined.</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4065'>#</a></div><p ><span class='indexparent'><a class='index' id='ptrdiff_t,implementation-defined_type_of'></a></span><span class='indexparent'><a class='index' id='subtraction,implementation-defined_pointer'></a></span><span class='indexparent'><a class='index' id='ptrdiff_t'></a></span><span class='indexparent'><a class='index' id='cstddef'></a></span><span class='indexparent'><a class='index' id='comparison,undefined_pointer'></a></span>When two pointers to elements of the same array object are subtracted,
the type of the result is an <span class='indexparent'><a class='index' id='type_of_ptrdiff_t'></a></span>implementation-defined signed
integral type; this type shall be the same type that is defined as
<span class='texttt'>std&#x200b;::&#x200b;ptrdiff_&shy;t</span> in the <span class='texttt'>&lt;cstddef&gt;</span>
header (<a href='support.types'>[support.types]</a>).
If the expressions <span class='texttt'>P</span> and <span class='texttt'>Q</span>
point to, respectively,
elements
<span class='math'><span class='mathtt'>x[</span><span class='mathalpha'>i</span><span class='mathtt'>]</span></span>
and
<span class='math'><span class='mathtt'>x[</span><span class='mathalpha'>j</span><span class='mathtt'>]</span></span>
of the same array object <span class='texttt'>x</span>,
the expression <span class='texttt'>P - Q</span> has the value <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span>;
otherwise, the behavior is undefined.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span>
If the value <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">−</span></span><span class="mjx-mi MJXc-space2"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.519em;">j</span></span></span></span></span>
is not in the range of representable values
of type <span class='texttt'>std&#x200b;::&#x200b;ptrdiff_&shy;t</span>,
the behavior is undefined.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4092'>#</a></div><p >For addition or subtraction, if the expressions <span class='texttt'>P</span> or <span class='texttt'>Q</span> have
type “pointer to <span class='textit'>cv</span> <span class='texttt'>T</span>”, where <span class='texttt'>T</span> and the array element type
are not <a href='conv.qual#def:similar_types'>similar</a>, the behavior is undefined.
[<span style='white-space:nowrap'>&thinsp;</span><span class='textit'>Note:</span> In particular, a pointer to a base class cannot be used for
pointer arithmetic when the array contains objects of a derived class type.
<span class='textit'><span style='white-space:nowrap'>&thinsp;</span>—<span style='white-space:nowrap'>&thinsp;</span>end note</span><span style='white-space:nowrap'>&thinsp;</span>]</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/88657c99d3781984bf06d1f89e6e32d3b0051830/source/expressions.tex#L4100'>#</a></div><p >If the value 0 is added to or subtracted from a null pointer value,
the result is a null pointer value.
If two null pointer values are subtracted,
the result compares equal to the value 0
converted to the type <span class='texttt'>std&#x200b;::&#x200b;ptrdiff_&shy;t</span>.</p></div><div class='footnote' id='footnote-86'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-86'>86)</a></div><p >An object that is not an array element is considered to belong to a
single-element array for this purpose; see <a href='expr.unary.op'>[expr.unary.op]</a>.
A pointer past the last element of an array <span class='texttt'>x</span> of <span class='math'><span class='mathalpha'>n</span></span> elements
is considered to be equivalent to a pointer to a hypothetical element
<span class='math'><span class='mathtt'>x[</span><span class='mathalpha'>n</span><span class='mathtt'>]</span></span> for this purpose; see <a href='basic.compound'>[basic.compound]</a>.</p></div></div></div></body></html>