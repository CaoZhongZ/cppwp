<!DOCTYPE html><html lang='en'><head><title>[socket.streambuf.virtual]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>19</a> Socket iostreams <a class='abbr_ref' href='./#socket.iostreams'>[socket.iostreams]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>19.1</a> Class template <span class='texttt'>basic_socket_streambuf</span> <a class='abbr_ref' href='socket.streambuf#virtual'>[socket.streambuf]</a></h2><div id='socket.streambuf.virtual'><h3 ><a class='secnum' style='min-width:103pt'>19.1.3</a> <span class='texttt'>basic_socket_streambuf</span> overridden virtual functions <a class='abbr_ref'>[socket.streambuf.virtual]</a></h3><p ><code class='itemdecl'>
virtual int_type underflow() override;
</code></p><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><p ><i>Effects:</i> Behaves according to the description of <span class='texttt'>basic_streambuf&lt;char&gt;::underflow()</span>, with the specialization that a sequence of characters is read from the input sequence as if by POSIX <span class='texttt'>recvmsg</span>, and <span class='texttt'>ec_</span> is set to reflect the error code produced by the operation. If the operation does not complete before the absolute timeout specified by <span class='texttt'>expiry_</span>, the socket is closed and <span class='texttt'>ec_</span> is set to <span class='texttt'>errc::timed_out</span>.</p></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>traits_type::to_int_type(*gptr())</span> to indicate success,
and <span class='texttt'>traits_type::eof()</span> to indicate failure.
</p></div></div><p ><code class='itemdecl'>
virtual int_type pbackfail(int_type c = traits_type::eof()) override;
</code></p><div class='itemdescr'></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><p ><i>Effects:</i> Puts back the character designated by <span class='texttt'>c</span> to the input sequence, if possible, in one of three ways:</p><ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div><p >If <span class='texttt'>traits_type::eq_int_type(c, traits_type::eof())</span> returns <span class='texttt'>false</span>, and if the function makes a putback position available, and if <span class='texttt'>traits_type::eq(traits_type::to_char_type(c), gptr()[-1])</span> returns <span class='texttt'>true</span>, decrements the next pointer for the input sequence, <span class='texttt'>gptr()</span>.</p><p >Returns: <span class='texttt'>c</span>.</p></li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div><p >If <span class='texttt'>traits_type::eq_int_type(c, traits_type::eof())</span> returns <span class='texttt'>false</span>, and if the function makes a putback position available, and if the function is permitted to assign to the putback position, decrements the next pointer for the input sequence, and stores <span class='texttt'>c</span> there.</p><p >Returns: <span class='texttt'>c</span>.</p></li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div><p >If <span class='texttt'>traits_type::eq_int_type(c, traits_type::eof())</span> returns <span class='texttt'>true</span>, and if either the input sequence has a putback position available or the function makes a putback position available, decrements the next pointer for the input sequence, <span class='texttt'>gptr()</span>.</p><p >Returns: <span class='texttt'>traits_type::not_eof(c)</span>.
</p></li></ul></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><p ><i>Returns:</i> As specified above, or <span class='texttt'>traits_type::eof()</span> to indicate failure.</p></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><p ><i>Remarks:</i> The function does not put back a character directly to the input sequence. If the function can succeed in more than one of these ways, it is unspecified which way is chosen. The function can alter the number of putback positions available as a result of any call.
</p></div></div><p ><code class='itemdecl'>
virtual int_type overflow(int_type c = traits_type::eof()) override;
</code></p><div class='itemdescr'></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><p ><i>Effects:</i> Behaves according to the description of <span class='texttt'>basic_streambuf&lt;char&gt;::overflow(c)</span>, except that the behavior of “consuming characters” is performed by output of the characters to the socket as if by one or more calls to POSIX <span class='texttt'>sendmsg</span>, and <span class='texttt'>ec_</span> is set to reflect the error code produced by the operation. If the operation does not complete before the absolute timeout specified by <span class='texttt'>expiry_</span>, the socket is closed and <span class='texttt'>ec_</span> is set to <span class='texttt'>errc::timed_out</span>.</p></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><p ><i>Returns:</i> <span class='texttt'>traits_type::not_eof(c)</span> to indicate success, and <span class='texttt'>traits_type::eof()</span> to indicate failure.
</p></div></div><p ><code class='itemdecl'>
virtual int sync() override;
</code></p><div class='itemdescr'></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><p ><i>Effects:</i> If a put area exists, calls <span class='texttt'>overflow(traits_type::eof())</span> to flush characters.
</p></div></div><p ><code class='itemdecl'>
virtual streambuf* setbuf(char_type* s, streamsize n) override;
</code></p><div class='itemdescr'></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><p ><i>Effects:</i> If <span class='texttt'>setbuf(nullptr, 0)</span> is called on a stream before any I/O has occurred on that stream, the stream becomes unbuffered. Otherwise the results are unspecified. “Unbuffered” means that <span class='texttt'>pbase()</span> and <span class='texttt'>pptr()</span> always return null and output to the socket should appear as soon as possible.
</p></div></div></div></div></body></html>