<!DOCTYPE html><html lang='en'><head><title>[socket.basic.ops]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>18</a> Sockets <a class='abbr_ref' href='./#socket'>[socket]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>18.6</a> Class template <span class='texttt'>basic_socket</span> <a class='abbr_ref' href='socket.basic#ops'>[socket.basic]</a></h2><div id='socket.basic.ops'><h3 ><a class='secnum' style='min-width:103pt'>18.6.4</a> <span class='texttt'>basic_socket</span> operations <a class='abbr_ref'>[socket.basic.ops]</a></h3><p ><code class='itemdecl'>
executor_type get_executor() noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><p ><i>Returns:</i> The associated executor.
</p></div></div><p ><code class='itemdecl'>
native_handle_type native_handle();
</code></p><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><p ><i>Returns:</i> The native representation of this socket.
</p></div></div><p ><code class='itemdecl'>
void open(const protocol_type&amp; protocol);
void open(const protocol_type&amp; protocol, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><p ><i>Effects:</i> Establishes the postcondition, as if by POSIX <span class='texttt'>socket(protocol.family(), protocol.type(), protocol.protocol())</span>.</p></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><p ><i>Postconditions:</i>
</p><ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><p ><span class='texttt'>is_open() == true</span>.
</p></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><p ><span class='texttt'>non_blocking() == false</span>.
</p></li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div><p ><span class='texttt'>protocol_ == protocol</span>.
</p></li></ul></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='5.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#5.1'>(5.1)</a></div><p ><span class='texttt'>socket_errc::already_open</span> — if <span class='texttt'>is_open() == true</span>.
</p></li></ul></div></div><p ><code class='itemdecl'>
void assign(const protocol_type&amp; protocol,
            const native_handle_type&amp; native_socket);
void assign(const protocol_type&amp; protocol,
            const native_handle_type&amp; native_socket, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><p ><i>Requires:</i> <span class='texttt'>native_socket</span> is a native handle to an open socket.</p></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><p ><i>Effects:</i> Assigns the native socket handle to this socket object.</p></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><p ><i>Postconditions:</i>
</p><ul class='itemize'><li id='8.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.1'>(8.1)</a></div><p ><span class='texttt'>is_open() == true</span>.
</p></li><li id='8.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.2'>(8.2)</a></div><p ><span class='texttt'>non_blocking() == false</span>.
</p></li><li id='8.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#8.3'>(8.3)</a></div><p ><span class='texttt'>protocol_ == protocol</span>.
</p></li></ul></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.1'>(9.1)</a></div><p ><span class='texttt'>socket_errc::already_open</span> — if <span class='texttt'>is_open() == true</span>.
</p></li></ul></div></div><p ><code class='itemdecl'>
bool is_open() const noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><p ><i>Returns:</i> A <span class='texttt'>bool</span> indicating whether this socket was opened by a previous call to <span class='texttt'>open</span> or <span class='texttt'>assign</span>.
</p></div></div><p ><code class='itemdecl'>
void close();
void close(error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><p ><i>Effects:</i> If <span class='texttt'>is_open()</span> is <span class='texttt'>true</span>, cancels all outstanding asynchronous operations associated with this socket, and establishes the postcondition as if by POSIX <span class='texttt'>close(native_handle())</span>. Completion handlers for canceled asynchronous operations are passed an error code <span class='texttt'>ec</span> such that <span class='texttt'>ec == errc::operation_canceled</span> yields <span class='texttt'>true</span>.</p></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><p ><i>Postconditions:</i> <span class='texttt'>is_open() == false</span>.
</p></div></div><p ><code class='itemdecl'>
void cancel();
void cancel(error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><p ><i>Effects:</i> Cancels all outstanding asynchronous operations associated with this socket. Completion handlers for canceled asynchronous operations are passed an error code <span class='texttt'>ec</span> such that <span class='texttt'>ec == errc::operation_canceled</span> yields <span class='texttt'>true</span>.</p></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='14.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.1'>(14.1)</a></div><p ><span class='texttt'>errc::bad_file_descriptor</span> — if <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>.
</p></li></ul></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><p ><i>Remarks:</i> Does not block (C++Std &sect;<a href='../n4140/defns.block'>[defns.block]</a>) the calling thread pending completion of the canceled operations.
</p></div></div><p ><code class='itemdecl'>
template&lt;class SettableSocketOption&gt;
  void set_option(const SettableSocketOption&amp; option);
template&lt;class SettableSocketOption&gt;
  void set_option(const SettableSocketOption&amp; option, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><p ><i>Effects:</i> Sets an option on this socket, as if by POSIX <span class='texttt'>setsockopt(native_handle(), option.level(protocol_), option.name(protocol_), option.data(protocol_), option.size(protocol_))</span>.
</p></div></div><p ><code class='itemdecl'>
template&lt;class GettableSocketOption&gt;
  void get_option(GettableSocketOption&amp; option);
template&lt;class GettableSocketOption&gt;
  void get_option(GettableSocketOption&amp; option, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><p ><i>Effects:</i> Gets an option from this socket, as if by POSIX:
</p><pre class='codeblock'>
socklen_t option_len = option.size(protocol_);
int result = getsockopt(native_handle(), option.level(protocol_),
                        option.name(protocol_), option.data(protocol_),
                        &amp;option_len);
if (result == 0)
  option.resize(option_len);
</pre></div></div><p ><code class='itemdecl'>
template&lt;class IoControlCommand&gt;
  void io_control(IoControlCommand&amp; command);
template&lt;class IoControlCommand&gt;
  void io_control(IoControlCommand&amp; command, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='itemdescr'><p ><i>Effects:</i> Executes an I/O control command on this socket, as if by POSIX <span class='texttt'>ioctl(native_handle(), command.name(), command.data())</span>.
</p></div></div><p ><code class='itemdecl'>
void non_blocking(bool mode);
void non_blocking(bool mode, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='itemdescr'><p ><i>Effects:</i> Sets the non-blocking mode of this socket. The non-blocking mode determines whether subsequent synchronous socket operations (<a href='socket.reqmts.sync'>[socket.reqmts.sync]</a>) on <span class='texttt'>*this</span> block the calling thread.</p></div></div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='20.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#20.1'>(20.1)</a></div><p ><span class='texttt'>errc::bad_file_descriptor</span> — if <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>.
</p></li></ul></div></div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='itemdescr'><p ><i>Postconditions:</i> <span class='texttt'>non_blocking() == mode</span>.</p></div></div><div class='para' id='22'><div class='marginalizedparent'><a class='marginalized' href='#22'>22</a></div><div class='itemdescr'><p >[&nbsp;<i>Note:</i> The non-blocking mode has no effect on the behavior of asynchronous operations. <i>&nbsp;—&nbsp;end note</i>&nbsp;]
</p></div></div><p ><code class='itemdecl'>
bool non_blocking() const;
</code></p><div class='itemdescr'></div><div class='para' id='23'><div class='marginalizedparent'><a class='marginalized' href='#23'>23</a></div><div class='itemdescr'><p ><i>Returns:</i> The non-blocking mode of this socket.
</p></div></div><p ><code class='itemdecl'>
void native_non_blocking(bool mode);
void native_non_blocking(bool mode, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='24'><div class='marginalizedparent'><a class='marginalized' href='#24'>24</a></div><div class='itemdescr'><p ><i>Effects:</i> Sets the non-blocking mode of the underlying native socket, as if by POSIX:
</p><pre class='codeblock'>
int flags = fcntl(native_handle(), F_GETFL, 0);
if (flags &gt;= 0){
  if (mode)
    flags |= O_NONBLOCK;
  else
    flags &amp;= ~O_NONBLOCK;
  fcntl(native_handle(), F_SETFL, flags);
}
</pre></div></div><div class='para' id='25'><div class='marginalizedparent'><a class='marginalized' href='#25'>25</a></div><div class='itemdescr'><p >The native non-blocking mode has no effect on the behavior of the synchronous or asynchronous operations specified in this clause.</p></div></div><div class='para' id='26'><div class='marginalizedparent'><a class='marginalized' href='#26'>26</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='26.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#26.1'>(26.1)</a></div><p ><span class='texttt'>errc::bad_file_descriptor</span> — if <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>.
</p></li><li id='26.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#26.2'>(26.2)</a></div><p ><span class='texttt'>errc::invalid_argument</span> — if <span class='texttt'>mode == false</span> and <span class='texttt'>non_blocking() == true</span>. [&nbsp;<i>Note:</i> As the combination does not make sense. <i>&nbsp;—&nbsp;end note</i>&nbsp;]
</p></li></ul></div></div><p ><code class='itemdecl'>
bool native_non_blocking() const;
</code></p><div class='itemdescr'></div><div class='para' id='27'><div class='marginalizedparent'><a class='marginalized' href='#27'>27</a></div><div class='itemdescr'><p ><i>Returns:</i> The non-blocking mode of the underlying native socket.</p></div></div><div class='para' id='28'><div class='marginalizedparent'><a class='marginalized' href='#28'>28</a></div><div class='itemdescr'><p ><i>Remarks:</i> Implementations are permitted and encouraged to cache the native non-blocking mode that was applied through a prior call to <span class='texttt'>native_non_blocking</span>. Implementations may return an incorrect value if a program sets the non-blocking mode directly on the socket, by calling an operating system-specific function on the result of <span class='texttt'>native_handle()</span>.
</p></div></div><p ><code class='itemdecl'>
bool at_mark() const;
bool at_mark(error_code&amp; ec) const;
</code></p><div class='itemdescr'></div><div class='para' id='29'><div class='marginalizedparent'><a class='marginalized' href='#29'>29</a></div><div class='itemdescr'><p ><i>Effects:</i> Determines if this socket is at the out-of-band data mark, as if by POSIX <span class='texttt'>sockatmark(native_handle())</span>. [&nbsp;<i>Note:</i> The <span class='texttt'>at_mark()</span> function must be used in conjunction with the <span class='texttt'>socket_base::out_of_band_inline</span> socket option. <i>&nbsp;—&nbsp;end note</i>&nbsp;]</p></div></div><div class='para' id='30'><div class='marginalizedparent'><a class='marginalized' href='#30'>30</a></div><div class='itemdescr'><p ><i>Returns:</i> A <span class='texttt'>bool</span> indicating whether this socket is at the out-of-band data mark. <span class='texttt'>false</span> if an error occurs.
</p></div></div><p ><code class='itemdecl'>
size_t available() const;
size_t available(error_code&amp; ec) const;
</code></p><div class='itemdescr'></div><div class='para' id='31'><div class='marginalizedparent'><a class='marginalized' href='#31'>31</a></div><div class='itemdescr'><p ><i>Returns:</i> An indication of the number of bytes that may be read without blocking, or <span class='texttt'>0</span> if an error occurs.</p></div></div><div class='para' id='32'><div class='marginalizedparent'><a class='marginalized' href='#32'>32</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='32.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#32.1'>(32.1)</a></div><p ><span class='texttt'>errc::bad_file_descriptor</span> — if <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>.
</p></li></ul></div></div><p ><code class='itemdecl'>
void bind(const endpoint_type&amp; endpoint);
void bind(const endpoint_type&amp; endpoint, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='33'><div class='marginalizedparent'><a class='marginalized' href='#33'>33</a></div><div class='itemdescr'><p ><i>Effects:</i> Binds this socket to the specified local endpoint, as if by POSIX <span class='texttt'>bind(native_handle(), endpoint.data(), endpoint.size())</span>.
</p></div></div><p ><code class='itemdecl'>
void shutdown(shutdown_type what);
void shutdown(shutdown_type what, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='34'><div class='marginalizedparent'><a class='marginalized' href='#34'>34</a></div><div class='itemdescr'><p ><i>Effects:</i> Shuts down all or part of a full-duplex connection for the socket, as if by POSIX <span class='texttt'>shutdown(native_handle(), static_cast&lt;int&gt;(what))</span>.
</p></div></div><p ><code class='itemdecl'>
endpoint_type local_endpoint() const;
endpoint_type local_endpoint(error_code&amp; ec) const;
</code></p><div class='itemdescr'></div><div class='para' id='35'><div class='marginalizedparent'><a class='marginalized' href='#35'>35</a></div><div class='itemdescr'><p ><i>Effects:</i> Determines the locally-bound endpoint associated with the socket, as if by POSIX:
</p><pre class='codeblock'>
endpoint_type endpoint;
socklen_t endpoint_len = endpoint.capacity();
int result = getsockname(native_handle(), endpoint.data(), &amp;endpoint_len);
if (result == 0)
  endpoint.resize(endpoint_len);
</pre></div></div><div class='para' id='36'><div class='marginalizedparent'><a class='marginalized' href='#36'>36</a></div><div class='itemdescr'><p ><i>Returns:</i> On success, <span class='texttt'>endpoint</span>. Otherwise <span class='texttt'>endpoint_type()</span>.
</p></div></div><p ><code class='itemdecl'>
endpoint_type remote_endpoint() const;
endpoint_type remote_endpoint(error_code&amp; ec) const;
</code></p><div class='itemdescr'></div><div class='para' id='37'><div class='marginalizedparent'><a class='marginalized' href='#37'>37</a></div><div class='itemdescr'><p ><i>Effects:</i> Determines the remote endpoint associated with this socket, as if by POSIX:
</p><pre class='codeblock'>
endpoint_type endpoint;
socklen_t endpoint_len = endpoint.capacity();
int result = getpeername(native_handle(), endpoint.data(), &amp;endpoint_len);
if (result == 0)
  endpoint.resize(endpoint_len);
</pre></div></div><div class='para' id='38'><div class='marginalizedparent'><a class='marginalized' href='#38'>38</a></div><div class='itemdescr'><p ><i>Returns:</i> On success, <span class='texttt'>endpoint</span>. Otherwise <span class='texttt'>endpoint_type()</span>.
</p></div></div><p ><code class='itemdecl'>
void connect(const endpoint_type&amp; endpoint);
void connect(const endpoint_type&amp; endpoint, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='39'><div class='marginalizedparent'><a class='marginalized' href='#39'>39</a></div><div class='itemdescr'><p ><i>Effects:</i> If <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>, opens this socket by performing <span class='texttt'>open(endpoint.protocol(), ec)</span>. If <span class='texttt'>ec</span>, returns with no further action. Connects this socket to the specified remote endpoint, as if by POSIX <span class='texttt'>connect(native_handle(), endpoint.data(), endpoint.size())</span>.
</p></div></div><p ><code class='itemdecl'>
template&lt;class CompletionToken&gt;
  <i><span class='texttt'>DEDUCED</span></i> async_connect(const endpoint_type&amp; endpoint, CompletionToken&amp;&amp; token);
</code></p><div class='itemdescr'></div><div class='para' id='40'><div class='marginalizedparent'><a class='marginalized' href='#40'>40</a></div><div class='itemdescr'><p ><i>Completion signature:</i> <span class='texttt'>void(error_code ec)</span>.</p></div></div><div class='para' id='41'><div class='marginalizedparent'><a class='marginalized' href='#41'>41</a></div><div class='itemdescr'><p ><i>Effects:</i> If <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>, opens this socket by performing <span class='texttt'>open(endpoint.protocol(), ec)</span>. If <span class='texttt'>ec</span>, the operation completes immediately with no further action. Initiates an asynchronous operation to connect this socket to the specified remote endpoint, as if by POSIX <span class='texttt'>connect(native_handle(), endpoint.data(), endpoint.size())</span>.</p></div></div><div class='para' id='42'><div class='marginalizedparent'><a class='marginalized' href='#42'>42</a></div><div class='itemdescr'><p >When an asynchronous connect operation on this socket is simultaneously outstanding with another asynchronous connect, read, or write operation on this socket, the behavior is undefined.</p></div></div><div class='para' id='43'><div class='marginalizedparent'><a class='marginalized' href='#43'>43</a></div><div class='itemdescr'><p >If a program performs a synchronous operation on this socket, other than <span class='texttt'>close</span> or <span class='texttt'>cancel</span>, while there is an outstanding asynchronous connect operation, the behavior is undefined.
</p></div></div><p ><code class='itemdecl'>
void wait(wait_type w);
void wait(wait_type w, error_code&amp; ec);
</code></p><div class='itemdescr'></div><div class='para' id='44'><div class='marginalizedparent'><a class='marginalized' href='#44'>44</a></div><div class='itemdescr'><p ><i>Effects:</i> Waits for this socket to be ready to read, ready to write, or to have error conditions pending, as if by POSIX <span class='texttt'>poll</span>.</p></div></div><div class='para' id='45'><div class='marginalizedparent'><a class='marginalized' href='#45'>45</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='45.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#45.1'>(45.1)</a></div><p ><span class='texttt'>errc::bad_file_descriptor</span> — if <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>.
</p></li></ul></div></div><p ><code class='itemdecl'>
template&lt;class CompletionToken&gt;
  <i><span class='texttt'>DEDUCED</span></i> async_wait(wait_type w, CompletionToken&amp;&amp; token);
</code></p><div class='itemdescr'></div><div class='para' id='46'><div class='marginalizedparent'><a class='marginalized' href='#46'>46</a></div><div class='itemdescr'><p ><i>Completion signature:</i> <span class='texttt'>void(error_code ec)</span>.</p></div></div><div class='para' id='47'><div class='marginalizedparent'><a class='marginalized' href='#47'>47</a></div><div class='itemdescr'><p ><i>Effects:</i> Initiates an asynchronous operation to wait for this socket to be ready to read, ready to write, or to have error conditions pending, as if by POSIX <span class='texttt'>poll</span>.</p></div></div><div class='para' id='48'><div class='marginalizedparent'><a class='marginalized' href='#48'>48</a></div><div class='itemdescr'><p >When there are multiple outstanding asynchronous wait operations on this socket with the same <span class='texttt'>wait_type</span> value, all of these operations complete when this socket enters the corresponding ready state. The order of invocation of the completion handlers for these operations is unspecified.</p></div></div><div class='para' id='49'><div class='marginalizedparent'><a class='marginalized' href='#49'>49</a></div><div class='itemdescr'><p ><i>Error conditions:</i>
</p><ul class='itemize'><li id='49.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#49.1'>(49.1)</a></div><p ><span class='texttt'>errc::bad_file_descriptor</span> — if <span class='texttt'>is_open()</span> is <span class='texttt'>false</span>.
</p></li></ul></div></div><p ><span class='indexparent'><a class='index' id='basic_datagram_socket'></a></span></p></div></div></body></html>