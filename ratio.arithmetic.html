<!DOCTYPE html><html lang='en'><head><title>[ratio.arithmetic]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>23</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>23.16</a> Compile-time rational arithmetic <a class='abbr_ref' href='ratio#arithmetic'>[ratio]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>23.16.4</a> Arithmetic on <span class='texttt'>ratio</span>s <a class='abbr_ref'>[ratio.arithmetic]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L17364'>#</a></div><div id='1.sentence-1' class='sentence'>Each of the alias templates <span class='texttt'>ratio_&shy;add</span>, <span class='texttt'>ratio_&shy;subtract</span>, <span class='texttt'>ratio_&shy;multiply</span>,
and <span class='texttt'>ratio_&shy;divide</span> denotes the result of an arithmetic computation on two
<span class='texttt'>ratio</span>s <span class='texttt'>R1</span> and <span class='texttt'>R2</span><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>With <span class='texttt'>X</span> and <span class='texttt'>Y</span> computed (in the
absence of arithmetic overflow) as specified by Table <a href='#tab:ratio.arithmetic'>51</a>, each alias
denotes a <span class='texttt'>ratio&lt;U, V&gt;</span> such that <span class='texttt'>U</span> is the same as <span class='texttt'>ratio&lt;X, Y&gt;&#x200b;::&#x200b;num</span> and
<span class='texttt'>V</span> is the same as <span class='texttt'>ratio&lt;X, Y&gt;&#x200b;::&#x200b;den</span><a class='hidden_link' href='#1.sentence-2'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L17372'>#</a></div><div id='2.sentence-1' class='sentence'>If it is not possible to represent <span class='texttt'>U</span> or <span class='texttt'>V</span> with <span class='texttt'>intmax_&shy;t</span>, the program is
ill-formed<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Otherwise, an implementation should yield correct values of <span class='texttt'>U</span> and
<span class='texttt'>V</span><a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>If it is not possible to represent <span class='texttt'>X</span> or <span class='texttt'>Y</span> with <span class='texttt'>intmax_&shy;t</span>, the
program is ill-formed unless the implementation yields correct values of <span class='texttt'>U</span> and
<span class='texttt'>V</span><a class='hidden_link' href='#2.sentence-3'>.</a></div><div class='numberedTable' id='tab:ratio.arithmetic'>Table <a href='#tab:ratio.arithmetic'>51</a> — Expressions used to perform ratio arithmetic<br><table ><tr class='rowsep'><td colspan='1' class='center'><div id='2.sentence-4' class='sentence'><b>Type</b></div></td><td colspan='1' class='center'><div id='2.sentence-5' class='sentence'><b>Value of <span class='texttt'>X</span></b></div></td><td colspan='1' class='center'><div id='2.sentence-6' class='sentence'><b>Value of <span class='texttt'>Y</span></b></div></td></tr><tr class='rowsep'><td class='left'><div id='2.sentence-7' class='sentence'><span class='texttt'>ratio_&shy;add&lt;R1, R2&gt;</span></div></td><td class='left'><div id='2.sentence-8' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;num * R2&#x200b;::&#x200b;den +</span></div></td><td class='left'><div id='2.sentence-9' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;den * R2&#x200b;::&#x200b;den</span></div></td></tr><tr ><td class='left'></td><td class='left'><div id='2.sentence-10' class='sentence'><span class='texttt'>R2&#x200b;::&#x200b;num * R1&#x200b;::&#x200b;den</span></div></td><td class='left'></td></tr><tr class='rowsep'><td class='left'><div id='2.sentence-11' class='sentence'><span class='texttt'>ratio_&shy;subtract&lt;R1, R2&gt;</span></div></td><td class='left'><div id='2.sentence-12' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;num * R2&#x200b;::&#x200b;den -</span></div></td><td class='left'><div id='2.sentence-13' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;den * R2&#x200b;::&#x200b;den</span></div></td></tr><tr ><td class='left'></td><td class='left'><div id='2.sentence-14' class='sentence'><span class='texttt'>R2&#x200b;::&#x200b;num * R1&#x200b;::&#x200b;den</span></div></td><td class='left'></td></tr><tr class='rowsep'><td class='left'><div id='2.sentence-15' class='sentence'><span class='texttt'>ratio_&shy;multiply&lt;R1, R2&gt;</span></div></td><td class='left'><div id='2.sentence-16' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;num * R2&#x200b;::&#x200b;num</span></div></td><td class='left'><div id='2.sentence-17' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;den * R2&#x200b;::&#x200b;den</span></div></td></tr><tr class='rowsep'><td class='left'><div id='2.sentence-18' class='sentence'><span class='texttt'>ratio_&shy;divide&lt;R1, R2&gt;</span></div></td><td class='left'><div id='2.sentence-19' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;num * R2&#x200b;::&#x200b;den</span></div></td><td class='left'><div id='2.sentence-20' class='sentence'><span class='texttt'>R1&#x200b;::&#x200b;den * R2&#x200b;::&#x200b;num</span></div></td></tr></table></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L17409'>#</a></div><div id='3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
static_assert(ratio_add&lt;ratio&lt;1, 3&gt;, ratio&lt;1, 6&gt;&gt;::num == 1, "1/3+1/6 == 1/2");
static_assert(ratio_add&lt;ratio&lt;1, 3&gt;, ratio&lt;1, 6&gt;&gt;::den == 2, "1/3+1/6 == 1/2");
static_assert(ratio_multiply&lt;ratio&lt;1, 3&gt;, ratio&lt;3, 2&gt;&gt;::num == 1, "1/3*3/2 == 1/2");
static_assert(ratio_multiply&lt;ratio&lt;1, 3&gt;, ratio&lt;3, 2&gt;&gt;::den == 2, "1/3*3/2 == 1/2");

<span class='comment'>// The following cases may cause the program to be ill-formed under some implementations
</span>static_assert(ratio_add&lt;ratio&lt;1, INT_MAX&gt;, ratio&lt;1, INT_MAX&gt;&gt;::num == 2,
  "1/MAX+1/MAX == 2/MAX");
static_assert(ratio_add&lt;ratio&lt;1, INT_MAX&gt;, ratio&lt;1, INT_MAX&gt;&gt;::den == INT_MAX,
  "1/MAX+1/MAX == 2/MAX");
static_assert(ratio_multiply&lt;ratio&lt;1, INT_MAX&gt;, ratio&lt;INT_MAX, 2&gt;&gt;::num == 1,
  "1/MAX * MAX/2 == 1/2");
static_assert(ratio_multiply&lt;ratio&lt;1, INT_MAX&gt;, ratio&lt;INT_MAX, 2&gt;&gt;::den == 2,
  "1/MAX * MAX/2 == 1/2");</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></body></html>