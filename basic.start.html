<!DOCTYPE html><html lang='en'><head><title>[basic.start]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>6</a> Basic concepts <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>6.8</a> Program execution <a class='abbr_ref' href='basic.exec#basic.start'>[basic.exec]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>6.8.3</a> Start and termination <a class='abbr_ref'>[basic.start]</a></h3><div id='main' class='section'><h4 ><a class='secnum' href='#main' style='min-width:118pt'>6.8.3.1</a> <span class='texttt'>main</span> function <a class='abbr_ref' href='basic.start.main'>[basic.start.main]</a></h4><span class='indexparent'><a class='index' id=':main_function'></a></span><div class='para' id='main-1'><div class='marginalizedparent'><a class='marginalized' href='#main-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5112'>#</a></div><div id='main-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':program,start'></a></span>A program shall contain a global function called <span class='texttt'>main</span><a class='hidden_link' href='#main-1.sentence-1'>.</a></div> <div id='main-1.sentence-2' class='sentence'>Executing a program starts a main thread of execution (<a href='intro.multithread'>[intro.multithread]</a>, <a href='thread.threads'>[thread.threads]</a>)
in which the <span class='texttt'>main</span> function is invoked,
and in which variables of static storage duration
might be initialized (<a href='basic.start.static'>[basic.start.static]</a>) and destroyed (<a href='basic.start.term'>[basic.start.term]</a>)<a class='hidden_link' href='#main-1.sentence-2'>.</a></div> <div id='main-1.sentence-3' class='sentence'>It is <span class='indexparent'><a class='index' id=':defining_main_in_freestanding_environment'></a></span>implementation-defined
whether a program in a freestanding environment is required to define a <span class='texttt'>main</span>
function<a class='hidden_link' href='#main-1.sentence-3'>.</a></div> <div id='main-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#main-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='main-1.sentence-4' class='sentence'>In a freestanding environment, start-up and termination is
<span class='indexparent'><a class='index' id=':start-up_and_termination_in_freestanding_environment'></a></span>implementation-defined; start-up contains the
execution of constructors for objects of namespace scope with static storage duration;
termination contains the execution of destructors for objects with static storage
duration<a class='hidden_link' href='#main-1.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='main-2'><div class='marginalizedparent'><a class='marginalized' href='#main-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5127'>#</a></div><div id='main-2.sentence-1' class='sentence'>An implementation shall not predefine the <span class='texttt'>main</span> function<a class='hidden_link' href='#main-2.sentence-1'>.</a></div> <div id='main-2.sentence-2' class='sentence'>This
function shall not be overloaded<a class='hidden_link' href='#main-2.sentence-2'>.</a></div> <div id='main-2.sentence-3' class='sentence'>Its type shall have C++ language linkage
and it shall have a declared return type of type
<span class='texttt'>int</span>, but otherwise its type is <span class='indexparent'><a class='index' id=':parameters_to_main'></a></span>implementation-defined<a class='hidden_link' href='#main-2.sentence-3'>.</a></div> <div id='main-2.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':main_function,implementation-defined_parameters_to'></a></span>An implementation shall allow both
<ul class='itemize'><li id='main-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#main-2.1'>(2.1)</a></div><div id='main-2.1.sentence-1' class='sentence'>a function of <span class='texttt'>()</span> returning <span class='texttt'>int</span> and</div></li><li id='main-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#main-2.2'>(2.2)</a></div><div id='main-2.2.sentence-1' class='sentence'>a function of <span class='texttt'>(int</span>, pointer to pointer to <span class='texttt'>char)</span> returning <span class='texttt'>int</span></div></li></ul></div><div id='main-2.sentence-5' class='sentence'><span class='indexparent'><a class='index' id=':argc'></a></span><span class='indexparent'><a class='index' id=':argv'></a></span>as the type of <span class='texttt'>main</span> (<a href='dcl.fct'>[dcl.fct]</a>)<a class='hidden_link' href='#main-2.sentence-5'>.</a></div> <div id='main-2.sentence-6' class='sentence'><span class='indexparent'><a class='index' id=':main_function,parameters_to'></a></span><span class='indexparent'><a class='index' id=':environment,program'></a></span>In the latter form, for purposes of exposition, the first function
parameter is called <span class='texttt'>argc</span> and the second function parameter is
called <span class='texttt'>argv</span>, where <span class='texttt'>argc</span> shall be the number of
arguments passed to the program from the environment in which the
program is run<a class='hidden_link' href='#main-2.sentence-6'>.</a></div> <div id='main-2.sentence-7' class='sentence'>If
<span class='texttt'>argc</span> is nonzero these arguments shall be supplied in
<span class='texttt'>argv[0]</span> through <span class='texttt'>argv[argc-1]</span> as pointers to the initial
characters of null-terminated multibyte strings (<span class='textsc'>ntmbs</span>s) (<a href='multibyte.strings'>[multibyte.strings]</a>)
and <span class='texttt'>argv[0]</span> shall be the pointer to
the initial character of a <span class='textsc'>ntmbs</span> that represents the name used to
invoke the program or <span class='texttt'>""</span><a class='hidden_link' href='#main-2.sentence-7'>.</a></div> <div id='main-2.sentence-8' class='sentence'>The value of <span class='texttt'>argc</span> shall be
non-negative<a class='hidden_link' href='#main-2.sentence-8'>.</a></div> <div id='main-2.sentence-9' class='sentence'>The value of <span class='texttt'>argv[argc]</span> shall be 0<a class='hidden_link' href='#main-2.sentence-9'>.</a></div> <div id='main-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#main-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='main-2.sentence-10' class='sentence'>It
is recommended that any further (optional) parameters be added after
<span class='texttt'>argv</span><a class='hidden_link' href='#main-2.sentence-10'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='main-3'><div class='marginalizedparent'><a class='marginalized' href='#main-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5159'>#</a></div><div id='main-3.sentence-1' class='sentence'>The function <span class='texttt'>main</span> shall not be used within
a program<a class='hidden_link' href='#main-3.sentence-1'>.</a></div> <div id='main-3.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':main_function,implementation-defined_linkage_of'></a></span>The linkage (<a href='basic.link'>[basic.link]</a>) of <span class='texttt'>main</span> is
<span class='indexparent'><a class='index' id=':linkage_of_main'></a></span>implementation-defined<a class='hidden_link' href='#main-3.sentence-2'>.</a></div> <div id='main-3.sentence-3' class='sentence'>A program that defines <span class='texttt'>main</span> as
deleted or that declares <span class='texttt'>main</span> to be
<span class='texttt'>inline</span>, <span class='texttt'>static</span>, or <span class='texttt'>constexpr</span> is ill-formed<a class='hidden_link' href='#main-3.sentence-3'>.</a></div> <div id='main-3.sentence-4' class='sentence'>The <span class='texttt'>main</span> function shall not be declared with a
<i ><a href='dcl.link#nt:linkage-specification'>linkage-specification</a></i><a class='hidden_link' href='#main-3.sentence-4'>.</a></div> <div id='main-3.sentence-5' class='sentence'>A program that
declares a variable <span class='texttt'>main</span> at global scope or that declares the name
<span class='texttt'>main</span> with C language linkage (in any namespace) is ill-formed<a class='hidden_link' href='#main-3.sentence-5'>.</a></div> <div id='main-3.sentence-6' class='sentence'>The name <span class='texttt'>main</span> is
not otherwise reserved<a class='hidden_link' href='#main-3.sentence-6'>.</a></div> <div id='main-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#main-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='main-3.sentence-7' class='sentence'>Member functions, classes, and
enumerations can be called <span class='texttt'>main</span>, as can entities in other
namespaces<a class='hidden_link' href='#main-3.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='main-4'><div class='marginalizedparent'><a class='marginalized' href='#main-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5176'>#</a></div><div id='main-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':exit'></a></span><span class='indexparent'><a class='index' id='lib:exit'></a></span><span class='indexparent'><a class='index' id=':termination,program'></a></span>Terminating the program
without leaving the current block (e.g., by calling the function
<span class='texttt'>std&#x200b;::&#x200b;exit(int)</span> (<a href='support.start.term'>[support.start.term]</a>)) does not destroy any
objects with automatic storage duration (<a href='class.dtor'>[class.dtor]</a>)<a class='hidden_link' href='#main-4.sentence-1'>.</a></div> <div id='main-4.sentence-2' class='sentence'>If
<span class='texttt'>std&#x200b;::&#x200b;exit</span> is called to end a program during the destruction of
an object with static or thread storage duration, the program has undefined
behavior<a class='hidden_link' href='#main-4.sentence-2'>.</a></div></div><div class='para' id='main-5'><div class='marginalizedparent'><a class='marginalized' href='#main-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5188'>#</a></div><div id='main-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':termination,program_'></a></span><span class='indexparent'><a class='index' id=':main_function,return_from'></a></span>A return statement in <span class='texttt'>main</span> has the effect of leaving the main
function (destroying any objects with automatic storage duration) and
calling <span class='texttt'>std&#x200b;::&#x200b;exit</span> with the return value as the argument<a class='hidden_link' href='#main-5.sentence-1'>.</a></div> <div id='main-5.sentence-2' class='sentence'>If control flows off the end of
the <i ><a href='stmt.block#nt:compound-statement'>compound-statement</a></i> of <span class='texttt'>main</span>,
the effect is equivalent to a <span class='texttt'>return</span> with operand <span class='texttt'>0</span>
(see also <a href='except.handle'>[except.handle]</a>)<a class='hidden_link' href='#main-5.sentence-2'>.</a></div> </div></div><div id='static' class='section'><h4 ><a class='secnum' href='#static' style='min-width:118pt'>6.8.3.2</a> Static initialization <a class='abbr_ref' href='basic.start.static'>[basic.start.static]</a></h4><div class='para' id='static-1'><div class='marginalizedparent'><a class='marginalized' href='#static-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5202'>#</a></div><div id='static-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization'></a></span><span class='indexparent'><a class='index' id=':initialization,static_and_thread'></a></span>Variables with static storage duration
are initialized as a consequence of program initiation<a class='hidden_link' href='#static-1.sentence-1'>.</a></div> <div id='static-1.sentence-2' class='sentence'>Variables with
thread storage duration are initialized as a consequence of thread execution<a class='hidden_link' href='#static-1.sentence-2'>.</a></div> <div id='static-1.sentence-3' class='sentence'>Within each of these phases of initiation, initialization occurs as follows<a class='hidden_link' href='#static-1.sentence-3'>.</a></div></div><div class='para' id='static-2'><div class='marginalizedparent'><a class='marginalized' href='#static-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5210'>#</a></div><div id='static-2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,static_object'></a></span><span class='indexparent'><a class='index' id=':initialization,constant'></a></span>A <a class='hidden_link' href='#def:constant_initializer' id='def:constant_initializer'><i >constant initializer</i></a> for a variable or temporary object <span class='texttt'>o</span>
is an initializer whose full-expression is a
constant expression, except that if <span class='texttt'>o</span> is an object,
such an initializer may also invoke constexpr constructors
for <span class='texttt'>o</span> and its subobjects even if those objects are of non-literal class
types<a class='hidden_link' href='#static-2.sentence-1'>.</a></div> <div id='static-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#static-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='static-2.sentence-6' class='sentence'>Such a class may have a non-trivial destructor<a class='hidden_link' href='#static-2.sentence-6'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='static-2.sentence-2' class='sentence'><a class='hidden_link' href='#def:constant_initialization' id='def:constant_initialization'><i >Constant initialization</i></a> is performed
if a variable or temporary object with static or thread storage duration
is initialized by a constant initializer for the entity<a class='hidden_link' href='#static-2.sentence-2'>.</a></div> <div id='static-2.sentence-3' class='sentence'><span class='indexparent'><a class='index' id=':initialization,runtime'></a></span>If constant initialization is not performed, a variable with static
storage duration (<a href='basic.stc.static'>[basic.stc.static]</a>) or thread storage
duration (<a href='basic.stc.thread'>[basic.stc.thread]</a>) is zero-initialized (<a href='dcl.init'>[dcl.init]</a>)<a class='hidden_link' href='#static-2.sentence-3'>.</a></div> <div id='static-2.sentence-4' class='sentence'>Together, zero-initialization and constant initialization are called
<span class='indexparent'><a class='index' id=':initialization,dynamic'></a></span><a class='hidden_link' href='#def:static_initialization' id='def:static_initialization'><i >static initialization</i></a>;
all other initialization is <a class='hidden_link' href='#def:dynamic_initialization' id='def:dynamic_initialization'><i >dynamic initialization</i></a><a class='hidden_link' href='#static-2.sentence-4'>.</a></div> <div id='static-2.sentence-5' class='sentence'>All static initialization strongly happens before (<a href='intro.races'>[intro.races]</a>)
any dynamic initialization<a class='hidden_link' href='#static-2.sentence-5'>.</a></div> <div id='static-2.note-2' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#static-2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='static-2.sentence-7' class='sentence'>The dynamic initialization of non-local variables is described
in <a href='basic.start.dynamic'>[basic.start.dynamic]</a>; that of local static variables is described
in <a href='stmt.dcl'>[stmt.dcl]</a><a class='hidden_link' href='#static-2.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='static-3'><div class='marginalizedparent'><a class='marginalized' href='#static-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5236'>#</a></div><div id='static-3.sentence-1' class='sentence'>An implementation is permitted to perform the initialization of a
variable with static or thread storage duration as a static
initialization even if such initialization is not required to be done
statically, provided that
<ul class='itemize'><li id='static-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#static-3.1'>(3.1)</a></div><div id='static-3.1.sentence-1' class='sentence'>the dynamic version of the initialization does not change the
value of any other object of static or thread storage duration
prior to its initialization, and</div></li><li id='static-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#static-3.2'>(3.2)</a></div><div id='static-3.2.sentence-1' class='sentence'>the static version of the initialization produces the same value
in the initialized variable as would be produced by the dynamic
initialization if all variables not required to be initialized statically
were initialized dynamically<a class='hidden_link' href='#static-3.2.sentence-1'>.</a></div></li></ul></div> <div id='static-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#static-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='static-3.sentence-2' class='sentence'>As a consequence, if the initialization of an object <span class='texttt'>obj1</span> refers to an
object <span class='texttt'>obj2</span> of namespace scope potentially requiring dynamic initialization and defined
later in the same translation unit, it is unspecified whether the value of <span class='texttt'>obj2</span> used
will be the value of the fully initialized <span class='texttt'>obj2</span> (because <span class='texttt'>obj2</span> was statically
initialized) or will be the value of <span class='texttt'>obj2</span> merely zero-initialized<a class='hidden_link' href='#static-3.sentence-2'>.</a></div> <div id='static-3.sentence-3' class='sentence'>For example,
<pre class='codeblock'>
inline double fd() { return 1.0; }
extern double d1;
double d2 = d1;     <span class='comment'>// unspecified:
</span>                    <span class='comment'>// may be statically initialized to <span class='tcode_in_codeblock'>0.0</span> or
</span>                    <span class='comment'>// dynamically initialized to <span class='tcode_in_codeblock'>0.0</span> if <span class='tcode_in_codeblock'>d1</span> is
</span>                    <span class='comment'>// dynamically initialized, or <span class='tcode_in_codeblock'>1.0</span> otherwise
</span>double d1 = fd();   <span class='comment'>// may be initialized statically or dynamically to <span class='tcode_in_codeblock'>1.0</span>
</span></pre></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='dynamic' class='section'><h4 ><a class='secnum' href='#dynamic' style='min-width:118pt'>6.8.3.3</a> Dynamic initialization of non-local variables <a class='abbr_ref' href='basic.start.dynamic'>[basic.start.dynamic]</a></h4><div class='para' id='dynamic-1'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5272'>#</a></div><div id='dynamic-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':initialization,dynamic_non-local'></a></span><span class='indexparent'><a class='index' id=':start,program'></a></span><span class='indexparent'><a class='index' id=':initialization,order_of'></a></span>Dynamic initialization of a non-local variable with static storage duration is
unordered if the variable is an implicitly or explicitly instantiated
specialization, is partially-ordered if the variable
is an inline variable that is not an implicitly or explicitly instantiated
specialization, and otherwise is ordered<a class='hidden_link' href='#dynamic-1.sentence-1'>.</a></div> <div id='dynamic-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#dynamic-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic-1.sentence-2' class='sentence'>An explicitly specialized non-inline static data member or
variable template specialization has ordered initialization<a class='hidden_link' href='#dynamic-1.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='dynamic-2'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5284'>#</a></div><div id='dynamic-2.sentence-1' class='sentence'>Dynamic initialization of non-local variables <span class='texttt'>V</span> and <span class='texttt'>W</span>
with static storage duration are ordered as follows:
<ul class='itemize'><li id='dynamic-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic-2.1'>(2.1)</a></div><div id='dynamic-2.1.sentence-1' class='sentence'>If <span class='texttt'>V</span> and <span class='texttt'>W</span> have
ordered initialization and <span class='texttt'>V</span> is defined before <span class='texttt'>W</span> within
a single translation unit, the initialization of <span class='texttt'>V</span> is sequenced
before the initialization of <span class='texttt'>W</span><a class='hidden_link' href='#dynamic-2.1.sentence-1'>.</a></div></li><li id='dynamic-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic-2.2'>(2.2)</a></div><div id='dynamic-2.2.sentence-1' class='sentence'>If <span class='texttt'>V</span> has partially-ordered initialization, <span class='texttt'>W</span> does not have
unordered initialization, and <span class='texttt'>V</span> is defined before <span class='texttt'>W</span> in
every translation unit in which <span class='texttt'>W</span> is defined, then
<ul class='itemize'><li id='dynamic-2.2.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#dynamic-2.2.1'>(2.2.1)</a></div><div id='dynamic-2.2.1.sentence-1' class='sentence'>if the program starts a thread (<a href='intro.multithread'>[intro.multithread]</a>)
other than the main thread (<a href='basic.start.main'>[basic.start.main]</a>),
the initialization of <span class='texttt'>V</span>
strongly happens before
the initialization of <span class='texttt'>W</span>;</div></li><li id='dynamic-2.2.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#dynamic-2.2.2'>(2.2.2)</a></div><div id='dynamic-2.2.2.sentence-1' class='sentence'>otherwise,
the initialization of <span class='texttt'>V</span>
is sequenced before
the initialization of <span class='texttt'>W</span><a class='hidden_link' href='#dynamic-2.2.2.sentence-1'>.</a></div></li></ul></div></li><li id='dynamic-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic-2.3'>(2.3)</a></div><div id='dynamic-2.3.sentence-1' class='sentence'>Otherwise, if the program starts a thread
other than the main thread
before either <span class='texttt'>V</span> or <span class='texttt'>W</span> is initialized,
it is unspecified in which threads
the initializations of <span class='texttt'>V</span> and <span class='texttt'>W</span> occur;
the initializations are unsequenced if they occur in the same thread<a class='hidden_link' href='#dynamic-2.3.sentence-1'>.</a></div></li><li id='dynamic-2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic-2.4'>(2.4)</a></div><div id='dynamic-2.4.sentence-1' class='sentence'>Otherwise, the initializations of <span class='texttt'>V</span> and <span class='texttt'>W</span> are indeterminately sequenced<a class='hidden_link' href='#dynamic-2.4.sentence-1'>.</a></div></li></ul></div> <div id='dynamic-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#dynamic-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic-2.sentence-2' class='sentence'>This definition permits initialization of a sequence of
ordered variables concurrently with another sequence<a class='hidden_link' href='#dynamic-2.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='dynamic-3'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5328'>#</a></div><div id='dynamic-3.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:odr-use,non-initialization' id='def:odr-use,non-initialization'><i >non-initialization odr-use</i></a>
is an odr-use (<a href='basic.def.odr'>[basic.def.odr]</a>) not caused directly or indirectly by
the initialization of a non-local static or thread storage duration variable<a class='hidden_link' href='#dynamic-3.sentence-1'>.</a></div></div><div class='para' id='dynamic-4'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5334'>#</a></div><div id='dynamic-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':evaluation,unspecified_order_of'></a></span>It is <span class='indexparent'><a class='index' id=':dynamic_initialization_of_static_variables_before_main'></a></span>implementation-defined
whether the dynamic initialization of a
non-local non-inline variable with static storage duration
is sequenced before the first statement of <span class='texttt'>main</span> or is deferred<a class='hidden_link' href='#dynamic-4.sentence-1'>.</a></div> <div id='dynamic-4.sentence-2' class='sentence'>If it is deferred, it strongly happens before
any non-initialization odr-use
of any non-inline function or non-inline variable
defined in the same translation unit as the variable to be initialized<a class='hidden_link' href='#dynamic-4.sentence-2'>.</a><a class='footnotenum' href='#footnote-55'>55</a></div> <div id='dynamic-4.sentence-3' class='sentence'>
It is <span class='indexparent'><a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed'></a></span>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#dynamic-4.sentence-3'>.</a></div> <div id='dynamic-4.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#dynamic-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic-4.sentence-4' class='sentence'>Such points should be chosen in a way that allows the programmer to avoid deadlocks<a class='hidden_link' href='#dynamic-4.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div>  <div id='dynamic-4.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#dynamic-4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='comment'>// - File 1 -
</span>#include "a.h"
#include "b.h"
B b;
A::A(){
  b.Use();
}

<span class='comment'>// - File 2 -
</span>#include "a.h"
A a;

<span class='comment'>// - File 3 -
</span>#include "a.h"
#include "b.h"
extern A a;
extern B b;

int main() {
  a.Use();
  b.Use();
}</pre><div id='dynamic-4.sentence-5' class='sentence'>It is <span class='indexparent'><a class='index' id=':dynamic_initialization_of_static_variables_before_main_'></a></span>implementation-defined
whether either <span class='texttt'>a</span> or <span class='texttt'>b</span> is
initialized before <span class='texttt'>main</span> is entered or whether the
initializations are delayed until <span class='texttt'>a</span> is first odr-used in
<span class='texttt'>main</span><a class='hidden_link' href='#dynamic-4.sentence-5'>.</a></div> <div id='dynamic-4.sentence-6' class='sentence'>In particular, if <span class='texttt'>a</span> is initialized before
<span class='texttt'>main</span> is entered, it is not guaranteed that <span class='texttt'>b</span> will be
initialized before it is odr-used by the initialization of <span class='texttt'>a</span>, that
is, before <span class='texttt'>A&#x200b;::&#x200b;A</span> is called<a class='hidden_link' href='#dynamic-4.sentence-6'>.</a></div> <div id='dynamic-4.sentence-7' class='sentence'>If, however, <span class='texttt'>a</span> is initialized
at some point after the first statement of <span class='texttt'>main</span>, <span class='texttt'>b</span> will
be initialized prior to its use in <span class='texttt'>A&#x200b;::&#x200b;A</span><a class='hidden_link' href='#dynamic-4.sentence-7'>.</a></div> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='dynamic-5'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5390'>#</a></div><div id='dynamic-5.sentence-1' class='sentence'>It is <span class='indexparent'><a class='index' id=':dynamic_initialization_of_static_inline_variables_before_main'></a></span>implementation-defined
whether the dynamic initialization of a
non-local inline variable with static storage duration
is sequenced before the first statement of <span class='texttt'>main</span> or is deferred<a class='hidden_link' href='#dynamic-5.sentence-1'>.</a></div> <div id='dynamic-5.sentence-2' class='sentence'>If it is deferred, it strongly happens before
any non-initialization odr-use
of that variable<a class='hidden_link' href='#dynamic-5.sentence-2'>.</a></div> <div id='dynamic-5.sentence-3' class='sentence'>It is <span class='indexparent'><a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed_'></a></span>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#dynamic-5.sentence-3'>.</a></div></div><div class='para' id='dynamic-6'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5401'>#</a></div><div id='dynamic-6.sentence-1' class='sentence'>It is <span class='indexparent'><a class='index' id=':dynamic_initialization_of_thread-local_variables_before_entry'></a></span>implementation-defined
whether the dynamic initialization of a
non-local non-inline variable with thread storage duration
is sequenced before the first statement of the initial function of a thread or is deferred<a class='hidden_link' href='#dynamic-6.sentence-1'>.</a></div> <div id='dynamic-6.sentence-2' class='sentence'>If it is deferred,
the initialization associated with the entity for thread <span class='textit'>t</span>
is sequenced before the first non-initialization odr-use by <span class='textit'>t</span>
of any non-inline variable with thread storage duration
defined in the same translation unit as the variable to be initialized<a class='hidden_link' href='#dynamic-6.sentence-2'>.</a></div> <div id='dynamic-6.sentence-3' class='sentence'>It is <span class='indexparent'><a class='index' id=':threads_and_program_points_at_which_deferred_dynamic_initialization_is_performed__'></a></span>implementation-defined
in which threads and at which points in the program such deferred dynamic initialization occurs<a class='hidden_link' href='#dynamic-6.sentence-3'>.</a></div></div><div class='para' id='dynamic-7'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5414'>#</a></div><div id='dynamic-7.sentence-1' class='sentence'>If the initialization of a non-local variable with static or thread storage duration
exits via
an exception, <span class='texttt'>std&#x200b;::&#x200b;terminate</span> is called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#dynamic-7.sentence-1'>.</a></div> </div><div class='footnote' id='footnote-55'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-55'>55)</a></div><div id='footnote-55.sentence-1' class='sentence'>A non-local variable with static storage duration
having initialization
with side effects is initialized in this case,
even if it is not itself odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>, <a href='basic.stc.static'>[basic.stc.static]</a>)<a class='hidden_link' href='#footnote-55.sentence-1'>.</a></div></div></div><div id='term' class='section'><h4 ><a class='secnum' href='#term' style='min-width:118pt'>6.8.3.4</a> Termination <a class='abbr_ref' href='basic.start.term'>[basic.start.term]</a></h4><div class='para' id='term-1'><div class='marginalizedparent'><a class='marginalized' href='#term-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5422'>#</a></div><div id='term-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':program,termination'></a></span><span class='indexparent'><a class='index' id=':object,destructor_static'></a></span><span class='indexparent'><a class='index' id=':main_function,return_from_'></a></span>Destructors (<a href='class.dtor'>[class.dtor]</a>) for initialized objects
(that is, objects whose lifetime (<a href='basic.life'>[basic.life]</a>) has begun)
with static storage duration,
and functions registered with <span class='texttt'>std&#x200b;::&#x200b;atexit</span>,
are called as part of a call to
<span class='indexparent'><a class='index' id=':exit_'></a></span><span class='indexparent'><a class='index' id='lib:exit_'></a></span><span class='texttt'>std&#x200b;::&#x200b;exit</span> (<a href='support.start.term'>[support.start.term]</a>)<a class='hidden_link' href='#term-1.sentence-1'>.</a></div> <div id='term-1.sentence-2' class='sentence'>The call to <span class='texttt'>std&#x200b;::&#x200b;exit</span> is sequenced before
the invocations of the destructors and the registered functions<a class='hidden_link' href='#term-1.sentence-2'>.</a></div> <div id='term-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#term-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='term-1.sentence-3' class='sentence'>Returning from <span class='texttt'>main</span> invokes <span class='texttt'>std&#x200b;::&#x200b;exit</span> (<a href='basic.start.main'>[basic.start.main]</a>)<a class='hidden_link' href='#term-1.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='term-2'><div class='marginalizedparent'><a class='marginalized' href='#term-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5440'>#</a></div><div id='term-2.sentence-1' class='sentence'>Destructors for initialized objects with thread storage duration within a given thread
are called as a result of returning from the initial function of that thread and as a
result of that thread calling <span class='texttt'>std&#x200b;::&#x200b;exit</span><a class='hidden_link' href='#term-2.sentence-1'>.</a></div> <div id='term-2.sentence-2' class='sentence'>The completions of the destructors for all initialized objects with thread storage
duration within that thread strongly happen before the initiation of the destructors of
any object with static storage duration<a class='hidden_link' href='#term-2.sentence-2'>.</a></div></div><div class='para' id='term-3'><div class='marginalizedparent'><a class='marginalized' href='#term-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5448'>#</a></div><div id='term-3.sentence-1' class='sentence'>If the completion of the constructor or dynamic initialization of an object with static
storage duration strongly happens before that of another, the completion of the destructor
of the second is sequenced before the initiation of the destructor of the first<a class='hidden_link' href='#term-3.sentence-1'>.</a></div> <div id='term-3.sentence-2' class='sentence'>If the completion of the constructor or dynamic initialization of an object with thread
storage duration is sequenced before that of another, the completion of the destructor
of the second is sequenced before the initiation of the destructor of the first<a class='hidden_link' href='#term-3.sentence-2'>.</a></div> <div id='term-3.sentence-3' class='sentence'>If an object is
initialized statically, the object is destroyed in the same order as if
the object was dynamically initialized<a class='hidden_link' href='#term-3.sentence-3'>.</a></div> <div id='term-3.sentence-4' class='sentence'>For an object of array or class
type, all subobjects of that object are destroyed before any block-scope
object with static storage duration initialized during the construction
of the subobjects is destroyed<a class='hidden_link' href='#term-3.sentence-4'>.</a></div> <div id='term-3.sentence-5' class='sentence'>If the destruction of an object with static or thread storage duration
exits via an exception,
<span class='texttt'>std&#x200b;::&#x200b;terminate</span> is called (<a href='except.terminate'>[except.terminate]</a>)<a class='hidden_link' href='#term-3.sentence-5'>.</a></div></div><div class='para' id='term-4'><div class='marginalizedparent'><a class='marginalized' href='#term-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5465'>#</a></div><div id='term-4.sentence-1' class='sentence'>If a function contains a block-scope object of static or thread storage duration that has been
destroyed and the function is called during the destruction of an object with static or
thread storage duration, the program has undefined behavior if the flow of control
passes through the definition of the previously destroyed block-scope object<a class='hidden_link' href='#term-4.sentence-1'>.</a></div> <div id='term-4.sentence-2' class='sentence'>Likewise, the
behavior is undefined if the block-scope object is used indirectly (i.e., through a
pointer) after its destruction<a class='hidden_link' href='#term-4.sentence-2'>.</a></div></div><div class='para' id='term-5'><div class='marginalizedparent'><a class='marginalized' href='#term-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5473'>#</a></div><div id='term-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':atexit'></a></span><span class='indexparent'><a class='index' id='lib:atexit'></a></span>If the completion of the initialization of an object with static storage
duration strongly happens before a call to <span class='texttt'>std&#x200b;::&#x200b;atexit</span> (see
<span class='texttt'>&lt;cstdlib&gt;</span>, <a href='support.start.term'>[support.start.term]</a>), the call to the function passed to
<span class='texttt'>std&#x200b;::&#x200b;atexit</span> is sequenced before the call to the destructor for the object<a class='hidden_link' href='#term-5.sentence-1'>.</a></div> <div id='term-5.sentence-2' class='sentence'>If a
call to <span class='texttt'>std&#x200b;::&#x200b;atexit</span> strongly happens before the completion of the initialization of
an object with static storage duration, the call to the destructor for the
object is sequenced before the call to the function passed to <span class='texttt'>std&#x200b;::&#x200b;atexit</span><a class='hidden_link' href='#term-5.sentence-2'>.</a></div> <div id='term-5.sentence-3' class='sentence'>If a
call to <span class='texttt'>std&#x200b;::&#x200b;atexit</span> strongly happens before another call to <span class='texttt'>std&#x200b;::&#x200b;atexit</span>, the
call to the function passed to the second <span class='texttt'>std&#x200b;::&#x200b;atexit</span> call is sequenced before
the call to the function passed to the first <span class='texttt'>std&#x200b;::&#x200b;atexit</span> call<a class='hidden_link' href='#term-5.sentence-3'>.</a></div></div><div class='para' id='term-6'><div class='marginalizedparent'><a class='marginalized' href='#term-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5487'>#</a></div><div id='term-6.sentence-1' class='sentence'>If there is a use of a standard library object or function not permitted within signal
handlers (<a href='support.runtime'>[support.runtime]</a>) that does not happen before (<a href='intro.multithread'>[intro.multithread]</a>)
completion of destruction of objects with static storage duration and execution of
<span class='texttt'>std&#x200b;::&#x200b;atexit</span> registered functions (<a href='support.start.term'>[support.start.term]</a>), the program has
undefined behavior<a class='hidden_link' href='#term-6.sentence-1'>.</a></div> <div id='term-6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#term-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='term-6.sentence-2' class='sentence'>If there is a use of an object with static storage
duration that does not happen before the object's destruction, the program has undefined
behavior<a class='hidden_link' href='#term-6.sentence-2'>.</a></div> <div id='term-6.sentence-3' class='sentence'>Terminating every thread before a call to <span class='texttt'>std&#x200b;::&#x200b;exit</span> or the exit from
<span class='texttt'>main</span> is sufficient, but not necessary, to satisfy these requirements<a class='hidden_link' href='#term-6.sentence-3'>.</a></div> <div id='term-6.sentence-4' class='sentence'>These
requirements permit thread managers as static-storage-duration objects<a class='hidden_link' href='#term-6.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='term-7'><div class='marginalizedparent'><a class='marginalized' href='#term-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/d29bd8c6591fe74b095e5bd277f986462ba40b24/source/basic.tex#L5498'>#</a></div><div id='term-7.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':abort'></a></span><span class='indexparent'><a class='index' id='lib:abort'></a></span><span class='indexparent'><a class='index' id=':termination,program__'></a></span>Calling the function <span class='texttt'>std&#x200b;::&#x200b;abort()</span> declared in
<span class='indexparent'><a class='index' id=':<cstdlib>'></a></span><span class='indexparent'><a class='index' id=':<cstdlib>'></a></span><span class='texttt'>&lt;cstdlib&gt;</span> terminates the program without executing any destructors
and without calling
the functions passed to <span class='texttt'>std&#x200b;::&#x200b;atexit()</span> or <span class='texttt'>std&#x200b;::&#x200b;at_&shy;quick_&shy;exit()</span><a class='hidden_link' href='#term-7.sentence-1'>.</a></div> </div></div></div></body></html>