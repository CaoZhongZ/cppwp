<!DOCTYPE html><html lang='en'><head><title>[util.smartptr.shared.create]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>23</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>23.11</a> Smart pointers <a class='abbr_ref' href='smartptr#util.smartptr.shared.create'>[smartptr]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>23.11.3</a> Class template <span class='texttt'>shared_&shy;ptr</span> <a class='abbr_ref' href='util.smartptr.shared#create'>[util.smartptr.shared]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>23.11.3.6</a> <span class='texttt'>shared_&shy;ptr</span> creation <a class='abbr_ref'>[util.smartptr.shared.create]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9671'>#</a></div><div id='1.sentence-1' class='sentence'>The common requirements that apply to
all <span class='texttt'>make_&shy;shared</span> and <span class='texttt'>allocate_&shy;shared</span> overloads,
unless specified otherwise, are described below<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div class='itemdecl' id='itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:1'>ðŸ”—</a></div><code class='itemdeclcode'>template&lt;class T, ...&gt;
  shared_ptr&lt;T&gt; make_shared(<span class='textit'>args</span>);
template&lt;class T, class A, ...&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, <span class='textit'>args</span>);
</code></div><div class='itemdescr'></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9684'>#</a></div><div id='2.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>A</span> shall satisfy the <span class='texttt'>Allocator</span>
requirements (Table <a href='allocator.requirements#tab:utilities.allocator.requirements'>31</a>)<a class='hidden_link' href='#2.sentence-1'>.</a></div></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9688'>#</a></div><div id='3.sentence-1' class='sentence'><span class='textit'>Effects:</span> Allocates memory for an object of type <span class='texttt'>T</span>
(or <span class='texttt'>U[N]</span> when <span class='texttt'>T</span> is <span class='texttt'>U[]</span>,
where <span class='texttt'>N</span> is determined from <span class='textit'>args</span> as specified by the concrete overload)<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>The object is initialized from <span class='textit'>args</span> as specified by the concrete overload<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>The <span class='texttt'>allocate_&shy;shared</span> templates use a copy of <span class='texttt'>a</span>
(rebound for an unspecified <span class='texttt'>value_&shy;type</span>) to allocate memory<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.sentence-4' class='sentence'>If an exception is thrown, the functions have no effect<a class='hidden_link' href='#3.sentence-4'>.</a></div></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9697'>#</a></div><div id='4.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> instance that stores and owns the address of
the newly constructed object<a class='hidden_link' href='#4.sentence-1'>.</a></div></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9701'>#</a></div><div id='5.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>r.get() != 0 &amp;&amp; r.use_&shy;count() == 1</span>,
where <span class='texttt'>r</span> is the return value<a class='hidden_link' href='#5.sentence-1'>.</a></div></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9705'>#</a></div><div id='6.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>bad_&shy;alloc</span>, or
an exception thrown from <span class='texttt'>allocate</span> or from the initialization of the object<a class='hidden_link' href='#6.sentence-1'>.</a></div></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9709'>#</a></div><div id='7.sentence-1' class='sentence'><span class='textit'>Remarks:</span> 
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.1'>(7.1)</a></div><div id='7.1.sentence-1' class='sentence'>Implementations should perform no more than one memory allocation<a class='hidden_link' href='#7.1.sentence-1'>.</a></div> <div id='7.1.note-1' class='note'>[<span style='white-space:nowrap'>â€‰</span><a class='note_link' href='#7.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='7.1.sentence-2' class='sentence'>This provides efficiency equivalent to an intrusive smart pointer<a class='hidden_link' href='#7.1.sentence-2'>.</a></div> â€”<span style='white-space:nowrap'>â€‰</span><i>end note</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </li><li id='7.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.2'>(7.2)</a></div><div id='7.2.sentence-1' class='sentence'>When an object of an array type <span class='texttt'>U</span> is specified to have
  an initial value of <span class='texttt'>u</span> (of the same type),
  this shall be interpreted to mean that
  each array element of the object has as its initial value
  the corresponding element from <span class='texttt'>u</span><a class='hidden_link' href='#7.2.sentence-1'>.</a></div></li><li id='7.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.3'>(7.3)</a></div><div id='7.3.sentence-1' class='sentence'>When an object of an array type is specified to have
  a default initial value,
  this shall be interpreted to mean that each array element of the object
  has a default initial value<a class='hidden_link' href='#7.3.sentence-1'>.</a></div></li><li id='7.4'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.4'>(7.4)</a></div><div id='7.4.sentence-1' class='sentence'>When a (sub)object of a non-array type <span class='texttt'>U</span> is specified to have
  an initial value of <span class='texttt'>v</span>, or <span class='texttt'>U(l...)</span>,
  where <span class='texttt'>l...</span> is a list of constructor arguments,
  <span class='texttt'>make_&shy;shared</span> shall initialize this (sub)object
  via the expression <span class='texttt'>&#x200b;::&#x200b;new(pv) U(v)</span> or <span class='texttt'>&#x200b;::&#x200b;new(pv) U(l...)</span> respectively,
  where <span class='texttt'>pv</span> has type <span class='texttt'>void*</span> and points to storage
  suitable to hold an object of type <span class='texttt'>U</span><a class='hidden_link' href='#7.4.sentence-1'>.</a></div></li><li id='7.5'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.5'>(7.5)</a></div><div id='7.5.sentence-1' class='sentence'>When a (sub)object of a non-array type <span class='texttt'>U</span> is specified to have
  an initial value of <span class='texttt'>v</span>, or <span class='texttt'>U(l...)</span>,
  where <span class='texttt'>l...</span> is a list of constructor arguments,
  <span class='texttt'>allocate_&shy;shared</span> shall initialize this (sub)object
  via the expression
  <ul class='itemize'><li id='7.5.1'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#7.5.1'>(7.5.1)</a></div><div id='7.5.1.sentence-1' class='sentence'>
  <span class='texttt'>allocator_&shy;traits&lt;A2&gt;&#x200b;::&#x200b;construct(a2, pv, v)</span> or</div></li><li id='7.5.2'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#7.5.2'>(7.5.2)</a></div><div id='7.5.2.sentence-1' class='sentence'><span class='texttt'>allocator_&shy;traits&lt;A2&gt;&#x200b;::&#x200b;construct(a2, pv, l...)</span></div></li></ul>
  respectively,
  where <span class='texttt'>pv</span> points to storage
  suitable to hold an object of type <span class='texttt'>U</span> and
  <span class='texttt'>a2</span> of type <span class='texttt'>A2</span> is a rebound copy of
  the allocator <span class='texttt'>a</span> passed to <span class='texttt'>allocate_&shy;shared</span>
  such that its <span class='texttt'>value_&shy;type</span> is <span class='texttt'>remove_&shy;cv_&shy;t&lt;U&gt;</span><a class='hidden_link' href='#7.5.sentence-1'>.</a></div></li><li id='7.6'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.6'>(7.6)</a></div><div id='7.6.sentence-1' class='sentence'>When a (sub)object of non-array type <span class='texttt'>U</span> is specified to have
  a default initial value,
  <span class='texttt'>make_&shy;shared</span> shall initialize this (sub)object
  via the expression <span class='texttt'>&#x200b;::&#x200b;new(pv) U()</span>,
  where <span class='texttt'>pv</span> has type <span class='texttt'>void*</span> and points to storage
  suitable to hold an object of type <span class='texttt'>U</span><a class='hidden_link' href='#7.6.sentence-1'>.</a></div></li><li id='7.7'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.7'>(7.7)</a></div><div id='7.7.sentence-1' class='sentence'>When a (sub)object of non-array type <span class='texttt'>U</span> is specified to have
  a default initial value,
  <span class='texttt'>allocate_&shy;shared</span> shall initialize this (sub)object
  via the expression <span class='texttt'>allocator_&shy;traits&lt;A2&gt;&#x200b;::&#x200b;construct(a2, pv)</span>,
  where <span class='texttt'>pv</span> points to storage
  suitable to hold an object of type <span class='texttt'>U</span> and
  <span class='texttt'>a2</span> of type <span class='texttt'>A2</span> is a rebound copy of
  the allocator <span class='texttt'>a</span> passed to <span class='texttt'>allocate_&shy;shared</span>
  such that its <span class='texttt'>value_&shy;type</span> is <span class='texttt'>remove_&shy;cv_&shy;t&lt;U&gt;</span><a class='hidden_link' href='#7.7.sentence-1'>.</a></div></li><li id='7.8'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.8'>(7.8)</a></div><div id='7.8.sentence-1' class='sentence'>Array elements are initialized in ascending order of their addresses<a class='hidden_link' href='#7.8.sentence-1'>.</a></div></li><li id='7.9'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#7.9'>(7.9)</a></div><div id='7.9.sentence-1' class='sentence'>When the lifetime of the object managed by the return value ends, or
  when the initialization of an array element throws an exception,
  the initialized elements are destroyed in the reverse order
  of their original construction<a class='hidden_link' href='#7.9.sentence-1'>.</a></div></li></ul></div> <div id='7.note-2' class='note'>[<span style='white-space:nowrap'>â€‰</span><a class='note_link' href='#7.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='7.sentence-2' class='sentence'>These functions will typically allocate more memory than <span class='texttt'>sizeof(T)</span> to
allow for internal bookkeeping structures such as reference counts<a class='hidden_link' href='#7.sentence-2'>.</a></div> â€”<span style='white-space:nowrap'>â€‰</span><i>end note</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </div></div><div class='itemdecl' id='itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:2'>ðŸ”—</a></div><code class='itemdeclcode'>template&lt;class T, class... Args&gt;
  shared_ptr&lt;T&gt; make_shared(Args&amp;&amp;... args);                    <span class='comment'>// <span class='texttt'>T</span> is not array
</span>template&lt;class T, class A, class... Args&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, Args&amp;&amp;... args);    <span class='comment'>// <span class='texttt'>T</span> is not array
</span></code></div><div class='itemdescr'></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9791'>#</a></div><div id='8.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> to an object of type <span class='texttt'>T</span>
with an initial value <span class='texttt'>T(forward&lt;Args&gt;(args)...)</span><a class='hidden_link' href='#8.sentence-1'>.</a></div></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9795'>#</a></div><div id='9.sentence-1' class='sentence'><span class='textit'>Remarks:</span> These overloads shall only participate in overload resolution
when <span class='texttt'>T</span> is not an array type<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'>The <span class='texttt'>shared_&shy;ptr</span> constructors called by these functions
enable <span class='texttt'>shared_&shy;from_&shy;this</span>
with the address of the newly constructed object of type <span class='texttt'>T</span><a class='hidden_link' href='#9.sentence-2'>.</a></div></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9802'>#</a></div><div id='10.example-1' class='example'>[<span style='white-space:nowrap'>â€‰</span><a class='example_link' href='#10.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
shared_ptr&lt;int&gt; p = make_shared&lt;int&gt;(); <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to <span class='tcode_in_codeblock'>int()</span>
</span>shared_ptr&lt;vector&lt;int&gt;&gt; q = make_shared&lt;vector&lt;int&gt;&gt;(16, 1);
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to vector of <span class='tcode_in_codeblock'>16</span> elements with value <span class='tcode_in_codeblock'>1</span>
</span></pre> â€”<span style='white-space:nowrap'>â€‰</span><i>end example</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </div></div><div class='itemdecl' id='itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:3'>ðŸ”—</a></div><code class='itemdeclcode'>template&lt;class T&gt; shared_ptr&lt;T&gt;
  make_shared(size_t N);                                        <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[]</span>
</span>template&lt;class T, class A&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, size_t N);          <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[]</span>
</span></code></div><div class='itemdescr'></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9820'>#</a></div><div id='11.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> to an object of type <span class='texttt'>U[N]</span>
with a default initial value,
where <span class='texttt'>U</span> is <span class='texttt'>remove_&shy;extent_&shy;t&lt;T&gt;</span><a class='hidden_link' href='#11.sentence-1'>.</a></div></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9825'>#</a></div><div id='12.sentence-1' class='sentence'><span class='textit'>Remarks:</span> These overloads shall only participate in overload resolution
when <span class='texttt'>T</span> is of the form <span class='texttt'>U[]</span><a class='hidden_link' href='#12.sentence-1'>.</a></div></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9829'>#</a></div><div id='13.example-1' class='example'>[<span style='white-space:nowrap'>â€‰</span><a class='example_link' href='#13.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
shared_ptr&lt;double[]&gt; p = make_shared&lt;double[]&gt;(1024);
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a value-initialized <span class='tcode_in_codeblock'>double[1024]</span>
</span>shared_ptr&lt;double[][2][2]&gt; q = make_shared&lt;double[][2][2]&gt;(6);
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a value-initialized <span class='tcode_in_codeblock'>double[6][2][2]</span>
</span></pre> â€”<span style='white-space:nowrap'>â€‰</span><i>end example</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:make_shared'></a></span><span class='indexparent'><a class='index' id='lib:allocate_shared'></a></span><div class='itemdecl' id='itemdecl:4'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:4'>ðŸ”—</a></div><code class='itemdeclcode'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; make_shared();                                  <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>
</span>template&lt;class T, class A&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a);                    <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>
</span></code></div><div class='itemdescr'></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9850'>#</a></div><div id='14.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> to an object of type <span class='texttt'>T</span>
with a default initial value<a class='hidden_link' href='#14.sentence-1'>.</a></div></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9854'>#</a></div><div id='15.sentence-1' class='sentence'><span class='textit'>Remarks:</span> These overloads shall only participate in overload resolution
when <span class='texttt'>T</span> is of the form <span class='texttt'>U[N]</span><a class='hidden_link' href='#15.sentence-1'>.</a></div></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9858'>#</a></div><div id='16.example-1' class='example'>[<span style='white-space:nowrap'>â€‰</span><a class='example_link' href='#16.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
shared_ptr&lt;double[1024]&gt; p = make_shared&lt;double[1024]&gt;();
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a value-initialized <span class='tcode_in_codeblock'>double[1024]</span>
</span>shared_ptr&lt;double[6][2][2]&gt; q = make_shared&lt;double[6][2][2]&gt;();
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a value-initialized <span class='tcode_in_codeblock'>double[6][2][2]</span>
</span></pre> â€”<span style='white-space:nowrap'>â€‰</span><i>end example</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:make_shared_'></a></span><span class='indexparent'><a class='index' id='lib:allocate_shared_'></a></span><div class='itemdecl' id='itemdecl:5'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:5'>ðŸ”—</a></div><code class='itemdeclcode'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; make_shared(size_t N,
                            const remove_extent_t&lt;T&gt;&amp; u);       <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[]</span>
</span>template&lt;class T, class A&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, size_t N,
                                const remove_extent_t&lt;T&gt;&amp; u);   <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[]</span>
</span></code></div><div class='itemdescr'></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9881'>#</a></div><div id='17.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> to an object of type <span class='texttt'>U[N]</span>,
where <span class='texttt'>U</span> is <span class='texttt'>remove_&shy;extent_&shy;t&lt;T&gt;</span> and
each array element has an initial value of <span class='texttt'>u</span><a class='hidden_link' href='#17.sentence-1'>.</a></div></div></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9886'>#</a></div><div id='18.sentence-1' class='sentence'><span class='textit'>Remarks:</span> These overloads shall only participate in overload resolution
when <span class='texttt'>T</span> is of the form <span class='texttt'>U[]</span><a class='hidden_link' href='#18.sentence-1'>.</a></div></div></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9890'>#</a></div><div id='19.example-1' class='example'>[<span style='white-space:nowrap'>â€‰</span><a class='example_link' href='#19.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
shared_ptr&lt;double[]&gt; p = make_shared&lt;double[]&gt;(1024, 1.0);
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a <span class='tcode_in_codeblock'>double[1024]</span>, where each element is <span class='tcode_in_codeblock'>1.0</span>
</span>shared_ptr&lt;double[][2]&gt; q = make_shared&lt;double[][2]&gt;(6, {1.0, 0.0});
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a <span class='tcode_in_codeblock'>double[6][2]</span>, where each <span class='tcode_in_codeblock'>double[2]</span> element is <span class='tcode_in_codeblock'>{1.0, 0.0}</span>
</span>shared_ptr&lt;vector&lt;int&gt;[]&gt; r = make_shared&lt;vector&lt;int&gt;[]&gt;(4, {1, 2});
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a <span class='tcode_in_codeblock'>vector&lt;int&gt;[4]</span>, where each vector has contents <span class='tcode_in_codeblock'>{1, 2}</span>
</span></pre> â€”<span style='white-space:nowrap'>â€‰</span><i>end example</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:make_shared__'></a></span><span class='indexparent'><a class='index' id='lib:allocate_shared__'></a></span><div class='itemdecl' id='itemdecl:6'><div class='marginalizedparent'><a class='itemDeclLink' href='#itemdecl:6'>ðŸ”—</a></div><code class='itemdeclcode'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; make_shared(const remove_extent_t&lt;T&gt;&amp; u);       <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>
</span>template&lt;class T, class A&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a,
                                const remove_extent_t&lt;T&gt;&amp; u);   <span class='comment'>// <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>
</span></code></div><div class='itemdescr'></div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9914'>#</a></div><div id='20.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> to an object of type <span class='texttt'>T</span>,
where each array element of type <span class='texttt'>remove_&shy;extent_&shy;t&lt;T&gt;</span>
has an initial value of <span class='texttt'>u</span><a class='hidden_link' href='#20.sentence-1'>.</a></div></div></div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9919'>#</a></div><div id='21.sentence-1' class='sentence'><span class='textit'>Remarks:</span> These overloads shall only participate in overload resolution
when <span class='texttt'>T</span> is of the form <span class='texttt'>U[N]</span><a class='hidden_link' href='#21.sentence-1'>.</a></div></div></div><div class='para' id='22'><div class='marginalizedparent'><a class='marginalized' href='#22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/06013de0d00e66204253d2f682b4b879f7686540/source/utilities.tex#L9923'>#</a></div><div id='22.example-1' class='example'>[<span style='white-space:nowrap'>â€‰</span><a class='example_link' href='#22.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
shared_ptr&lt;double[1024]&gt; p = make_shared&lt;double[1024]&gt;(1.0);
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a <span class='tcode_in_codeblock'>double[1024]</span>, where each element is <span class='tcode_in_codeblock'>1.0</span>
</span>shared_ptr&lt;double[6][2]&gt; q = make_shared&lt;double[6][2]&gt;({1.0, 0.0});
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a <span class='tcode_in_codeblock'>double[6][2]</span>, where each double[2] element is <span class='tcode_in_codeblock'>{1.0, 0.0}</span>
</span>shared_ptr&lt;vector&lt;int&gt;[4]&gt; r = make_shared&lt;vector&lt;int&gt;[4]&gt;({1, 2});
  <span class='comment'>// <span class='tcode_in_codeblock'>shared_&shy;ptr</span> to a <span class='tcode_in_codeblock'>vector&lt;int&gt;[4]</span>, where each vector has contents <span class='tcode_in_codeblock'>{1, 2}</span>
</span></pre> â€”<span style='white-space:nowrap'>â€‰</span><i>end example</i></div><span style='white-space:nowrap'>â€‰</span>]</div> </div></div></div></body></html>