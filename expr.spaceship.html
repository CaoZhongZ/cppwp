<!DOCTYPE html><html lang='en'><head><title>[expr.spaceship]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>8</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>8.5</a> Compound expressions <a class='abbr_ref' href='expr.compound#expr.spaceship'>[expr.compound]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>8.5.8</a> Three-way comparison operator <a class='abbr_ref'>[expr.spaceship]</a></h3><span class='indexparent'><a class='index' id=':expression,three-way_comparison'></a></span><span class='indexparent'><a class='index' id=':expression,spaceship'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4859'>#</a></div><div id='1.sentence-1' class='sentence'>The three-way comparison operator groups left-to-right<a class='hidden_link' href='#1.sentence-1'>.</a></div><div id='1.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':operator,three-way_comparison'></a></span><span class='indexparent'><a class='index' id=':operator,spaceship'></a></span>
<pre class='bnf'><span class='nontermdef'><i ><a href='expr.spaceship#nt:compare-expression'>compare-expression</a></i></span>
&#9;<i ><a href='expr.shift#nt:shift-expression'>shift-expression</a></i>
&#9;<i ><a href='expr.spaceship#nt:compare-expression'>compare-expression</a></i> <span class='terminal'>&lt;=&gt;</span> <i ><a href='expr.shift#nt:shift-expression'>shift-expression</a></i>
</pre></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4872'>#</a></div><div id='2.sentence-1' class='sentence'>The expression <span class='texttt'>p &lt;=&gt; q</span> is a prvalue indicating whether
<span class='texttt'>p</span> is less than, equal to, greater than, or incomparable with
<span class='texttt'>q</span><a class='hidden_link' href='#2.sentence-1'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4877'>#</a></div><div id='3.sentence-1' class='sentence'>If one of the operands is of type <span class='texttt'>bool</span>
and the other is not, the program is ill-formed<a class='hidden_link' href='#3.sentence-1'>.</a></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4881'>#</a></div><div id='4.sentence-1' class='sentence'>If both operands have arithmetic types,
the usual arithmetic conversions (<a href='expr.arith.conv'>[expr.arith.conv]</a>) are applied to the operands<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>Then:</div><div id='4.sentence-3' class='sentence'><ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><div id='4.1.sentence-1' class='sentence'>If a narrowing conversion (<a href='dcl.init.list'>[dcl.init.list]</a>) is required,
other than from an integral type to a floating point type,
the program is ill-formed<a class='hidden_link' href='#4.1.sentence-1'>.</a></div></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><div id='4.2.sentence-1' class='sentence'>Otherwise, if the operands have integral type,
the result is of type <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering</span><a class='hidden_link' href='#4.2.sentence-1'>.</a></div> <div id='4.2.sentence-2' class='sentence'>The result is
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;equal</span>
if both operands are arithmetically equal,
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;less</span>
if the first operand is arithmetically
less than the second operand,
and
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;greater</span>
otherwise<a class='hidden_link' href='#4.2.sentence-2'>.</a></div></li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div><div id='4.3.sentence-1' class='sentence'>Otherwise, the operands have floating-point type, and
the result is of type <span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering</span><a class='hidden_link' href='#4.3.sentence-1'>.</a></div> <div id='4.3.sentence-2' class='sentence'>The expression <span class='texttt'>a &lt;=&gt; b</span> yields
<span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering&#x200b;::&#x200b;less</span>
if <span class='texttt'>a</span> is less than <span class='texttt'>b</span>,
<span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering&#x200b;::&#x200b;greater</span>
if <span class='texttt'>a</span> is greater than <span class='texttt'>b</span>,
<span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering&#x200b;::&#x200b;equivalent</span>
if <span class='texttt'>a</span> is equivalent to <span class='texttt'>b</span>,
and
<span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering&#x200b;::&#x200b;unordered</span> otherwise<a class='hidden_link' href='#4.3.sentence-2'>.</a></div></li></ul></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4918'>#</a></div><div id='5.sentence-1' class='sentence'>If both operands have the same enumeration type <span class='texttt'>E</span>,
the operator yields the result of
converting the operands to the underlying type of <span class='texttt'>E</span>
and applying <span class='texttt'>&lt;=&gt;</span> to the converted operands<a class='hidden_link' href='#5.sentence-1'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4924'>#</a></div><div id='6.sentence-1' class='sentence'>If at least one of the operands is of pointer type,
array-to-pointer conversions (<a href='conv.array'>[conv.array]</a>),
pointer conversions (<a href='conv.ptr'>[conv.ptr]</a>),
function pointer conversions (<a href='conv.fctptr'>[conv.fctptr]</a>),
and
qualification conversions (<a href='conv.qual'>[conv.qual]</a>)
are performed on both operands
to bring them to their composite pointer type (<a href='expr.type'>[expr.type]</a>)<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>If at least one of the operands is of pointer-to-member type,
pointer-to-member conversions (<a href='conv.mem'>[conv.mem]</a>)
and
qualification conversions (<a href='conv.qual'>[conv.qual]</a>)
are performed on both operands
to bring them to their composite pointer type (<a href='expr.type'>[expr.type]</a>)<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'>If both operands are null pointer constants,
but not both of integer type,
pointer conversions (<a href='conv.ptr'>[conv.ptr]</a>)
are performed on both operands
to bring them to their composite pointer type (<a href='expr.type'>[expr.type]</a>)<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.sentence-4' class='sentence'>In all cases, after the conversions, the operands shall have the same type<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='6.sentence-5' class='sentence'>If both of the operands are arrays,
array-to-pointer conversions (<a href='conv.array'>[conv.array]</a>) are not applied<a class='hidden_link' href='#6.sentence-5'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4953'>#</a></div><div id='7.sentence-1' class='sentence'>If the composite pointer type is
a function pointer type,
a pointer-to-member type, or
<span class='texttt'>std&#x200b;::&#x200b;nullptr_&shy;t</span>,
the result is of type <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality</span>;
the result is
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality&#x200b;::&#x200b;equal</span>
if the (possibly converted) operands compare equal (<a href='expr.eq'>[expr.eq]</a>)
and
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality&#x200b;::&#x200b;unequal</span>
if they compare unequal,
otherwise the result of the operator is unspecified<a class='hidden_link' href='#7.sentence-1'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4967'>#</a></div><div id='8.sentence-1' class='sentence'>If the composite pointer type is an object pointer type,
<span class='texttt'>p &lt;=&gt; q</span> is of type <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering</span><a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>If two pointer operands <span class='texttt'>p</span> and <span class='texttt'>q</span> compare equal (<a href='expr.eq'>[expr.eq]</a>),
<span class='texttt'>p &lt;=&gt; q</span> yields <span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;equal</span>;
if <span class='texttt'>p</span> and <span class='texttt'>q</span> compare unequal,
<span class='texttt'>p &lt;=&gt; q</span> yields
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;less</span>
if <span class='texttt'>q</span> compares greater than <span class='texttt'>p</span>
and
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering&#x200b;::&#x200b;greater</span>
if <span class='texttt'>p</span> compares greater than <span class='texttt'>q</span> (<a href='expr.rel'>[expr.rel]</a>)<a class='hidden_link' href='#8.sentence-2'>.</a></div> <div id='8.sentence-3' class='sentence'>Otherwise, the result is unspecified<a class='hidden_link' href='#8.sentence-3'>.</a></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4981'>#</a></div><div id='9.sentence-1' class='sentence'>Otherwise, the program is ill-formed<a class='hidden_link' href='#9.sentence-1'>.</a></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3b306cd7198c3d7657620c1f448bdef04c98dc0e/source/expressions.tex#L4984'>#</a></div><div id='10.sentence-1' class='sentence'>The five comparison category types (<a href='cmp.categories'>[cmp.categories]</a>)
(the types
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;ordering</span>,
<span class='texttt'>std&#x200b;::&#x200b;strong_&shy;equality</span>,
<span class='texttt'>std&#x200b;::&#x200b;weak_&shy;ordering</span>,
<span class='texttt'>std&#x200b;::&#x200b;weak_&shy;equality</span>, and
<span class='texttt'>std&#x200b;::&#x200b;partial_&shy;ordering</span>)
are not predefined;
if the header
<span class='indexparent'><a class='index' id=':<compare>'></a></span><span class='indexparent'><a class='index' id=':<compare>'></a></span><span class='texttt'>&lt;compare&gt;</span>
is not included prior to a use of such a class type –
even an implicit use in which the type is not named
(e.g., via the <span class='texttt'>auto</span> specifier (<a href='dcl.spec.auto'>[dcl.spec.auto]</a>)
in a defaulted three-way comparison (<a href='class.spaceship'>[class.spaceship]</a>)
or use of the built-in operator) – the program is ill-formed<a class='hidden_link' href='#10.sentence-1'>.</a></div></div></div></body></html>