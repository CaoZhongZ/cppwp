<!DOCTYPE html><html lang='en'><head><title>[expr.const.cast]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>5</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>5.2</a> Postfix expressions <a class='abbr_ref' href='expr.post#expr.const.cast'>[expr.post]</a></h2><div id='expr.const.cast'><h3 ><a class='secnum' style='min-width:103pt'>5.2.11</a> Const cast <a class='abbr_ref'>[expr.const.cast]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2535'>#</a></div><p ><span class='indexparent'><a class='index' id='expression,const_cast'></a></span><span class='indexparent'><a class='index' id='cast,const'></a></span>The result of the expression <span class='texttt'>const_cast&lt;T&gt;(v)</span> is of type
<span class='texttt'>T</span>. If <span class='texttt'>T</span> is an lvalue reference to object type, the result is an
lvalue;
if <span class='texttt'>T</span> is an rvalue reference to object type, the result is an xvalue;
otherwise, the result is a prvalue and the
lvalue-to-rvalue (<a href='conv.lval'>[conv.lval]</a>), array-to-pointer (<a href='conv.array'>[conv.array]</a>),
and function-to-pointer (<a href='conv.func'>[conv.func]</a>) standard conversions are
performed on the expression <span class='texttt'>v</span>. Conversions that can be performed explicitly using
<span class='texttt'>const_cast</span> are listed below. No other conversion shall be
performed explicitly using <span class='texttt'>const_cast</span>.</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2549'>#</a></div><p >[ <i>Note:</i>
Subject to the restrictions in this section, an expression may be cast
to its own type using a <span class='texttt'>const_cast</span> operator.
<i> — end note</i> ]</p></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2555'>#</a></div><p >For two similar types <span class='texttt'>T1</span> and <span class='texttt'>T2</span> (<a href='conv.qual'>[conv.qual]</a>),
a prvalue of type <span class='texttt'>T1</span> may be explicitly
converted to the type <span class='texttt'>T2</span> using a <span class='texttt'>const_cast</span>. The result
of a <span class='texttt'>const_cast</span> refers to the original entity.
[ <i>Example:</i>
</p><pre class='codeblock'>
typedef int *A[3];               <span class='comment'>// array of 3 pointer to <span class='texttt'>int</span>
</span>typedef const int *const CA[3];  <span class='comment'>// array of 3 const pointer to <span class='texttt'>const int</span>
</span>
CA &amp;&amp;r = A{}; <span class='comment'>// OK, reference binds to temporary array object after qualification conversion to type <span class='texttt'>CA</span>
</span>A &amp;&amp;r1 = const_cast&lt;A&gt;(CA{});    <span class='comment'>// error: temporary array decayed to pointer
</span>A &amp;&amp;r2 = const_cast&lt;A&amp;&amp;&gt;(CA{});  <span class='comment'>// OK
</span></pre><p ><i> — end example</i> ]</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2571'>#</a></div><p >For two object types <span class='texttt'>T1</span> and <span class='texttt'>T2</span>, if a pointer to <span class='texttt'>T1</span> can
be explicitly converted to the type “pointer to <span class='texttt'>T2</span>” using a
<span class='texttt'>const_cast</span>, then the following conversions can also be made:</p><ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div><p >an lvalue of type <span class='texttt'>T1</span> can be explicitly converted to an lvalue
of type <span class='texttt'>T2</span> using the cast <span class='texttt'>const_cast&lt;T2&amp;&gt;</span>;</p></li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div><p >a glvalue of type <span class='texttt'>T1</span> can be explicitly converted to an xvalue
of type <span class='texttt'>T2</span> using the cast <span class='texttt'>const_cast&lt;T2&amp;&amp;&gt;</span>; and</p></li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div><p >if <span class='texttt'>T1</span> is a class type, a prvalue of type <span class='texttt'>T1</span> can be
explicitly converted to an xvalue of type <span class='texttt'>T2</span> using the cast
<span class='texttt'>const_cast&lt;T2&amp;&amp;&gt;</span>.
</p></li></ul><p >The result of a reference <span class='texttt'>const_cast</span> refers
to the original object if the operand is a glvalue and
to the result of applying the temporary materialization conversion (<a href='conv.rval'>[conv.rval]</a>) otherwise.</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2592'>#</a></div><p >A null pointer value (<a href='conv.ptr'>[conv.ptr]</a>) is converted to the null pointer
value of the destination type. The null member pointer
value (<a href='conv.mem'>[conv.mem]</a>) is converted to the null member pointer value of
the destination type.</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2598'>#</a></div><p >[ <i>Note:</i>
Depending on the type of the object, a write operation through the
pointer, lvalue or pointer to data member resulting from a
<span class='texttt'>const_cast</span> that casts away a const-qualifier<a class='footnotenum' href='#footnote-76'>76</a>
may produce undefined behavior (<a href='dcl.type.cv'>[dcl.type.cv]</a>).
<i> — end note</i> ]</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2608'>#</a></div><p ><span class='indexparent'><a class='index' id='const,cast_away'></a></span>A conversion from a type <span class='texttt'>T1</span> to a type <span class='texttt'>T2</span>
<a class='hidden_link' href='#def:casting_away_constness' id='def:casting_away_constness'><i>casts away constness</i></a>
if <span class='texttt'>T1</span> and <span class='texttt'>T2</span> are different,
there is a cv-decomposition (<a href='conv.qual'>[conv.qual]</a>) of <span class='texttt'>T1</span>
yielding <i>n</i> such that
<span class='texttt'>T2</span> has a cv-decomposition of the form</p><p ><div class='indented'>
<span class='math'><span class='mathalpha'>cv</span><sub >0</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>P</span><sub >0</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>cv</span><sub >1</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>P</span><sub >1</sub><sup >2</sup></span> <span class='math'>⋯</span> <span class='math'><span class='mathalpha'>cv</span><sub ><span class='mathalpha'>n</span>-1</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>P</span><sub ><span class='mathalpha'>n</span>-1</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>cv</span><sub ><span class='mathalpha'>n</span></sub><sup >2</sup></span> <span class='math'><span class='mathtt'>U</span><sub >2</sub></span>,
</div></p><p >and there is no qualification conversion that converts <span class='texttt'>T1</span> to</p><p ><div class='indented'>
<span class='math'><span class='mathalpha'>cv</span><sub >0</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>P</span><sub >0</sub><sup >1</sup></span> <span class='math'><span class='mathalpha'>cv</span><sub >1</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>P</span><sub >1</sub><sup >1</sup></span> <span class='math'>⋯</span> <span class='math'><span class='mathalpha'>cv</span><sub ><span class='mathalpha'>n</span>-1</sub><sup >2</sup></span> <span class='math'><span class='mathalpha'>P</span><sub ><span class='mathalpha'>n</span>-1</sub><sup >1</sup></span> <span class='math'><span class='mathalpha'>cv</span><sub ><span class='mathalpha'>n</span></sub><sup >2</sup></span> <span class='math'><span class='mathtt'>U</span><sub >1</sub></span>.
</div></p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2627'>#</a></div><p >Casting from an lvalue of type <span class='texttt'>T1</span> to an lvalue of type
<span class='texttt'>T2</span> using an lvalue reference cast
or casting from an expression of type <span class='texttt'>T1</span> to an xvalue of type <span class='texttt'>T2</span> using
an rvalue reference cast
casts away constness if a cast from a prvalue of type “pointer to <span class='texttt'>T1</span>” to the type “pointer to
<span class='texttt'>T2</span>” casts away constness.</p></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/expressions.tex#L2635'>#</a></div><p >[ <i>Note:</i>
Some conversions which involve only changes in cv-qualification cannot
be done using <span class='texttt'>const_cast.</span> For instance, conversions between
pointers to functions are not covered because such conversions lead to
values whose use causes undefined behavior. For the same reasons,
conversions between pointers to member functions, and in particular, the
conversion from a pointer to a const member function to a pointer to a
non-const member function, are not covered.
<i> — end note</i> ]<span class='indexparent'><a class='index' id='expression,postfix'></a></span></p></div><div class='footnote' id='footnote-76'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-76'>76)</a></div><p ><span class='texttt'>const_cast</span>
is not limited to conversions that cast away a
const-qualifier.</p></div></div></div></body></html>