<!DOCTYPE html><html lang='en'><head><title>[dcl.align]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>7</a> Declarations <a class='abbr_ref' href='./#dcl.dcl'>[dcl.dcl]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>7.6</a> Attributes <a class='abbr_ref' href='dcl.attr#dcl.align'>[dcl.attr]</a></h2><div id='dcl.align'><h3 ><a class='secnum' style='min-width:103pt'>7.6.2</a> Alignment specifier <a class='abbr_ref'>[dcl.align]</a></h3><p ><span class='indexparent'><a class='index' id='attribute,alignment'></a></span></p><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><p >An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>
may be applied to a variable
or to a class data member, but it shall not be applied to a bit-field, a function
parameter, or an <i ><a href='except#nt:exception-declaration'>exception-declaration</a></i> (<a href='except.handle'>[except.handle]</a>).
An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> may also be applied to the declaration or
definition of a class (in an
<i ><a href='dcl.type.elab#nt:elaborated-type-specifier'>elaborated-type-specifier</a></i> (<a href='dcl.type.elab'>[dcl.type.elab]</a>) or
<i ><a href='class#nt:class-head'>class-head</a></i> (Clause <a href='class'>[class]</a>), respectively) and to the
declaration or definition of an enumeration (in an
<i ><a href='dcl.enum#nt:opaque-enum-declaration'>opaque-enum-declaration</a></i> or <i ><a href='dcl.enum#nt:enum-head'>enum-head</a></i>,
respectively (<a href='dcl.enum'>[dcl.enum]</a>)).
An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> with an ellipsis is a pack expansion (<a href='temp.variadic'>[temp.variadic]</a>).</p></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><p >When the <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> is of the form
<span class='texttt'>alignas(</span> <i ><a href='expr.const#nt:constant-expression'>constant-expression</a></i> <span class='texttt'>)</span>:</p><ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div><p >the <i ><a href='expr.const#nt:constant-expression'>constant-expression</a></i> shall be an integral constant expression</p></li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div><p >if the constant expression does not evaluate to an alignment
value (<a href='basic.align'>[basic.align]</a>), or evaluates to an extended alignment and
the implementation does not support that alignment in the context of the
declaration, the program is ill-formed.
</p></li></ul></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><p >An <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i> of the form
<span class='texttt'>alignas(</span> <i ><a href='dcl.name#nt:type-id'>type-id</a></i> <span class='texttt'>)</span> has the same
effect as <span class='texttt'>alignas(<span class='discretionary'></span>alignof(</span> <i ><a href='dcl.name#nt:type-id'>type-id</a></i> <span class='texttt'>))</span> (<a href='expr.alignof'>[expr.alignof]</a>).</p></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><p >The alignment requirement of an entity is the strictest non-zero alignment
specified by its <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifiers</a></i>, if any;
otherwise, the <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifiers</a></i> have no effect.</p></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><p >The combined effect of all <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifiers</a></i> in a declaration shall not
specify an alignment that is less strict than the alignment that would
be required for the entity being declared if all <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifiers</a></i>
appertaining to that entity
were omitted.
[&nbsp;<i>Example:</i><span class='space'></span>
</p><pre class='codeblock'>
struct alignas(8) S {};
struct alignas(1) U {
  S s;
};   <span class='comment'>// Error: <span class='texttt'>U</span> specifies an alignment that is less strict than
</span>     <span class='comment'>// if the <span class='texttt'>alignas(1)</span> were omitted.
</span></pre><p ><i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><p >If the defining declaration of an entity has an
<i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>, any non-defining
declaration of that entity shall either specify equivalent alignment or have no
<i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>.
Conversely, if any declaration of an entity has an
<i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifier</a></i>,
every defining
declaration of that entity shall specify an equivalent alignment.
No diagnostic is required if declarations of an entity have
different <i ><a href='dcl.attr.grammar#nt:alignment-specifier'>alignment-specifiers</a></i>
in different translation units.</p><p >[&nbsp;<i>Example:</i><span class='space'></span>
</p><pre class='codeblock'>
<span class='comment'>// Translation unit #1:
</span>struct S { int x; } s, *p = &amp;s;

<span class='comment'>// Translation unit #2:
</span>struct alignas(16) S;           <span class='comment'>// error: definition of <span class='texttt'>S</span> lacks alignment; no
</span>extern S* p;                    <span class='comment'>// diagnostic required
</span></pre><p ><i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><p >[&nbsp;<i>Example:</i><span class='space'></span> An aligned buffer with an alignment requirement
of <span class='texttt'>A</span> and holding <span class='texttt'>N</span> elements of type <span class='texttt'>T</span>
can be declared as:</p><pre class='codeblock'>
alignas(T) alignas(A) T buffer[N];
</pre><p >Specifying <span class='texttt'>alignas(T)</span> ensures
that the final requested alignment will not be weaker than <span class='texttt'>alignof(T)</span>,
and therefore the program will not be ill-formed.
<i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><p >[&nbsp;<i>Example:</i><span class='space'></span>
</p><pre class='codeblock'>
alignas(double) void f();                         <span class='comment'>// error: alignment applied to function
</span>alignas(double) unsigned char c[sizeof(double)];  <span class='comment'>// array of characters, suitably aligned for a <span class='texttt'>double</span>
</span>extern unsigned char c[sizeof(double)];           <span class='comment'>// no <span class='texttt'>alignas</span> necessary
</span>alignas(float)
  extern unsigned char c[sizeof(double)];         <span class='comment'>// error: different alignment in declaration
</span></pre><p ><i>&nbsp;—&nbsp;end example</i>&nbsp;]</p></div></div></div></body></html>