<!DOCTYPE html><html lang='en'><head><title>[unique.ptr.single.ctor]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>20</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>20.11</a> Smart pointers <a class='abbr_ref' href='smartptr#unique.ptr.single.ctor'>[smartptr]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>20.11.1</a> Class template <span class='texttt'>unique_ptr</span> <a class='abbr_ref' href='unique.ptr#single.ctor'>[unique.ptr]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>20.11.1.2</a> <span class='texttt'>unique_ptr</span> for single objects <a class='abbr_ref' href='unique.ptr.single#ctor'>[unique.ptr.single]</a></h4><div id='unique.ptr.single.ctor'><h4 ><a class='secnum' style='min-width:133pt'>20.11.1.2.1</a> <span class='texttt'>unique_ptr</span> constructors <a class='abbr_ref'>[unique.ptr.single.ctor]</a></h4><p ><span class='indexparent'><a class='index' id='unique_ptr,constructor'></a></span><code class='itemdecl'>
constexpr unique_ptr() noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8433'>#</a></div><p ><i>Requires:</i> <span class='texttt'>D</span> shall
satisfy the requirements of <span class='texttt'>DefaultConstructible</span> (Table <a href='utility.arg.requirements#tab:defaultconstructible'>[tab:defaultconstructible]</a>),
and that construction shall not throw an exception.</p></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8438'>#</a></div><p ><i>Effects:</i> Constructs a <span class='texttt'>unique_ptr</span> object that owns
nothing, value-initializing the stored pointer and the stored deleter.</p></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8442'>#</a></div><p ><i>Postconditions:</i> <span class='texttt'>get() == nullptr</span>. <span class='texttt'>get_deleter()</span>
returns a reference to the stored deleter.</p></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8446'>#</a></div><p ><i>Remarks:</i> If this constructor is instantiated with a pointer type or reference type
for the template argument <span class='texttt'>D</span>, the program is ill-formed.
</p></div></div><p ><span class='indexparent'><a class='index' id='unique_ptr,constructor'></a></span><code class='itemdecl'>
explicit unique_ptr(pointer p) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8457'>#</a></div><p ><i>Requires:</i> <span class='texttt'>D</span> shall
satisfy the requirements of <span class='texttt'>DefaultConstructible</span> (Table <a href='utility.arg.requirements#tab:defaultconstructible'>[tab:defaultconstructible]</a>),
and that construction shall not throw an exception.</p></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8462'>#</a></div><p ><i>Effects:</i> Constructs a <span class='texttt'>unique_ptr</span> which owns
<span class='texttt'>p</span>, initializing the stored pointer with <span class='texttt'>p</span> and
value-initializing the stored deleter.</p></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8467'>#</a></div><p ><i>Postconditions:</i> <span class='texttt'>get() == p</span>. <span class='texttt'>get_deleter()</span>
returns a reference to the stored deleter.</p></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8471'>#</a></div><p ><i>Remarks:</i> If this constructor is instantiated with a pointer type or reference type
for the template argument <span class='texttt'>D</span>, the program is ill-formed.
</p></div></div><p ><span class='indexparent'><a class='index' id='unique_ptr,constructor'></a></span><code class='itemdecl'>
unique_ptr(pointer p, <i><span class='texttt'>see below</span></i> d1) noexcept;
unique_ptr(pointer p, <i><span class='texttt'>see below</span></i> d2) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8483'>#</a></div><p >The signature of these constructors depends upon whether <span class='texttt'>D</span>
is a reference type. If <span class='texttt'>D</span> is a non-reference type
<span class='texttt'>A</span>, then the signatures are:</p><pre class='codeblock'>
unique_ptr(pointer p, const A&amp; d);
unique_ptr(pointer p, A&amp;&amp; d);</pre></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8493'>#</a></div><p >If <span class='texttt'>D</span> is an lvalue reference type <span class='texttt'>A&amp;</span>,
then the signatures are:</p><pre class='codeblock'>
unique_ptr(pointer p, A&amp; d);
unique_ptr(pointer p, A&amp;&amp; d);</pre></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8502'>#</a></div><p >If <span class='texttt'>D</span> is an lvalue reference type <span class='texttt'>const A&amp;</span>,
then the signatures are:</p><pre class='codeblock'>
unique_ptr(pointer p, const A&amp; d);
unique_ptr(pointer p, const A&amp;&amp; d);</pre></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8511'>#</a></div><p ><i>Requires:</i>
</p><ul class='itemize'><li id='12.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#12.1'>(12.1)</a></div><p >If <span class='texttt'>D</span> is not an lvalue reference type then</p><ul class='itemize'><li id='12.1.1'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#12.1.1'>(12.1.1)</a></div><p >If <span class='texttt'>d</span> is an lvalue or <span class='texttt'>const</span> rvalue then
the first constructor of this pair will be selected. <span class='texttt'>D</span>
shall satisfy the requirements of
<span class='texttt'>CopyConstructible</span> (Table <a href='utility.arg.requirements#tab:copyconstructible'>[tab:copyconstructible]</a>), and
the copy constructor of <span class='texttt'>D</span> shall
not throw an exception.
This <span class='texttt'>unique_ptr</span> will hold
a copy of <span class='texttt'>d</span>.</p></li><li id='12.1.2'><div class='marginalizedparent' style='left:-12em'><a class='marginalized' href='#12.1.2'>(12.1.2)</a></div><p >Otherwise, <span class='texttt'>d</span> is a non-const rvalue and the second
constructor of this pair will be selected. <span class='texttt'>D</span>
shall satisfy the requirements of
<span class='texttt'>MoveConstructible</span> (Table <a href='utility.arg.requirements#tab:moveconstructible'>[tab:moveconstructible]</a>), and the
move constructor of <span class='texttt'>D</span> shall not throw an exception.
This <span class='texttt'>unique_ptr</span> will
hold a value move constructed from <span class='texttt'>d</span>.
</p></li></ul></li><li id='12.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#12.2'>(12.2)</a></div><p >Otherwise <span class='texttt'>D</span> is an lvalue reference type. <span class='texttt'>d</span>
shall be reference-compatible with one of the constructors. If <span class='texttt'>d</span> is
an rvalue, it will bind to the second constructor of this pair and the program is
ill-formed. [ <i>Note:</i> The diagnostic could
be implemented using a <span class='texttt'>static_assert</span> which assures that
<span class='texttt'>D</span> is not a reference type. <i> — end note</i> ] Else <span class='texttt'>d</span>
is an lvalue and will bind to the first constructor of this pair. The type
which <span class='texttt'>D</span> references need not be <span class='texttt'>CopyConstructible</span>
nor <span class='texttt'>MoveConstructible</span>. This <span class='texttt'>unique_ptr</span> will
hold a <span class='texttt'>D</span> which refers to the lvalue <span class='texttt'>d</span>.
[ <i>Note:</i> <span class='texttt'>D</span> may not be an rvalue reference type.
<i> — end note</i> ]
</p></li></ul></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8549'>#</a></div><p ><i>Effects:</i> Constructs a <span class='texttt'>unique_ptr</span> object which owns <span class='texttt'>p</span>, initializing
the stored pointer with <span class='texttt'>p</span> and initializing the deleter as described above.</p></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8553'>#</a></div><p ><i>Postconditions:</i> <span class='texttt'>get() == p</span>.
<span class='texttt'>get_deleter()</span> returns a reference to the stored
deleter. If <span class='texttt'>D</span> is a reference type then <span class='texttt'>get_deleter()</span>
returns a reference to the lvalue <span class='texttt'>d</span>.</p><p >[ <i>Example:</i></p><pre class='codeblock'>
D d;
unique_ptr&lt;int, D&gt; p1(new int, D());        <span class='comment'>// <span class='texttt'>D</span> must be <span class='texttt'>MoveConstructible</span>
</span>unique_ptr&lt;int, D&gt; p2(new int, d);          <span class='comment'>// <span class='texttt'>D</span> must be <span class='texttt'>CopyConstructible</span>
</span>unique_ptr&lt;int, D&amp;&gt; p3(new int, d);         <span class='comment'>// <span class='texttt'>p3</span> holds a reference to <span class='texttt'>d</span>
</span>unique_ptr&lt;int, const D&amp;&gt; p4(new int, D()); <span class='comment'>// error: rvalue deleter object combined
</span>                                            <span class='comment'>// with reference deleter type
</span></pre><p ><i> — end example</i> ]</p></div></div><p ><span class='indexparent'><a class='index' id='unique_ptr,constructor'></a></span><code class='itemdecl'>
unique_ptr(unique_ptr&amp;&amp; u) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8580'>#</a></div><p ><i>Requires:</i> If <span class='texttt'>D</span> is not a reference type,
<span class='texttt'>D</span> shall satisfy the requirements of <span class='texttt'>MoveConstructible</span>
(Table <a href='utility.arg.requirements#tab:moveconstructible'>[tab:moveconstructible]</a>).
Construction
of the deleter from an rvalue of type <span class='texttt'>D</span> shall not
throw an exception.</p></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8588'>#</a></div><p ><i>Effects:</i> Constructs a <span class='texttt'>unique_ptr</span> by transferring ownership from
<span class='texttt'>u</span> to <span class='texttt'>*this</span>. If <span class='texttt'>D</span> is a reference type, this
deleter is copy constructed from <span class='texttt'>u</span>'s deleter; otherwise, this
deleter is move constructed from <span class='texttt'>u</span>'s deleter. [ <i>Note:</i> The
deleter constructor can be implemented with <span class='texttt'>std::forward&lt;D&gt;</span>. <i> — end note</i> ]</p></div></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8595'>#</a></div><p ><i>Postconditions:</i> <span class='texttt'>get()</span> yields the value <span class='texttt'>u.get()</span>
yielded before the construction. <span class='texttt'>get_deleter()</span> returns a reference
to the stored deleter that was constructed from
<span class='texttt'>u.get_deleter()</span>. If <span class='texttt'>D</span> is a reference type then
<span class='texttt'>get_deleter()</span> and <span class='texttt'>u.get_deleter()</span> both reference
the same lvalue deleter.
</p></div></div><p ><span class='indexparent'><a class='index' id='unique_ptr,constructor'></a></span><code class='itemdecl'>
template &lt;class U, class E&gt; unique_ptr(unique_ptr&lt;U, E&gt;&amp;&amp; u) noexcept;
</code></p><div class='itemdescr'></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8610'>#</a></div><p ><i>Requires:</i> If <span class='texttt'>E</span> is not a reference type,
construction of the deleter from an rvalue of type
<span class='texttt'>E</span> shall be well formed and shall not throw an exception.
Otherwise, <span class='texttt'>E</span> is a reference type and construction of the deleter from an
lvalue of type <span class='texttt'>E</span> shall be well formed and shall not throw an exception.</p></div></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8617'>#</a></div><p ><i>Remarks:</i> This constructor shall not participate in overload resolution unless:</p><ul class='itemize'><li id='19.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#19.1'>(19.1)</a></div><p ><span class='texttt'>unique_ptr&lt;U, E&gt;::pointer</span> is implicitly convertible to <span class='texttt'>pointer</span>,
</p></li><li id='19.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#19.2'>(19.2)</a></div><p ><span class='texttt'>U</span> is not an array type, and
</p></li><li id='19.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#19.3'>(19.3)</a></div><p >either <span class='texttt'>D</span> is a reference type and <span class='texttt'>E</span> is the same type as <span class='texttt'>D</span>, or
<span class='texttt'>D</span> is not a reference type and <span class='texttt'>E</span> is implicitly convertible to <span class='texttt'>D</span>.
</p></li></ul></div></div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8627'>#</a></div><p ><i>Effects:</i> Constructs a <span class='texttt'>unique_ptr</span> by transferring ownership from <span class='texttt'>u</span>
to <span class='texttt'>*this</span>. If <span class='texttt'>E</span> is a reference type, this deleter is copy constructed from
<span class='texttt'>u</span>'s deleter; otherwise, this deleter is move constructed from <span class='texttt'>u</span>'s
deleter. [ <i>Note:</i> The deleter constructor can be implemented with
<span class='texttt'>std::forward&lt;E&gt;</span>. <i> — end note</i> ]</p></div></div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/e5ca011e3f449e4ae1ac4777e587a4534be46224/source/utilities.tex#L8634'>#</a></div><p ><i>Postconditions:</i> <span class='texttt'>get()</span> yields the value <span class='texttt'>u.get()</span>
yielded before the construction.
<span class='texttt'>get_deleter()</span> returns a reference
to the stored deleter that was constructed from
<span class='texttt'>u.get_deleter()</span>.
</p></div></div></div></div></body></html>