<!DOCTYPE html><html lang='en'><head><title>[diff.dcl]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='annexnum' style='min-width:73pt'>Annex C&emsp;(informative)</a> Compatibility <a class='abbr_ref' href='./#diff'>[diff]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>C.1</a> C++ and ISO C <a class='abbr_ref' href='diff.iso#diff.dcl'>[diff.iso]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>C.1.6</a> <a href='dcl.dcl'>[dcl.dcl]</a>: declarations <a class='abbr_ref'>[diff.dcl]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div id='1.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.stc'>[dcl.stc]</a>
<br/><b>Change:</b> In C++, the <span class='texttt'>static</span> or <span class='texttt'>extern</span> specifiers can only be applied to names of objects or functions<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'><br/>
Using these specifiers with type declarations is illegal in C++<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>In C, these specifiers are ignored when used on type declarations<a class='hidden_link' href='#1.sentence-3'>.</a></div><div style='height:0.6em;display:block'></div><div id='1.sentence-4' class='sentence'>Example:</div><pre class='codeblock'>
static struct S {               <span class='comment'>// valid C, invalid in C++
</span>  int i;
};</pre><div id='1.sentence-5' class='sentence'><br/><b>Rationale:</b> 
Storage class specifiers don't have any meaning when associated
with a type<a class='hidden_link' href='#1.sentence-5'>.</a></div> <div id='1.sentence-6' class='sentence'>In C++, class members can be declared with the <span class='texttt'>static</span> storage
class specifier<a class='hidden_link' href='#1.sentence-6'>.</a></div> <div id='1.sentence-7' class='sentence'>Allowing storage class specifiers on type
declarations could render the code confusing for users<a class='hidden_link' href='#1.sentence-7'>.</a></div> <div id='1.sentence-8' class='sentence'><br/><b>Effect on original feature:</b> 
Deletion of semantically well-defined feature<a class='hidden_link' href='#1.sentence-8'>.</a></div> <div id='1.sentence-9' class='sentence'><br/><b>Difficulty of converting:</b> 
Syntactic transformation<a class='hidden_link' href='#1.sentence-9'>.</a></div> <div id='1.sentence-10' class='sentence'><br/><b>How widely used:</b> 
Seldom<a class='hidden_link' href='#1.sentence-10'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div id='2.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.stc'>[dcl.stc]</a>
<br/><b>Change:</b> In C++, <span class='texttt'>register</span> is not a storage class specifier<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'><br/><b>Rationale:</b> 
The storage class specifier had no effect in C++<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Deletion of semantically well-defined feature<a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'><br/><b>Difficulty of converting:</b> 
Syntactic transformation<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.sentence-5' class='sentence'><br/><b>How widely used:</b> 
Common<a class='hidden_link' href='#2.sentence-5'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div id='3.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.typedef'>[dcl.typedef]</a>
<br/><b>Change:</b> A C++ typedef name must be different from any class type name declared
in the same scope (except if the typedef is a synonym of the class name with the
same name)<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>In C, a typedef name and a struct tag name declared in the same scope
can have the same name (because they have different name spaces)<a class='hidden_link' href='#3.sentence-2'>.</a></div><div style='height:0.6em;display:block'></div><div id='3.sentence-3' class='sentence'>Example:
<pre class='codeblock'>
typedef struct name1 { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> } name1;         <span class='comment'>// valid C and C++
</span>struct name { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
typedef int name;               <span class='comment'>// valid C, invalid C++
</span></pre></div><div id='3.sentence-4' class='sentence'><br/><b>Rationale:</b> 
For ease of use, C++ doesn't require that a type name be prefixed
with the keywords <span class='texttt'>class</span>, <span class='texttt'>struct</span> or <span class='texttt'>union</span> when used in object
declarations or type casts<a class='hidden_link' href='#3.sentence-4'>.</a></div><div style='height:0.6em;display:block'></div><div id='3.sentence-5' class='sentence'>Example:
<pre class='codeblock'>
class name { <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span> };
name i;                         <span class='comment'>// <span class='tcode_in_codeblock'>i</span> has type <span class='tcode_in_codeblock'>class name</span>
</span></pre></div><div id='3.sentence-6' class='sentence'><br/><b>Effect on original feature:</b> 
Deletion of semantically well-defined feature<a class='hidden_link' href='#3.sentence-6'>.</a></div> <div id='3.sentence-7' class='sentence'><br/><b>Difficulty of converting:</b> 
Semantic transformation<a class='hidden_link' href='#3.sentence-7'>.</a></div> <div id='3.sentence-8' class='sentence'>One of the 2 types has to be renamed<a class='hidden_link' href='#3.sentence-8'>.</a></div> <div id='3.sentence-9' class='sentence'><br/><b>How widely used:</b> 
Seldom<a class='hidden_link' href='#3.sentence-9'>.</a></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div id='4.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.type'>[dcl.type]</a> [see also <a href='basic.link'>[basic.link]</a>]
<br/><b>Change:</b> const objects must be initialized in C++ but can be left uninitialized in C<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'><br/><b>Rationale:</b> 
A const object cannot be assigned to so it must be initialized
to hold a useful value<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> 
Deletion of semantically well-defined feature<a class='hidden_link' href='#4.sentence-3'>.</a></div> <div id='4.sentence-4' class='sentence'><br/><b>Difficulty of converting:</b> 
Semantic transformation<a class='hidden_link' href='#4.sentence-4'>.</a></div> <div id='4.sentence-5' class='sentence'><br/><b>How widely used:</b> 
Seldom<a class='hidden_link' href='#4.sentence-5'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div id='5.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.type'>[dcl.type]</a>
<br/><b>Change:</b> Banning implicit <span class='texttt'>int</span><a class='hidden_link' href='#5.sentence-1'>.</a></div><div style='height:0.6em;display:block'></div><div id='5.sentence-2' class='sentence'>In C++ a
<i ><a href='dcl.spec#nt:decl-specifier-seq'>decl-specifier-seq</a></i>
must contain a
<i ><a href='dcl.type#nt:type-specifier'>type-specifier</a></i>, unless
it is followed by a declarator for a constructor, a destructor, or a
conversion function<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>In the following example, the
left-hand column presents valid C;
the right-hand column presents
equivalent C++ :</div><pre class='codeblock'>
void f(const parm);            void f(const int parm);
const n = 3;                   const int n = 3;
main()                         int main()
    <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span>                      <span class='tcode_in_codeblock'>/* ...&nbsp;*/</span></pre><div id='5.sentence-4' class='sentence'><br/><b>Rationale:</b> 
In C++, implicit int creates several opportunities for
ambiguity between expressions involving function-like
casts and declarations<a class='hidden_link' href='#5.sentence-4'>.</a></div> <div id='5.sentence-5' class='sentence'>Explicit declaration is increasingly considered
to be proper style<a class='hidden_link' href='#5.sentence-5'>.</a></div> <div id='5.sentence-6' class='sentence'>Liaison with WG14 (C) indicated support for (at least)
deprecating implicit int in the next revision of C<a class='hidden_link' href='#5.sentence-6'>.</a></div> <div id='5.sentence-7' class='sentence'><br/><b>Effect on original feature:</b> 
Deletion of semantically well-defined feature<a class='hidden_link' href='#5.sentence-7'>.</a></div> <div id='5.sentence-8' class='sentence'><br/><b>Difficulty of converting:</b> 
Syntactic transformation<a class='hidden_link' href='#5.sentence-8'>.</a></div> <div id='5.sentence-9' class='sentence'>Could be automated<a class='hidden_link' href='#5.sentence-9'>.</a></div> <div id='5.sentence-10' class='sentence'><br/><b>How widely used:</b> 
Common<a class='hidden_link' href='#5.sentence-10'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div id='6.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.spec.auto'>[dcl.spec.auto]</a>
<br/><b>Change:</b> 
The keyword <span class='texttt'>auto</span> cannot be used as a storage class specifier<a class='hidden_link' href='#6.sentence-1'>.</a></div><pre class='codeblock'>
void f() {
  auto int x;     <span class='comment'>// valid C, invalid C++
</span>}</pre><div id='6.sentence-2' class='sentence'><br/><b>Rationale:</b> Allowing the use of <span class='texttt'>auto</span> to deduce the type
of a variable from its initializer results in undesired interpretations of
<span class='texttt'>auto</span> as a storage class specifier in certain contexts<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.sentence-3' class='sentence'><br/><b>Effect on original feature:</b> Deletion of semantically well-defined feature<a class='hidden_link' href='#6.sentence-3'>.</a></div> <div id='6.sentence-4' class='sentence'><br/><b>Difficulty of converting:</b> Syntactic transformation<a class='hidden_link' href='#6.sentence-4'>.</a></div> <div id='6.sentence-5' class='sentence'><br/><b>How widely used:</b> Rare<a class='hidden_link' href='#6.sentence-5'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div id='7.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.enum'>[dcl.enum]</a>
<br/><b>Change:</b> C++ objects of enumeration type can only be assigned values of the same enumeration type<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>In C, objects of enumeration type can be assigned values of any integral type<a class='hidden_link' href='#7.sentence-2'>.</a></div><div style='height:0.6em;display:block'></div><div id='7.sentence-3' class='sentence'>Example:
<pre class='codeblock'>
enum color { red, blue, green };
enum color c = 1;               <span class='comment'>// valid C, invalid C++
</span></pre></div><div id='7.sentence-4' class='sentence'><br/><b>Rationale:</b> 
The type-safe nature of C++<a class='hidden_link' href='#7.sentence-4'>.</a></div> <div id='7.sentence-5' class='sentence'><br/><b>Effect on original feature:</b> 
Deletion of semantically well-defined feature<a class='hidden_link' href='#7.sentence-5'>.</a></div> <div id='7.sentence-6' class='sentence'><br/><b>Difficulty of converting:</b> 
Syntactic transformation<a class='hidden_link' href='#7.sentence-6'>.</a></div> <div id='7.sentence-7' class='sentence'>(The type error produced by the assignment can be automatically
corrected by applying an explicit cast<a class='hidden_link' href='#7.sentence-7'>.</a>)</div> <div id='7.sentence-8' class='sentence'><br/><b>How widely used:</b> 
Common<a class='hidden_link' href='#7.sentence-8'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div id='8.sentence-1' class='sentence'><b>Affected subclause:</b> <a href='dcl.enum'>[dcl.enum]</a>
<br/><b>Change:</b> In C++, the type of an enumerator is its enumeration<a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.sentence-2' class='sentence'>In C, the type of an enumerator is <span class='texttt'>int</span><a class='hidden_link' href='#8.sentence-2'>.</a></div><div style='height:0.6em;display:block'></div><div id='8.sentence-3' class='sentence'>Example:</div><pre class='codeblock'>
enum e { A };
sizeof(A) == sizeof(int)        <span class='comment'>// in C
</span>sizeof(A) == sizeof(e)          <span class='comment'>// in C++
</span>/* and sizeof(int) is not necessarily equal to sizeof(e) */</pre><div id='8.sentence-4' class='sentence'><br/><b>Rationale:</b> 
In C++, an enumeration is a distinct type<a class='hidden_link' href='#8.sentence-4'>.</a></div> <div id='8.sentence-5' class='sentence'><br/><b>Effect on original feature:</b> 
Change to semantics of well-defined feature<a class='hidden_link' href='#8.sentence-5'>.</a></div> <div id='8.sentence-6' class='sentence'><br/><b>Difficulty of converting:</b> 
Semantic transformation<a class='hidden_link' href='#8.sentence-6'>.</a></div> <div id='8.sentence-7' class='sentence'><br/><b>How widely used:</b> 
Seldom<a class='hidden_link' href='#8.sentence-7'>.</a></div> <div id='8.sentence-8' class='sentence'>The only time this affects existing C code is when the size of an
enumerator is taken<a class='hidden_link' href='#8.sentence-8'>.</a></div> <div id='8.sentence-9' class='sentence'>Taking the size of an enumerator is not a
common C coding practice<a class='hidden_link' href='#8.sentence-9'>.</a></div></div></div></body></html>