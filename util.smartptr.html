<!DOCTYPE html><html lang='en'><head><title>[util.smartptr]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='collapsed.css' title='Notes and examples collapsed'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>23</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>23.11</a> Smart pointers <a class='abbr_ref' href='smartptr#util.smartptr'>[smartptr]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>23.11.2</a> Shared-ownership pointers <a class='abbr_ref'>[util.smartptr]</a></h3><div id='weak.bad' class='section'><h4 ><a class='secnum' href='#weak.bad' style='min-width:118pt'>23.11.2.1</a> Class <span class='texttt'>bad_&shy;weak_&shy;ptr</span> <a class='abbr_ref' href='util.smartptr.weak.bad'>[util.smartptr.weak.bad]</a></h4><span class='indexparent'><a class='index' id='lib:bad_weak_ptr'></a></span><pre class='codeblock'>
namespace std {
  class bad_weak_ptr : public exception {
  public:
    bad_weak_ptr() noexcept;
  };
}</pre><div class='para' id='weak.bad-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.bad-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9490'>#</a></div><div id='weak.bad-1.sentence-1' class='sentence'>An exception of type <span class='texttt'>bad_&shy;weak_&shy;ptr</span> is thrown by the <span class='texttt'>shared_&shy;ptr</span>
constructor taking a <span class='texttt'>weak_&shy;ptr</span><a class='hidden_link' href='#weak.bad-1.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:bad_weak_ptr,constructor'></a></span><span class='indexparent'><a class='index' id='lib:what,bad_weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:bad_weak_ptr,what'></a></span></div><code class='itemdecl'>bad_weak_ptr() noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.bad-2'><div class='marginalizedparent'><a class='marginalized' href='#weak.bad-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9501'>#</a></div><div id='weak.bad-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>what()</span> returns an
<span class='indexparent'><a class='index' id=':return_value_of_bad_weak_ptr::what'></a></span>implementation-defined <span class='textsc'>ntbs</span><a class='hidden_link' href='#weak.bad-2.sentence-1'>.</a></div></div></div></div><div id='shared' class='section'><h4 ><a class='secnum' href='#shared' style='min-width:118pt'>23.11.2.2</a> Class template <span class='texttt'>shared_&shy;ptr</span> <a class='abbr_ref' href='util.smartptr.shared'>[util.smartptr.shared]</a></h4><div class='para' id='shared-1'><div class='marginalizedparent'><a class='marginalized' href='#shared-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9508'>#</a></div><div id='shared-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:shared_ptr'></a></span>The <span class='texttt'>shared_&shy;ptr</span> class template stores a pointer, usually obtained
via <span class='texttt'>new</span><a class='hidden_link' href='#shared-1.sentence-1'>.</a></div> <div id='shared-1.sentence-2' class='sentence'><span class='texttt'>shared_&shy;ptr</span> implements semantics of shared ownership;
the last remaining owner of the pointer is responsible for destroying
the object, or otherwise releasing the resources associated with the stored pointer<a class='hidden_link' href='#shared-1.sentence-2'>.</a></div> <div id='shared-1.sentence-3' class='sentence'>A
<span class='texttt'>shared_&shy;ptr</span> is said to be empty if it does not own a pointer<a class='hidden_link' href='#shared-1.sentence-3'>.</a></div><pre class='codeblock'>
namespace std {
  template&lt;class T&gt; class shared_ptr {
  public:
    using element_type = remove_extent_t&lt;T&gt;;
    using weak_type    = weak_ptr&lt;T&gt;;

    <span class='comment'>// <a href='util.smartptr.shared.const'>[util.smartptr.shared.const]</a>, constructors
</span>    constexpr shared_ptr() noexcept;
    template&lt;class Y&gt; explicit shared_ptr(Y* p);
    template&lt;class Y, class D&gt; shared_ptr(Y* p, D d);
    template&lt;class Y, class D, class A&gt; shared_ptr(Y* p, D d, A a);
    template &lt;class D&gt; shared_ptr(nullptr_t p, D d);
    template &lt;class D, class A&gt; shared_ptr(nullptr_t p, D d, A a);
    template&lt;class Y&gt; shared_ptr(const shared_ptr&lt;Y&gt;&amp; r, element_type* p) noexcept;
    shared_ptr(const shared_ptr&amp; r) noexcept;
    template&lt;class Y&gt; shared_ptr(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
    shared_ptr(shared_ptr&amp;&amp; r) noexcept;
    template&lt;class Y&gt; shared_ptr(shared_ptr&lt;Y&gt;&amp;&amp; r) noexcept;
    template&lt;class Y&gt; explicit shared_ptr(const weak_ptr&lt;Y&gt;&amp; r);
    template &lt;class Y, class D&gt; shared_ptr(unique_ptr&lt;Y, D&gt;&amp;&amp; r);
    constexpr shared_ptr(nullptr_t) noexcept : shared_ptr() { }

    <span class='comment'>// <a href='util.smartptr.shared.dest'>[util.smartptr.shared.dest]</a>, destructor
</span>    ~shared_ptr();

    <span class='comment'>// <a href='util.smartptr.shared.assign'>[util.smartptr.shared.assign]</a>, assignment
</span>    shared_ptr&amp; operator=(const shared_ptr&amp; r) noexcept;
    template&lt;class Y&gt; shared_ptr&amp; operator=(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
    shared_ptr&amp; operator=(shared_ptr&amp;&amp; r) noexcept;
    template&lt;class Y&gt; shared_ptr&amp; operator=(shared_ptr&lt;Y&gt;&amp;&amp; r) noexcept;
    template &lt;class Y, class D&gt; shared_ptr&amp; operator=(unique_ptr&lt;Y, D&gt;&amp;&amp; r);

    <span class='comment'>// <a href='util.smartptr.shared.mod'>[util.smartptr.shared.mod]</a>, modifiers
</span>    void swap(shared_ptr&amp; r) noexcept;
    void reset() noexcept;
    template&lt;class Y&gt; void reset(Y* p);
    template&lt;class Y, class D&gt; void reset(Y* p, D d);
    template&lt;class Y, class D, class A&gt; void reset(Y* p, D d, A a);

    <span class='comment'>// <a href='util.smartptr.shared.obs'>[util.smartptr.shared.obs]</a>, observers
</span>    element_type* get() const noexcept;
    T&amp; operator*() const noexcept;
    T* operator-&gt;() const noexcept;
    element_type&amp; operator[](ptrdiff_t i) const;
    long use_count() const noexcept;
    explicit operator bool() const noexcept;
    template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const noexcept;
    template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const noexcept;
  };

  template&lt;class T&gt; shared_ptr(weak_ptr&lt;T&gt;) -&gt; shared_ptr&lt;T&gt;;
  template&lt;class T, class D&gt; shared_ptr(unique_ptr&lt;T, D&gt;) -&gt; shared_ptr&lt;T&gt;;

  <span class='comment'>// <a href='util.smartptr.shared.create'>[util.smartptr.shared.create]</a>, <span class='tcode_in_codeblock'>shared_&shy;ptr</span> creation
</span>  template&lt;class T, class... Args&gt;
    shared_ptr&lt;T&gt; make_shared(Args&amp;&amp;... args);
  template&lt;class T, class A, class... Args&gt;
    shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, Args&amp;&amp;... args);

  <span class='comment'>// <a href='util.smartptr.shared.cmp'>[util.smartptr.shared.cmp]</a>, <span class='tcode_in_codeblock'>shared_&shy;ptr</span> comparisons
</span>  template&lt;class T, class U&gt;
    bool operator==(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
  template&lt;class T, class U&gt;
    bool operator!=(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
  template&lt;class T, class U&gt;
    bool operator&lt;(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
  template&lt;class T, class U&gt;
    bool operator&gt;(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
  template&lt;class T, class U&gt;
    bool operator&lt;=(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
  template&lt;class T, class U&gt;
    bool operator&gt;=(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;

  template &lt;class T&gt;
    bool operator==(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
  template &lt;class T&gt;
    bool operator==(nullptr_t, const shared_ptr&lt;T&gt;&amp; b) noexcept;
  template &lt;class T&gt;
    bool operator!=(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
  template &lt;class T&gt;
    bool operator!=(nullptr_t, const shared_ptr&lt;T&gt;&amp; b) noexcept;
  template &lt;class T&gt;
    bool operator&lt;(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
  template &lt;class T&gt;
    bool operator&lt;(nullptr_t, const shared_ptr&lt;T&gt;&amp; b) noexcept;
  template &lt;class T&gt;
    bool operator&lt;=(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
  template &lt;class T&gt;
    bool operator&lt;=(nullptr_t, const shared_ptr&lt;T&gt;&amp; b) noexcept;
  template &lt;class T&gt;
    bool operator&gt;(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
  template &lt;class T&gt;
    bool operator&gt;(nullptr_t, const shared_ptr&lt;T&gt;&amp; b) noexcept;
  template &lt;class T&gt;
    bool operator&gt;=(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
  template &lt;class T&gt;
    bool operator&gt;=(nullptr_t, const shared_ptr&lt;T&gt;&amp; b) noexcept;

  <span class='comment'>// <a href='util.smartptr.shared.spec'>[util.smartptr.shared.spec]</a>, <span class='tcode_in_codeblock'>shared_&shy;ptr</span> specialized algorithms
</span>  template&lt;class T&gt;
    void swap(shared_ptr&lt;T&gt;&amp; a, shared_ptr&lt;T&gt;&amp; b) noexcept;

  <span class='comment'>// <a href='util.smartptr.shared.cast'>[util.smartptr.shared.cast]</a>, <span class='tcode_in_codeblock'>shared_&shy;ptr</span> casts
</span>  template&lt;class T, class U&gt;
    shared_ptr&lt;T&gt; static_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
  template&lt;class T, class U&gt;
    shared_ptr&lt;T&gt; dynamic_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
  template&lt;class T, class U&gt;
    shared_ptr&lt;T&gt; const_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
  template&lt;class T, class U&gt;
    shared_ptr&lt;T&gt; reinterpret_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;

  <span class='comment'>// <a href='util.smartptr.getdeleter'>[util.smartptr.getdeleter]</a>, <span class='tcode_in_codeblock'>shared_&shy;ptr</span> <span class='tcode_in_codeblock'>get_&shy;deleter</span>
</span>  template&lt;class D, class T&gt;
    D* get_deleter(const shared_ptr&lt;T&gt;&amp; p) noexcept;

  <span class='comment'>// <a href='util.smartptr.shared.io'>[util.smartptr.shared.io]</a>, <span class='tcode_in_codeblock'>shared_&shy;ptr</span> I/O
</span>  template&lt;class E, class T, class Y&gt;
    basic_ostream&lt;E, T&gt;&amp; operator&lt;&lt; (basic_ostream&lt;E, T&gt;&amp; os, const shared_ptr&lt;Y&gt;&amp; p);
}</pre></div><div class='para' id='shared-2'><div class='marginalizedparent'><a class='marginalized' href='#shared-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9639'>#</a></div><div id='shared-2.sentence-1' class='sentence'>Specializations of <span class='texttt'>shared_&shy;ptr</span> shall be <span class='texttt'>CopyConstructible</span>,
<span class='texttt'>CopyAssignable</span>, and <span class='texttt'>LessThanComparable</span>, allowing their use in standard
containers<a class='hidden_link' href='#shared-2.sentence-1'>.</a></div> <div id='shared-2.sentence-2' class='sentence'>Specializations of <span class='texttt'>shared_&shy;ptr</span> shall be
contextually convertible to <span class='texttt'>bool</span>,
allowing their use in boolean expressions and declarations in conditions<a class='hidden_link' href='#shared-2.sentence-2'>.</a></div> <div id='shared-2.sentence-3' class='sentence'>The template
parameter <span class='texttt'>T</span> of <span class='texttt'>shared_&shy;ptr</span> may be an incomplete type<a class='hidden_link' href='#shared-2.sentence-3'>.</a></div></div><div class='para' id='shared-3'><div class='marginalizedparent'><a class='marginalized' href='#shared-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9647'>#</a></div><div id='shared-3.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#shared-3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
if (shared_ptr&lt;X&gt; px = dynamic_pointer_cast&lt;X&gt;(py)) {
  <span class='comment'>// do something with <span class='tcode_in_codeblock'>px</span>
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> </div><div class='para' id='shared-4'><div class='marginalizedparent'><a class='marginalized' href='#shared-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9656'>#</a></div><div id='shared-4.sentence-1' class='sentence'>For purposes of determining the presence of a data race, member functions shall
access and modify only the <span class='texttt'>shared_&shy;ptr</span> and <span class='texttt'>weak_&shy;ptr</span> objects
themselves and not objects they refer to<a class='hidden_link' href='#shared-4.sentence-1'>.</a></div> <div id='shared-4.sentence-2' class='sentence'>Changes in <span class='texttt'>use_&shy;count()</span> do not
reflect modifications that can introduce data races<a class='hidden_link' href='#shared-4.sentence-2'>.</a></div></div><div class='para' id='shared-5'><div class='marginalizedparent'><a class='marginalized' href='#shared-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9662'>#</a></div><div id='shared-5.sentence-1' class='sentence'>For the purposes of subclause <a href='util.smartptr'>[util.smartptr]</a>,
a pointer type <span class='texttt'>Y*</span> is said to be
<a class='hidden_link' href='#def:compatible_with,shared_ptr' id='def:compatible_with,shared_ptr'><i >compatible with</i></a>
a pointer type <span class='texttt'>T*</span> when either
<span class='texttt'>Y*</span> is convertible to <span class='texttt'>T*</span> or
<span class='texttt'>Y</span> is <span class='texttt'>U[N]</span> and <span class='texttt'>T</span> is <span class='textit'>cv</span> <span class='texttt'>U[]</span><a class='hidden_link' href='#shared-5.sentence-1'>.</a></div></div><div id='shared.const' class='section'><h4 ><a class='secnum' href='#shared.const' style='min-width:133pt'>23.11.2.2.1</a> <span class='texttt'>shared_&shy;ptr</span> constructors <a class='abbr_ref' href='util.smartptr.shared.const'>[util.smartptr.shared.const]</a></h4><div class='para' id='shared.const-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9672'>#</a></div><div id='shared.const-1.sentence-1' class='sentence'>In the constructor definitions below,
enables <span class='texttt'>shared_&shy;from_&shy;this</span> with <span class='texttt'>p</span>,
for a pointer <span class='texttt'>p</span> of type <span class='texttt'>Y*</span>,
means that if <span class='texttt'>Y</span> has an unambiguous and accessible base class
that is a specialization of <span class='texttt'>enable_&shy;shared_&shy;from_&shy;this</span> (<a href='util.smartptr.enab'>[util.smartptr.enab]</a>),
then <span class='texttt'>remove_&shy;cv_&shy;t&lt;Y&gt;*</span> shall be implicitly convertible to <span class='texttt'>T*</span> and
the constructor evaluates the statement:
<pre class='codeblock'>
if (p != nullptr &amp;&amp; p-&gt;weak_this.expired())
  p-&gt;weak_this = shared_ptr&lt;remove_cv_t&lt;Y&gt;&gt;(*this, const_cast&lt;remove_cv_t&lt;Y&gt;*&gt;(p));</pre>
The assignment to the <span class='texttt'>weak_&shy;this</span> member is not atomic and
conflicts with any potentially concurrent access to the same object (<a href='intro.multithread'>[intro.multithread]</a>)<a class='hidden_link' href='#shared.const-1.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:shared_ptr,constructor'></a></span></div><code class='itemdecl'>constexpr shared_ptr() noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.const-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9693'>#</a></div><div id='shared.const-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an empty <span class='texttt'>shared_&shy;ptr</span> object<a class='hidden_link' href='#shared.const-2.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9695'>#</a></div><div id='shared.const-3.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>use_&shy;count() == 0 &amp;&amp; get() == nullptr</span><a class='hidden_link' href='#shared.const-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor_'></a></span><code class='itemdecl'>template&lt;class Y&gt; explicit shared_ptr(Y* p);
</code><div class='itemdescr'></div><div class='para' id='shared.const-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9704'>#</a></div><div id='shared.const-4.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>Y</span> shall be a complete type<a class='hidden_link' href='#shared.const-4.sentence-1'>.</a></div> <div id='shared.const-4.sentence-2' class='sentence'>The expression
<span class='texttt'>delete[] p</span>, when <span class='texttt'>T</span> is an array type, or
<span class='texttt'>delete p</span>, when <span class='texttt'>T</span> is not an array type,
shall have well-defined behavior, and
shall not throw exceptions<a class='hidden_link' href='#shared.const-4.sentence-2'>.</a></div></div></div><div class='para' id='shared.const-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9710'>#</a></div><div id='shared.const-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> When <span class='texttt'>T</span> is not an array type,
constructs a <span class='texttt'>shared_&shy;ptr</span> object
that owns the pointer <span class='texttt'>p</span><a class='hidden_link' href='#shared.const-5.sentence-1'>.</a></div> <div id='shared.const-5.sentence-2' class='sentence'>Otherwise, constructs a <span class='texttt'>shared_&shy;ptr</span>
that owns <span class='texttt'>p</span> and a deleter of an
unspecified type that calls <span class='texttt'>delete[] p</span><a class='hidden_link' href='#shared.const-5.sentence-2'>.</a></div> <div id='shared.const-5.sentence-3' class='sentence'>When <span class='texttt'>T</span> is not an array type,
enables <span class='texttt'>shared_&shy;from_&shy;this</span> with <span class='texttt'>p</span><a class='hidden_link' href='#shared.const-5.sentence-3'>.</a></div> <div id='shared.const-5.sentence-4' class='sentence'>If an exception is thrown, <span class='texttt'>delete p</span> is called
when <span class='texttt'>T</span> is not an array type, <span class='texttt'>delete[] p</span> otherwise<a class='hidden_link' href='#shared.const-5.sentence-4'>.</a></div></div></div><div class='para' id='shared.const-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9721'>#</a></div><div id='shared.const-6.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>use_&shy;count() == 1 &amp;&amp; get() == p</span><a class='hidden_link' href='#shared.const-6.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9723'>#</a></div><div id='shared.const-7.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>bad_&shy;alloc</span>, or an <span class='indexparent'><a class='index' id=':exception_type_when_shared_ptr_constructor_fails'></a></span>implementation-defined exception when a resource other than memory could not be obtained<a class='hidden_link' href='#shared.const-7.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-8'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9726'>#</a></div><div id='shared.const-8.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is an array type,
this constructor shall not participate in overload resolution unless
the expression <span class='texttt'>delete[] p</span> is well-formed and either
<span class='texttt'>T</span> is <span class='texttt'>U[N]</span> and <span class='texttt'>Y(*)[N]</span> is convertible to <span class='texttt'>T*</span>, or
<span class='texttt'>T</span> is <span class='texttt'>U[]</span> and <span class='texttt'>Y(*)[]</span> is convertible to <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-8.sentence-1'>.</a></div> <div id='shared.const-8.sentence-2' class='sentence'>When <span class='texttt'>T</span> is not an array type,
this constructor shall not participate in overload resolution unless
the expression <span class='texttt'>delete p</span> is well-formed and
<span class='texttt'>Y*</span> is convertible to <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-8.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor__'></a></span><code class='itemdecl'>template&lt;class Y, class D&gt; shared_ptr(Y* p, D d);
template&lt;class Y, class D, class A&gt; shared_ptr(Y* p, D d, A a);
template &lt;class D&gt; shared_ptr(nullptr_t p, D d);
template &lt;class D, class A&gt; shared_ptr(nullptr_t p, D d, A a);
</code><div class='itemdescr'></div><div class='para' id='shared.const-9'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9746'>#</a></div><div id='shared.const-9.sentence-1' class='sentence'><span class='textit'>Requires:</span> Construction of <span class='texttt'>d</span> and a deleter of type <span class='texttt'>D</span>
initialized with <span class='texttt'>std&#x200b;::&#x200b;move(d)</span> shall not throw exceptions<a class='hidden_link' href='#shared.const-9.sentence-1'>.</a></div> <div id='shared.const-9.sentence-2' class='sentence'>The expression <span class='texttt'>d(p)</span>
shall have well-defined behavior and shall not throw exceptions<a class='hidden_link' href='#shared.const-9.sentence-2'>.</a></div> <div id='shared.const-9.sentence-3' class='sentence'><span class='texttt'>A</span> shall be an allocator (<a href='allocator.requirements'>[allocator.requirements]</a>)<a class='hidden_link' href='#shared.const-9.sentence-3'>.</a></div></div></div><div class='para' id='shared.const-10'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9752'>#</a></div><div id='shared.const-10.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>shared_&shy;ptr</span> object that owns the
object <span class='texttt'>p</span> and the deleter <span class='texttt'>d</span><a class='hidden_link' href='#shared.const-10.sentence-1'>.</a></div> <div id='shared.const-10.sentence-2' class='sentence'>When <span class='texttt'>T</span> is not an array type,
the first and second constructors enable <span class='texttt'>shared_&shy;from_&shy;this</span> with <span class='texttt'>p</span><a class='hidden_link' href='#shared.const-10.sentence-2'>.</a></div> <div id='shared.const-10.sentence-3' class='sentence'>The second and fourth constructors shall use a copy of <span class='texttt'>a</span> to
allocate memory for internal use<a class='hidden_link' href='#shared.const-10.sentence-3'>.</a></div> <div id='shared.const-10.sentence-4' class='sentence'>If an exception is thrown, <span class='texttt'>d(p)</span> is called<a class='hidden_link' href='#shared.const-10.sentence-4'>.</a></div></div></div><div class='para' id='shared.const-11'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9760'>#</a></div><div id='shared.const-11.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>use_&shy;count() == 1 &amp;&amp; get() == p</span><a class='hidden_link' href='#shared.const-11.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-12'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9762'>#</a></div><div id='shared.const-12.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>bad_&shy;alloc</span>, or an <span class='indexparent'><a class='index' id=':exception_type_when_shared_ptr_constructor_fails_'></a></span>implementation-defined exception
when a resource other than memory could not be obtained<a class='hidden_link' href='#shared.const-12.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-13'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9766'>#</a></div><div id='shared.const-13.sentence-1' class='sentence'><span class='textit'>Remarks:</span>
When <span class='texttt'>T</span> is an array type,
this constructor shall not participate in overload resolution unless
<span class='texttt'>is_&shy;move_&shy;constructible_&shy;v&lt;D&gt;</span> is <span class='texttt'>true</span>,
the expression <span class='texttt'>d(p)</span> is well-formed, and either
<span class='texttt'>T</span> is <span class='texttt'>U[N]</span> and <span class='texttt'>Y(*)[N]</span> is convertible to <span class='texttt'>T*</span>, or
<span class='texttt'>T</span> is <span class='texttt'>U[]</span> and <span class='texttt'>Y(*)[]</span> is convertible to <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-13.sentence-1'>.</a></div> <div id='shared.const-13.sentence-2' class='sentence'>When <span class='texttt'>T</span> is not an array type,
this constructor shall not participate in overload resolution unless
<span class='texttt'>is_&shy;move_&shy;constructible_&shy;v&lt;D&gt;</span> is <span class='texttt'>true</span>,
the expression <span class='texttt'>d(p)</span> is well-formed, and
<span class='texttt'>Y*</span> is convertible to <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-13.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor___'></a></span><code class='itemdecl'>template&lt;class Y&gt; shared_ptr(const shared_ptr&lt;Y&gt;&amp; r, element_type* p) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.const-14'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9786'>#</a></div><div id='shared.const-14.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>shared_&shy;ptr</span> instance that
stores <span class='texttt'>p</span> and shares ownership with <span class='texttt'>r</span><a class='hidden_link' href='#shared.const-14.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-15'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9790'>#</a></div><div id='shared.const-15.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>get() == p &amp;&amp; use_&shy;count() == r.use_&shy;count()</span><a class='hidden_link' href='#shared.const-15.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-16'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9793'>#</a></div><div id='shared.const-16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.const-16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.const-16.sentence-1' class='sentence'>To avoid the possibility of a dangling pointer, the
user of this constructor must ensure that <span class='texttt'>p</span> remains valid at
least until the ownership group of <span class='texttt'>r</span> is destroyed<a class='hidden_link' href='#shared.const-16.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='shared.const-17'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9798'>#</a></div><div id='shared.const-17.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.const-17.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.const-17.sentence-1' class='sentence'>This constructor allows creation of an empty
<span class='texttt'>shared_&shy;ptr</span> instance with a non-null stored pointer<a class='hidden_link' href='#shared.const-17.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor____'></a></span><code class='itemdecl'>shared_ptr(const shared_ptr&amp; r) noexcept;
template&lt;class Y&gt; shared_ptr(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.const-18'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9810'>#</a></div><div id='shared.const-18.sentence-1' class='sentence'><span class='textit'>Remarks:</span>
The second constructor shall not participate in overload resolution unless
<span class='texttt'>Y*</span> is compatible with <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-18.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-19'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9814'>#</a></div><div id='shared.const-19.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>r</span> is empty, constructs
an empty <span class='texttt'>shared_&shy;ptr</span> object; otherwise, constructs
a <span class='texttt'>shared_&shy;ptr</span> object that shares ownership with <span class='texttt'>r</span><a class='hidden_link' href='#shared.const-19.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-20'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9818'>#</a></div><div id='shared.const-20.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>get() == r.get() &amp;&amp; use_&shy;count() == r.use_&shy;count()</span><a class='hidden_link' href='#shared.const-20.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor_____'></a></span><code class='itemdecl'>shared_ptr(shared_ptr&amp;&amp; r) noexcept;
template&lt;class Y&gt; shared_ptr(shared_ptr&lt;Y&gt;&amp;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.const-21'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9828'>#</a></div><div id='shared.const-21.sentence-1' class='sentence'><span class='textit'>Remarks:</span> The second constructor shall not participate in overload resolution unless
<span class='texttt'>Y*</span> is compatible with <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-21.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-22'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9832'>#</a></div><div id='shared.const-22.sentence-1' class='sentence'><span class='textit'>Effects:</span> Move constructs a <span class='texttt'>shared_&shy;ptr</span> instance from <span class='texttt'>r</span><a class='hidden_link' href='#shared.const-22.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-23'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9835'>#</a></div><div id='shared.const-23.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>*this</span> shall contain the old value of
<span class='texttt'>r</span><a class='hidden_link' href='#shared.const-23.sentence-1'>.</a></div> <div id='shared.const-23.sentence-2' class='sentence'><span class='texttt'>r</span> shall be empty<a class='hidden_link' href='#shared.const-23.sentence-2'>.</a></div> <div id='shared.const-23.sentence-3' class='sentence'><span class='texttt'>r.get() == nullptr</span><a class='hidden_link' href='#shared.const-23.sentence-3'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor______'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr'></a></span><code class='itemdecl'>template&lt;class Y&gt; explicit shared_ptr(const weak_ptr&lt;Y&gt;&amp; r);
</code><div class='itemdescr'></div><div class='para' id='shared.const-24'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9847'>#</a></div><div id='shared.const-24.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs a <span class='texttt'>shared_&shy;ptr</span> object that shares ownership with
<span class='texttt'>r</span> and stores a copy of the pointer stored in <span class='texttt'>r</span><a class='hidden_link' href='#shared.const-24.sentence-1'>.</a></div> <div id='shared.const-24.sentence-2' class='sentence'>If an exception is thrown, the constructor has no effect<a class='hidden_link' href='#shared.const-24.sentence-2'>.</a></div></div></div><div class='para' id='shared.const-25'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9851'>#</a></div><div id='shared.const-25.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>use_&shy;count() == r.use_&shy;count()</span><a class='hidden_link' href='#shared.const-25.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-26'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9853'>#</a></div><div id='shared.const-26.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>bad_&shy;weak_&shy;ptr</span> when <span class='texttt'>r.expired()</span><a class='hidden_link' href='#shared.const-26.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-27'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9855'>#</a></div><div id='shared.const-27.sentence-1' class='sentence'><span class='textit'>Remarks:</span> This constructor shall not participate in overload resolution unless
<span class='texttt'>Y*</span> is compatible with <span class='texttt'>T*</span><a class='hidden_link' href='#shared.const-27.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:shared_ptr,constructor_______'></a></span><span class='indexparent'><a class='index' id='lib:unique_ptr'></a></span><code class='itemdecl'>template &lt;class Y, class D&gt; shared_ptr(unique_ptr&lt;Y, D&gt;&amp;&amp; r);
</code><div class='itemdescr'></div><div class='para' id='shared.const-28'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9866'>#</a></div><div id='shared.const-28.sentence-1' class='sentence'><span class='textit'>Remarks:</span> This constructor shall not participate in overload resolution
unless <span class='texttt'>Y*</span> is compatible with <span class='texttt'>T*</span> and
<span class='texttt'>unique_&shy;ptr&lt;Y, D&gt;&#x200b;::&#x200b;pointer</span> is convertible to <span class='texttt'>element_&shy;type*</span><a class='hidden_link' href='#shared.const-28.sentence-1'>.</a></div></div></div><div class='para' id='shared.const-29'><div class='marginalizedparent'><a class='marginalized' href='#shared.const-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9870'>#</a></div><div id='shared.const-29.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>r.get() == nullptr</span>, equivalent to <span class='texttt'>shared_&shy;ptr()</span><a class='hidden_link' href='#shared.const-29.sentence-1'>.</a></div> <div id='shared.const-29.sentence-2' class='sentence'>Otherwise, if <span class='texttt'>D</span> is not a reference type,
equivalent to <span class='texttt'>shared_&shy;ptr(r.release(), r.get_&shy;deleter())</span><a class='hidden_link' href='#shared.const-29.sentence-2'>.</a></div> <div id='shared.const-29.sentence-3' class='sentence'>Otherwise, equivalent to <span class='texttt'>shared_&shy;ptr(r.release(), ref(r.get_&shy;deleter()))</span><a class='hidden_link' href='#shared.const-29.sentence-3'>.</a></div> <div id='shared.const-29.sentence-4' class='sentence'>If an exception is thrown, the constructor has no effect<a class='hidden_link' href='#shared.const-29.sentence-4'>.</a></div></div></div></div><div id='shared.dest' class='section'><h4 ><a class='secnum' href='#shared.dest' style='min-width:133pt'>23.11.2.2.2</a> <span class='texttt'>shared_&shy;ptr</span> destructor <a class='abbr_ref' href='util.smartptr.shared.dest'>[util.smartptr.shared.dest]</a></h4><span class='indexparent'><a class='index' id='lib:shared_ptr,destructor'></a></span><code class='itemdecl'>~shared_ptr();
</code><div class='itemdescr'></div><div class='para' id='shared.dest-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.dest-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9886'>#</a></div><div id='shared.dest-1.sentence-1' class='sentence'><span class='textit'>Effects:</span>
<ul class='itemize'><li id='shared.dest-1.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.dest-1.1'>(1.1)</a></div><div id='shared.dest-1.1.sentence-1' class='sentence'>If <span class='texttt'>*this</span> is empty or shares ownership with another
<span class='texttt'>shared_&shy;ptr</span> instance (<span class='texttt'>use_&shy;count() &gt; 1</span>), there are no side effects<a class='hidden_link' href='#shared.dest-1.1.sentence-1'>.</a></div></li><li id='shared.dest-1.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.dest-1.2'>(1.2)</a></div><div id='shared.dest-1.2.sentence-1' class='sentence'>Otherwise, if <span class='texttt'>*this</span> owns an object
<span class='texttt'>p</span> and a deleter <span class='texttt'>d</span>, <span class='texttt'>d(p)</span> is called<a class='hidden_link' href='#shared.dest-1.2.sentence-1'>.</a></div></li><li id='shared.dest-1.3'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.dest-1.3'>(1.3)</a></div><div id='shared.dest-1.3.sentence-1' class='sentence'>Otherwise, <span class='texttt'>*this</span> owns a pointer <span class='texttt'>p</span>,
and <span class='texttt'>delete p</span> is called<a class='hidden_link' href='#shared.dest-1.3.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='shared.dest-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.dest-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9900'>#</a></div><div id='shared.dest-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.dest-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.dest-2.sentence-1' class='sentence'>Since the destruction of <span class='texttt'>*this</span>
decreases the number of instances that share ownership with <span class='texttt'>*this</span>
by one,
after <span class='texttt'>*this</span> has been destroyed
all <span class='texttt'>shared_&shy;ptr</span> instances that shared ownership with
<span class='texttt'>*this</span> will report a <span class='texttt'>use_&shy;count()</span> that is one less
than its previous value<a class='hidden_link' href='#shared.dest-2.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='shared.assign' class='section'><h4 ><a class='secnum' href='#shared.assign' style='min-width:133pt'>23.11.2.2.3</a> <span class='texttt'>shared_&shy;ptr</span> assignment <a class='abbr_ref' href='util.smartptr.shared.assign'>[util.smartptr.shared.assign]</a></h4><span class='indexparent'><a class='index' id='lib:operator=,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator='></a></span><code class='itemdecl'>shared_ptr&amp; operator=(const shared_ptr&amp; r) noexcept;
template&lt;class Y&gt; shared_ptr&amp; operator=(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.assign-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9918'>#</a></div><div id='shared.assign-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr(r).swap(*this)</span><a class='hidden_link' href='#shared.assign-1.sentence-1'>.</a></div></div></div><div class='para' id='shared.assign-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9920'>#</a></div><div id='shared.assign-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#shared.assign-2.sentence-1'>.</a></div></div></div><div class='para' id='shared.assign-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9922'>#</a></div><div id='shared.assign-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.assign-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.assign-3.sentence-1' class='sentence'>The use count updates caused by the temporary object
construction and destruction are not observable side
effects, so the implementation may meet the effects (and the
implied guarantees) via different means, without creating a
temporary<a class='hidden_link' href='#shared.assign-3.sentence-1'>.</a></div> <div id='shared.assign-3.sentence-2' class='sentence'>In particular, in the example:
<pre class='codeblock'>
shared_ptr&lt;int&gt; p(new int);
shared_ptr&lt;void&gt; q(p);
p = p;
q = p;</pre>
both assignments may be no-ops<a class='hidden_link' href='#shared.assign-3.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:operator=,shared_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator=_'></a></span><code class='itemdecl'>shared_ptr&amp; operator=(shared_ptr&amp;&amp; r) noexcept;
template&lt;class Y&gt; shared_ptr&amp; operator=(shared_ptr&lt;Y&gt;&amp;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.assign-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9944'>#</a></div><div id='shared.assign-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr(std&#x200b;::&#x200b;move(r)).swap(*this)</span><a class='hidden_link' href='#shared.assign-4.sentence-1'>.</a></div></div></div><div class='para' id='shared.assign-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9947'>#</a></div><div id='shared.assign-5.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#shared.assign-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,shared_ptr__'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator=__'></a></span><code class='itemdecl'>template &lt;class Y, class D&gt; shared_ptr&amp; operator=(unique_ptr&lt;Y, D&gt;&amp;&amp; r);
</code><div class='itemdescr'></div><div class='para' id='shared.assign-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9957'>#</a></div><div id='shared.assign-6.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr(std&#x200b;::&#x200b;move(r)).swap(*this)</span><a class='hidden_link' href='#shared.assign-6.sentence-1'>.</a></div></div></div><div class='para' id='shared.assign-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.assign-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9960'>#</a></div><div id='shared.assign-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#shared.assign-7.sentence-1'>.</a></div></div></div></div><div id='shared.mod' class='section'><h4 ><a class='secnum' href='#shared.mod' style='min-width:133pt'>23.11.2.2.4</a> <span class='texttt'>shared_&shy;ptr</span> modifiers <a class='abbr_ref' href='util.smartptr.shared.mod'>[util.smartptr.shared.mod]</a></h4><span class='indexparent'><a class='index' id='lib:swap,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,swap'></a></span><code class='itemdecl'>void swap(shared_ptr&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9975'>#</a></div><div id='shared.mod-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Exchanges the contents of <span class='texttt'>*this</span> and <span class='texttt'>r</span><a class='hidden_link' href='#shared.mod-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:reset,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,reset'></a></span><code class='itemdecl'>void reset() noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9984'>#</a></div><div id='shared.mod-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr().swap(*this)</span><a class='hidden_link' href='#shared.mod-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:reset,shared_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,reset_'></a></span><code class='itemdecl'>template&lt;class Y&gt; void reset(Y* p);
</code><div class='itemdescr'></div><div class='para' id='shared.mod-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.mod-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L9993'>#</a></div><div id='shared.mod-3.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr(p).swap(*this)</span><a class='hidden_link' href='#shared.mod-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:reset,shared_ptr__'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,reset__'></a></span><code class='itemdecl'>template&lt;class Y, class D&gt; void reset(Y* p, D d);
</code><div class='itemdescr'></div><div class='para' id='shared.mod-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.mod-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10002'>#</a></div><div id='shared.mod-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr(p, d).swap(*this)</span><a class='hidden_link' href='#shared.mod-4.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:reset,shared_ptr___'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,reset___'></a></span><code class='itemdecl'>template&lt;class Y, class D, class A&gt; void reset(Y* p, D d, A a);
</code><div class='itemdescr'></div><div class='para' id='shared.mod-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.mod-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10011'>#</a></div><div id='shared.mod-5.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>shared_&shy;ptr(p, d, a).swap(*this)</span><a class='hidden_link' href='#shared.mod-5.sentence-1'>.</a></div></div></div></div><div id='shared.obs' class='section'><h4 ><a class='secnum' href='#shared.obs' style='min-width:133pt'>23.11.2.2.5</a> <span class='texttt'>shared_&shy;ptr</span> observers <a class='abbr_ref' href='util.smartptr.shared.obs'>[util.smartptr.shared.obs]</a></h4><span class='indexparent'><a class='index' id='lib:get,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,get'></a></span><code class='itemdecl'>element_type* get() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10022'>#</a></div><div id='shared.obs-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> The stored pointer<a class='hidden_link' href='#shared.obs-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator*,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator*'></a></span><code class='itemdecl'>T&amp; operator*() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10031'>#</a></div><div id='shared.obs-2.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>get() != 0</span><a class='hidden_link' href='#shared.obs-2.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10033'>#</a></div><div id='shared.obs-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*get()</span><a class='hidden_link' href='#shared.obs-3.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10035'>#</a></div><div id='shared.obs-4.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is an array type or <span class='textit'>cv</span> <span class='texttt'>void</span>,
it is unspecified whether this
member function is declared<a class='hidden_link' href='#shared.obs-4.sentence-1'>.</a></div> <div id='shared.obs-4.sentence-2' class='sentence'>If it is declared, it is unspecified what its
return type is, except that the declaration (although not necessarily the
definition) of the function shall be well formed<a class='hidden_link' href='#shared.obs-4.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator->,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator->'></a></span><code class='itemdecl'>T* operator-&gt;() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10048'>#</a></div><div id='shared.obs-5.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>get() != 0</span><a class='hidden_link' href='#shared.obs-5.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10050'>#</a></div><div id='shared.obs-6.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get()</span><a class='hidden_link' href='#shared.obs-6.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10052'>#</a></div><div id='shared.obs-7.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is an array type,
it is unspecified whether this member function is declared<a class='hidden_link' href='#shared.obs-7.sentence-1'>.</a></div> <div id='shared.obs-7.sentence-2' class='sentence'>If it is declared, it is unspecified what its return type is,
except that the declaration (although not necessarily the definition)
of the function shall be well formed<a class='hidden_link' href='#shared.obs-7.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator[],shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator[]'></a></span><code class='itemdecl'>element_type&amp; operator[](ptrdiff_t i) const;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-8'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10065'>#</a></div><div id='shared.obs-8.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>get() != 0 &amp;&amp; i &gt;= 0</span><a class='hidden_link' href='#shared.obs-8.sentence-1'>.</a></div> <div id='shared.obs-8.sentence-2' class='sentence'>If <span class='texttt'>T</span> is <span class='texttt'>U[N]</span>, <span class='texttt'>i &lt; N</span><a class='hidden_link' href='#shared.obs-8.sentence-2'>.</a></div></div></div><div class='para' id='shared.obs-9'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10068'>#</a></div><div id='shared.obs-9.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get()[i]</span><a class='hidden_link' href='#shared.obs-9.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-10'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10070'>#</a></div><div id='shared.obs-10.sentence-1' class='sentence'><span class='textit'>Remarks:</span> When <span class='texttt'>T</span> is not an array type,
it is unspecified whether this member function is declared<a class='hidden_link' href='#shared.obs-10.sentence-1'>.</a></div> <div id='shared.obs-10.sentence-2' class='sentence'>If it is declared, it is unspecified what its return type is,
except that the declaration (although not necessarily the definition)
of the function shall be well formed<a class='hidden_link' href='#shared.obs-10.sentence-2'>.</a></div></div></div><div class='para' id='shared.obs-11'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10076'>#</a></div><div id='shared.obs-11.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.obs-11.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:use_count,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,use_count'></a></span><code class='itemdecl'>long use_count() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-12'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10085'>#</a></div><div id='shared.obs-12.sentence-1' class='sentence'><span class='textit'>Returns:</span> The number of <span class='texttt'>shared_&shy;ptr</span> objects, <span class='texttt'>*this</span> included,
that share ownership with <span class='texttt'>*this</span>, or <span class='texttt'>0</span> when <span class='texttt'>*this</span> is
empty<a class='hidden_link' href='#shared.obs-12.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-13'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10089'>#</a></div><div id='shared.obs-13.sentence-1' class='sentence'><span class='textit'>Synchronization:</span> None<a class='hidden_link' href='#shared.obs-13.sentence-1'>.</a></div></div></div><div class='para' id='shared.obs-14'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10091'>#</a></div><div id='shared.obs-14.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.obs-14.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.obs-14.sentence-1' class='sentence'><span class='texttt'>get() == nullptr</span>
does not imply a specific return value of <span class='texttt'>use_&shy;count()</span><a class='hidden_link' href='#shared.obs-14.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='shared.obs-15'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10094'>#</a></div><div id='shared.obs-15.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.obs-15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.obs-15.sentence-1' class='sentence'><span class='texttt'>weak_&shy;ptr&lt;T&gt;&#x200b;::&#x200b;lock()</span>
can affect the return value of <span class='texttt'>use_&shy;count()</span><a class='hidden_link' href='#shared.obs-15.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='shared.obs-16'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10097'>#</a></div><div id='shared.obs-16.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.obs-16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.obs-16.sentence-1' class='sentence'>When multiple threads
can affect the return value of <span class='texttt'>use_&shy;count()</span>,
the result should be treated as approximate<a class='hidden_link' href='#shared.obs-16.sentence-1'>.</a></div> <div id='shared.obs-16.sentence-2' class='sentence'>In particular, <span class='texttt'>use_&shy;count() == 1</span> does not imply that accesses through
a previously destroyed <span class='texttt'>shared_&shy;ptr</span> have in any sense completed<a class='hidden_link' href='#shared.obs-16.sentence-2'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:operator_bool,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator_bool'></a></span><code class='itemdecl'>explicit operator bool() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-17'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10110'>#</a></div><div id='shared.obs-17.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>get() != 0</span><a class='hidden_link' href='#shared.obs-17.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:owner_before,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,owner_before'></a></span><code class='itemdecl'>template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const noexcept;
template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.obs-18'><div class='marginalizedparent'><a class='marginalized' href='#shared.obs-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10120'>#</a></div><div id='shared.obs-18.sentence-1' class='sentence'><span class='textit'>Returns:</span> An unspecified value such that</div><div id='shared.obs-18.sentence-2' class='sentence'><ul class='itemize'><li id='shared.obs-18.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.obs-18.1'>(18.1)</a></div><div id='shared.obs-18.1.sentence-1' class='sentence'><span class='texttt'>x.owner_&shy;before(y)</span> defines a strict weak ordering as defined in <a href='alg.sorting'>[alg.sorting]</a>;</div></li><li id='shared.obs-18.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.obs-18.2'>(18.2)</a></div><div id='shared.obs-18.2.sentence-1' class='sentence'>under the equivalence relation defined by <span class='texttt'>owner_&shy;before</span>,
<span class='texttt'>!a.owner_&shy;before(b) &amp;&amp; !b.owner_&shy;before(a)</span>, two <span class='texttt'>shared_&shy;ptr</span> or
<span class='texttt'>weak_&shy;ptr</span> instances are equivalent if and only if they share ownership or
are both empty<a class='hidden_link' href='#shared.obs-18.2.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='shared.create' class='section'><h4 ><a class='secnum' href='#shared.create' style='min-width:133pt'>23.11.2.2.6</a> <span class='texttt'>shared_&shy;ptr</span> creation <a class='abbr_ref' href='util.smartptr.shared.create'>[util.smartptr.shared.create]</a></h4><span class='indexparent'><a class='index' id='lib:make_shared'></a></span><span class='indexparent'><a class='index' id='lib:allocate_shared'></a></span><code class='itemdecl'>template&lt;class T, class... Args&gt;
  shared_ptr&lt;T&gt; make_shared(Args&amp;&amp;... args);
template&lt;class T, class A, class... Args&gt;
  shared_ptr&lt;T&gt; allocate_shared(const A&amp; a, Args&amp;&amp;... args);
</code><div class='itemdescr'></div><div class='para' id='shared.create-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10147'>#</a></div><div id='shared.create-1.sentence-1' class='sentence'><span class='textit'>Requires:</span> The expression <span class='texttt'>&#x200b;::&#x200b;new (pv) T(std&#x200b;::&#x200b;forward&lt;Args&gt;(args)...)</span>,
where <span class='texttt'>pv</span> has type <span class='texttt'>void*</span> and points to storage suitable
to hold an object of type <span class='texttt'>T</span>, shall be well formed<a class='hidden_link' href='#shared.create-1.sentence-1'>.</a></div> <div id='shared.create-1.sentence-2' class='sentence'><span class='texttt'>A</span> shall
be an allocator (<a href='allocator.requirements'>[allocator.requirements]</a>)<a class='hidden_link' href='#shared.create-1.sentence-2'>.</a></div> <div id='shared.create-1.sentence-3' class='sentence'>The copy constructor
and destructor of <span class='texttt'>A</span> shall not throw exceptions<a class='hidden_link' href='#shared.create-1.sentence-3'>.</a></div></div></div><div class='para' id='shared.create-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10154'>#</a></div><div id='shared.create-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Allocates memory suitable for an object of type <span class='texttt'>T</span>
and constructs an object in that memory via the placement
<i ><a href='expr.new#nt:new-expression'>new-expression</a></i>
<span class='texttt'>&#x200b;::&#x200b;new (pv) T(std&#x200b;::&#x200b;forward&lt;Args&gt;(args)...)</span><a class='hidden_link' href='#shared.create-2.sentence-1'>.</a></div> <div id='shared.create-2.sentence-2' class='sentence'>The template <span class='texttt'>allocate_&shy;shared</span> uses a copy of <span class='texttt'>a</span> to
allocate memory<a class='hidden_link' href='#shared.create-2.sentence-2'>.</a></div> <div id='shared.create-2.sentence-3' class='sentence'>If an exception is thrown, the functions have no effect<a class='hidden_link' href='#shared.create-2.sentence-3'>.</a></div></div></div><div class='para' id='shared.create-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10162'>#</a></div><div id='shared.create-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> A <span class='texttt'>shared_&shy;ptr</span> instance that stores and owns
the address of the newly constructed object of type <span class='texttt'>T</span><a class='hidden_link' href='#shared.create-3.sentence-1'>.</a></div></div></div><div class='para' id='shared.create-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10166'>#</a></div><div id='shared.create-4.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>get() != 0 &amp;&amp; use_&shy;count() == 1</span><a class='hidden_link' href='#shared.create-4.sentence-1'>.</a></div></div></div><div class='para' id='shared.create-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10169'>#</a></div><div id='shared.create-5.sentence-1' class='sentence'><span class='textit'>Throws:</span> <span class='texttt'>bad_&shy;alloc</span>, or an exception thrown from
<span class='texttt'>A&#x200b;::&#x200b;allocate</span> or from the constructor of <span class='texttt'>T</span><a class='hidden_link' href='#shared.create-5.sentence-1'>.</a></div></div></div><div class='para' id='shared.create-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10173'>#</a></div><div id='shared.create-6.sentence-1' class='sentence'><span class='textit'>Remarks:</span> The <span class='texttt'>shared_&shy;ptr</span> constructor called by this function
enables <span class='texttt'>shared_&shy;from_&shy;this</span> with the address
of the newly constructed object of type <span class='texttt'>T</span><a class='hidden_link' href='#shared.create-6.sentence-1'>.</a></div> <div id='shared.create-6.sentence-2' class='sentence'>Implementations should
perform no more than one memory allocation<a class='hidden_link' href='#shared.create-6.sentence-2'>.</a></div> <div id='shared.create-6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.create-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.create-6.sentence-3' class='sentence'>This provides
efficiency equivalent to an intrusive smart pointer<a class='hidden_link' href='#shared.create-6.sentence-3'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div class='para' id='shared.create-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.create-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10181'>#</a></div><div id='shared.create-7.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.create-7.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.create-7.sentence-1' class='sentence'>These functions will typically allocate more memory
than <span class='texttt'>sizeof(T)</span> to allow for internal bookkeeping structures such
as the reference counts<a class='hidden_link' href='#shared.create-7.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='shared.cmp' class='section'><h4 ><a class='secnum' href='#shared.cmp' style='min-width:133pt'>23.11.2.2.7</a> <span class='texttt'>shared_&shy;ptr</span> comparison <a class='abbr_ref' href='util.smartptr.shared.cmp'>[util.smartptr.shared.cmp]</a></h4><span class='indexparent'><a class='index' id='lib:operator==,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator=='></a></span><code class='itemdecl'>template&lt;class T, class U&gt;
  bool operator==(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10196'>#</a></div><div id='shared.cmp-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>a.get() == b.get()</span><a class='hidden_link' href='#shared.cmp-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator<,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator<'></a></span><code class='itemdecl'>template&lt;class T, class U&gt;
  bool operator&lt;(const shared_ptr&lt;T&gt;&amp; a, const shared_ptr&lt;U&gt;&amp; b) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10207'>#</a></div><div id='shared.cmp-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>less&lt;&gt;()(a.get(), b.get())</span><a class='hidden_link' href='#shared.cmp-2.sentence-1'>.</a></div></div></div><div class='para' id='shared.cmp-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10210'>#</a></div><div id='shared.cmp-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.cmp-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.cmp-3.sentence-1' class='sentence'>Defining a comparison function allows <span class='texttt'>shared_&shy;ptr</span> objects to be
used as keys in associative containers<a class='hidden_link' href='#shared.cmp-3.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:operator==,shared_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator==_'></a></span><code class='itemdecl'>template &lt;class T&gt;
  bool operator==(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
template &lt;class T&gt;
  bool operator==(nullptr_t, const shared_ptr&lt;T&gt;&amp; a) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10226'>#</a></div><div id='shared.cmp-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>!a</span><a class='hidden_link' href='#shared.cmp-4.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator!=,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator!='></a></span><code class='itemdecl'>template &lt;class T&gt;
  bool operator!=(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
template &lt;class T&gt;
  bool operator!=(nullptr_t, const shared_ptr&lt;T&gt;&amp; a) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10239'>#</a></div><div id='shared.cmp-5.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>(bool)a</span><a class='hidden_link' href='#shared.cmp-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator<,shared_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator<_'></a></span><code class='itemdecl'>template &lt;class T&gt;
  bool operator&lt;(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
template &lt;class T&gt;
  bool operator&lt;(nullptr_t, const shared_ptr&lt;T&gt;&amp; a) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10252'>#</a></div><div id='shared.cmp-6.sentence-1' class='sentence'><span class='textit'>Returns:</span>
The first function template returns
<span class='texttt'>less&lt;shared_&shy;ptr&lt;T&gt;&#x200b;::&#x200b;element_&shy;type*&gt;()(a.get(), nullptr)</span><a class='hidden_link' href='#shared.cmp-6.sentence-1'>.</a></div> <div id='shared.cmp-6.sentence-2' class='sentence'>The second function template returns
<span class='texttt'>less&lt;shared_&shy;ptr&lt;T&gt;&#x200b;::&#x200b;element_&shy;type*&gt;()(nullptr, a.get())</span><a class='hidden_link' href='#shared.cmp-6.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator>,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator>'></a></span><code class='itemdecl'>template &lt;class T&gt;
  bool operator&gt;(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
template &lt;class T&gt;
  bool operator&gt;(nullptr_t, const shared_ptr&lt;T&gt;&amp; a) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10269'>#</a></div><div id='shared.cmp-7.sentence-1' class='sentence'><span class='textit'>Returns:</span>
The first function template returns <span class='texttt'>nullptr &lt; a</span><a class='hidden_link' href='#shared.cmp-7.sentence-1'>.</a></div> <div id='shared.cmp-7.sentence-2' class='sentence'>The second function template returns <span class='texttt'>a &lt; nullptr</span><a class='hidden_link' href='#shared.cmp-7.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator<=,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator<='></a></span><code class='itemdecl'>template &lt;class T&gt;
  bool operator&lt;=(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
template &lt;class T&gt;
  bool operator&lt;=(nullptr_t, const shared_ptr&lt;T&gt;&amp; a) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-8'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10284'>#</a></div><div id='shared.cmp-8.sentence-1' class='sentence'><span class='textit'>Returns:</span>
The first function template returns <span class='texttt'>!(nullptr &lt; a)</span><a class='hidden_link' href='#shared.cmp-8.sentence-1'>.</a></div> <div id='shared.cmp-8.sentence-2' class='sentence'>The second function template returns <span class='texttt'>!(a &lt; nullptr)</span><a class='hidden_link' href='#shared.cmp-8.sentence-2'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator>=,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator>='></a></span><code class='itemdecl'>template &lt;class T&gt;
  bool operator&gt;=(const shared_ptr&lt;T&gt;&amp; a, nullptr_t) noexcept;
template &lt;class T&gt;
  bool operator&gt;=(nullptr_t, const shared_ptr&lt;T&gt;&amp; a) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cmp-9'><div class='marginalizedparent'><a class='marginalized' href='#shared.cmp-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10299'>#</a></div><div id='shared.cmp-9.sentence-1' class='sentence'><span class='textit'>Returns:</span>
The first function template returns <span class='texttt'>!(a &lt; nullptr)</span><a class='hidden_link' href='#shared.cmp-9.sentence-1'>.</a></div> <div id='shared.cmp-9.sentence-2' class='sentence'>The second function template returns <span class='texttt'>!(nullptr &lt; a)</span><a class='hidden_link' href='#shared.cmp-9.sentence-2'>.</a></div></div></div></div><div id='shared.spec' class='section'><h4 ><a class='secnum' href='#shared.spec' style='min-width:133pt'>23.11.2.2.8</a> <span class='texttt'>shared_&shy;ptr</span> specialized algorithms <a class='abbr_ref' href='util.smartptr.shared.spec'>[util.smartptr.shared.spec]</a></h4><span class='indexparent'><a class='index' id='lib:swap,shared_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,swap_'></a></span><code class='itemdecl'>template&lt;class T&gt;
  void swap(shared_ptr&lt;T&gt;&amp; a, shared_ptr&lt;T&gt;&amp; b) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.spec-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.spec-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10314'>#</a></div><div id='shared.spec-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>a.swap(b)</span><a class='hidden_link' href='#shared.spec-1.sentence-1'>.</a></div></div></div></div><div id='shared.cast' class='section'><h4 ><a class='secnum' href='#shared.cast' style='min-width:133pt'>23.11.2.2.9</a> <span class='texttt'>shared_&shy;ptr</span> casts <a class='abbr_ref' href='util.smartptr.shared.cast'>[util.smartptr.shared.cast]</a></h4><span class='indexparent'><a class='index' id='lib:static_pointer_cast,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,static_pointer_cast'></a></span><code class='itemdecl'>template&lt;class T, class U&gt;
  shared_ptr&lt;T&gt; static_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cast-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10326'>#</a></div><div id='shared.cast-1.sentence-1' class='sentence'><span class='textit'>Requires:</span> The expression <span class='texttt'>static_&shy;cast&lt;T*&gt;((U*)nullptr)</span> shall
be well formed<a class='hidden_link' href='#shared.cast-1.sentence-1'>.</a></div></div></div><div class='para' id='shared.cast-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10330'>#</a></div><div id='shared.cast-2.sentence-1' class='sentence'><span class='textit'>Returns:</span>
<pre class='codeblock'>
shared_ptr&lt;T&gt;(r, static_cast&lt;typename shared_ptr&lt;T&gt;::element_type*&gt;(r.get()))</pre></div></div></div><div class='para' id='shared.cast-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10336'>#</a></div><div id='shared.cast-3.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.cast-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.cast-3.sentence-1' class='sentence'>The seemingly equivalent expression
<span class='texttt'>shared_&shy;ptr&lt;T&gt;(static_&shy;cast&lt;T*&gt;(r.get()))</span>
will eventually result in undefined behavior, attempting to delete the
same object twice<a class='hidden_link' href='#shared.cast-3.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:dynamic_pointer_cast,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,dynamic_pointer_cast'></a></span><code class='itemdecl'>template&lt;class T, class U&gt;
  shared_ptr&lt;T&gt; dynamic_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cast-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10352'>#</a></div><div id='shared.cast-4.sentence-1' class='sentence'><span class='textit'>Requires:</span> The expression <span class='texttt'>dynamic_&shy;cast&lt;T*&gt;((U*)nullptr)</span>
shall be well formed and shall have well defined behavior<a class='hidden_link' href='#shared.cast-4.sentence-1'>.</a></div></div></div><div class='para' id='shared.cast-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10356'>#</a></div><div id='shared.cast-5.sentence-1' class='sentence'><span class='textit'>Returns:</span>
<ul class='itemize'><li id='shared.cast-5.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.cast-5.1'>(5.1)</a></div><div id='shared.cast-5.1.sentence-1' class='sentence'>When <span class='texttt'>dynamic_&shy;cast&lt;typename shared_&shy;ptr&lt;T&gt;&#x200b;::&#x200b;element_&shy;type*&gt;(r.get())</span>
returns a non-null value <span class='texttt'>p</span>, <span class='texttt'>shared_&shy;ptr&lt;T&gt;(r, p)</span><a class='hidden_link' href='#shared.cast-5.1.sentence-1'>.</a></div></li><li id='shared.cast-5.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#shared.cast-5.2'>(5.2)</a></div><div id='shared.cast-5.2.sentence-1' class='sentence'>Otherwise, <span class='texttt'>shared_&shy;ptr&lt;T&gt;()</span><a class='hidden_link' href='#shared.cast-5.2.sentence-1'>.</a></div></li></ul></div></div></div><div class='para' id='shared.cast-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10364'>#</a></div><div id='shared.cast-6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.cast-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.cast-6.sentence-1' class='sentence'>The seemingly equivalent expression
<span class='texttt'>shared_&shy;ptr&lt;T&gt;(dynamic_&shy;cast&lt;T*&gt;(r.get()))</span> will eventually result in
undefined behavior, attempting to delete the same object twice<a class='hidden_link' href='#shared.cast-6.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:const_pointer_cast,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,const_pointer_cast'></a></span><code class='itemdecl'>template&lt;class T, class U&gt;
  shared_ptr&lt;T&gt; const_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cast-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10379'>#</a></div><div id='shared.cast-7.sentence-1' class='sentence'><span class='textit'>Requires:</span> The expression <span class='texttt'>const_&shy;cast&lt;T*&gt;((U*)nullptr)</span> shall
be well formed<a class='hidden_link' href='#shared.cast-7.sentence-1'>.</a></div></div></div><div class='para' id='shared.cast-8'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10383'>#</a></div><div id='shared.cast-8.sentence-1' class='sentence'><span class='textit'>Returns:</span>
<pre class='codeblock'>
shared_ptr&lt;T&gt;(r, const_cast&lt;typename shared_ptr&lt;T&gt;::element_type*&gt;(r.get()))</pre></div></div></div><div class='para' id='shared.cast-9'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10389'>#</a></div><div id='shared.cast-9.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.cast-9.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.cast-9.sentence-1' class='sentence'>The seemingly equivalent expression
<span class='texttt'>shared_&shy;ptr&lt;T&gt;(const_&shy;cast&lt;T*&gt;(r.get()))</span> will eventually result in
undefined behavior, attempting to delete the same object twice<a class='hidden_link' href='#shared.cast-9.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:reinterpret_pointer_cast,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,reinterpret_pointer_cast'></a></span><code class='itemdecl'>template&lt;class T, class U&gt;
  shared_ptr&lt;T&gt; reinterpret_pointer_cast(const shared_ptr&lt;U&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='shared.cast-10'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10404'>#</a></div><div id='shared.cast-10.sentence-1' class='sentence'><span class='textit'>Requires:</span> The expression <span class='texttt'>reinterpret_&shy;cast&lt;T*&gt;((U*)nullptr)</span>
shall be well formed<a class='hidden_link' href='#shared.cast-10.sentence-1'>.</a></div></div></div><div class='para' id='shared.cast-11'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10408'>#</a></div><div id='shared.cast-11.sentence-1' class='sentence'><span class='textit'>Returns:</span>
<pre class='codeblock'>
shared_ptr&lt;T&gt;(r, reinterpret_cast&lt;typename shared_ptr&lt;T&gt;::element_type*&gt;(r.get()))</pre></div></div></div><div class='para' id='shared.cast-12'><div class='marginalizedparent'><a class='marginalized' href='#shared.cast-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10413'>#</a></div><div id='shared.cast-12.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#shared.cast-12.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='shared.cast-12.sentence-1' class='sentence'>The seemingly equivalent expression
<span class='texttt'>shared_&shy;ptr&lt;T&gt;(reinterpret_&shy;cast&lt;T*&gt;(r.get()))</span> will eventually result in
undefined behavior, attempting to delete the same object twice<a class='hidden_link' href='#shared.cast-12.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='getdeleter' class='section'><h4 ><a class='secnum' href='#getdeleter' style='min-width:133pt'>23.11.2.2.10</a> <span class='texttt'>get_&shy;deleter</span> <a class='abbr_ref' href='util.smartptr.getdeleter'>[util.smartptr.getdeleter]</a></h4><span class='indexparent'><a class='index' id='lib:get_deleter,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,get_deleter'></a></span><code class='itemdecl'>template&lt;class D, class T&gt;
  D* get_deleter(const shared_ptr&lt;T&gt;&amp; p) noexcept;
</code><div class='itemdescr'></div><div class='para' id='getdeleter-1'><div class='marginalizedparent'><a class='marginalized' href='#getdeleter-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10430'>#</a></div><div id='getdeleter-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> If <span class='texttt'>p</span> owns a deleter <span class='texttt'>d</span> of type cv-unqualified
<span class='texttt'>D</span>, returns <span class='texttt'>addressof(d)</span>; otherwise returns <span class='texttt'>nullptr</span><a class='hidden_link' href='#getdeleter-1.sentence-1'>.</a></div> <div id='getdeleter-1.sentence-2' class='sentence'>The returned
pointer remains valid as long as there exists a <span class='texttt'>shared_&shy;ptr</span> instance
that owns <span class='texttt'>d</span><a class='hidden_link' href='#getdeleter-1.sentence-2'>.</a></div> <div id='getdeleter-1.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#getdeleter-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='getdeleter-1.sentence-3' class='sentence'>It is unspecified whether the pointer
remains valid longer than that<a class='hidden_link' href='#getdeleter-1.sentence-3'>.</a></div> <div id='getdeleter-1.sentence-4' class='sentence'>This can happen if the implementation doesn't destroy
the deleter until all <span class='texttt'>weak_&shy;ptr</span> instances that share ownership with
<span class='texttt'>p</span> have been destroyed<a class='hidden_link' href='#getdeleter-1.sentence-4'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div></div><div id='shared.io' class='section'><h4 ><a class='secnum' href='#shared.io' style='min-width:133pt'>23.11.2.2.11</a> <span class='texttt'>shared_&shy;ptr</span> I/O <a class='abbr_ref' href='util.smartptr.shared.io'>[util.smartptr.shared.io]</a></h4><span class='indexparent'><a class='index' id='lib:operator<<,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,operator<<'></a></span><code class='itemdecl'>template&lt;class E, class T, class Y&gt;
  basic_ostream&lt;E, T&gt;&amp; operator&lt;&lt; (basic_ostream&lt;E, T&gt;&amp; os, const shared_ptr&lt;Y&gt;&amp; p);
</code><div class='itemdescr'></div><div class='para' id='shared.io-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.io-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10449'>#</a></div><div id='shared.io-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by: <span class='texttt'>os &lt;&lt; p.get();</span></div></div></div><div class='para' id='shared.io-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.io-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10451'>#</a></div><div id='shared.io-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>os</span><a class='hidden_link' href='#shared.io-2.sentence-1'>.</a></div></div></div></div></div><div id='weak' class='section'><h4 ><a class='secnum' href='#weak' style='min-width:118pt'>23.11.2.3</a> Class template <span class='texttt'>weak_&shy;ptr</span> <a class='abbr_ref' href='util.smartptr.weak'>[util.smartptr.weak]</a></h4><div class='para' id='weak-1'><div class='marginalizedparent'><a class='marginalized' href='#weak-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10456'>#</a></div><div id='weak-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:weak_ptr_'></a></span>The <span class='texttt'>weak_&shy;ptr</span> class template stores a weak reference to an object
that is already managed by a <span class='texttt'>shared_&shy;ptr</span><a class='hidden_link' href='#weak-1.sentence-1'>.</a></div> <div id='weak-1.sentence-2' class='sentence'>To access the object, a
<span class='texttt'>weak_&shy;ptr</span> can be converted to a <span class='texttt'>shared_&shy;ptr</span> using the member
function <span class='texttt'>lock</span><a class='hidden_link' href='#weak-1.sentence-2'>.</a></div><pre class='codeblock'>
namespace std {
  template&lt;class T&gt; class weak_ptr {
  public:
    using element_type = T;

    <span class='comment'>// <a href='util.smartptr.weak.const'>[util.smartptr.weak.const]</a>, constructors
</span>    constexpr weak_ptr() noexcept;
    template&lt;class Y&gt; weak_ptr(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
    weak_ptr(const weak_ptr&amp; r) noexcept;
    template&lt;class Y&gt; weak_ptr(const weak_ptr&lt;Y&gt;&amp; r) noexcept;
    weak_ptr(weak_ptr&amp;&amp; r) noexcept;
    template&lt;class Y&gt; weak_ptr(weak_ptr&lt;Y&gt;&amp;&amp; r) noexcept;

    <span class='comment'>// <a href='util.smartptr.weak.dest'>[util.smartptr.weak.dest]</a>, destructor
</span>    ~weak_ptr();

    <span class='comment'>// <a href='util.smartptr.weak.assign'>[util.smartptr.weak.assign]</a>, assignment
</span>    weak_ptr&amp; operator=(const weak_ptr&amp; r) noexcept;
    template&lt;class Y&gt; weak_ptr&amp; operator=(const weak_ptr&lt;Y&gt;&amp; r) noexcept;
    template&lt;class Y&gt; weak_ptr&amp; operator=(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
    weak_ptr&amp; operator=(weak_ptr&amp;&amp; r) noexcept;
    template&lt;class Y&gt; weak_ptr&amp; operator=(weak_ptr&lt;Y&gt;&amp;&amp; r) noexcept;

    <span class='comment'>// <a href='util.smartptr.weak.mod'>[util.smartptr.weak.mod]</a>, modifiers
</span>    void swap(weak_ptr&amp; r) noexcept;
    void reset() noexcept;

    <span class='comment'>// <a href='util.smartptr.weak.obs'>[util.smartptr.weak.obs]</a>, observers
</span>    long use_count() const noexcept;
    bool expired() const noexcept;
    shared_ptr&lt;T&gt; lock() const noexcept;
    template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const;
    template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const;
  };

  template&lt;class T&gt; weak_ptr(shared_ptr&lt;T&gt;) -&gt; weak_ptr&lt;T&gt;;


  <span class='comment'>// <a href='util.smartptr.weak.spec'>[util.smartptr.weak.spec]</a>, specialized algorithms
</span>  template&lt;class T&gt; void swap(weak_ptr&lt;T&gt;&amp; a, weak_ptr&lt;T&gt;&amp; b) noexcept;
}</pre></div><div class='para' id='weak-2'><div class='marginalizedparent'><a class='marginalized' href='#weak-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10507'>#</a></div><div id='weak-2.sentence-1' class='sentence'>Specializations of <span class='texttt'>weak_&shy;ptr</span> shall be <span class='texttt'>CopyConstructible</span> and
<span class='texttt'>CopyAssignable</span>, allowing their use in standard
containers<a class='hidden_link' href='#weak-2.sentence-1'>.</a></div> <div id='weak-2.sentence-2' class='sentence'>The template parameter <span class='texttt'>T</span> of <span class='texttt'>weak_&shy;ptr</span> may be an
incomplete type<a class='hidden_link' href='#weak-2.sentence-2'>.</a></div></div><div id='weak.const' class='section'><h4 ><a class='secnum' href='#weak.const' style='min-width:133pt'>23.11.2.3.1</a> <span class='texttt'>weak_&shy;ptr</span> constructors <a class='abbr_ref' href='util.smartptr.weak.const'>[util.smartptr.weak.const]</a></h4><span class='indexparent'><a class='index' id='lib:weak_ptr,constructor'></a></span><code class='itemdecl'>constexpr weak_ptr() noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.const-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10521'>#</a></div><div id='weak.const-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Constructs an empty <span class='texttt'>weak_&shy;ptr</span> object<a class='hidden_link' href='#weak.const-1.sentence-1'>.</a></div></div></div><div class='para' id='weak.const-2'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10523'>#</a></div><div id='weak.const-2.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>use_&shy;count() == 0</span><a class='hidden_link' href='#weak.const-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:weak_ptr,constructor_'></a></span><code class='itemdecl'>weak_ptr(const weak_ptr&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(const weak_ptr&lt;Y&gt;&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.const-3'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10534'>#</a></div><div id='weak.const-3.sentence-1' class='sentence'><span class='textit'>Remarks:</span> The second and third constructors shall not participate in
overload resolution unless <span class='texttt'>Y*</span> is compatible with <span class='texttt'>T*</span><a class='hidden_link' href='#weak.const-3.sentence-1'>.</a></div></div></div><div class='para' id='weak.const-4'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10537'>#</a></div><div id='weak.const-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>r</span> is empty, constructs
an empty <span class='texttt'>weak_&shy;ptr</span> object; otherwise, constructs
a <span class='texttt'>weak_&shy;ptr</span> object that shares ownership
with <span class='texttt'>r</span> and stores a copy of the pointer stored in <span class='texttt'>r</span><a class='hidden_link' href='#weak.const-4.sentence-1'>.</a></div></div></div><div class='para' id='weak.const-5'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10542'>#</a></div><div id='weak.const-5.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>use_&shy;count() == r.use_&shy;count()</span><a class='hidden_link' href='#weak.const-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:weak_ptr,constructor__'></a></span><code class='itemdecl'>weak_ptr(weak_ptr&amp;&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr(weak_ptr&lt;Y&gt;&amp;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.const-6'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10552'>#</a></div><div id='weak.const-6.sentence-1' class='sentence'><span class='textit'>Remarks:</span> The second constructor shall not participate in overload resolution unless
<span class='texttt'>Y*</span> is compatible with <span class='texttt'>T*</span><a class='hidden_link' href='#weak.const-6.sentence-1'>.</a></div></div></div><div class='para' id='weak.const-7'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10555'>#</a></div><div id='weak.const-7.sentence-1' class='sentence'><span class='textit'>Effects:</span> Move constructs a <span class='texttt'>weak_&shy;ptr</span> instance from <span class='texttt'>r</span><a class='hidden_link' href='#weak.const-7.sentence-1'>.</a></div></div></div><div class='para' id='weak.const-8'><div class='marginalizedparent'><a class='marginalized' href='#weak.const-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10557'>#</a></div><div id='weak.const-8.sentence-1' class='sentence'><span class='textit'>Postconditions:</span> <span class='texttt'>*this</span> shall contain the old value of <span class='texttt'>r</span><a class='hidden_link' href='#weak.const-8.sentence-1'>.</a></div> <div id='weak.const-8.sentence-2' class='sentence'><span class='texttt'>r</span> shall be empty<a class='hidden_link' href='#weak.const-8.sentence-2'>.</a></div> <div id='weak.const-8.sentence-3' class='sentence'><span class='texttt'>r.use_&shy;count() == 0</span><a class='hidden_link' href='#weak.const-8.sentence-3'>.</a></div></div></div></div><div id='weak.dest' class='section'><h4 ><a class='secnum' href='#weak.dest' style='min-width:133pt'>23.11.2.3.2</a> <span class='texttt'>weak_&shy;ptr</span> destructor <a class='abbr_ref' href='util.smartptr.weak.dest'>[util.smartptr.weak.dest]</a></h4><span class='indexparent'><a class='index' id='lib:weak_ptr,destructor'></a></span><code class='itemdecl'>~weak_ptr();
</code><div class='itemdescr'></div><div class='para' id='weak.dest-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.dest-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10569'>#</a></div><div id='weak.dest-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Destroys this <span class='texttt'>weak_&shy;ptr</span> object but has no
effect on the object its stored pointer points to<a class='hidden_link' href='#weak.dest-1.sentence-1'>.</a></div></div></div></div><div id='weak.assign' class='section'><h4 ><a class='secnum' href='#weak.assign' style='min-width:133pt'>23.11.2.3.3</a> <span class='texttt'>weak_&shy;ptr</span> assignment <a class='abbr_ref' href='util.smartptr.weak.assign'>[util.smartptr.weak.assign]</a></h4><span class='indexparent'><a class='index' id='lib:operator=,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,operator='></a></span><code class='itemdecl'>weak_ptr&amp; operator=(const weak_ptr&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr&amp; operator=(const weak_ptr&lt;Y&gt;&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr&amp; operator=(const shared_ptr&lt;Y&gt;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.assign-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.assign-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10583'>#</a></div><div id='weak.assign-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>weak_&shy;ptr(r).swap(*this)</span><a class='hidden_link' href='#weak.assign-1.sentence-1'>.</a></div></div></div><div class='para' id='weak.assign-2'><div class='marginalizedparent'><a class='marginalized' href='#weak.assign-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10585'>#</a></div><div id='weak.assign-2.sentence-1' class='sentence'><span class='textit'>Remarks:</span> The implementation may meet the effects (and the
implied guarantees) via different means, without creating a temporary<a class='hidden_link' href='#weak.assign-2.sentence-1'>.</a></div></div></div><div class='para' id='weak.assign-3'><div class='marginalizedparent'><a class='marginalized' href='#weak.assign-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10588'>#</a></div><div id='weak.assign-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#weak.assign-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,weak_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,operator=_'></a></span><code class='itemdecl'>weak_ptr&amp; operator=(weak_ptr&amp;&amp; r) noexcept;
template&lt;class Y&gt; weak_ptr&amp; operator=(weak_ptr&lt;Y&gt;&amp;&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.assign-4'><div class='marginalizedparent'><a class='marginalized' href='#weak.assign-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10598'>#</a></div><div id='weak.assign-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>weak_&shy;ptr(std&#x200b;::&#x200b;move(r)).swap(*this)</span><a class='hidden_link' href='#weak.assign-4.sentence-1'>.</a></div></div></div><div class='para' id='weak.assign-5'><div class='marginalizedparent'><a class='marginalized' href='#weak.assign-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10600'>#</a></div><div id='weak.assign-5.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#weak.assign-5.sentence-1'>.</a></div></div></div></div><div id='weak.mod' class='section'><h4 ><a class='secnum' href='#weak.mod' style='min-width:133pt'>23.11.2.3.4</a> <span class='texttt'>weak_&shy;ptr</span> modifiers <a class='abbr_ref' href='util.smartptr.weak.mod'>[util.smartptr.weak.mod]</a></h4><span class='indexparent'><a class='index' id='lib:swap,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,swap'></a></span><code class='itemdecl'>void swap(weak_ptr&amp; r) noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10610'>#</a></div><div id='weak.mod-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Exchanges the contents of <span class='texttt'>*this</span> and <span class='texttt'>r</span><a class='hidden_link' href='#weak.mod-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:reset,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,reset'></a></span><code class='itemdecl'>void reset() noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#weak.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10619'>#</a></div><div id='weak.mod-2.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>weak_&shy;ptr().swap(*this)</span><a class='hidden_link' href='#weak.mod-2.sentence-1'>.</a></div></div></div></div><div id='weak.obs' class='section'><h4 ><a class='secnum' href='#weak.obs' style='min-width:133pt'>23.11.2.3.5</a> <span class='texttt'>weak_&shy;ptr</span> observers <a class='abbr_ref' href='util.smartptr.weak.obs'>[util.smartptr.weak.obs]</a></h4><span class='indexparent'><a class='index' id='lib:use_count,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,use_count'></a></span><code class='itemdecl'>long use_count() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.obs-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.obs-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10629'>#</a></div><div id='weak.obs-1.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>0</span> if <span class='texttt'>*this</span> is empty;
otherwise, the number of <span class='texttt'>shared_&shy;ptr</span> instances
that share ownership with <span class='texttt'>*this</span><a class='hidden_link' href='#weak.obs-1.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:expired,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,expired'></a></span><code class='itemdecl'>bool expired() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.obs-2'><div class='marginalizedparent'><a class='marginalized' href='#weak.obs-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10640'>#</a></div><div id='weak.obs-2.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>use_&shy;count() == 0</span><a class='hidden_link' href='#weak.obs-2.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:lock,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,lock'></a></span><code class='itemdecl'>shared_ptr&lt;T&gt; lock() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.obs-3'><div class='marginalizedparent'><a class='marginalized' href='#weak.obs-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10649'>#</a></div><div id='weak.obs-3.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>expired() ?&nbsp;shared_&shy;ptr&lt;T&gt;() :&nbsp;shared_&shy;ptr&lt;T&gt;(*this)</span>, executed atomically<a class='hidden_link' href='#weak.obs-3.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:owner_before,weak_ptr'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,owner_before'></a></span><code class='itemdecl'>template&lt;class U&gt; bool owner_before(const shared_ptr&lt;U&gt;&amp; b) const;
template&lt;class U&gt; bool owner_before(const weak_ptr&lt;U&gt;&amp; b) const;
</code><div class='itemdescr'></div><div class='para' id='weak.obs-4'><div class='marginalizedparent'><a class='marginalized' href='#weak.obs-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10660'>#</a></div><div id='weak.obs-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> An unspecified value such that</div><div id='weak.obs-4.sentence-2' class='sentence'><ul class='itemize'><li id='weak.obs-4.1'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#weak.obs-4.1'>(4.1)</a></div><div id='weak.obs-4.1.sentence-1' class='sentence'><span class='texttt'>x.owner_&shy;before(y)</span> defines a strict weak ordering as defined in <a href='alg.sorting'>[alg.sorting]</a>;</div></li><li id='weak.obs-4.2'><div class='marginalizedparent' style='left:-10em'><a class='marginalized' href='#weak.obs-4.2'>(4.2)</a></div><div id='weak.obs-4.2.sentence-1' class='sentence'>under the equivalence relation defined by <span class='texttt'>owner_&shy;before</span>,
<span class='texttt'>!a.owner_&shy;before(b) &amp;&amp; !b.owner_&shy;before(a)</span>, two <span class='texttt'>shared_&shy;ptr</span> or
<span class='texttt'>weak_&shy;ptr</span> instances are equivalent if and only if they share ownership or are
both empty<a class='hidden_link' href='#weak.obs-4.2.sentence-1'>.</a></div></li></ul></div></div></div></div><div id='weak.spec' class='section'><h4 ><a class='secnum' href='#weak.spec' style='min-width:133pt'>23.11.2.3.6</a> <span class='texttt'>weak_&shy;ptr</span> specialized algorithms <a class='abbr_ref' href='util.smartptr.weak.spec'>[util.smartptr.weak.spec]</a></h4><span class='indexparent'><a class='index' id='lib:swap,weak_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:weak_ptr,swap_'></a></span><code class='itemdecl'>template&lt;class T&gt;
  void swap(weak_ptr&lt;T&gt;&amp; a, weak_ptr&lt;T&gt;&amp; b) noexcept;
</code><div class='itemdescr'></div><div class='para' id='weak.spec-1'><div class='marginalizedparent'><a class='marginalized' href='#weak.spec-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10683'>#</a></div><div id='weak.spec-1.sentence-1' class='sentence'><span class='textit'>Effects:</span> Equivalent to <span class='texttt'>a.swap(b)</span><a class='hidden_link' href='#weak.spec-1.sentence-1'>.</a></div></div></div></div></div><div id='ownerless' class='section'><h4 ><a class='secnum' href='#ownerless' style='min-width:118pt'>23.11.2.4</a> Class template <span class='texttt'>owner_&shy;less</span> <a class='abbr_ref' href='util.smartptr.ownerless'>[util.smartptr.ownerless]</a></h4><div class='para' id='ownerless-1'><div class='marginalizedparent'><a class='marginalized' href='#ownerless-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10688'>#</a></div><div id='ownerless-1.sentence-1' class='sentence'>The class template <span class='texttt'>owner_&shy;less</span> allows ownership-based mixed comparisons of shared
and weak pointers<a class='hidden_link' href='#ownerless-1.sentence-1'>.</a></div><span class='indexparent'><a class='index' id='lib:owner_less'></a></span><pre class='codeblock'>
namespace std {
  template&lt;class T = void&gt; struct owner_less;

  template&lt;class T&gt; struct owner_less&lt;shared_ptr&lt;T&gt;&gt; {
    bool operator()(const shared_ptr&lt;T&gt;&amp;, const shared_ptr&lt;T&gt;&amp;) const noexcept;
    bool operator()(const shared_ptr&lt;T&gt;&amp;, const weak_ptr&lt;T&gt;&amp;) const noexcept;
    bool operator()(const weak_ptr&lt;T&gt;&amp;, const shared_ptr&lt;T&gt;&amp;) const noexcept;
  };

  template&lt;class T&gt; struct owner_less&lt;weak_ptr&lt;T&gt;&gt; {
    bool operator()(const weak_ptr&lt;T&gt;&amp;, const weak_ptr&lt;T&gt;&amp;) const noexcept;
    bool operator()(const shared_ptr&lt;T&gt;&amp;, const weak_ptr&lt;T&gt;&amp;) const noexcept;
    bool operator()(const weak_ptr&lt;T&gt;&amp;, const shared_ptr&lt;T&gt;&amp;) const noexcept;
  };

  template&lt;&gt; struct owner_less&lt;void&gt; {
    template&lt;class T, class U&gt;
      bool operator()(const shared_ptr&lt;T&gt;&amp;, const shared_ptr&lt;U&gt;&amp;) const noexcept;
    template&lt;class T, class U&gt;
      bool operator()(const shared_ptr&lt;T&gt;&amp;, const weak_ptr&lt;U&gt;&amp;) const noexcept;
    template&lt;class T, class U&gt;
      bool operator()(const weak_ptr&lt;T&gt;&amp;, const shared_ptr&lt;U&gt;&amp;) const noexcept;
    template&lt;class T, class U&gt;
      bool operator()(const weak_ptr&lt;T&gt;&amp;, const weak_ptr&lt;U&gt;&amp;) const noexcept;

    using is_transparent = <span class='textit'><span class='texttt'>unspecified</span></span>;
  };
}</pre><span class='indexparent'><a class='index' id='lib:operator(),owner_less'></a></span><span class='indexparent'><a class='index' id='lib:owner_less,operator()'></a></span></div><div class='para' id='ownerless-2'><div class='marginalizedparent'><a class='marginalized' href='#ownerless-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10725'>#</a></div><div id='ownerless-2.sentence-1' class='sentence'><span class='texttt'>operator()(x, y)</span> shall return <span class='texttt'>x.owner_&shy;before(y)</span><a class='hidden_link' href='#ownerless-2.sentence-1'>.</a></div> <div id='ownerless-2.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#ownerless-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='ownerless-2.sentence-2' class='sentence'>Note that</div><div id='ownerless-2.sentence-3' class='sentence'><ul class='itemize'><li id='ownerless-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#ownerless-2.1'>(2.1)</a></div><div id='ownerless-2.1.sentence-1' class='sentence'><span class='texttt'>operator()</span> defines a strict weak ordering as defined in <a href='alg.sorting'>[alg.sorting]</a>;</div></li><li id='ownerless-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#ownerless-2.2'>(2.2)</a></div><div id='ownerless-2.2.sentence-1' class='sentence'>under the equivalence relation defined by <span class='texttt'>operator()</span>,
<span class='texttt'>!operator()(a, b) &amp;&amp; !operator()(b, a)</span>, two <span class='texttt'>shared_&shy;ptr</span> or
<span class='texttt'>weak_&shy;ptr</span> instances are equivalent if and only if they share ownership or are
both empty<a class='hidden_link' href='#ownerless-2.2.sentence-1'>.</a></div></li></ul></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><div id='enab' class='section'><h4 ><a class='secnum' href='#enab' style='min-width:118pt'>23.11.2.5</a> Class template <span class='texttt'>enable_&shy;shared_&shy;from_&shy;this</span> <a class='abbr_ref' href='util.smartptr.enab'>[util.smartptr.enab]</a></h4><div class='para' id='enab-1'><div class='marginalizedparent'><a class='marginalized' href='#enab-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10739'>#</a></div><div id='enab-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id='lib:enable_shared_from_this'></a></span>A class <span class='texttt'>T</span> can inherit from <span class='texttt'>enable_&shy;shared_&shy;from_&shy;this&lt;T&gt;</span>
to inherit the <span class='texttt'>shared_&shy;from_&shy;this</span> member functions that obtain
a <span class='texttt'>shared_&shy;ptr</span> instance pointing to <span class='texttt'>*this</span><a class='hidden_link' href='#enab-1.sentence-1'>.</a></div></div><div class='para' id='enab-2'><div class='marginalizedparent'><a class='marginalized' href='#enab-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10745'>#</a></div><div id='enab-2.example-1' class='example'>[<span style='white-space:nowrap'> </span><a class='example_link' href='#enab-2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
struct X: public enable_shared_from_this&lt;X&gt; { };

int main() {
  shared_ptr&lt;X&gt; p(new X);
  shared_ptr&lt;X&gt; q = p-&gt;shared_from_this();
  assert(p == q);
  assert(!p.owner_before(q) &amp;&amp; !q.owner_before(p)); <span class='comment'>// p and q share ownership
</span>}</pre> —<span style='white-space:nowrap'> </span><i>end example</i></div><span style='white-space:nowrap'> </span>]</div> <pre class='codeblock'>
namespace std {
  template&lt;class T&gt; class enable_shared_from_this {
  protected:
    constexpr enable_shared_from_this() noexcept;
    enable_shared_from_this(const enable_shared_from_this&amp;) noexcept;
    enable_shared_from_this&amp; operator=(const enable_shared_from_this&amp;) noexcept;
    ~enable_shared_from_this();
  public:
    shared_ptr&lt;T&gt; shared_from_this();
    shared_ptr&lt;T const&gt; shared_from_this() const;
    weak_ptr&lt;T&gt; weak_from_this() noexcept;
    weak_ptr&lt;T const&gt; weak_from_this() const noexcept;
  private:
    mutable weak_ptr&lt;T&gt; weak_this; <span class='comment'>// <span class='textit'>exposition only</span>
</span>  };
}</pre></div><div class='para' id='enab-3'><div class='marginalizedparent'><a class='marginalized' href='#enab-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10778'>#</a></div><div id='enab-3.sentence-1' class='sentence'>The template parameter <span class='texttt'>T</span> of <span class='texttt'>enable_&shy;shared_&shy;from_&shy;this</span>
may be an incomplete type<a class='hidden_link' href='#enab-3.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:enable_shared_from_this,constructor'></a></span></div><code class='itemdecl'>constexpr enable_shared_from_this() noexcept;
enable_shared_from_this(const enable_shared_from_this&lt;T&gt;&amp;) noexcept;
</code><div class='itemdescr'></div><div class='para' id='enab-4'><div class='marginalizedparent'><a class='marginalized' href='#enab-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10789'>#</a></div><div id='enab-4.sentence-1' class='sentence'><span class='textit'>Effects:</span> Value-initializes <span class='texttt'>weak_&shy;this</span><a class='hidden_link' href='#enab-4.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:operator=,enable_shared_from_this'></a></span><span class='indexparent'><a class='index' id='lib:enable_shared_from_this,operator='></a></span><code class='itemdecl'>enable_shared_from_this&lt;T&gt;&amp; operator=(const enable_shared_from_this&lt;T&gt;&amp;) noexcept;
</code><div class='itemdescr'></div><div class='para' id='enab-5'><div class='marginalizedparent'><a class='marginalized' href='#enab-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10798'>#</a></div><div id='enab-5.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*this</span><a class='hidden_link' href='#enab-5.sentence-1'>.</a></div></div></div><div class='para' id='enab-6'><div class='marginalizedparent'><a class='marginalized' href='#enab-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10800'>#</a></div><div id='enab-6.note-1' class='note'>[<span style='white-space:nowrap'> </span><a class='note_link' href='#enab-6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='enab-6.sentence-1' class='sentence'><span class='texttt'>weak_&shy;this</span> is not changed<a class='hidden_link' href='#enab-6.sentence-1'>.</a></div> —<span style='white-space:nowrap'> </span><i>end note</i></div><span style='white-space:nowrap'> </span>]</div> </div></div><span class='indexparent'><a class='index' id='lib:shared_ptr_'></a></span><span class='indexparent'><a class='index' id='lib:shared_from_this,enable_shared_from_this'></a></span><span class='indexparent'><a class='index' id='lib:enable_shared_from_this,shared_from_this'></a></span><code class='itemdecl'>shared_ptr&lt;T&gt;       shared_from_this();
shared_ptr&lt;T const&gt; shared_from_this() const;
</code><div class='itemdescr'></div><div class='para' id='enab-7'><div class='marginalizedparent'><a class='marginalized' href='#enab-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10811'>#</a></div><div id='enab-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>shared_&shy;ptr&lt;T&gt;(weak_&shy;this)</span><a class='hidden_link' href='#enab-7.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:weak_ptr__'></a></span><span class='indexparent'><a class='index' id='lib:weak_from_this,enable_shared_from_this'></a></span><span class='indexparent'><a class='index' id='lib:enable_shared_from_this,weak_from_this'></a></span><code class='itemdecl'>weak_ptr&lt;T&gt;       weak_from_this() noexcept;
weak_ptr&lt;T const&gt; weak_from_this() const noexcept;
</code><div class='itemdescr'></div><div class='para' id='enab-8'><div class='marginalizedparent'><a class='marginalized' href='#enab-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10822'>#</a></div><div id='enab-8.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>weak_&shy;this</span><a class='hidden_link' href='#enab-8.sentence-1'>.</a></div></div></div></div><div id='shared.atomic' class='section'><h4 ><a class='secnum' href='#shared.atomic' style='min-width:118pt'>23.11.2.6</a> <span class='texttt'>shared_&shy;ptr</span> atomic access <a class='abbr_ref' href='util.smartptr.shared.atomic'>[util.smartptr.shared.atomic]</a></h4><div class='para' id='shared.atomic-1'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10827'>#</a></div><div id='shared.atomic-1.sentence-1' class='sentence'>Concurrent access to a <span class='texttt'>shared_&shy;ptr</span> object from multiple threads does not
introduce a data race if the access is done exclusively via the functions in
this section and the instance is passed as their first argument<a class='hidden_link' href='#shared.atomic-1.sentence-1'>.</a></div></div><div class='para' id='shared.atomic-2'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10832'>#</a></div><div id='shared.atomic-2.sentence-1' class='sentence'>The meaning of the arguments of type <span class='texttt'>memory_&shy;order</span> is explained in <a href='atomics.order'>[atomics.order]</a><a class='hidden_link' href='#shared.atomic-2.sentence-1'>.</a></div> <span class='indexparent'><a class='index' id='lib:atomic_is_lock_free,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_is_lock_free'></a></span></div><code class='itemdecl'>template&lt;class T&gt;
  bool atomic_is_lock_free(const shared_ptr&lt;T&gt;* p);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-3'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10842'>#</a></div><div id='shared.atomic-3.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-3.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-4'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10845'>#</a></div><div id='shared.atomic-4.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if atomic access to <span class='texttt'>*p</span> is lock-free, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#shared.atomic-4.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-5'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10848'>#</a></div><div id='shared.atomic-5.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-5.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_load,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_load'></a></span><code class='itemdecl'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; atomic_load(const shared_ptr&lt;T&gt;* p);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-6'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10859'>#</a></div><div id='shared.atomic-6.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-6.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-7'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10862'>#</a></div><div id='shared.atomic-7.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>atomic_&shy;load_&shy;explicit(p, memory_&shy;order_&shy;seq_&shy;cst)</span><a class='hidden_link' href='#shared.atomic-7.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-8'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10865'>#</a></div><div id='shared.atomic-8.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-8.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_load_explicit,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_load_explicit'></a></span><code class='itemdecl'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; atomic_load_explicit(const shared_ptr&lt;T&gt;* p, memory_order mo);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-9'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10876'>#</a></div><div id='shared.atomic-9.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-9.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-10'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10879'>#</a></div><div id='shared.atomic-10.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>mo</span> shall not be <span class='texttt'>memory_&shy;order_&shy;release</span> or <span class='texttt'>memory_&shy;order_&shy;acq_&shy;rel</span><a class='hidden_link' href='#shared.atomic-10.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-11'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10882'>#</a></div><div id='shared.atomic-11.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>*p</span><a class='hidden_link' href='#shared.atomic-11.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-12'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10885'>#</a></div><div id='shared.atomic-12.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-12.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_store,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_store'></a></span><code class='itemdecl'>template&lt;class T&gt;
  void atomic_store(shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt; r);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-13'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10896'>#</a></div><div id='shared.atomic-13.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-13.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-14'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10899'>#</a></div><div id='shared.atomic-14.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>atomic_&shy;store_&shy;explicit(p, r, memory_&shy;order_&shy;seq_&shy;cst)</span><a class='hidden_link' href='#shared.atomic-14.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-15'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10902'>#</a></div><div id='shared.atomic-15.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-15.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_store_explicit,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_store_explicit'></a></span><code class='itemdecl'>template&lt;class T&gt;
  void atomic_store_explicit(shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt; r, memory_order mo);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-16'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10913'>#</a></div><div id='shared.atomic-16.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-16.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-17'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10916'>#</a></div><div id='shared.atomic-17.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>mo</span> shall not be <span class='texttt'>memory_&shy;order_&shy;acquire</span> or <span class='texttt'>memory_&shy;order_&shy;acq_&shy;rel</span><a class='hidden_link' href='#shared.atomic-17.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-18'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10919'>#</a></div><div id='shared.atomic-18.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>p-&gt;swap(r)</span><a class='hidden_link' href='#shared.atomic-18.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-19'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10922'>#</a></div><div id='shared.atomic-19.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-19.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_exchange,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_exchange'></a></span><code class='itemdecl'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; atomic_exchange(shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt; r);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-20'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10933'>#</a></div><div id='shared.atomic-20.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-20.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-21'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10936'>#</a></div><div id='shared.atomic-21.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>atomic_&shy;exchange_&shy;explicit(p, r, memory_&shy;order_&shy;seq_&shy;cst)</span><a class='hidden_link' href='#shared.atomic-21.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-22'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10939'>#</a></div><div id='shared.atomic-22.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-22.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_exchange_explicit,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_exchange_explicit'></a></span><code class='itemdecl'>template&lt;class T&gt;
  shared_ptr&lt;T&gt; atomic_exchange_explicit(shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt; r, memory_order mo);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-23'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10950'>#</a></div><div id='shared.atomic-23.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null<a class='hidden_link' href='#shared.atomic-23.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-24'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10953'>#</a></div><div id='shared.atomic-24.sentence-1' class='sentence'><span class='textit'>Effects:</span> As if by <span class='texttt'>p-&gt;swap(r)</span><a class='hidden_link' href='#shared.atomic-24.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-25'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10956'>#</a></div><div id='shared.atomic-25.sentence-1' class='sentence'><span class='textit'>Returns:</span> The previous value of <span class='texttt'>*p</span><a class='hidden_link' href='#shared.atomic-25.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-26'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10959'>#</a></div><div id='shared.atomic-26.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-26.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_compare_exchange_weak,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_compare_exchange_weak'></a></span><code class='itemdecl'>template&lt;class T&gt;
  bool atomic_compare_exchange_weak(shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt;* v, shared_ptr&lt;T&gt; w);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-27'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10970'>#</a></div><div id='shared.atomic-27.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null and <span class='texttt'>v</span> shall not be null<a class='hidden_link' href='#shared.atomic-27.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-28'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10973'>#</a></div><div id='shared.atomic-28.sentence-1' class='sentence'><span class='textit'>Returns:</span>
<pre class='codeblock'>
atomic_compare_exchange_weak_explicit(p, v, w, memory_order_seq_cst, memory_order_seq_cst)</pre></div></div></div><div class='para' id='shared.atomic-29'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10979'>#</a></div><div id='shared.atomic-29.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-29.sentence-1'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_compare_exchange_strong,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_compare_exchange_strong'></a></span><code class='itemdecl'>template&lt;class T&gt;
  bool atomic_compare_exchange_strong(shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt;* v, shared_ptr&lt;T&gt; w);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-30'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-30'>30</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L10990'>#</a></div><div id='shared.atomic-30.sentence-1' class='sentence'><span class='textit'>Returns:</span>
<pre class='codeblock'>
atomic_compare_exchange_strong_explicit(p, v, w, memory_order_seq_cst, memory_order_seq_cst)</pre></div></div></div><span class='indexparent'><a class='index' id='lib:atomic_compare_exchange_weak_explicit,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_compare_exchange_weak_explicit'></a></span><span class='indexparent'><a class='index' id='lib:atomic_compare_exchange_strong_explicit,shared_ptr'></a></span><span class='indexparent'><a class='index' id='lib:shared_ptr,atomic_compare_exchange_strong_explicit'></a></span><code class='itemdecl'>template&lt;class T&gt;
  bool atomic_compare_exchange_weak_explicit(
    shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt;* v, shared_ptr&lt;T&gt; w,
    memory_order success, memory_order failure);
template&lt;class T&gt;
  bool atomic_compare_exchange_strong_explicit(
    shared_ptr&lt;T&gt;* p, shared_ptr&lt;T&gt;* v, shared_ptr&lt;T&gt; w,
    memory_order success, memory_order failure);
</code><div class='itemdescr'></div><div class='para' id='shared.atomic-31'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-31'>31</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11011'>#</a></div><div id='shared.atomic-31.sentence-1' class='sentence'><span class='textit'>Requires:</span> <span class='texttt'>p</span> shall not be null and <span class='texttt'>v</span> shall not be null<a class='hidden_link' href='#shared.atomic-31.sentence-1'>.</a></div> <div id='shared.atomic-31.sentence-2' class='sentence'>The <span class='texttt'>failure</span> argument shall not be <span class='texttt'>memory_&shy;order_&shy;release</span> nor
<span class='texttt'>memory_&shy;order_&shy;acq_&shy;rel</span><a class='hidden_link' href='#shared.atomic-31.sentence-2'>.</a></div></div></div><div class='para' id='shared.atomic-32'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-32'>32</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11016'>#</a></div><div id='shared.atomic-32.sentence-1' class='sentence'><span class='textit'>Effects:</span> If <span class='texttt'>*p</span> is equivalent to <span class='texttt'>*v</span>, assigns <span class='texttt'>w</span> to
<span class='texttt'>*p</span> and has synchronization semantics corresponding to the value of
<span class='texttt'>success</span>, otherwise assigns <span class='texttt'>*p</span> to <span class='texttt'>*v</span> and has
synchronization semantics corresponding to the value of <span class='texttt'>failure</span><a class='hidden_link' href='#shared.atomic-32.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-33'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-33'>33</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11022'>#</a></div><div id='shared.atomic-33.sentence-1' class='sentence'><span class='textit'>Returns:</span> <span class='texttt'>true</span> if <span class='texttt'>*p</span> was equivalent to <span class='texttt'>*v</span>, <span class='texttt'>false</span> otherwise<a class='hidden_link' href='#shared.atomic-33.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-34'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-34'>34</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11025'>#</a></div><div id='shared.atomic-34.sentence-1' class='sentence'><span class='textit'>Throws:</span> Nothing<a class='hidden_link' href='#shared.atomic-34.sentence-1'>.</a></div></div></div><div class='para' id='shared.atomic-35'><div class='marginalizedparent'><a class='marginalized' href='#shared.atomic-35'>35</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11028'>#</a></div><div id='shared.atomic-35.sentence-1' class='sentence'><span class='textit'>Remarks:</span> Two <span class='texttt'>shared_&shy;ptr</span> objects are equivalent if they store the same
pointer value and share ownership<a class='hidden_link' href='#shared.atomic-35.sentence-1'>.</a></div> <div id='shared.atomic-35.sentence-2' class='sentence'>The weak form may fail spuriously<a class='hidden_link' href='#shared.atomic-35.sentence-2'>.</a></div> <div id='shared.atomic-35.sentence-3' class='sentence'>See <a href='atomics.types.operations'>[atomics.types.operations]</a><a class='hidden_link' href='#shared.atomic-35.sentence-3'>.</a></div></div></div></div><div id='hash' class='section'><h4 ><a class='secnum' href='#hash' style='min-width:118pt'>23.11.2.7</a> Smart pointer hash support <a class='abbr_ref' href='util.smartptr.hash'>[util.smartptr.hash]</a></h4><span class='indexparent'><a class='index' id='lib:hash,unique_ptr'></a></span><code class='itemdecl'>template &lt;class T, class D&gt; struct hash&lt;unique_ptr&lt;T, D&gt;&gt;;
</code><div class='itemdescr'></div><div class='para' id='hash-1'><div class='marginalizedparent'><a class='marginalized' href='#hash-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11042'>#</a></div><div id='hash-1.sentence-1' class='sentence'>Letting <span class='texttt'>UP</span> be <span class='texttt'>unique_&shy;ptr&lt;T,D&gt;</span>,
the specialization <span class='texttt'>hash&lt;UP&gt;</span> is enabled (<a href='unord.hash'>[unord.hash]</a>)
if and only if <span class='texttt'>hash&lt;typename UP&#x200b;::&#x200b;pointer&gt;</span> is enabled<a class='hidden_link' href='#hash-1.sentence-1'>.</a></div> <div id='hash-1.sentence-2' class='sentence'>When enabled, for an object <span class='texttt'>p</span> of type <span class='texttt'>UP</span>,
<span class='texttt'>hash&lt;UP&gt;()(p)</span> shall evaluate to
the same value as <span class='texttt'>hash&lt;typename UP&#x200b;::&#x200b;pointer&gt;()(p.get())</span><a class='hidden_link' href='#hash-1.sentence-2'>.</a></div> <div id='hash-1.sentence-3' class='sentence'>The member functions are not guaranteed to be <span class='texttt'>noexcept</span><a class='hidden_link' href='#hash-1.sentence-3'>.</a></div></div></div><span class='indexparent'><a class='index' id='lib:hash,shared_ptr'></a></span><code class='itemdecl'>template &lt;class T&gt; struct hash&lt;shared_ptr&lt;T&gt;&gt;;
</code><div class='itemdescr'></div><div class='para' id='hash-2'><div class='marginalizedparent'><a class='marginalized' href='#hash-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/48da313836eb57fd8282649c6c17b50a9cb97c3a/source/utilities.tex#L11058'>#</a></div><div id='hash-2.sentence-1' class='sentence'>For an object <span class='texttt'>p</span> of type <span class='texttt'>shared_&shy;ptr&lt;T&gt;</span>,
<span class='texttt'>hash&lt;shared_&shy;ptr&lt;T&gt;&gt;()(p)</span> shall evaluate to
the same value as <span class='texttt'>hash&lt;typename shared_&shy;ptr&lt;T&gt;&#x200b;::&#x200b;element_&shy;type*&gt;()(p.get())</span><a class='hidden_link' href='#hash-2.sentence-1'>.</a></div></div></div></div></div></body></html>